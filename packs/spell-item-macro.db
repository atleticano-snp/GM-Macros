{"name":"Cause Fear","type":"spell","system":{"description":{"value":"<div class=\"rd__b  rd__b--3\"><p>You awaken the sense of mortality in one creature you can see within range. A construct or an undead is immune to this effect. The target must succeed on a Wisdom saving throw or become @condition[frightened] of you until the spell ends. The @condition[frightened] target can repeat the saving throw at the end of each of its turns, ending the effect on itself on a success.</p><div class=\"rd__spc-inline-post\"></div></div><div class=\"rd__b  rd__b--3\"><div class=\"rd__b  rd__b--3\"><span class=\"rd__h rd__h--3\" data-title-index=\"1\"> <span class=\"entry-title-inner\">At Higher Levels.</span></span> <p>When you cast this spell using a spell slot of 2nd level or higher, you can target one additional creature for each slot level above 1st. The creatures must be within 30 feet of each other when you target them.</p><div class=\"rd__spc-inline-post\"></div></div><div class=\"rd__spc-inline-post\"></div></div>","chat":"","unidentified":""},"source":"XGE","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":"1","units":"minute"},"cover":null,"target":{"value":null,"width":null,"units":"","type":"creature"},"range":{"value":60,"long":null,"units":"ft"},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"save","attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"wis","dc":null,"scaling":"spell"},"level":1,"school":"nec","components":{"vocal":true,"somatic":false,"material":false,"ritual":false,"concentration":true},"materials":{"value":"","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"none","formula":""}},"img":"icons/commodities/bones/skull-hollow-worn-blue.webp","ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"flags":{"plutonium":{"page":"spells.html","source":"XGE","hash":"cause%20fear_xge","propDroppable":"spell"},"rest-recovery":{"data":{"recovery":{"enabled":false}}},"midi-qol":{"effectActivation":false,"onUseMacroName":"[preItemRoll]ItemMacro"},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"autoFailFriendly":false,"autoSaveFriendly":false,"rollOther":false,"critOther":false,"offHandWeapon":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false},"core":{"sourceId":"Actor.aPsy28VvUP9LaaJV.Item.nRWo98oTvEg5xQYJ"},"itemacro":{"macro":{"name":"Cause Fear","type":"script","scope":"global","command":"if (args[0].macroPass === \"preItemRoll\") {\n      const theTarget = args[0].targets[0];\n      if (!theTarget) return false;\n    \n      // does not work on undead/constructs\n      let invalid = [\"undead\", \"construct\"].some(type => (theTarget?.actor.system.details.type?.value || \"\").toLowerCase().includes(type));\n      if (invalid) {\n          ui.notifications.warn(\"Lay on Hands can't affect undead/constructs\")\n          return false;\n      }\n    }","author":"Be8r6Sgxcs3sL08I","_id":null,"img":"icons/svg/dice-target.svg","folder":null,"sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null}}},"cf":{"id":"temp_6q1ztzxb2o4"}},"effects":[{"label":"Cause Fear","icon":"icons/commodities/bones/skull-hollow-worn-blue.webp","changes":[{"key":"macro.CE","mode":0,"value":"Frightened","priority":20},{"key":"flags.midi-qol.OverTime","mode":0,"value":"turn=end,\nsaveAbility=wis,\nsaveDC=@attributes.spelldc","priority":20}],"transfer":false,"_id":"Rgh3ffCDEX4HABKo","disabled":false,"duration":{"startTime":null,"seconds":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"origin":null,"tint":null,"flags":{"dfreds-convenient-effects":{"description":""},"dae":{"selfTarget":false,"selfTargetAlways":false,"stackable":"noneName","durationExpression":"","macroRepeat":"none","specialDuration":[]},"core":{"statusId":""},"ActiveAuras":{"isAura":false,"aura":"None","radius":"","alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"displayTemp":false,"hostile":false,"onlyOnce":false}}}],"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1685631301114,"modifiedTime":1685638139577,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"_id":"0xQyM0EkzCQGP1HJ"}
{"name":"Booming Blade","type":"spell","system":{"description":{"value":"<div class=\"rd__b  rd__b--3\"><p>You brandish the weapon used in the spell's casting and make a melee attack with it against one creature within 5 feet of you. On a hit, the target suffers the weapon attack's normal effects and then becomes sheathed in booming energy until the start of your next turn. If the target willingly moves 5 feet or more before then, the target takes [[/r 1d8]] thunder damage, and the spell ends.</p><div class=\"rd__spc-inline-post\"></div><p>This spell's damage increases when you reach certain levels. At 5th level, the melee attack deals an extra [[/r 1d8]] thunder damage to the target on a hit, and the damage the target takes for moving increases to [[/r 2d8]]. Both damage rolls increase by 1d8 at 11th level ([[/r 2d8]] and [[/r 3d8]]) and again at 17th level ([[/r 3d8]] and [[/r 4d8]]).</p></div>","chat":"","unidentified":""},"source":"TCE","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":null,"units":""},"cover":null,"target":{"value":null,"width":null,"units":"","type":"self"},"range":{"value":null,"long":null,"units":"self"},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"util","attackBonus":null,"chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"int"},"level":0,"school":"evo","components":{"vocal":false,"somatic":true,"material":true,"ritual":false,"concentration":false,"value":""},"materials":{"value":"a melee weapon worth at least 1 sp","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"always","prepared":true},"scaling":{"mode":"cantrip","formula":"1d8"}},"img":"icons/skills/melee/strike-sword-slashing-red.webp","flags":{"plutonium":{"page":"spells.html","source":"TCE","hash":"booming%20blade_tce","propDroppable":"spell"},"rest-recovery":{"data":{"recovery":{"enabled":false}}},"midi-qol":{"effectActivation":false},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"autoFailFriendly":false,"rollOther":false,"critOther":false,"offHandWeapon":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false,"autoSaveFriendly":false},"itemacro":{"macro":{"name":"Booming Blade","type":"script","scope":"global","command":"const version = \"10.0.17\";\ntry {\n    if (![\"mwak\"].includes(args[0].item.system.actionType)) return {}; \n    if (args[0].hitTargetUuids.length === 0) return {}; // did not hit anyone\n    for (let tokenUuid of args[0].hitTargetUuids) {\n        const target = await fromUuid(tokenUuid);\n        const targetActor = target.actor;\n        if (!targetActor) continue;\n        let bsEffect = new ActiveEffect({label: \"Booming Blade\", icon: \"icons/skills/melee/strike-sword-slashing-red.webp\", duration: {rounds: 1},flags:{dae: {specialDuration: [\"turnEnd\"]}}});\n            await MidiQOL.socket().executeAsGM(\"createEffects\", {actorUuid: targetActor.uuid, effects: [bsEffect.toObject()]})\n    }\n\nconst spellLevel = actor.flags[\"midi-qol\"].boomingLevel.level;\n\nif (spellLevel > 16) {\ndados = 3} else if (spellLevel > 10) {\ndados = 2} else if (spellLevel > 4) {\ndados = 1} else {\ndados = 0}\n\nif (args[0].isCritical) dados = dados * 2;\n\n    return{damageRoll: `${dados}d8[thunder]`, flavor: \"Booming Blade\"}\n} catch (err) {\n    console.error(`${args[0].itemData.name} - Booming Blade ${version}`, err);\n}","author":"Be8r6Sgxcs3sL08I","_id":null,"img":"icons/svg/dice-target.svg","folder":null,"sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null}}},"core":{"sourceId":"Actor.YPh5XDISqV1e9Zth.Item.v7nuxo5TUTGtys7W"},"cf":{"id":"temp_6q1ztzxb2o4"}},"effects":[{"label":"Booming Blade","icon":"icons/skills/melee/strike-sword-slashing-red.webp","changes":[{"key":"flags.dnd5e.DamageBonusMacro","mode":0,"value":"ItemMacro","priority":20},{"key":"flags.midi-qol.boomingLevel.level","mode":2,"value":"@details.level","priority":20}],"transfer":false,"_id":"7Dmml4ccyo7qjwv8","disabled":false,"duration":{"startTime":null,"seconds":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"origin":null,"tint":null,"flags":{"dae":{"selfTarget":false,"selfTargetAlways":false,"stackable":"none","durationExpression":"","macroRepeat":"none","specialDuration":["1Attack:mwak"]},"core":{"statusId":""},"ActiveAuras":{"isAura":false,"aura":"None","radius":null,"alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"displayTemp":false,"hostile":false,"onlyOnce":false}}}],"ownership":{"default":0,"l056gHuKc3178tdK":3,"Be8r6Sgxcs3sL08I":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1669683494379,"modifiedTime":1686243976885,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"_id":"1BtolCJNJcPR9w1r"}
{"name":"#[CF_tempEntity]","type":"weapon","flags":{"cf":{"id":"temp_5lmql55efox","name":"Magias_premades_chris","color":"#eb3737","fontColor":"#FFFFFF","icon":"","sorting":"m","contents":["a6sXcIqCBa4AA9oE","VidDcXmpTTrALYEP","Y5CExsBpbzV7TeDA"],"children":[],"folderPath":[],"version":"2.5.7"}},"img":"icons/svg/item-bag.svg","system":{"description":{"value":"","chat":"","unidentified":""},"source":"","quantity":1,"weight":0,"price":{"value":0,"denomination":"gp"},"attunement":0,"equipped":false,"rarity":"","identified":true,"activation":{"type":"","cost":null,"condition":""},"duration":{"value":"","units":""},"cover":null,"target":{"value":null,"width":null,"units":"","type":""},"range":{"value":null,"long":null,"units":""},"uses":{"value":null,"max":"","per":null,"recovery":""},"consume":{"type":"","target":null,"amount":null},"ability":null,"actionType":null,"attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"armor":{"value":null},"hp":{"value":null,"max":null,"dt":null,"conditions":""},"weaponType":"simpleM","baseItem":"","properties":{},"proficient":true},"effects":[],"folder":null,"sort":0,"ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1684720027226,"modifiedTime":1685751112183,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"_id":"4Vkemr2SHGDR7EML"}
{"name":"Ensnaring Strike","type":"spell","img":"modules/GMmacros/img/phb-ensnaring-strike.jpg","effects":[{"_id":"QjokgzRRv5cJRCYE","changes":[{"key":"flags.dnd5e.DamageBonusMacro","mode":0,"value":"ItemMacro.Ensnaring Strike","priority":20},{"key":"flags.midi-qol.ensnaringSmite.level","mode":5,"value":"@item.level","priority":20}],"disabled":false,"duration":{"startTime":null,"rounds":10,"seconds":null,"combat":null,"turns":null,"startRound":null,"startTurn":null},"icon":"modules/plutonium/media/icon/spell/phb-ensnaring-strike.webp","label":"Ensnaring Strike","transfer":false,"flags":{"dae":{"stackable":"none","macroRepeat":"none","specialDuration":["1Hit:mwak","1Hit:rwak"],"transfer":false,"durationExpression":""},"ActiveAuras":{"isAura":false,"radius":null,"aura":"None","alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"hostile":false,"onlyOnce":false,"displayTemp":false},"core":{"statusId":""},"dnd5e-helpers":{"rest-effect":"Ignore"}},"tint":null,"origin":null}],"flags":{"srd5e":{"page":"spells.html","source":"PHB","hash":"ensnaring%20strike_phb"},"spellTemplateManager":{"stmData":{"ignoreDuration":false,"spellTexture":"","useTexture":false,"alpha":50,"coneOrigin":1,"loopAnimations":true}},"core":{"sourceId":"Item.iUIt6MO3Ioq2z59k"},"midi-qol":{"onUseMacroName":"","effectActivation":false},"itemacro":{"macro":{"data":{"_id":null,"name":"Ensnaring Strike","type":"script","author":"WpiVAovmlZrRTFMX","img":"icons/svg/dice-target.svg","scope":"global","command":"if (![\"mwak\",\"rwak\"].includes(args[0].itemData.data.actionType)) return {}; // melee weapon attack\nconst uuid = game.user.targets.first().actor.uuid;\nconst targets = Array.from(game.user.targets);\nconst spldc = actor.data.data.attributes.spelldc\nconst wait = async (ms) => new Promise((resolve)=> setTimeout(resolve, ms));\nconst hasEffectApplied = game.dfreds.effectInterface.hasEffectApplied('Restrained', uuid);\nconst spellLevel = actor.data.flags[\"midi-qol\"].ensnaringSmite.level;\nlet bsEffect = new ActiveEffect({label: \"Ensnaring Smite\", icon: \"modules/GMmacros/img/phb-ensnaring-strike.jpg\", changes: [{value: `turn=start,damageRoll=${spellLevel}d6,type=piercing,label=Ensnaring Smite`, mode: CONST.ACTIVE_EFFECT_MODES.CUSTOM, priority: 20, key:\"flags.midi-qol.OverTime\"},\n{value: \"1\", mode: CONST.ACTIVE_EFFECT_MODES.ADD, priority: 20, key:\"flags.midi-qol.disadvantage.attack.all\"},\n{value: \"1\", mode: CONST.ACTIVE_EFFECT_MODES.ADD, priority: 20, key:\"flags.midi-qol.grants.advantage.attack.all\"},\n{value: \"1\", mode: CONST.ACTIVE_EFFECT_MODES.ADD, priority: 20, key:\"flags.midi-qol.disadvantage.ability.save.dex\"},\n{value: \"0\", mode: CONST.ACTIVE_EFFECT_MODES.OVERRIDE, priority: 20, key:\"data.attributes.movement.all\"}], \n\nduration: {seconds: 60}});\n\nfor (const target of targets) {\nif (target.actor.data.data.traits.ci.value.includes(\"restrained\")) {\n  \t\tui.notifications.info(\"Restrained\");\n} else {\nfor (const target of targets) {\nawait game.MonksTokenBar.requestRoll(targets,{request:'save:str', silent: true});\nawait wait(5000)\n\nconst listMessages = game.messages.contents\nconst lastMessage = listMessages[listMessages.length - 1];\nconst spellDC = actor.data.data.attributes.spelldc\nlet tokenid = 'token'+target.id;\nlet saveRoll = lastMessage.data.flags[\"monks-tokenbar\"][tokenid].total\n\nif (saveRoll < spellDC) {\nfor (let tokenUuid of args[0].hitTargetUuids) {\n        const target = await fromUuid(tokenUuid);\n        const targetActor = target.actor;\n        if (!targetActor) continue;\n        await MidiQOL.socket().executeAsGM(\"createEffects\", {actorUuid: targetActor.uuid, effects: [bsEffect.toObject()]})\n}//for\n}//if\n}//if\n}//for\n}//else","folder":null,"sort":0,"permission":{"default":0},"flags":{}},"name":"Ensnaring Strike","type":"script","scope":"global","command":"// Modules Required - Item Macro, MIDQOL, Dynamic Active Effects\n// Card settings - Target & range: Self\n// DAE settings - [1] flags.dnd5e.DamageBonusMacro / Custom / ItemMacro.Wrathful Smite \n\nif (![\"mwak\",\"rwak\"].includes(args[0].item.data.actionType)) return {}; \nif (args[0].hitTargetUuids.length === 0) return {}; // did not hit anyone\nlet selected = await MidiQOL.MQfromActorUuid(args[0].actorUuid); \nconst targetActor = game.user.targets.first().actor.uuid;\nconst targett = game.user.targets.first();\nconst spellLevel = actor.data.flags[\"midi-qol\"].ensnaringSmite.level;\nconst effectData = {\n        label: \"Ensnaring Strike\", \n        icon: \"modules/GMmacros/img/phb-ensnaring-strike.jpg\",\n        flags: {\n          \"core\": {\n          \"statusId\": \"show\"\n        }},\n        changes: [\n          {value: `turn=start,damageRoll=${spellLevel}d6,type=piercing,label=Ensnaring Smite`, mode: CONST.ACTIVE_EFFECT_MODES.CUSTOM, priority: 20, key:\"flags.midi-qol.OverTime\"}, \n          {key: \"macro.CE\", mode: 0, value: \"Restrained\", priority: 20} // macro to apply the damage\n                ],\n        origin: \"Ensnaring Strike\", \n        disabled: false,\n      }\n\nconst immunity = targett.actor.system.traits.ci.value.has(\"restrained\");\nif(immunity === true) {\n  \tui.notifications.info(\"They are immune to restrained!\");\n} else {\n\nconst hasEffectApplied = game.dfreds.effectInterface.hasEffectApplied('Restrained', game.user.targets.first().actor.uuid)\nif(!hasEffectApplied) {\n        const actorD = canvas.tokens.controlled[0].actor;\n        const DC = selected.data.data.attributes.spelldc;\n        let results = await game.MonksTokenBar.requestRoll([game.user.targets.first()],{request:'save:str', silent: true, fastForward: false, dc: `${DC}`, flavor: \"Save against being restrained\"});\n        let tokenid = 'token'+targett.id;\n        var i = 0;\n        while (results.data.flags['monks-tokenbar'][tokenid].total === undefined && i < 30) {\n            await new Promise(resolve => setTimeout(resolve, 500))\n            i++;\n        }\n             \n        if (results.data.flags['monks-tokenbar'][tokenid].passed === false) {\n      await MidiQOL.socket().executeAsGM(\"createEffects\", { actorUuid: targetActor, effects: [effectData] });\n      }\n      }\n  } \n\nHooks.once(\"midi-qol.RollComplete\", (workflow) => {\n    console.log(\"Deleting concentration\")\n    const effect = MidiQOL.getConcentrationEffect(actor);\n    if (effect) effect.delete();\n    return true;\n})","author":"Be8r6Sgxcs3sL08I","_id":null,"img":"icons/svg/dice-target.svg","folder":null,"sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null}}},"exportSource":{"world":"criador","system":"dnd5e","coreVersion":"0.8.8","systemVersion":"1.3.6"},"siftoolkit":{"SIFData":{"ignoreDuration":false,"texture":"","useTexture":false,"alpha":50,"coneOrigin":1,"loopAnimations":true,"playTemplateAudio":false,"playDamageAudio":false,"clip":"","volume":100}},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"autoFailFriendly":false,"autoSaveFriendly":false,"offHandWeapon":false,"ignoreTotalCover":false},"cf":{"id":"temp_bj0kdv44v2"},"scene-packer":{"hash":"4da88ac660e81874205a3d7adbc3df158d14881c","sourceId":"Item.mdTcCcyIKWaJBfKS"},"rest-recovery":{"data":{"recovery":{"enabled":false}}}},"system":{"description":{"value":"<div class=\"rd__b  rd__b--3\"><p>The next time you hit a creature with a weapon attack before this spell ends, a writhing mass of thorny vines appears at the point of impact, and the target must succeed on a Strength saving throw or be <a href=\"https://5e.tools/conditionsdiseases.html#restrained_phb\" data-plut-hover=\"{&quot;page&quot;:&quot;conditionsdiseases.html&quot;,&quot;source&quot;:&quot;PHB&quot;,&quot;hash&quot;:&quot;restrained_phb&quot;}\">restrained</a> by the magical vines until the spell ends. A Large or larger creature has advantage on this saving throw. If the target succeeds on the save, the vines shrivel away.</p><div class=\"rd__spc-inline-post\"></div><p>While <a href=\"https://5e.tools/conditionsdiseases.html#restrained_phb\" data-plut-hover=\"{&quot;page&quot;:&quot;conditionsdiseases.html&quot;,&quot;source&quot;:&quot;PHB&quot;,&quot;hash&quot;:&quot;restrained_phb&quot;}\">restrained</a> by this spell, the target takes [[/r 1d6]] piercing damage at the start of each of its turns. A creature <a href=\"https://5e.tools/conditionsdiseases.html#restrained_phb\" data-plut-hover=\"{&quot;page&quot;:&quot;conditionsdiseases.html&quot;,&quot;source&quot;:&quot;PHB&quot;,&quot;hash&quot;:&quot;restrained_phb&quot;}\">restrained</a> by the vines or one that can touch the creature can use its action to make a Strength check against your spell save DC. On a success, the target is freed.</p></div><div class=\"rd__b  rd__b--3\"><div class=\"rd__b  rd__b--3\"><span class=\"rd__h rd__h--3\" data-title-index=\"2\"> <span class=\"entry-title-inner\">At Higher Levels.</span></span> <p>If you cast this spell using a spell slot of 2nd level or higher, the damage increases by [[/r 1d6]] for each slot level above 1st.</p><div class=\"rd__spc-inline-post\"></div></div><div class=\"rd__spc-inline-post\"></div></div>","chat":"","unidentified":""},"source":"PHB","activation":{"type":"bonus","cost":1,"condition":""},"duration":{"value":"1","units":"minute"},"cover":null,"target":{"value":null,"width":null,"units":"","type":"self"},"range":{"value":null,"long":null,"units":"self"},"uses":{"value":0,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"save","attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"level":1,"school":"con","components":{"vocal":true,"somatic":false,"material":false,"ritual":false,"concentration":true},"materials":{"value":"","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"level","formula":"1d6"}},"ownership":{"default":0,"WpiVAovmlZrRTFMX":3,"Be8r6Sgxcs3sL08I":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1684982005145,"modifiedTime":1684984791546,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"_id":"5GQYvOKAJOYFLeq8"}
{"name":"Blinding Smite","type":"spell","img":"modules/GMmacros/img/phb-blinding-smite.webp","effects":[{"_id":"bUvjVVw3euakm0xu","changes":[{"key":"flags.dnd5e.DamageBonusMacro","mode":0,"value":"ItemMacro.Blinding Smite","priority":20},{"key":"flags.midi-qol.blindingDC.level","mode":0,"value":"@attributes.spelldc","priority":20},{"key":"flags.midi-qol.blindingSmite.level","mode":0,"value":"3","priority":20}],"disabled":false,"duration":{"startTime":null,"rounds":10,"seconds":null,"combat":null,"turns":null,"startRound":null,"startTurn":null},"icon":"modules/plutonium/media/icon/spell/phb-blinding-smite.webp","label":"Blinding Smite","transfer":false,"flags":{"dae":{"stackable":"none","macroRepeat":"none","specialDuration":["1Hit:mwak","1Hit:rwak"],"transfer":false,"durationExpression":""},"ActiveAuras":{"isAura":false,"radius":null,"aura":"None","alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"hostile":false,"onlyOnce":false,"displayTemp":false},"core":{"statusId":""},"dnd5e-helpers":{"rest-effect":"Ignore"}},"tint":null,"origin":null}],"flags":{"srd5e":{"page":"spells.html","source":"PHB","hash":"blinding%20smite_phb"},"spellTemplateManager":{"stmData":{"ignoreDuration":false,"spellTexture":"","useTexture":false,"alpha":50,"coneOrigin":1,"loopAnimations":true}},"midi-qol":{"onUseMacroName":"","effectActivation":false},"itemacro":{"macro":{"data":{"_id":null,"name":"Blinding Smite","type":"script","author":"WpiVAovmlZrRTFMX","img":"icons/svg/dice-target.svg","scope":"global","command":"if (![\"mwak\"].includes(args[0].itemData.data.actionType)) return {}; // melee weapon attack\nconst uuid = game.user.targets.first().actor.uuid;\nconst targets = Array.from(game.user.targets);\nconst hasEffectApplied = game.dfreds.effectInterface.hasEffectApplied('Blinded', uuid);\nconst wait = async (ms) => new Promise((resolve)=> setTimeout(resolve, ms));\nconst spldc = actor.data.data.attributes.spelldc\n\nlet bsEffect = new ActiveEffect({label: \"Blinding Smite\", icon: \"modules/GMmacros/img/phb-blinding-smite.webp\", changes: [{value: `turn=end,saveDC=${spldc},saveAbility=con,label=Blinding Smite`, mode: CONST.ACTIVE_EFFECT_MODES.CUSTOM, priority: 20, key:\"flags.midi-qol.OverTime\"},{value: 1, mode:CONST.ACTIVE_EFFECT_MODES.ADD, priority: 20, key:\"flags.midi-qol.disadvantage.attack.all\"},{value: 1, mode:CONST.ACTIVE_EFFECT_MODES.ADD, priority: 20, key:\"flags.midi-qol.grants.advantage.attack.all\"}], duration: {seconds: 60}});\n\n\nfor (const target of targets) {\nif (target.actor.data.data.traits.ci.value.includes(\"blinded\")) {\n  \t\tui.notifications.info(\"Imune to Blind!\");\n} else { \n\nawait game.MonksTokenBar.requestRoll(targets,{request:'save:con', silent: true});\nawait wait(5000)\n\nconst listMessages = game.messages.contents\nconst lastMessage = listMessages[listMessages.length - 1];\nconst spellDC = actor.data.data.attributes.spelldc\nlet tokenid = 'token'+target.id;\nlet saveRoll = lastMessage.data.flags[\"monks-tokenbar\"][tokenid].total\n\nif (saveRoll < spellDC) {\nif (!hasEffectApplied) {\n  for (let tokenUuid of args[0].hitTargetUuids) {\n        const target = await fromUuid(tokenUuid);\n        const targetActor = target.actor;\n        if (!targetActor) continue;\n        await MidiQOL.socket().executeAsGM(\"createEffects\", {actorUuid: targetActor.uuid, effects: [bsEffect.toObject()]})\n} // for\n} // if has\n} // if save\n} // else\n} // for target\n\n\nlet spellLevel = 3;\nif (args[0].isCritical) spellLevel = spellLevel * 2;\nreturn{damageRoll: `${spellLevel}d8[radiant]`, flavor: \"Blinding Smite\"};","folder":null,"sort":0,"permission":{"default":0},"flags":{}},"name":"Blinding Smite","type":"script","scope":"global","command":"// Modules Required - Item Macro, MIDQOL, Dynamic Active Effects\n// Card settings - Target & range: Self\n// DAE settings - [1] flags.dnd5e.DamageBonusMacro / Custom / ItemMacro.Blinding Smite\n\nif (![\"mwak\",\"rwak\"].includes(args[0].item.data.actionType)) return {}; \nif (args[0].hitTargetUuids.length === 0) return {}; // did not hit anyone\nlet selected = await MidiQOL.MQfromActorUuid(args[0].actorUuid); \nconst targetActor = game.user.targets.first().actor.uuid;\nconst DC = selected.data.data.attributes.spelldc;\nconst targett = game.user.targets.first();\nconst effectData = {\n        label: \"Blinding Smite\", \n        icon: \"modules/GMmacros/img/phb-blinding-smite.webp\",\n        flags: {\n          \"core\": {\n          \"statusId\": \"show\"\n        }},\n        changes: [\n          {key: \"flags.midi-qol.OverTime\", mode: 0, value: `turn=end,saveAbility=con,saveDC=${DC},label=Blinding Smite`, priority: 20}, \n          {key: \"macro.CE\", mode: 0, value: \"Blinded\", priority: 20} // macro to apply the damage\n                ],\n\tduration: {seconds: 60}\n      }\n\nconst immunity = targett.actor.system.traits.ci.value.has(\"blinded\");\nif(immunity === true) {\n  \tui.notifications.info(\"They are immune to Blinded!\");\n} else {\n\nconst hasEffectApplied = game.dfreds.effectInterface.hasEffectApplied('Blinded', game.user.targets.first().actor.uuid)\nif(!hasEffectApplied) {\n        const actorD = canvas.tokens.controlled[0].actor;\n        let results = await game.MonksTokenBar.requestRoll([game.user.targets.first()],{request:'save:wis', silent: true, fastForward: false, dc: `${DC}`, flavor: \"Save against being Blinded\"});\n        let tokenid = 'token'+targett.id;\n        var i = 0;\n        while (results.data.flags['monks-tokenbar'][tokenid].total === undefined && i < 30) {\n            await new Promise(resolve => setTimeout(resolve, 500))\n            i++;\n        }\n             \n        if (results.data.flags['monks-tokenbar'][tokenid].passed === false) {\n      await MidiQOL.socket().executeAsGM(\"createEffects\", { actorUuid: targetActor, effects: [effectData] });\n      }\n      }\n  } \n\nHooks.once(\"midi-qol.RollComplete\", (workflow) => {\n    console.log(\"Deleting concentration\")\n    const effect = MidiQOL.getConcentrationEffect(actor);\n    if (effect) effect.delete();\n    return true;\n})\n\nlet spellLevel = 3;\nif (args[0].isCritical) spellLevel = spellLevel * 2;\nreturn{damageRoll: `${spellLevel}d8[radiant]`, flavor: \"Blinding Smite\"};","author":"Be8r6Sgxcs3sL08I","_id":null,"img":"icons/svg/dice-target.svg","folder":null,"sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null}}},"core":{"sourceId":"Item.rf69h6xNdtAnObgs"},"exportSource":{"world":"criador","system":"dnd5e","coreVersion":"0.8.8","systemVersion":"1.3.6"},"siftoolkit":{"SIFData":{"ignoreDuration":false,"texture":"","useTexture":false,"alpha":50,"coneOrigin":1,"loopAnimations":true,"playTemplateAudio":false,"playDamageAudio":false,"playSaveAudio":false,"clip":"","volume":100}},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"autoFailFriendly":false,"autoSaveFriendly":false,"offHandWeapon":false,"ignoreTotalCover":false},"cf":{"id":"temp_bj0kdv44v2"},"scene-packer":{"hash":"eb9e70407027add56d9d8a4ff17616d7ad628f7b","sourceId":"Item.IvQefmPblsJAvuPP"},"rest-recovery":{"data":{"recovery":{"enabled":false}}}},"system":{"description":{"value":"<div class=\"rd__b  rd__b--3\"><p>The next time you hit a creature with a melee weapon attack during this spell's duration, your weapon flares with bright light, and the attack deals an extra [[/r 3d8]] radiant damage to the target. Additionally, the target must succeed on a Constitution saving throw or be <a href=\"https://5e.tools/conditionsdiseases.html#blinded_phb\" data-plut-hover=\"{&quot;page&quot;:&quot;conditionsdiseases.html&quot;,&quot;source&quot;:&quot;PHB&quot;,&quot;hash&quot;:&quot;blinded_phb&quot;}\">blinded</a> until the spell ends.</p><div class=\"rd__spc-inline-post\"></div><p>A creature <a href=\"https://5e.tools/conditionsdiseases.html#blinded_phb\" data-plut-hover=\"{&quot;page&quot;:&quot;conditionsdiseases.html&quot;,&quot;source&quot;:&quot;PHB&quot;,&quot;hash&quot;:&quot;blinded_phb&quot;}\">blinded</a> by this spell makes another Constitution saving throw at the end of each of its turns. On a successful save, it is no longer <a href=\"https://5e.tools/conditionsdiseases.html#blinded_phb\" data-plut-hover=\"{&quot;page&quot;:&quot;conditionsdiseases.html&quot;,&quot;source&quot;:&quot;PHB&quot;,&quot;hash&quot;:&quot;blinded_phb&quot;}\">blinded</a>.</p></div>","chat":"","unidentified":""},"source":"PHB","activation":{"type":"bonus","cost":1,"condition":""},"duration":{"value":"1","units":"minute"},"cover":null,"target":{"value":null,"width":null,"units":"","type":"self"},"range":{"value":null,"long":null,"units":"self"},"uses":{"value":0,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"other","attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"level":3,"school":"evo","components":{"vocal":true,"somatic":false,"material":false,"ritual":false,"concentration":true},"materials":{"value":"","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"none","formula":""}},"ownership":{"default":0,"WpiVAovmlZrRTFMX":3,"Be8r6Sgxcs3sL08I":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1684984048423,"modifiedTime":1684984786128,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"_id":"6ZLGz7J1QOpEP5qY"}
{"name":"Investiture of Ice","type":"spell","img":"icons/magic/water/elemental-water.webp","effects":[{"_id":"VygXwtkI2whJS9vA","changes":[{"key":"macro.itemMacro","mode":0,"value":"@item","priority":20},{"key":"system.traits.di.value","mode":0,"value":"cold","priority":20},{"key":"system.traits.dr.value","mode":0,"value":"fire","priority":20}],"disabled":false,"duration":{"startTime":null,"seconds":600,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"icon":"icons/magic/water/strike-ice-blade-axe.webp","label":"Investiture of Ice","transfer":false,"flags":{"dae":{"stackable":"none","macroRepeat":"none","specialDuration":[],"transfer":false,"selfTarget":false,"selfTargetAlways":false,"durationExpression":""},"dnd5e-helpers":{"rest-effect":"Ignore"},"ActiveAuras":{"isAura":false,"aura":"All","radius":"","alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"hostile":false,"onlyOnce":false,"displayTemp":false},"dfreds-convenient-effects":{"description":""},"core":{"statusId":""}},"tint":null,"origin":null}],"flags":{"ddbimporter":{"id":138169,"definitionId":2387,"entityTypeId":435869154,"dndbeyond":{"lookup":"generic","lookupName":"generic","level":null,"castAtLevel":null},"sources":[{"sourceId":4,"pageNumber":159,"sourceType":1}],"tags":["Damage","Control","Warding"]},"betterRolls5e":{"quickVersatile":{"altValue":true},"quickCharges":{"value":{"use":true,"resource":true},"altValue":{"use":true,"resource":true}}},"core":{"sourceId":"Compendium.SharedData.spells.CEfnuDlO2vfx0Zqx"},"siftoolkit":{"SIFData":{"ignoreDuration":false,"texture":"","useTexture":false,"alpha":50,"coneOrigin":1,"loopAnimations":true,"playTemplateAudio":false,"playDamageAudio":false,"playSaveAudio":false,"clip":"","volume":100}},"enhanced-terrain-layer":{"multiple":1,"min":0,"max":0,"environment":""},"midi-qol":{"onUseMacroName":"","effectActivation":false},"itemacro":{"macro":{"data":{"_id":null,"name":"Investiture of Ice","type":"script","author":"jM4h8qpyxwTpfNli","img":"icons/svg/dice-target.svg","scope":"global","command":"const lastArg = args[args.length - 1];\nconst thisToken = canvas.tokens.get(lastArg.tokenId);\n\nif (args[0] === \"on\") {\n  // If the dynamic active effect started\n  new Sequence()\n    .effect()\n    .file(\n      \"modules/jb2a_patreon/Library/3rd_Level/Sleet_Storm/SleetStorm_01_Blue_800x800.webm\"\n    )\n    .attachTo(thisToken)\n    .belowTokens()\n    .persist()\n    .name(`Icy Terrain-${thisToken.id}`)\n    .fadeIn(300)\n    .fadeOut(500)\n    .play();\n\n  const updates = {\n    embedded: {\n      //create Winter Wind part of this spell\n      Item: {\n        \"Freezing Wind\": {\n          type: \"feat\",\n          img: \"systems/dnd5e/icons/spells/fog-blue-3.jpg\",\n          data: {\n            description: {\n              value:\n                \"<p>You can use your action to create a 15-foot cone of freezing wind extending from your outstretched hand in a direction you choose. Each creature in the cone must make a Constitution saving throw. A creature takes 4d6 cold damage on a failed save, or half as much damage on a successful one. A creature that fails its save against this effect has its speed halved until the start of your next turn.</p>\",\n              chat: \"\",\n              unidentified: \"\",\n            },\n            source: \"\",\n            activation: {\n              type: \"action\",\n              cost: 1,\n              condition: \"\",\n            },\n            duration: {\n              value: null,\n              units: \"inst\",\n            },\n            target: {\n              value: 15,\n              width: null,\n              units: \"ft\",\n              type: \"cone\",\n            },\n            range: {\n              value: null,\n              long: null,\n              units: \"\",\n            },\n            uses: {\n              value: null,\n              max: \"\",\n              per: \"\",\n            },\n            consume: {\n              type: \"\",\n              target: \"\",\n              amount: null,\n            },\n            ability: \"\",\n            actionType: \"save\",\n            attackBonus: 0,\n            chatFlavor: \"\",\n            critical: {\n              threshold: null,\n              damage: \"\",\n            },\n            damage: {\n              parts: [[\"4d6\", \"cold\"]],\n              versatile: \"\",\n            },\n            formula: \"\",\n            save: {\n              ability: \"con\",\n              dc: null,\n              scaling: \"spell\",\n            },\n            requirements: \"\",\n            recharge: {\n              value: null,\n              charged: false,\n            },\n          },\n          effects: [\n            {\n              _id: \"yisApSXj0G5K8YBj\",\n              changes: [\n                {\n                  key: \"data.attributes.movement.walk\",\n                  mode: 1,\n                  value: \".5\",\n                  priority: \"20\",\n                },\n              ],\n              disabled: false,\n              duration: {\n                startTime: null,\n              },\n              icon: \"systems/dnd5e/icons/spells/fog-blue-3.jpg\",\n              label: \"Freezing Wind\",\n              transfer: false,\n              flags: {\n                dae: {\n                  stackable: \"none\",\n                  macroRepeat: \"none\",\n                  specialDuration: [\"turnStartSource\"],\n                  transfer: false,\n                },\n                \"dnd5e-helpers\": {\n                  \"rest-effect\": \"Ignore\",\n                },\n                ActiveAuras: {\n                  isAura: false,\n                  aura: \"None\",\n                  radius: null,\n                  alignment: \"\",\n                  type: \"\",\n                  ignoreSelf: false,\n                  height: false,\n                  hidden: false,\n                  hostile: false,\n                  onlyOnce: false,\n                },\n              },\n              tint: \"\",\n              selectedKey: \"data.attributes.movement.walk\",\n            },\n          ],\n        },\n      },\n    },\n  };\n  //update the token and create the necessary attack spell\n  await warpgate.mutate(thisToken.document, updates);\n  ui.notifications.info(`Freezing Wind has been added to actions.`);\n}\nif (args[0] === \"off\") {\n  //Concentration broke or time expired, let's revert the token and remove the attack spell item\n  await warpgate.revert(thisToken.document);\n  Sequencer.EffectManager.endEffects({\n    name: `Icy Terrain-${thisToken.id}`,\n    object: thisToken,\n  });\n}","folder":null,"sort":0,"permission":{"default":0},"flags":{}},"name":"Investiture of Ice","type":"script","scope":"global","command":"const lastArg = args[args.length - 1];\nconst thisToken = canvas.tokens.get(lastArg.tokenId);\n\nif (args[0] === \"on\") {\n  // If the dynamic active effect started\n    const updates = {\n        embedded: {\n            Item: {\n                \"Freezing Wind\": { //String\n                    type: \"spell\", // feat, spell\n                    img: \"icons/magic/air/wind-weather-snow-gusts.webp\", //Example: \"icons/magic/holy/projectiles-blades-salvo-yellow.webp\"\n                    type: \"spell\",\n                    flags: {\n                        \"midi-qol\": {\n                            onUseMacroName: \"[postActiveEffects]Enervate Healing\",\n                        },\n                    },\n                    system: {\n                        description: {\n                            value: \"<p>You can use your action to create a 15-foot cone of freezing wind extending from your outstretched hand in a direction you choose. Each creature in the cone must make a Constitution saving throw. A creature takes 4d6 cold damage on a failed save, or half as much damage on a successful one. A creature that fails its save against this effect has its speed halved until the start of your next turn.</p>\", //String\n                        },\n                        activation: {\n                            type: \"action\", // action, bonus, crew, day, hour, lair, legendary, minute, none, reaction, special, reactiondamage, reactionmanual\n                            cost: 1, // Numeric\n                            condition: \"\" // String\n                        },\n                        target: {\n                        value: 15,\n                        width: null,\n                        units: \"ft\",\n                        type: \"cone\",\n                        },\n                        actionType: \"other\", // mwak, rwak, msak, rsak, save, heal, abil, util, other\n                        damage: {\n                            parts: [\n                                [ \"4d6\", \"cold\" ] // [\"Formula\", \"acid, bludgeoning, cold, fire, force, lightning, necrotic, piercing, poison, psychic, radiant, slashing, thunder, healing, temphp\"]\n                            ]\n                        },\n                        level: 6, // Numeric 1-9\n                        school: \"trans\", // abj, con, div, enc, evo, ill, nec, trs\n                        preparation: {\n                            mode: \"atwill\", // prepared, pact, always, atwill, innate\n                            prepared: true // true, false\n                        },\n                        save: {\n                        ability: \"con\",\n                        dc: null,\n                        scaling: \"spell\",\n                        },\n                        },\n                     effects: [\n                        {\n                        _id: \"yisApSXj0G5K8YBj\",\n                        changes: [\n                        {\n                        key: \"data.attributes.movement.walk\",\n                        mode: 1,\n                        value: \".5\",\n                        priority: \"20\",\n                        },\n                        ],\n                        disabled: false,\n                        duration: {\n                        startTime: null,\n                        },\n                        icon: \"icons/magic/air/wind-weather-snow-gusts.webp\",\n                        label: \"Freezing Wind\",\n                        transfer: false,\n                        flags: {\n                        dae: {\n                        stackable: \"none\",\n                        macroRepeat: \"none\",\n                        specialDuration: [\"turnStartSource\"],\n                        transfer: false,\n                        },\n                        core:{\n                        statusId: \"show\"\n                        },\n                        \"dnd5e-helpers\": {\n                        \"rest-effect\": \"Ignore\",\n                        },\n                ActiveAuras: {\n                  isAura: false,\n                  aura: \"None\",\n                  radius: null,\n                  alignment: \"\",\n                  type: \"\",\n                  ignoreSelf: false,\n                  height: false,\n                  hidden: false,\n                  hostile: false,\n                  onlyOnce: false,\n                },\n              },\n              tint: \"\",\n              selectedKey: \"data.attributes.movement.walk\",\n            },\n          ],\n                }\n            }\n        }\n    }\n  //update the token and create the necessary attack spell\n await warpgate.mutate(thisToken.document, updates);\n//  ui.notifications.info(`Freezing Wind has been added to spells at will.`);\n}\nif (args[0] === \"off\") {\n  //Concentration broke or time expired, let's revert the token and remove the attack spell item\n await warpgate.revert(thisToken.document);\n}","author":"Be8r6Sgxcs3sL08I","_id":null,"img":"icons/svg/dice-target.svg","folder":null,"sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null}}},"exportSource":{"world":"Rime-of-the-Frost-Maiden","system":"dnd5e","coreVersion":"0.8.9","systemVersion":"1.5.3"},"rest-recovery":{"data":{"recovery":{"enabled":false}}},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"autoFailFriendly":false,"autoSaveFriendly":false,"rollOther":false,"critOther":false,"offHandWeapon":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false},"cf":{"id":"temp_6q1ztzxb2o4"}},"system":{"description":{"value":"<p>Until the spell ends, ice rimes your body, and you gain the following benefits:</p>\n<ul>\n<li>\n<p>You are immune to cold damage and have resistance to fire damage.</p>\n</li>\n<li>\n<p>You can move across difficult terrain created by ice or snow without spending extra movement.</p>\n</li>\n<li>\n<p>The ground in a 10-foot radius around you is icy and is difficult terrain for creatures other than you. The radius moves with you.</p>\n</li>\n<li>\n<p>You can use your action to create a 15-foot cone of freezing wind extending from your outstretched hand in a direction you choose. Each creature in the cone must make a Constitution saving throw. A creature takes 4d6 cold damage on a failed save, or half as much damage on a successful one. A creature that fails its save against this effect has its speed halved until the start of your next turn.</p>\n</li>\n</ul>","chat":"<p>Until the spell ends, ice rimes your body, and you gain the following benefits:</p>\n<ul>\n<li>\n<p>You are immune to cold damage and have resistance to fire damage.</p>\n</li>\n<li>\n<p>You can move across difficult terrain created by ice or snow without spending extra movement.</p>\n</li>\n<li>\n<p>The ground in a 10-foot radius around you is icy and is difficult terrain for creatures other than you. The radius moves with you.</p>\n</li>\n<li>\n<p>You can use your action to create a 15-foot cone of freezing wind extending from your outstretched hand in a direction you choose. Each creature in the cone must make a Constitution saving throw. A creature takes 4d6 cold damage on a failed save, or half as much damage on a successful one. A creature that fails its save against this effect has its speed halved until the start of your next turn.</p>\n</li>\n</ul>","unidentified":""},"source":"Elemental Evil Player's Companion pg 159","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":"10","units":"minute"},"cover":null,"target":{"value":null,"width":null,"units":"","type":"self"},"range":{"value":null,"long":null,"units":"self"},"uses":{"value":0,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"other","attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"level":6,"school":"trs","components":{"vocal":true,"somatic":true,"material":false,"ritual":false,"concentration":true},"materials":{"value":"","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"none","formula":""}},"ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1685807590722,"modifiedTime":1685814109720,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"_id":"7HRCx2kiSHNnxArq"}
{"name":"Hex","type":"spell","system":{"description":{"value":"<div class=\"rd__b  rd__b--3\"><p>You place a curse on a creature that you can see within range. Until the spell ends, you deal an extra [[/r 1d6]] necrotic damage to the target whenever you hit it with an attack. Also, choose one ability when you cast the spell. The target has disadvantage on ability checks made with the chosen ability.</p><div class=\"rd__spc-inline-post\"></div><p>If the target drops to 0 hit points before this spell ends, you can use a bonus action on a subsequent turn of yours to curse a new creature.</p><p>A @spell[remove curse] cast on the target ends this spell early.</p></div><div class=\"rd__b  rd__b--3\"><div class=\"rd__b  rd__b--3\"><span class=\"rd__h rd__h--3\" data-title-index=\"65\"> <span class=\"entry-title-inner\">At Higher Levels.</span></span> <p>When you cast this spell using a spell slot of 3rd or 4th level, you can maintain your concentration on the spell for up to 8 hours. When you use a spell slot of 5th level or higher, you can maintain your concentration on the spell for up to 24 hours.</p><div class=\"rd__spc-inline-post\"></div></div><div class=\"rd__spc-inline-post\"></div></div>","chat":"","unidentified":""},"source":"PHB","activation":{"type":"bonus","cost":1,"condition":""},"duration":{"value":1,"units":"hour"},"cover":null,"target":{"value":0,"width":null,"units":"","type":"creature"},"range":{"value":90,"long":null,"units":"ft"},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"util","attackBonus":null,"chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"level":1,"school":"enc","components":{"vocal":true,"somatic":true,"material":true,"ritual":false,"concentration":true,"value":""},"materials":{"value":"the petrified eye of a newt","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"none","formula":""}},"img":"icons/magic/control/voodoo-doll-pain-damage-red.webp","flags":{"plutonium":{"page":"spells.html","source":"PHB","hash":"hex_phb","propDroppable":"spell"},"itemacro":{"macro":{"name":"Hex","type":"script","scope":"global","command":"const version = \"10.0.10\";\ntry {\n\tif (actor.flags?.dae?.onUpdateTarget && args[0].hitTargets.length > 0) {\n\tconst isMarked = actor.flags.dae.onUpdateTarget.find(flag => \n\t\t\tflag.flagName === \"Hex\" && flag.sourceTokenUuid === args[0].hitTargetUuids[0]);\n\tif (isMarked) {\n\t        let damageType = args[0].item.system.damage.parts[0][1];\n\t        const diceMult = args[0].isCritical ? 2: 1;\n\t        return {damageRoll: `${diceMult}d6[necrotic]`, flavor: \"Hex\"};\n\t}\t\n}\nreturn {};\n} catch (err) {\n\t    console.error(`${args[0].itemData.name} - Hex ${version}`, err);\n\t\treturn {}\n}","author":"Be8r6Sgxcs3sL08I","_id":null,"img":"icons/svg/dice-target.svg","folder":null,"sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null}}},"rest-recovery":{"data":{"recovery":{"enabled":false}}},"midi-qol":{"effectActivation":false},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false,"autoFailFriendly":false,"autoSaveFriendly":false,"offHandWeapon":false},"core":{"sourceId":"Actor.l17Codzmb868P2e7.Item.ESR4e9bhBwpEF38l"},"cf":{"id":"temp_6q1ztzxb2o4"}},"effects":[{"label":"Hex","icon":"icons/magic/control/voodoo-doll-pain-damage-red.webp","changes":[{"key":"flags.dnd5e.DamageBonusMacro","mode":0,"value":"ItemMacro","priority":20}],"transfer":true,"_id":"6GBt0klUMbj7pdu0","disabled":false,"duration":{"startTime":null,"seconds":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"origin":null,"tint":null,"flags":{"dae":{"selfTarget":false,"selfTargetAlways":false,"stackable":"none","durationExpression":"","macroRepeat":"none","specialDuration":[]},"core":{"statusId":""},"ActiveAuras":{"isAura":false,"aura":"None","radius":null,"alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"displayTemp":false,"hostile":false,"onlyOnce":false}}},{"label":"Hex","icon":"icons/magic/control/voodoo-doll-pain-damage-red.webp","changes":[{"key":"flags.dae.onUpdateSource","mode":0,"value":"Hex","priority":20}],"transfer":false,"_id":"0ZjraMDyURYU0T9t","disabled":false,"duration":{"startTime":null,"seconds":3600,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"origin":null,"tint":null,"flags":{"dae":{"selfTarget":false,"selfTargetAlways":false,"stackable":"none","durationExpression":"","macroRepeat":"none","specialDuration":[]},"core":{"statusId":""},"ActiveAuras":{"isAura":false,"aura":"None","radius":null,"alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"displayTemp":false,"hostile":false,"onlyOnce":false}}}],"ownership":{"default":0,"QEGPFkVbwvqQv8sl":3,"Be8r6Sgxcs3sL08I":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1669603610917,"modifiedTime":1685623845320,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"_id":"7LHvzm1F8aJpLzbf"}
{"name":"Aid","type":"spell","img":"icons/magic/life/heart-cross-blue.webp","effects":[{"_id":"9lafpgID8ffkvJ9q","flags":{},"changes":[{"key":"system.attributes.hp.max","value":"5 * (@spellLevel - 1)","mode":2,"priority":20},{"key":"macro.itemMacro","value":"@spellLevel @data.attributes.hp.max","mode":0,"priority":0}],"disabled":false,"duration":{"startTime":null,"seconds":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"icon":"icons/magic/life/heart-cross-blue.webp","label":"Aid","tint":null,"transfer":false,"origin":null}],"flags":{"midi-qol":{"onUseMacroName":""},"dynamiceffects":{"equipActive":false,"alwaysActive":false,"effects":[{"modSpecKey":"data.attributes.hp.max","value":"5 * @spellLevel + @classes.paladin.levels","mode":"+","targetSpecific":false,"id":1,"itemId":"aAyxEwNPeiB4nsCs","active":true,"_targets":[],"label":"Attributes HP Max"},{"modSpecKey":"data.bonuses.mwak.damage","value":"(ceil(@classes.paladin.levels/2))d6","mode":"+","targetSpecific":false,"id":2,"itemId":"aAyxEwNPeiB4nsCs","active":true,"_targets":[]}]},"favtab":{"isFavourite":true},"dae":{"alwaysActive":false,"activeEquipped":false},"itemacro":{"macro":{"data":{"_id":null,"name":"Aid","type":"script","author":"Jwooh1sMQvmhHrUO","img":"icons/svg/dice-target.svg","scope":"global","command":"MidiMacros.aid(args)","folder":null,"sort":0,"permission":{"default":0},"flags":{}}}},"exportSource":{"world":"testWorld","system":"dnd5e","coreVersion":"0.7.7","systemVersion":"1.1.1"},"core":{"sourceId":"Item.F6gMC9VPMrxfyGGN"},"mess":{"templateTexture":""},"rest-recovery":{"data":{"recovery":{"enabled":false}}},"cf":{"id":"temp_6q1ztzxb2o4"}},"system":{"description":{"value":"<p>Your spell bolsters your allies with toughness and resolve. Choose up to three creatures within range. Each target's hit point maximum and current hit points increase by 5 for the duration.</p>\n                                                        <p><strong>At Higher Levels.</strong> When you cast this spell using a spell slot of 3rd level or higher, a target's hit points increase by an additional 5 for each slot level above 2nd.</p>","chat":"","unidentified":""},"source":"PHB pg. 211","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":"8","units":"hour"},"cover":null,"crewed":false,"target":{"value":null,"width":null,"units":"","type":"creature"},"range":{"value":30,"long":null,"units":""},"uses":{"value":0,"max":"","per":null,"recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"","attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"level":2,"school":"abj","components":{"vocal":true,"somatic":true,"material":true,"ritual":false,"concentration":false},"materials":{"value":"A tiny strip of white cloth.","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"level","formula":""}},"ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.2.1","coreVersion":"10.291","createdTime":1663114169154,"modifiedTime":1688080849428,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"_id":"8IE0lszIgvk6neFK"}
{"name":"Convocar Dancing Sword","type":"weapon","img":"icons/weapons/swords/greatsword-guard-gem-blue.webp","system":{"description":{"value":"<div class=\"rd__b  rd__b--2\"><p>You can use a bonus action to toss this magic sword into the air and speak the command word. When you do so, the sword begins to hover, flies up to 30 feet, and attacks one creature of your choice within 5 feet of it. The sword uses your attack roll and ability score modifier to damage rolls.</p><p>While the sword hovers, you can use a bonus action to cause it to fly up to 30 feet to another spot within 30 feet of you. As part of the same bonus action, you can cause the sword to attack one creature within 5 feet of it.</p><p>After the hovering sword attacks for the fourth time, it flies up to 30 feet and tries to return to your hand. If you have no hand free, it falls to the ground at your feet. If the sword has no unobstructed path to you, it moves as close to you as it can and then falls to the ground. It also ceases to hover if you grasp it or move more than 30 feet away from it.</p><div class=\"rd__b  rd__b--3\"><p><span class=\"entry-title-inner\">Base items.</span></p><p>This item variant can be applied to the following base items:</p><div class=\"rd__spc-inline-post\"><p></p></div><ul class=\"rd__list\"><li class=\"rd__li \">@item[Double-Bladed Scimitar|ERLW] (@item[Dancing Double-Bladed Scimitar|DMG])</li><li class=\"rd__li \">@item[Greatsword|PHB] (@item[Dancing Greatsword|DMG])</li><li class=\"rd__li \">@item[Longsword|PHB] (@item[Dancing Longsword|DMG])</li><li class=\"rd__li \">@item[Rapier|PHB] (@item[Dancing Rapier|DMG])</li><li class=\"rd__li \">@item[Scimitar|PHB] (@item[Dancing Scimitar|DMG])</li><li class=\"rd__li \">@item[Shortsword|PHB] (@item[Dancing Shortsword|DMG])</li></ul></div></div>","chat":"","unidentified":""},"source":"SRD 5.1","quantity":1,"weight":6,"price":{"value":50,"denomination":"gp"},"attunement":0,"equipped":true,"rarity":"veryRare","identified":true,"activation":{"type":"action","cost":1,"condition":""},"duration":{"value":"","units":""},"cover":null,"target":{"value":null,"width":null,"units":"","type":""},"range":{"value":5,"long":null,"units":"ft"},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"other","attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"armor":{"value":10},"hp":{"value":0,"max":0,"dt":null,"conditions":""},"weaponType":"martialM","baseItem":"greatsword","properties":{"hvy":true,"two":true,"ada":false,"amm":false,"fin":false,"fir":false,"foc":false,"lgt":false,"lod":false,"mgc":false,"rch":false,"rel":false,"ret":false,"sil":false,"spc":false,"thr":false,"ver":false},"proficient":true},"effects":[],"ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"flags":{"core":{"sourceId":"Compendium.dnd5e.items.xMkP8BmFzElcsMaR"},"rest-recovery":{"data":{"recovery":{"enabled":false}}},"midi-qol":{"fumbleThreshold":null,"effectActivation":false,"onUseMacroName":"[postActiveEffects]ItemMacro"},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"autoFailFriendly":false,"autoSaveFriendly":false,"rollOther":false,"critOther":false,"offHandWeapon":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false},"magicitems":{"enabled":false,"equipped":false,"attuned":false,"charges":"0","chargeType":"c1","destroy":false,"destroyFlavorText":"reaches 0 charges: it crumbles into ashes and is destroyed.","rechargeable":false,"recharge":"0","rechargeType":"t1","rechargeUnit":"r1","sorting":"l"},"itemacro":{"macro":{"name":"Dancing Sword","type":"script","scope":"global","command":"let me = canvas.tokens.controlled[0].actor;\nconst mestr = me.system.abilities.str.value\nconst medex = me.system.abilities.dex.value\nconst mecon = me.system.abilities.con.value\nconst meint = me.system.abilities.int.value\nconst mewis = me.system.abilities.wis.value\nconst mecha = me.system.abilities.cha.value\nconst cer = me.system.details.level\n\nlet updates = {\n        'actor': {\n            'name': \"Dancing Sword\",\n            'system': {\n                'details': {\n                    'cr': cer\n                },\n                'abilities': {\n                    'str': {\n                        'value': mestr\n                    },\n                    'dex': {\n                        'value': medex\n                    },\n                    'con': {\n                        'value': mecon\n                    },\n                    'int': {\n                        'value': meint\n                    },\n                    'wis': {\n                        'value': mewis\n                    },\n                    'cha': {\n                        'value': mecha\n                    }\n                 }  // abilities \n            } // system\n        },// actor\n}//updates\n  \n  await warpgate.spawn(\"Dancing Sword\",  updates)","author":"Be8r6Sgxcs3sL08I","_id":null,"img":"icons/svg/dice-target.svg","folder":null,"sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null}}},"cf":{"id":"temp_bnv1ahmj4k"}},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1661787233965,"modifiedTime":1685996834008,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"_id":"95u0EQIqNCZzYlky"}
{"_id":"BvU3MCmn58F6dTd8","name":"Gift of Alacrity","type":"spell","img":"modules/plutonium/media/icon/spell/egw-gift-of-alacrity.webp","effects":[{"_id":"OwMoEzA7O4KTf5hq","changes":[{"key":"system.attributes.init.mod","mode":2,"value":"1d8","priority":20}],"disabled":false,"duration":{"startTime":null,"seconds":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"icon":"modules/plutonium/media/icon/spell/egw-gift-of-alacrity.webp","label":"Gift of Alacrity","transfer":false,"flags":{"dae":{"stackable":false,"macroRepeat":"none","specialDuration":[],"transfer":false},"ActiveAuras":{"isAura":false,"radius":null,"aura":"None","alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"hostile":false,"onlyOnce":false}},"tint":null,"origin":null}],"folder":null,"sort":0,"flags":{"srd5e":{"page":"spells.html","source":"EGW","hash":"gift%20of%20alacrity_egw"},"core":{"sourceId":"Item.cDZVJXsJjGY7F6P4"},"midi-qol":{"onUseMacroName":"","effectActivation":false},"autoanimations":{"killAnim":false,"override":false,"animType":"t1","animName":"","bards":{"bardAnim":"a1","bardTarget":true,"bardTargetAnim":"a1","bardTargetColor":"a1","bardSelf":true,"marker":true,"markerColor":"a1","markerColorTarget":"a1"},"spellVar":"a1","hmAnim":"a1","color":"n1","spellOptions":{"spellLoops":1},"uaStrikeType":"physical","dtvar":"dt1","divineSmite":{"dsEnable":false,"dsSelf":true,"dsSelfDelay":0,"dsSelfColor":"a1","dsTarget":true,"dsTargetDelay":1250,"dsTargetColor":"a1"},"explosion":false,"explodeVariant":"ev1","explodeColor":"","explodeRadius":"0","explodeLoop":"1","allSounds":{"explosion":{"audioExplodeEnabled":false,"file":"","delay":100,"volume":0.25},"item":{"enableAudio":false,"file":"","delay":100,"volume":0.25}},"selfRadius":"5","animTint":"#ffffff","auraOpacity":0.75,"ctaOption":false,"teleDist":30,"animLevel":false,"rangedOptions":{"rangeDmgType":""},"exAnimLevel":false,"impactVar":"a1","templates":{"tempType":"a1","tempAnim":"","tempColor":"","tempLoop":1,"customAnim":false,"customPath":""}},"spellTemplateManager":{"stmData":{"ignoreDuration":false,"spellTexture":"","useTexture":false,"alpha":50,"coneOrigin":1,"loopAnimations":true}},"rest-recovery":{"data":{"recovery":{"enabled":false}}},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false},"cf":{"id":"temp_lpjg4hxkuum"}},"system":{"description":{"value":"<div class=\"rd__b  rd__b--3\"><p>You touch a willing creature. For the duration, the target can add [[/r 1d8]] to its initiative rolls.</p><div class=\"rd__spc-inline-post\"></div></div>","chat":"","unidentified":""},"source":"EGW","activation":{"type":"minute","cost":1,"condition":""},"duration":{"value":8,"units":"hour"},"target":{"value":null,"width":null,"units":"touch","type":""},"range":{"value":null,"long":null,"units":"touch"},"uses":{"value":0,"max":"1","per":"lr","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"cha","actionType":"util","attackBonus":0,"chatFlavor":"","critical":null,"damage":{"parts":[],"versatile":""},"formula":"1d8","save":{"ability":"","dc":null,"scaling":"cha"},"level":1,"school":"div","components":{"value":"","vocal":true,"somatic":true,"material":false,"ritual":false,"concentration":false},"materials":{"value":"","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"innate","prepared":true},"scaling":{"mode":"none","formula":""}},"ownership":{"default":0,"XaHraXd0L5EoLNNo":3,"05k4ub2VgC3VLxAg":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.0.3","coreVersion":"10.290","createdTime":null,"modifiedTime":1668439902817,"lastModifiedBy":"Be8r6Sgxcs3sL08I"}}
{"name":"Fire Shield","type":"spell","system":{"description":{"value":"<div class=\"rd__b  rd__b--3\"><p>Thin and wispy flames wreathe your body for the duration, shedding bright light in a 10-foot radius and dim light for an additional 10 feet. You can end the spell early by using an action to dismiss it.</p><div class=\"rd__spc-inline-post\"></div><p>The flames provide you with a warm shield or a chill shield, as you choose. The warm shield grants you resistance to cold damage, and the chill shield grants you resistance to fire damage.</p><p>In addition, whenever a creature within 5 feet of you hits you with a melee attack, the shield erupts with flame. The attacker takes [[/r 2d8]] fire damage from a warm shield, or [[/r 2d8]] cold damage from a cold shield.</p></div>","chat":"","unidentified":""},"source":"PHB","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":"10","units":"minute"},"cover":null,"target":{"value":null,"width":null,"units":"","type":"self"},"range":{"value":null,"long":null,"units":"self"},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"int","actionType":"util","attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"int"},"level":4,"school":"evo","components":{"vocal":true,"somatic":true,"material":true,"ritual":false,"concentration":false},"materials":{"value":"a bit of phosphorus or a firefly","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"none","formula":""}},"img":"icons/equipment/shield/heater-steel-crystal-red.webp","ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"flags":{"plutonium":{"page":"spells.html","source":"PHB","hash":"fire%20shield_phb","propDroppable":"spell"},"rest-recovery":{"data":{"recovery":{"enabled":false}}},"midi-qol":{"effectActivation":false,"forceCEOff":true,"forceCEOn":false,"onUseMacroName":"[postActiveEffects]ItemMacro","onUseMacroParts":{"items":{"0":{"macroName":"ItemMacro","option":"postActiveEffects"}}}},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"autoFailFriendly":false,"autoSaveFriendly":false,"rollOther":false,"critOther":false,"offHandWeapon":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false},"itemacro":{"macro":{"name":"Fire Shield","type":"script","scope":"global","command":"if (args[0].tag === \"OnUse\" && args[0].macroPass !== \"isDamaged\") {\n    const actor = canvas.scene.tokens.get(args[0].tokenId).actor;\n    new Dialog({\n        title: \"Warm or Cold Shield\",\n        buttons: {\n            one: {\n                label: \"Warm (cold resist + fire dmg)\",\n                callback: async () => {\n                    await ChatMessage.create({ content: `${actor.name} gains resistanace to cold` });\n                    await actor.createEmbeddedDocuments(\"ActiveEffect\", [{\n                        \"changes\": [\n                            {\n                                \"key\": \"system.traits.dr.value\",\n                                \"value\": \"cold\",\n                                \"mode\": 2,\n                            },\n                            {\n                                \"key\": \"ATL.light.dim\",\n                                \"value\": \"20\",\n                                \"mode\": 5,\n                            },\n                            {\n                                \"key\": \"ATL.light.bright\",\n                                \"value\": \"10\",\n                                \"mode\": 5,\n                            },\n                                    {\n          key: 'ATL.light.color',\n          mode: CONST.ACTIVE_EFFECT_MODES.OVERRIDE,\n          value: \"#f98026\",\n        },\n        {\n          key: 'ATL.light.alpha',\n          mode: CONST.ACTIVE_EFFECT_MODES.OVERRIDE,\n          value: 0.25,\n        },\n        {\n          key: 'ATL.light.animation',\n          mode: CONST.ACTIVE_EFFECT_MODES.OVERRIDE,\n          value: '{\"type\": \"torch\", \"speed\": 3, \"intensity\": 1}',\n        },\n                            {\n                                \"key\": \"flags.midi-qol.onUseMacroName\",\n                                \"value\": `ItemMacro.${args[0].item.uuid},isDamaged`,\n                                \"mode\": 0,\n                            }\n                        ],\n                        \"duration\": {\n                            \"startTime\": game.time.worldTime,\n                            \"seconds\": 600,\n                            \"startRound\": game.combat?.round,\n                            \"startTurn\": game.combat?.turn\n                        },\n                        \"icon\": \"icons/magic/defensive/shield-barrier-flaming-pentagon-red.webp\",\n                        \"label\": \"Warm Shield\",\n                        \"origin\": args[0].item.uuid,\n                        \"flags\": {\n                            \"times-up\": {\n                                \"isPassive\": true\n                            }\n                        }\n                    }])\n                }\n            },\n            two: {\n                label: \"Cold (fire resist + cold damage)\",\n                callback: async () => {\n                    await ChatMessage.create({ content: `${actor.name} gains resistance to fire` });\n                    await actor.createEmbeddedDocuments(\"ActiveEffect\", [{\n                        \"changes\": [\n                            {\n                                \"key\": \"system.traits.dr.value\",\n                                \"value\": \"fire\",\n                                \"mode\": 2,\n                            },\n                            {\n                                \"key\": \"ATL.light.dim\",\n                                \"value\": \"20\",\n                                \"mode\": 5,\n                            },\n                            {\n                                \"key\": \"ATL.light.bright\",\n                                \"value\": \"10\",\n                                \"mode\": 5,\n                            },\n                                    {\n          key: 'ATL.light.color',\n          mode: CONST.ACTIVE_EFFECT_MODES.OVERRIDE,\n          value: \"#86E9EF\",\n        },\n        {\n          key: 'ATL.light.alpha',\n          mode: CONST.ACTIVE_EFFECT_MODES.OVERRIDE,\n          value: 0.25,\n        },\n        {\n          key: 'ATL.light.animation',\n          mode: CONST.ACTIVE_EFFECT_MODES.OVERRIDE,\n          value: '{\"type\": \"torch\", \"speed\": 3, \"intensity\": 1}',\n        },\n                            \n                \n                            {\n                                \"key\": \"flags.midi-qol.onUseMacroName\",\n                                \"value\": `ItemMacro.${args[0].item.uuid},isDamaged`,\n                                \"mode\": 0,\n                            }\n                        ],\n                        \"duration\": {\n                            \"startTime\": game.time.worldTime,\n                            \"seconds\": 600,\n                            \"startRound\": game.combat?.round,\n                            \"startTurn\": game.combat?.turn\n                        },\n                        \"icon\": \"icons/magic/defensive/shield-barrier-flaming-pentagon-blue.webp\",\n                        \"label\": \"Chill Shield\",\n                        \"origin\": args[0].item.uuid,\n                        \"flags\": {\n                            \"times-up\": {\n                                \"isPassive\": true\n                            }\n                        }\n                    }])\n                }\n            },\n        }\n    }).render(true);\n}\n\nif (args[0].macroPass = \"isDamaged\") {\n    const attackerToken = fromUuidSync(args[0].tokenUuid).object;\n    console.log(attackerToken)\n    const defenderToken = args[0].options.token;\n    const defenderActor = args[0].options.actor;\n    if (!attackerToken || !defenderToken || !defenderActor) return;\n    const distance = 5;\n    if (MidiQOL.getDistance(attackerToken,defenderToken) > 5) return;\n    const dmgType = defenderActor.effects.find(eff=>eff.label.toLocaleLowerCase().includes(\"Warm Shield\")) ? \"fire\" : \"cold\";\nconsole.log(dmgType)\n    const damageRoll = await new Roll(`2d8[${dmgType}]`).roll({async: true});\n    await new MidiQOL.DamageOnlyWorkflow(defenderActor, defenderToken, damageRoll.total, dmgType, [attackerToken.document], damageRoll, { itemCardId: \"new\" , damageList: args[0].damageList});\n}","author":"Be8r6Sgxcs3sL08I","_id":null,"img":"icons/svg/dice-target.svg","folder":null,"sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null}}},"core":{"sourceId":"Scene.V3MxnI9gjrfdinfI.Token.Hm3Wxl6uErcUEFHd.Item.r44mO0N2Xnp2CgDj"},"cf":{"id":"temp_6q1ztzxb2o4"}},"effects":[],"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1684929757911,"modifiedTime":1684938724803,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"_id":"CIdIlzrEbvKoL8Bv"}
{"name":"Power Word Stun","type":"spell","img":"icons/magic/sonic/scream-wail-shout-teal.webp","effects":[{"label":"Power Word Stun","icon":"icons/magic/sonic/scream-wail-shout-teal.webp","origin":"Item.mOJESKFyTfjxucjp","duration":{"rounds":null,"startTime":null,"seconds":null,"combat":null,"turns":null,"startRound":null,"startTurn":null},"disabled":false,"_id":"mzC1KfSGnhhc1jmF","changes":[{"key":"StatusEffect","mode":0,"value":"Convenient Effect: Stunned","priority":20},{"key":"flags.midi-qol.OverTime","mode":5,"value":"turn=end,\nsaveDC=@attributes.spelldc,\nsaveAbility=con,\nallowIncapacitated=true,\nlabel=Save to overcome Stun","priority":20},{"key":"macro.itemMacro","mode":0,"value":"@targetUuid","priority":20}],"tint":null,"transfer":false,"flags":{"times-up":{},"dfreds-convenient-effects":{"description":""},"dae":{"selfTarget":false,"selfTargetAlways":false,"stackable":"none","durationExpression":"","macroRepeat":"none","specialDuration":[]},"core":{"statusId":""},"ActiveAuras":{"isAura":false,"aura":"None","radius":"undefined","alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"displayTemp":false,"hostile":false,"onlyOnce":false},"effectmacro":{}}}],"flags":{"ddbimporter":{"id":138580,"definitionId":2211,"entityTypeId":435869154,"dndbeyond":{"lookup":"generic","lookupName":"generic","level":null,"castAtLevel":null},"sources":[{"sourceId":1,"pageNumber":null,"sourceType":2},{"sourceId":2,"pageNumber":267,"sourceType":1}],"tags":["Control"],"originalName":"Power Word Stun","version":"3.3.16","effectsApplied":true},"betterRolls5e":{"quickVersatile":{"altValue":true},"quickCharges":{"value":{"use":true,"resource":true},"altValue":{"use":true,"resource":true}}},"midiProperties":{"magicdam":true,"magiceffect":true,"nodam":false,"fulldam":false,"halfdam":false,"autoFailFriendly":false,"autoSaveFriendly":false,"rollOther":false,"critOther":false,"offHandWeapon":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false},"core":{"sourceId":"Compendium.world.ddb-spells.OIrrK8CwuXKgcoKA"},"scene-packer":{"hash":"71d5d0c924b02a2f0d17dcf68a35990c486dbf6a","sourceId":"Item.DsYpXvdxheIfl70M"},"midi-qol":{"effectActivation":true},"itemacro":{"macro":{"name":"Power Word Stun (base) (Copy)","type":"script","img":"icons/svg/dice-target.svg","scope":"global","command":"const target = fromUuidSync(args[1]);\nif (args[0] === \"on\") {\n    return game.dfreds.effectInterface.addEffect({effectName: \"Incapacitated\", uuid: target.actor.uuid})\n} else if (args[0] === \"off\") {\n    return game.dfreds.effectInterface.removeEffect({effectName: \"Incapacitated\", uuid: target.actor.uuid})\n}","sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null}}},"cf":{"id":"temp_6q1ztzxb2o4"},"rest-recovery":{"data":{"recovery":{"enabled":false}}}},"system":{"description":{"value":"<p>You speak a word of power that can overwhelm the mind of one creature you can see within range, leaving it dumbfounded. If the target has 150 hit points or fewer, it is @Compendium[dnd5e.rules.w7eitkpD7QQTB6j0]{stunned}. Otherwise, the spell has no effect.</p><p>The @Compendium[dnd5e.rules.w7eitkpD7QQTB6j0]{stunned} target must make a Constitution saving throw at the end of each of its turns. On a successful save, this stunning effect ends.</p><p></p><p><span style=\"font-family:Signika, sans-serif\"><strong style=\"box-sizing:border-box;user-select:text;color:rgb(25, 24, 19);font-family:Signika, sans-serif;font-size:13px;font-style:normal;font-variant-ligatures:normal;font-variant-caps:normal;letter-spacing:normal;orphans:2;text-align:start;text-indent:0px;text-transform:none;white-space:normal;widows:2;word-spacing:0px;-webkit-text-stroke-width:0px;background-color:rgb(102, 102, 102);text-decoration-thickness:initial;text-decoration-style:initial;text-decoration-color:initial\">Midi-qol:</strong> requires DAE and Convenient Effects.</span></p>","chat":"","unidentified":""},"source":"Basic Rules, Player's Handbook pg 267","activation":{"type":"action","cost":1,"condition":"target.attributes.hp.value <= 150"},"duration":{"value":"","units":"perm"},"cover":null,"target":{"value":2,"width":null,"units":"","type":"creature"},"range":{"value":60,"long":null,"units":"ft"},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"other","attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"level":8,"school":"enc","components":{"vocal":true,"somatic":false,"material":false,"ritual":false,"concentration":false},"materials":{"value":"","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"none","formula":""}},"ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1673396101030,"modifiedTime":1684881663894,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"_id":"DdqUxw7Mdf9YRCJs"}
{"_id":"EPHJ7sWdZ261mMWZ","name":"#[CF_tempEntity]","type":"weapon","img":"icons/svg/item-bag.svg","effects":[],"folder":null,"sort":0,"flags":{"cf":{"id":"temp_lpjg4hxkuum","folderPath":[],"color":"#3b67ce","fontColor":"#FFFFFF","name":"Magias-AE","children":[],"icon":"","contents":["aB23YkFsI94D2cGu","Okywjza8OsAcDlgr","hJtxGFRQtTrzrnHd","OU9Hofvwzt57gxQe","eUs1fgUWJjnGBORK","gm64hlsUZjozjRSB","uibQwUoZJJXgcL0i","BvU3MCmn58F6dTd8","GOBoTPAKTGD3AGek","fPyvY0acMFVbJ7Zn","n4IHsz8nMdZEFlUJ","Ys4Y9WBkqqbrutAC","xUS6yLmCT15NqYQg","QPc95ukgFgXAmIKP","TGL4z244vlkKeZva","l9Y4XJYgAgW907UM","xaEjEihMhwxUg5MC"],"sorting":"a","version":"2.5.7"}},"system":{"description":{"value":"","chat":"","unidentified":""},"source":"","quantity":1,"weight":0,"price":0,"attunement":0,"equipped":false,"rarity":"","identified":true,"activation":{"type":"","cost":0,"condition":""},"duration":{"value":null,"units":""},"cover":null,"crewed":false,"target":{"value":null,"width":null,"units":"","type":""},"range":{"value":null,"long":null,"units":""},"uses":{"value":null,"max":"","per":null,"recovery":""},"consume":{"type":"","target":null,"amount":null},"ability":null,"actionType":null,"attackBonus":0,"chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"armor":{"value":10},"hp":{"value":0,"max":0,"dt":null,"conditions":""},"weaponType":"simpleM","baseItem":"","properties":{},"proficient":true},"ownership":{"default":0,"QwT9izJ4aW8QVTjo":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.2.1","coreVersion":"10.291","createdTime":null,"modifiedTime":1688219693417,"lastModifiedBy":"Be8r6Sgxcs3sL08I"}}
{"name":"Levitate","type":"spell","img":"modules/GMmacros/img/phb-levitate.webp","effects":[{"_id":"9rwdSxFSfv6oDrvY","changes":[{"key":"macro.itemMacro","mode":0,"value":"","priority":20}],"disabled":false,"duration":{"startTime":null,"seconds":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"icon":"modules/plutonium/media/icon/spell/phb-levitate.webp","label":"Levitate","transfer":false,"flags":{"dae":{"stackable":"none","macroRepeat":"none","specialDuration":[],"transfer":false},"dnd5e-helpers":{"rest-effect":"Ignore"},"ActiveAuras":{"isAura":false,"aura":"None","radius":null,"alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"hostile":false,"onlyOnce":false}},"tint":null,"origin":null}],"folder":null,"sort":0,"flags":{"srd5e":{"page":"spells.html","source":"PHB","hash":"levitate_phb"},"midi-qol":{"onUseMacroName":"","effectActivation":false},"autoanimations":{"killAnim":false,"animLevel":false,"override":false,"animType":"t1","animName":"","bards":{"bardAnim":"a1","bardTarget":true,"bardTargetAnim":"a1","bardTargetColor":"a1","bardSelf":true,"marker":true,"markerColor":"a1","markerColorTarget":"a1"},"spellVar":"a1","hmAnim":"a1","color":"n1","spellOptions":{"spellLoops":1},"uaStrikeType":"physical","dtvar":"dt1","divineSmite":{"dsEnable":false,"dsSelf":true,"dsSelfDelay":0,"dsSelfColor":"a1","dsTarget":true,"dsTargetDelay":1250,"dsTargetColor":"a1"},"explosion":false,"exAnimLevel":false,"explodeVariant":"ev1","impactVar":"a1","explodeColor":"","explodeRadius":"0","explodeLoop":"1","allSounds":{"explosion":{"audioExplodeEnabled":false,"file":"","delay":100,"volume":0.25},"item":{"enableAudio":false,"file":"","delay":100,"volume":0.25}},"selfRadius":"5","animTint":"#ffffff","auraOpacity":0.75,"ctaOption":false,"teleDist":30,"templates":{"tempType":"a1","tempAnim":"","tempColor":"","tempLoop":1,"customAnim":false,"customPath":""}},"spellTemplateManager":{"stmData":{"ignoreDuration":false,"spellTexture":"","useTexture":false,"alpha":50,"coneOrigin":1,"loopAnimations":true}},"siftoolkit":{"SIFData":{"ignoreDuration":false,"texture":"","useTexture":false,"alpha":50,"coneOrigin":1,"loopAnimations":true,"playTemplateAudio":false,"playDamageAudio":false,"clip":"","volume":100}},"core":{"sourceId":"Item.eK3E5SyLzarUd7Nl"},"itemacro":{"macro":{"data":{"_id":null,"name":"Levitate","type":"script","author":"QwT9izJ4aW8QVTjo","img":"icons/svg/dice-target.svg","scope":"global","command":"//DAE Item Macro, no arguments passed\nif (!game.modules.get(\"advanced-macros\")?.active) ui.notifications.error(\"Please enable the Advanced Macros module\")\nconst lastArg = args[args.length - 1];\nlet tactor;\nconst target = canvas.tokens.get(lastArg.tokenId)\n\nif (args[0] === \"on\") {\n    ChatMessage.create({ content: `${target.name} is levitated 20ft` });\n    target.update({ \"elevation\": 20 });\n}\nif (args[0] === \"off\") {\n    target.update({\"elevation\": 0 });\n    ChatMessage.create({ content: `${target.name} is returned to the ground` });\n}","folder":null,"sort":0,"permission":{"default":0},"flags":{}}}},"rest-recovery":{"data":{"recovery":{"enabled":false}}},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false},"cf":{"id":"temp_6q1ztzxb2o4"}},"_id":"F6j4KmRGUvKWZ9kI","system":{"description":{"value":"<div class=\"rd__b  rd__b--3\">\n<p>One creature or loose object of your choice that you can see within range rises vertically, up to 20 feet, and remains suspended there for the duration. The spell can levitate a target that weighs up to 500 pounds (227kg). An unwilling creature that succeeds on a Constitution saving throw is unaffected.</p>\n<div class=\"rd__spc-inline-post\"></div>\n<p>The target can move only by pushing or pulling against a fixed object or surface within reach (such as a wall or a ceiling), which allows it to move as if it were climbing. You can change the target's altitude by up to 20 feet in either direction on your turn. If you are the target, you can move up or down as part of your move. Otherwise, you can use your action to move the target, which must remain within the spell's range.</p>\n<p>When the spell ends, the target floats gently to the ground if it is still aloft.</p>\n</div>","chat":"","unidentified":""},"source":"PHB","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":10,"units":"minute"},"target":{"value":1,"width":null,"units":"","type":"creature"},"range":{"value":60,"long":null,"units":"ft"},"uses":{"value":0,"max":"0","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"save","attackBonus":0,"chatFlavor":"","critical":null,"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"con","dc":null,"scaling":"spell"},"level":2,"school":"trs","components":{"value":"","vocal":true,"somatic":true,"material":true,"ritual":false,"concentration":true},"materials":{"value":"either a small leather loop or a piece of golden wire bent into a cup shape with a long shank on one end","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"always","prepared":true},"scaling":{"mode":"none","formula":""}},"ownership":{"default":0,"QwT9izJ4aW8QVTjo":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.0.3","coreVersion":"10.290","createdTime":null,"modifiedTime":1668440009567,"lastModifiedBy":"Be8r6Sgxcs3sL08I"}}
{"name":"Immolation","type":"spell","system":{"description":{"value":"<div class=\"rd__b  rd__b--3\"><p>Flames wreathe one creature you can see within range. The target must make a Dexterity saving throw. It takes [[/r 8d6]] fire damage on a failed save, or half as much damage on a successful one. On a failed save, the target also burns for the spell's duration. The burning target sheds bright light in a 30-foot radius and dim light for an additional 30 feet. At the end of each of its turns, the target repeats the saving throw. It takes [[/r 4d6]] fire damage on a failed save, and the spell ends on a successful one. These magical flames can't be extinguished by nonmagical means.</p><div class=\"rd__spc-inline-post\"></div><p>If damage from this spell kills a target, the target is turned to ash.</p></div>","chat":"","unidentified":""},"source":"XGE","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":"1","units":"minute"},"cover":null,"target":{"value":null,"width":null,"units":"","type":"creature"},"range":{"value":90,"long":null,"units":"ft"},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"save","attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[["8d6","fire"]],"versatile":""},"formula":"","save":{"ability":"dex","dc":null,"scaling":"spell"},"level":5,"school":"evo","components":{"vocal":true,"somatic":false,"material":false,"ritual":false,"concentration":true},"materials":{"value":"","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"none","formula":""}},"img":"icons/magic/death/projectile-skull-fire-orange.webp","ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"flags":{"plutonium":{"page":"spells.html","source":"XGE","hash":"immolation_xge","propDroppable":"spell"},"rest-recovery":{"data":{"recovery":{"enabled":false}}},"midi-qol":{"effectActivation":false},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"autoFailFriendly":false,"autoSaveFriendly":false,"rollOther":false,"critOther":false,"offHandWeapon":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false},"core":{"sourceId":"Scene.V3MxnI9gjrfdinfI.Token.YwlyuncLrraAp49M.Item.2ALNUDANxh4tWPan"},"cf":{"id":"temp_lpjg4hxkuum"}},"effects":[{"label":"Immolation","icon":"icons/magic/death/projectile-skull-fire-orange.webp","changes":[{"key":"flags.midi-qol.OverTime","mode":0,"value":"turn=end,\nsaveAbility=dex,\nsaveDC=@attributes.spelldc,\nsaveMagic=true,\nlabel=Immolation,\nsaveDamage=nodamage,\ndamageRoll=4d6,\ndamageType=fire","priority":20}],"transfer":false,"_id":"zCKDzk3cDZVFF1Ah","disabled":false,"duration":{"startTime":null,"seconds":60,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"origin":null,"tint":null,"flags":{"dfreds-convenient-effects":{"description":""},"dae":{"selfTarget":false,"selfTargetAlways":false,"stackable":"noneName","durationExpression":"","macroRepeat":"none","specialDuration":[]},"core":{"statusId":""},"ActiveAuras":{"isAura":false,"aura":"None","radius":"","alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"displayTemp":false,"hostile":false,"onlyOnce":false}}}],"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1684880976341,"modifiedTime":1684880980752,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"_id":"GOBoTPAKTGD3AGek"}
{"name":"Ring of Air Elemental Command","type":"equipment","img":"icons/equipment/finger/ring-cabochon-silver-gold-red.webp","system":{"description":{"value":"<p><em>(Requires attunement)</em></p>\n<p>This ring is linked to the Elemental Plane of Air.</p>\n<p>While wearing this ring, you have advantage on attack rolls against @Compendium[dnd5e.monsters.banHjKDMCegbUwYE]{Air Elemental}s, and they have disadvantage on attack rolls against you. In addition, you have access to properties based on the linked plane.</p>\n<p>The ring has 5 charges. It regains 1d4 + 1 expended charges daily at dawn. Spells cast from the ring have a save DC of 17.</p>\n<p><strong>Ring of Air Elemental Command</strong>. You can expend 2 of the ring's charges to cast @Compendium[dnd5e.spells.eEpy1ONlXumKS1mp]{Dominate Monster} on an Air Elemental. In addition, when you fall, you descend 60 feet per round and take no damage from falling. You can also speak and understand Auran.</p>\n<p>If you help slay an Air Elemental while attuned to the ring, you gain access to the following additional properties:</p>\n<ul>\n<li>You have resistance to lightning damage.</li>\n<li>You have a flying speed equal to your walking speed and can hover.</li>\n<li>You can cast the following spells from the ring, expending the necessary number of charges: @Compendium[dnd5e.spells.QbTxN5dWIbYZ4jLU]{Chain Lightning} (3 charges), @Compendium[dnd5e.spells.FSMy6VAjDnXY9vWz]{Gust of Wind} (2 charges), or @Compendium[dnd5e.spells.ew6GA8dJy2spQmFW]{Wind Wall} (1 charge).</li>\n</ul>","chat":"","unidentified":""},"source":"SRD 5.1","quantity":1,"weight":0,"price":{"value":35000,"denomination":"gp"},"attunement":2,"equipped":true,"rarity":"legendary","identified":true,"activation":{"type":"action","cost":1,"condition":""},"duration":{"value":"","units":""},"cover":null,"target":{"value":null,"width":null,"units":"","type":""},"range":{"value":null,"long":null,"units":""},"uses":{"value":5,"max":"5","per":"charges","recovery":"1d4 + 1"},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"save","attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"flat"},"armor":{"value":0,"type":"trinket","dex":0},"hp":{"value":0,"max":0,"dt":null,"conditions":""},"baseItem":"","speed":{"value":null,"conditions":""},"strength":null,"stealth":false,"proficient":false},"effects":[{"label":"Ring of Air Elemental Command","icon":"icons/equipment/finger/ring-cabochon-silver-gold-red.webp","changes":[{"key":"system.traits.dr.value","mode":0,"value":"lightning","priority":20},{"key":"system.attributes.movement.fly","mode":2,"value":"30","priority":20}],"transfer":true,"_id":"BW75D4VdMdOZnWGm","disabled":false,"duration":{"startTime":null,"seconds":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"origin":null,"tint":null,"flags":{"dfreds-convenient-effects":{"description":""},"dae":{"selfTarget":false,"selfTargetAlways":false,"stackable":"noneName","durationExpression":"","macroRepeat":"none","specialDuration":[]},"core":{"statusId":""},"ActiveAuras":{"isAura":false,"aura":"None","radius":"","alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"displayTemp":false,"hostile":false,"onlyOnce":false}}}],"ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"flags":{"core":{"sourceId":"Compendium.dnd5e.items.XZWHQ20ynJBK6xmU"},"rest-recovery":{"data":{"recovery":{"enabled":false}}},"midi-qol":{"effectActivation":false},"magicitems":{"enabled":true,"equipped":true,"attuned":false,"charges":"5","chargeType":"c1","destroy":false,"destroyFlavorText":"reaches 0 charges: it crumbles into ashes and is destroyed.","rechargeable":true,"recharge":"1d4+1","rechargeType":"t1","rechargeUnit":"r5","sorting":"l","spells":{"0":{"id":"FSMy6VAjDnXY9vWz","name":"Gust of Wind","pack":"dnd5e.spells","img":"icons/magic/air/wind-swirl-gray-blue.webp","baseLevel":"2","level":"2","consumption":"2","upcast":"2","upcastCost":"1","flatDc":true,"dc":"17","uses":5},"1":{"id":"Q8QGc39CEYCdIgvo","name":"Wind Wall","pack":"world","img":"icons/magic/air/fog-gas-smoke-swirling-white.webp","baseLevel":"3","level":"3","consumption":"1","upcast":"3","upcastCost":"1","flatDc":true,"dc":"17","uses":5},"2":{"id":"V6vnNNpVjnUFEqbV","name":"Chain Lightning","pack":"chris-premades.CPR Spells","img":"icons/magic/lightning/bolts-forked-large-blue.webp","baseLevel":"6","level":"6","consumption":"3","upcast":"6","upcastCost":"1","flatDc":true,"dc":"17","uses":5}},"destroyCheck":"d1","destroyType":"dt1","feats":{},"tables":{},"uses":0},"cf":{"id":"temp_bnv1ahmj4k"}},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1661787233701,"modifiedTime":1685996945908,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"_id":"GqezVlVybWXE4ebI"}
{"name":"Sunburst","type":"spell","system":{"description":{"value":"<div class=\"rd__b  rd__b--3\"><p>Brilliant sunlight flashes in a 60-foot radius centered on a point you choose within range. Each creature in that light must make a Constitution saving throw. On a failed save, a creature takes [[/r 12d6]] radiant damage and is @condition[blinded] for 1 minute. On a successful save, it takes half as much damage and isn't @condition[blinded] by this spell. Undead and oozes have disadvantage on this saving throw.</p><div class=\"rd__spc-inline-post\"></div><p>A creature @condition[blinded] by this spell makes another Constitution saving throw at the end of each of its turns. On a successful save, it is no longer @condition[blinded].</p><p>This spell dispels any darkness in its area that was created by a spell.</p></div>","chat":"","unidentified":""},"source":"PHB","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":"","units":"inst"},"cover":null,"target":{"value":60,"width":null,"units":"ft","type":"radius"},"range":{"value":150,"long":null,"units":"ft"},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"save","attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[["12d6","radiant"]],"versatile":""},"formula":"","save":{"ability":"con","dc":null,"scaling":"spell"},"level":8,"school":"evo","components":{"vocal":true,"somatic":true,"material":true,"ritual":false,"concentration":false},"materials":{"value":"fire and a piece of sunstone","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"none","formula":""}},"img":"icons/magic/light/explosion-glow-spiral-yellow.webp","ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"flags":{"srd5e":{"page":"spells.html","source":"PHB","hash":"sunburst_phb","propDroppable":"spell"},"scene-packer":{"hash":"3623b05668ff3e72c48106cd500e9576974246a0","sourceId":"Item.HdkOguA2zxSwfQTV"},"siftoolkit":{"SIFData":{"ignoreDuration":false,"texture":"","useTexture":false,"alpha":50,"coneOrigin":1,"loopAnimations":true,"playTemplateAudio":false,"playDamageAudio":false,"playSaveAudio":false,"clip":"","volume":100}},"itemacro":{"macro":{"data":{"_id":null,"name":"Sunburst","type":"script","author":"WpiVAovmlZrRTFMX","img":"icons/svg/dice-target.svg","scope":"global","command":"let targetList = args[0].targets;\nif(targetList.length === 0) return {};\nfor(let target of targetList) {\nlet undead = [\"undead\", \"ooze\"].some(type => (target?.actor.data.data.details.type?.value || \"\").toLowerCase().includes(type));\nif (undead) {\n\tlet effectData = {\n          label : \"Sunburst\",\n          icon : \"modules/GMmacros/img/phb-blinding-smite.webp\",\n\t  flags: {dae: {specialDuration: [\"isSave\"]}},\n          changes: [{value: \"1\", mode: CONST.ACTIVE_EFFECT_MODES.CUSTOM, priority: 20, key:\"flags.midi-qol.disadvantage.ability.save.con\"}],\n            }\n        await MidiQOL.socket().executeAsGM(\"createEffects\", {actorUuid: target.uuid, effects: [effectData]});\n} else {return{}}\n}","folder":null,"sort":0,"permission":{"default":0},"flags":{}}}},"midi-qol":{"effectActivation":false,"onUseMacroName":"[preSave]ItemMacro"},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"autoFailFriendly":false,"autoSaveFriendly":false,"offHandWeapon":false,"ignoreTotalCover":false},"core":{"sourceId":"Item.T8qdNAZnW1AYqrTb"},"cf":{"id":"temp_6q1ztzxb2o4"},"rest-recovery":{"data":{"recovery":{"enabled":false}}}},"effects":[{"label":"Sunburst","icon":"icons/magic/light/explosion-glow-spiral-yellow.webp","changes":[{"key":"macro.CE","mode":0,"value":"Blinded","priority":20},{"key":"flags.midi-qol.OverTime","mode":0,"value":"turn=end,\nsaveDC=@attributes.spelldc,\nsaveAbility=con","priority":20}],"transfer":false,"_id":"yDMA8bktrRNliBfE","disabled":false,"duration":{"startTime":null,"seconds":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"origin":null,"tint":null,"flags":{"dfreds-convenient-effects":{"description":""},"dae":{"selfTarget":false,"selfTargetAlways":false,"stackable":"noneName","durationExpression":"","macroRepeat":"none","specialDuration":[]},"core":{"statusId":""},"ActiveAuras":{"isAura":false,"aura":"None","radius":"","alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"displayTemp":false,"hostile":false,"onlyOnce":false}}}],"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1685763042965,"modifiedTime":1685891373999,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"_id":"GyNLdOWPJR8KBtfQ"}
{"name":"Draconic Transformation","type":"spell","img":"icons/magic/movement/abstract-ribbons-red-orange.webp","system":{"description":{"value":"<div class=\"rd__b  rd__b--3\"><p>With a roar, you draw on the magic of dragons to transform yourself, taking on draconic features. You gain the following benefits until the spell ends:</p><div class=\"rd__spc-inline-post\"><p></p></div><ul class=\"rd__list rd__list-hang-notitle\"><li class=\"rd__li \"><p class=\"rd__p-list-item\"><span class=\"bold rd__list-item-name\">Blindsight.</span> You have @sense[blindsight] with a range of 30 feet. Within that range, you can effectively see anything that isn't behind total cover, even if you're @condition[blinded] or in darkness. Moreover, you can see an @condition[invisible] creature, unless the creature successfully hides from you.</p></li><li class=\"rd__li \"><p class=\"rd__p-list-item\"><span class=\"bold rd__list-item-name\">Breath Weapon.</span> When you cast this spell, and as a bonus action on subsequent turns for the duration, you can exhale shimmering energy in a 60-foot cone. Each creature in that area must make a Dexterity saving throw, taking [[/r 6d8]] force damage on a failed save, or half as much damage on a successful one.</p></li><li class=\"rd__li \"><p class=\"rd__p-list-item\"><span class=\"bold rd__list-item-name\">Wings.</span> Incorporeal wings sprout from your back, giving you a flying speed of 60 feet.</p></li></ul></div>","chat":"","unidentified":""},"source":"FTD","activation":{"type":"bonus","cost":1,"condition":""},"duration":{"value":"1","units":"minute"},"cover":null,"target":{"value":null,"width":null,"units":"","type":"self"},"range":{"value":null,"long":null,"units":"self"},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"cha","actionType":"util","attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"level":7,"school":"trs","components":{"vocal":true,"somatic":true,"material":true,"ritual":false,"concentration":true},"materials":{"value":"a statuette of a dragon, worth at least 500 gp","consumed":false,"cost":500,"supply":0},"preparation":{"mode":"always","prepared":true},"scaling":{"mode":"none","formula":""}},"effects":[{"label":"Draconic Transformation","icon":"icons/magic/movement/abstract-ribbons-red-orange.webp","changes":[{"key":"system.attributes.movement.fly","mode":2,"value":"60","priority":20},{"key":"macro.itemMacro","mode":0,"value":"@item","priority":20}],"transfer":false,"_id":"Dun5R7UH1xwW4HfO","disabled":false,"duration":{"startTime":null,"seconds":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"origin":null,"tint":null,"flags":{"dae":{"selfTarget":false,"selfTargetAlways":false,"stackable":"none","durationExpression":"","macroRepeat":"none","specialDuration":[]},"core":{"statusId":""},"ActiveAuras":{"isAura":false,"aura":"None","radius":"","alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"displayTemp":false,"hostile":false,"onlyOnce":false},"dfreds-convenient-effects":{"description":""}}}],"ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"flags":{"plutonium":{"page":"spells.html","source":"FTD","hash":"draconic%20transformation_ftd","propDroppable":"spell"},"rest-recovery":{"data":{"recovery":{"enabled":false}}},"midi-qol":{"effectActivation":false},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"autoFailFriendly":false,"rollOther":false,"critOther":false,"offHandWeapon":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false,"autoSaveFriendly":false},"itemacro":{"macro":{"name":"Draconic Transformation","type":"script","scope":"global","command":"const lastArg = args[args.length - 1];\nconst thisToken = canvas.tokens.get(lastArg.tokenId);\n\nif (args[0] === \"on\") {\n  // If the dynamic active effect started\n    const updates = {\n        embedded: {\n            Item: {\n                \"Draconic Transformation breath\": { //String\n                    type: \"spell\", // feat, spell\n                    img: \"icons/creatures/abilities/dragon-breath-purple.webp\", //Example: \"icons/magic/holy/projectiles-blades-salvo-yellow.webp\"\n                    type: \"spell\",\n\n                    flags: {\n                        \"midi-qol\": {\n                            onUseMacroName: \"[postActiveEffects]Enervate Healing\",\n                        },\n                    },\n                    system: {\n                        description: {\n                            value: \"<p>When you cast this spell, and as a bonus action on subsequent turns for the duration, you can exhale shimmering energy in a 60-foot cone. Each creature in that area must make a Dexterity saving throw, taking [[/r 6d8]] force damage on a failed save, or half as much damage on a successful one.</p>\", //String\n                        },\n                        activation: {\n                            type: \"action\", // action, bonus, crew, day, hour, lair, legendary, minute, none, reaction, special, reactiondamage, reactionmanual\n                            cost: 1, // Numeric\n                            condition: \"\" // String\n                        },\n                        target: {\n                        value: 60,\n                        width: null,\n                        units: \"ft\",\n                        type: \"cone\",\n                        },\n                        actionType: \"other\", // mwak, rwak, msak, rsak, save, heal, abil, util, other\n                        damage: {\n                            parts: [\n                                [ \"6d8\", \"force\" ] // [\"Formula\", \"acid, bludgeoning, cold, fire, force, lightning, necrotic, piercing, poison, psychic, radiant, slashing, thunder, healing, temphp\"]\n                            ]\n                        },\n                        level: 6, // Numeric 1-9\n                        school: \"trans\", // abj, con, div, enc, evo, ill, nec, trs\n                        preparation: {\n                            mode: \"atwill\", // prepared, pact, always, atwill, innate\n                            prepared: true // true, false\n                        },\n                        save: {\n                        ability: \"dex\",\n                        dc: null,\n                        scaling: \"spell\",\n                        },\n                        },\n                                     }\n            }\n        }\n    }\n  //update the token and create the necessary attack spell\n await warpgate.mutate(thisToken.document, updates);\n//  ui.notifications.info(`Draconic Transformation breath Foi incluida como Spell At Will.`);\n}\nif (args[0] === \"off\") {\n  //Concentration broke or time expired, let's revert the token and remove the attack spell item\n await warpgate.revert(thisToken.document);\n}","author":"Be8r6Sgxcs3sL08I","_id":null,"img":"icons/svg/dice-target.svg","folder":null,"sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null}}},"core":{"sourceId":"Actor.CQaWddu2rSc1igDg.Item.Dws55OiLFTYJWB3M"},"exportSource":{"world":"liganvl20","system":"dnd5e","coreVersion":"10.291","systemVersion":"2.1.5"},"cf":{"id":"temp_6q1ztzxb2o4"}},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1671212939936,"modifiedTime":1686950738148,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"_id":"HPvqkgIl1Y6F7Sdo"}
{"name":"Sunbeam","ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"type":"spell","system":{"description":{"value":"<p>A beam of brilliant light flashes out from your hand in a 5-foot-wide, 60-foot-long line. Each creature in the line must make a Constitution saving throw. On a failed save, a creature takes 6d8 radiant damage and is Blinded until your next turn. On a successful save, it takes half as much damage and isn't blinded by this spell. Undead and oozes have disadvantage on this saving throw.</p><p>You can create a new line of radiance as your action on any turn until the spell ends.</p><p>For the Duration, a mote of brilliant radiance shines in your hand. It sheds bright light in a 30-foot radius and dim light for an additional 30 feet. This light is sunlight.</p>","chat":"","unidentified":""},"source":"PHB pg. 279","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":1,"units":"minute"},"cover":null,"target":{"value":null,"width":null,"units":"","type":"self"},"range":{"value":null,"long":null,"units":"self"},"uses":{"value":0,"max":"0","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"other","attackBonus":0,"chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":0,"scaling":"spell"},"level":6,"school":"evo","components":{"vocal":true,"somatic":true,"material":true,"ritual":false,"concentration":true,"value":""},"materials":{"value":"A magnifying glass","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"none","formula":""}},"flags":{"core":{"sourceId":"Compendium.dnd5e.spells.2RC0EyvBLPH88PZF"},"itemacro":{"macro":{"name":"Sunbeam","type":"script","scope":"global","command":"const lastArg = args[args.length - 1];\nlet tactor;\nif (lastArg.tokenId) tactor = canvas.tokens.get(lastArg.tokenId).actor;\nelse tactor = game.actors.get(lastArg.actorId);\nconst target = canvas.tokens.get(lastArg.tokenId)\nlet item = args[1];  //passed by @item in the DAE field\n\nif (args[0] === \"on\") {\n    \n        const updates = {\n        //apply sunlight to token    \n        token: {\n                \"brightLight\": 30,\n                \"dimLight\": 60,\n                \"lightAlpha\": .1,\n                \"lightAngle\": 360,\n                \"lightColor\":\"#ffd700\",\n                \"lightAnimation\":{\n                    \"intensity\":3,\n                    \"speed\":1,\n                    \"type\": \"sunburst\"\n                },\n        },\n        embedded: {\n            //create Sunbeam (attack) part of this spell\n            Item: {\n                \"Sunbeam (attack)\": { \n                    \"type\": \"spell\",\n                    \"img\": item.img,\n                    \n                    \"data\": {\n                        \"damage\":{\n                            \"parts\":[\n                             [\"6d8\"\n                             ,\"radiant\"]\n                             ]\n                        },\n                        \"preparation\": {\n                            \"mode\":\"atwill\"    \n                        \n                        },\n                        \"activation\":{\n                            \"type\": \"action\",\n                            \"cost\": 1,\n                        },\n                        \"target\":{\n                            \"value\":60,\n                            \"units\":\"ft\",\n                            \"type\":\"line\"\n                        },\n                        \"description\": {\n                            \"value\": `A beam of brilliant light flashes out from your hand in a 5-foot-wide, 60-foot-long line. Each creature in the line must make a Constitution saving throw. On a failed save, a creature takes 6d8 radiant damage and is Blinded until your next turn. On a successful save, it takes half as much damage and isnt blinded by this spell. Undead and oozes have disadvantage on this saving throw.`\n                        },\n                        \"level\": 6,\n                        \"school\": \"evo\",\n                        \"save\": {\n                            \"ability\": \"con\",\n                        },\n                    \n                        \"actionType\": \"save\",\n                    },  \n            \n                    \"flags\": {\n                            \"favtab\": {\n                               \"isFavorite\": true\n                            },\n\n                    },\n                    //Here we assign the macro used by Sunbeam (attack)\n                    'flags.midi-qol.onUseMacroName': 'ItemMacro',\n                    'flags.itemacro.macro.data.name': \"Attack\",\n                    'flags.itemacro.macro.data.type': \"script\",\n                    'flags.itemacro.macro.data.scope': \"global\",\n                    'flags.itemacro.macro.data.command': `const actorD = game.actors.get(args[0].actor._id);\nconst tokenD = canvas.tokens.get(args[0].tokenId);\nconst itemD = args[0].item;\n\n//Let's fancy up the template with an animation\nlet template = canvas.templates.get(args[0].templateId);\nlet texture = \"modules/jb2a_patreon/Library/2nd_Level/Scorching_Ray/ScorchingRay_01_Regular_Yellow_60ft_2800x400.webm\";\nlet opacity = 1;\n\nlet updates = [{ \"_id\": args[0].templateId, \"texture\": texture, \"flags.tokenmagic.templateData.opacity\": opacity }]\nawait canvas.scene.updateEmbeddedDocuments(\"MeasuredTemplate\", updates);\n\n//some TMFX to burn the targets\nlet param =\n        [{\n            filterType: \"xfire\",\n            filterId: \"meleeBurn\",\n            autoDestroy: true,\n            time: 0,\n            color: 0xFFDF00,\n            blend: 1,\n            amplitude: 1,\n            dispersion: 0,\n            chromatic: false,\n            scaleX: 1,\n            scaleY: 1,\n            inlay: false,\n            animated:\n            {\n                time:\n                {\n                    loopDuration: 500,\n                    loops: 4,\n                    active: true,\n                    speed: -0.0015,\n                    animType: \"move\"\n                }\n            }\n        }];\n\nawait TokenMagic.addUpdateFiltersOnTargeted(param);\n\n//Adding CUB Blindness\nfor (let targets of args[0].failedSaves) {\n        let target = canvas.tokens.get(targets._id);\n        let effectData = {\n            duration: {rounds: 1},\n            changes: [{ \n                \"key\": \"macro.CE\",\n                \"mode\": 0,\n                \"value\": \"Blinded\",\n                \"priority\": 20\n            }]\n        };\n        await target.actor.createEmbeddedEntity(\"ActiveEffect\", effectData);\n}\n\n//remove template after 3 seconds because I'm too lazy to do it manually\nawait warpgate.wait(3000)\nlet sunbeamTemplate = canvas.templates.get(args[0].templateId);\nif(sunbeamTemplate) await sunbeamTemplate.delete()\n`\n                },\n            },\n        }\n\n        \n        \n    }\n\n    //update the token and create the necessary attack spell\n    await warpgate.mutate(token.document, updates);\n    ui.notifications.info(`Sunbeam (attack) has been added to your At-Will spells.`);\n    ChatMessage.create({ content: `${tactor.name} shines like the sun!` });\n    await tactor.items.getName(\"Sunbeam (attack)\").roll();\n    \n}\nif (args[0] === \"off\") {\n    \n    //Concentration broke or time expired, let's revert the token and remove the attack spell item\n    await warpgate.revert(token.document)\n    ChatMessage.create({ content: `${tactor.name} dims.` });\n    \n}","author":"Be8r6Sgxcs3sL08I","_id":null,"img":"icons/svg/dice-target.svg","folder":null,"sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null}}},"rest-recovery":{"data":{"recovery":{"enabled":false}}},"midi-qol":{"effectActivation":false,"onUseMacroName":""},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"autoFailFriendly":false,"rollOther":false,"critOther":false,"offHandWeapon":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false,"autoSaveFriendly":false},"cf":{"id":"temp_6q1ztzxb2o4"}},"img":"icons/magic/light/beams-rays-orange-purple-large.webp","effects":[{"label":"Sunbeam","icon":"icons/magic/light/beams-rays-orange-purple-large.webp","changes":[{"key":"macro.itemMacro","mode":0,"value":"@item","priority":20}],"transfer":false,"_id":"lthhL9HVGyLVZtEB","disabled":false,"duration":{"startTime":null,"seconds":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"origin":null,"tint":null,"flags":{"dae":{"selfTarget":false,"selfTargetAlways":false,"stackable":"none","durationExpression":"","macroRepeat":"none","specialDuration":[]},"core":{"statusId":""},"ActiveAuras":{"isAura":false,"aura":"None","radius":null,"alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"displayTemp":false,"hostile":false,"onlyOnce":false}}}],"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1661787234059,"modifiedTime":1684722744071,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"_id":"HqWYW8sSHhfaMWHf"}
{"name":"Globe of Invulnerability","type":"spell","system":{"description":{"value":"<div class=\"rd__b  rd__b--3\"><p>An immobile, faintly shimmering barrier springs into existence in a 10-foot radius around you and remains for the duration.</p><div class=\"rd__spc-inline-post\"></div><p>Any spell of 5th level or lower cast from outside the barrier can't affect creatures or objects within it, even if the spell is cast using a higher level spell slot. Such a spell can target creatures and objects within the barrier, but the spell has no effect on them. Similarly, the area within the barrier is excluded from the areas affected by such spells.</p></div><div class=\"rd__b  rd__b--3\"><div class=\"rd__b  rd__b--3\"><span class=\"rd__h rd__h--3\" data-title-index=\"1\"> <span class=\"entry-title-inner\">At Higher Levels.</span></span> <p>When you cast this spell using a spell slot of 7th level or higher, the barrier blocks spells of one level higher for each slot level above 6th.</p><div class=\"rd__spc-inline-post\"></div></div><div class=\"rd__spc-inline-post\"></div></div>","chat":"","unidentified":""},"source":"PHB","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":"1","units":"minute"},"cover":null,"target":{"value":10,"width":null,"units":"ft","type":"radius"},"range":{"value":null,"long":null,"units":""},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"util","attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"level":6,"school":"abj","components":{"vocal":true,"somatic":true,"material":true,"ritual":false,"concentration":true},"materials":{"value":"a glass or crystal bead that shatters when the spell ends","consumed":true,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"none","formula":""}},"img":"icons/magic/unholy/orb-glowing-yellow-purple.webp","ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"flags":{"plutonium":{"page":"spells.html","source":"PHB","hash":"globe%20of%20invulnerability_phb","propDroppable":"spell"},"rest-recovery":{"data":{"recovery":{"enabled":false}}},"midi-qol":{"effectActivation":false,"forceCEOff":false,"forceCEOn":false,"onUseMacroName":"[postActiveEffects]ItemMacro","onUseMacroParts":{"items":{"0":{"macroName":"ItemMacro","option":"postActiveEffects"}}}},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"autoFailFriendly":false,"autoSaveFriendly":false,"rollOther":false,"critOther":false,"offHandWeapon":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false},"itemacro":{"macro":{"name":"Globe of Invulnerability","type":"script","scope":"global","command":"async function TemplateAttach() {\n    const templateID = canvas.templates.placeables[canvas.templates.placeables.length - 1].data._id;\n    let template = await canvas.templates.get(templateID);\n    let target_token = canvas.tokens.placeables.find(i => i.center.x === template.center.x && i.center.y === template.center.y);\n    tokenAttacher.attachElementToToken(template, target_token)\n}\nTemplateAttach();","author":"Be8r6Sgxcs3sL08I","_id":null,"img":"icons/svg/dice-target.svg","folder":null,"sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null}}},"core":{"sourceId":"Scene.V3MxnI9gjrfdinfI.Token.5or5KOs5Z7TrZri0.Item.osZcnhwAujVW5Pdb"},"cf":{"id":"temp_6q1ztzxb2o4"}},"effects":[],"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1684878183978,"modifiedTime":1684878743790,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"_id":"IURWIs6belYf2Alj"}
{"name":"Wall of Force","type":"spell","system":{"description":{"value":"<div class=\"rd__b  rd__b--3\"><p>An invisible wall of force springs into existence at a point you choose within range. The wall appears in any orientation you choose, as a horizontal or vertical barrier or at an angle. It can be free floating or resting on a solid surface. You can form it into a hemispherical dome or a sphere with a radius of up to 10 feet, or you can shape a flat surface made up of ten 10-foot-by-10-foot panels. Each panel must be contiguous with another panel. In any form, the wall is 1/4 inch thick. It lasts for the duration. If the wall cuts through a creature's space when it appears, the creature is pushed to one side of the wall (your choice which side).</p><div class=\"rd__spc-inline-post\"></div><p>Nothing can physically pass through the wall. It is immune to all damage and can't be dispelled by @spell[dispel magic]. A @spell[disintegrate] spell destroys the wall instantly, however. The wall also extends into the Ethereal Plane, blocking ethereal travel through the wall.</p></div>","chat":"","unidentified":""},"source":"PHB","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":"10","units":"minute"},"cover":null,"target":{"value":null,"width":null,"units":"","type":""},"range":{"value":120,"long":null,"units":"ft"},"uses":{"value":0,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"other","attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"level":5,"school":"evo","components":{"vocal":true,"somatic":true,"material":true,"ritual":false,"concentration":true},"materials":{"value":"","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"none","formula":""}},"img":"icons/magic/air/air-pressure-shield-blue.webp","ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"flags":{"plutonium":{"page":"spells.html","source":"PHB","hash":"wall%20of%20force_phb","propDroppable":"spell"},"advancedspelleffects":{"enableASE":true,"spellEffect":"Wall of Force","effectOptions":{"wallOfForceRadius":10,"wallOfForceSegmentSize":10,"wallOfForcePanelCount":10,"color":"blue","useWebP":false}},"rest-recovery":{"data":{"recovery":{"enabled":false}}},"midi-qol":{"effectActivation":false},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"autoFailFriendly":false,"autoSaveFriendly":false,"rollOther":false,"critOther":false,"offHandWeapon":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false},"core":{"sourceId":"Scene.V3MxnI9gjrfdinfI.Token.AA1ZiqPlTmq7gS9N.Item.9IQ8hWlut8JFIPYf"},"cf":{"id":"temp_l1iqp9ewh5e"}},"effects":[],"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1684929758373,"modifiedTime":1684938885761,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"_id":"KHkVhwbSbCP8fi5j"}
{"name":"Darkness","type":"spell","img":"modules/plutonium/media/icon/spell/phb-darkness.webp","effects":[],"folder":null,"sort":0,"flags":{"srd5e":{"page":"spells.html","source":"PHB","hash":"darkness_phb","propDroppable":"spell"},"scene-packer":{"hash":"f0899aebc24dc8b0fcc7a74d86ef6c05e869adf1","sourceId":"Item.3S566zmrdwHQSz3C"},"siftoolkit":{"SIFData":{"ignoreDuration":false,"texture":"","useTexture":false,"alpha":50,"coneOrigin":1,"loopAnimations":true,"playTemplateAudio":false,"playDamageAudio":false,"playSaveAudio":false,"clip":"","volume":100}},"itemacro":{"macro":{"data":{"_id":null,"name":"Darkness","type":"script","author":"QwT9izJ4aW8QVTjo","img":"icons/svg/dice-target.svg","scope":"global","command":"// Use this macro in the \"On-Use Macro\" Field in the details page (bottom) of the item/spell\n// Requires Token Attacher module\n// Suggested to use Token Magic FX to apply a template animation to the aura/spell when cast and placed down\n\n/* For example: Spirit Guardians. Use this macro in the on-use field and set an animation for the template in Token Magic FX.\nWhen you cast the spell drop it on the canvas with your token at the center. This reads the center location of the template and\nautomatically attaches it to your token\n*/\n\nasync function TemplateAttach() {\n    const templateID = canvas.templates.placeables[canvas.templates.placeables.length - 1].data._id;\n    let template = await canvas.templates.get(templateID);\n    let target_token = canvas.tokens.placeables.find(i => i.center.x === template.center.x && i.center.y === template.center.y);\n    tokenAttacher.attachElementToToken(template, target_token)\n}\nTemplateAttach();","folder":null,"sort":0,"permission":{"default":0},"flags":{}}}},"midi-qol":{"effectActivation":false,"onUseMacroName":"[postActiveEffects]ItemMacro"},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false,"autoFailFriendly":false,"autoSaveFriendly":false,"offHandWeapon":false},"core":{"sourceId":"Item.3S566zmrdwHQSz3C"},"rest-recovery":{"data":{"recovery":{"enabled":false}}},"cf":{"id":"temp_6q1ztzxb2o4"}},"_id":"KaLnVaBNHOpDLEHF","system":{"description":{"value":"<div class=\"rd__b  rd__b--3\"><p>Magical darkness spreads from a point you choose within range to fill a 15-foot-radius sphere for the duration. The darkness spreads around corners. A creature with <span class=\"help help--hover\" data-plut-hover=\"true\" data-plut-hover-preload=\"true\" data-plut-hover-preload-id=\"1\">darkvision</span> can't see through this darkness, and nonmagical light can't illuminate it.</p><div class=\"rd__spc-inline-post\"></div><p>If the point you choose is on an object you are holding or one that isn't being worn or carried, the darkness emanates from the object and moves with it. Completely covering the source of the darkness with an opaque object, such as a bowl or a helm, blocks the darkness.</p><p>If any of this spell's area overlaps with an area of light created by a spell of 2nd level or lower, the spell that created the light is dispelled.</p></div>","chat":"","unidentified":""},"source":"PHB","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":10,"units":"minute"},"cover":null,"crewed":false,"target":{"value":15,"width":null,"units":"ft","type":"sphere"},"range":{"value":60,"long":null,"units":"ft"},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"util","attackBonus":null,"chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"level":2,"school":"evo","components":{"vocal":true,"somatic":false,"material":true,"ritual":false,"concentration":true,"value":""},"materials":{"value":"bat fur and a drop of pitch or piece of coal","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"none","formula":""}},"ownership":{"default":0,"QwT9izJ4aW8QVTjo":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.2.1","coreVersion":"10.291","createdTime":null,"modifiedTime":1688343236140,"lastModifiedBy":"Be8r6Sgxcs3sL08I"}}
{"name":"#[CF_tempEntity]","type":"weapon","flags":{"cf":{"id":"temp_bj0kdv44v2","name":"Smites","color":"#e19393","fontColor":"#FFFFFF","icon":"","sorting":"m","contents":["lPp5ru8rQbrI48yz","6ZLGz7J1QOpEP5qY","oUZRNyPtvOAAOkqO","5GQYvOKAJOYFLeq8","Z1R54lhVCtYLvPjs","SnjJtf3r27NpqNZI","StTL0wDevBtJYioA","qUlZma5mEIh2Ps6t"],"children":[],"folderPath":[],"version":"2.5.7"}},"img":"icons/svg/item-bag.svg","system":{"description":{"value":"","chat":"","unidentified":""},"source":"","quantity":1,"weight":0,"price":{"value":0,"denomination":"gp"},"attunement":0,"equipped":false,"rarity":"","identified":true,"activation":{"type":"","cost":null,"condition":""},"duration":{"value":"","units":""},"cover":null,"target":{"value":null,"width":null,"units":"","type":""},"range":{"value":null,"long":null,"units":""},"uses":{"value":null,"max":"","per":null,"recovery":""},"consume":{"type":"","target":null,"amount":null},"ability":null,"actionType":null,"attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"armor":{"value":null},"hp":{"value":null,"max":null,"dt":null,"conditions":""},"weaponType":"simpleM","baseItem":"","properties":{},"proficient":true},"effects":[],"folder":null,"sort":0,"ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1684984679918,"modifiedTime":1686772021740,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"_id":"Mar70oQjoLupV6SM"}
{"_id":"MtJ2H7j2NA83zJIV","name":"Veneno (Purple Worm)","type":"consumable","img":"icons/consumables/potions/bottle-conical-corked-labeled-skull-poison-green.webp","effects":[{"_id":"yum7fb0w2wdq51a9","changes":[{"key":"flags.dnd5e.DamageBonusMacro","mode":0,"value":"ItemMacro.Veneno (Purple Worm)","priority":20}],"disabled":false,"duration":{"startTime":null,"seconds":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"icon":"icons/consumables/potions/bottle-conical-corked-labeled-skull-poison-green.webp","label":"Veneno (Purple Worm)","transfer":false,"flags":{"core":{"statusId":"Veneno"},"dae":{"stackable":"none","durationExpression":"","macroRepeat":"none","specialDuration":["1Hit:rwak","1Hit:mwak"],"transfer":false},"dnd5e-helpers":{"rest-effect":"Ignore"},"ActiveAuras":{"isAura":false,"aura":"None","radius":null,"alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"displayTemp":false,"hostile":false,"onlyOnce":false}},"tint":null,"origin":null}],"folder":null,"sort":0,"flags":{"siftoolkit":{"SIFData":{"ignoreDuration":false,"texture":"","useTexture":false,"alpha":50,"coneOrigin":1,"loopAnimations":true,"playTemplateAudio":false,"playDamageAudio":false,"playSaveAudio":false,"clip":"","volume":100}},"magicitems":{"enabled":false,"equipped":false,"attuned":false,"charges":"0","chargeType":"c1","destroy":false,"destroyFlavorText":"reaches 0 charges: it crumbles into ashes and is destroyed.","rechargeable":false,"recharge":"0","rechargeType":"t1","rechargeUnit":"r1","sorting":"l"},"itemacro":{"macro":{"data":{"_id":null,"name":"Veneno (Purple Worm)","type":"script","author":"QwT9izJ4aW8QVTjo","img":"icons/svg/dice-target.svg","scope":"global","command":"// v1.0. Requires midi-qol.\nif (![\"mwak\",\"rwak\"].includes(args[0].item.data.actionType)) return {}; \nfor (let tokenUuid of args[0].hitTargetUuids) {\n    const target = await fromUuid(tokenUuid);\n    const targetActor = target.actor;\n    if (!targetActor) continue;\n\n}\nlet spellDC = 19\nlet results = await\ngame.user.targets.first().actor.rollAbilitySave(\"con\");\nif (results.total < spellDC) {\nreturn{damageRoll: `12d6[poison]`, flavor: \"Veneno\"}\n} else {\nreturn{damageRoll: `6d6[poison]`, flavor: \"Veneno\"}\n}","folder":null,"sort":0,"permission":{"default":0},"flags":{}}}},"core":{"sourceId":"Item.PtNBU46PSIol0yEk"},"cf":{"id":"temp_bnv1ahmj4k"},"rest-recovery":{"data":{"recovery":{"enabled":false}}}},"system":{"description":{"value":"<p>Purple Worm Poison (Injury): This poison must be harvested from a dead or Incapacitated Purple Worm. A creature subjected to this poison must make a DC 19 Constitution saving throw, taking 42 (12d6) poison damage on a failed save, or half as much damage on a successful one.</p>","chat":"","unidentified":""},"source":"","quantity":2,"weight":0,"price":0,"attunement":0,"equipped":false,"rarity":"","identified":true,"activation":{"type":"action","cost":1,"condition":""},"duration":{"value":null,"units":""},"target":{"value":null,"width":null,"units":"","type":"self"},"range":{"value":null,"long":null,"units":"self"},"uses":{"value":null,"max":"","per":"","recovery":"","autoDestroy":false},"consume":{"type":"ammo","target":"","amount":1},"ability":null,"actionType":"","attackBonus":0,"chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"consumableType":"poison"},"ownership":{"default":0,"QwT9izJ4aW8QVTjo":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.0.3","coreVersion":"10.291","createdTime":null,"modifiedTime":1670804847549,"lastModifiedBy":"Be8r6Sgxcs3sL08I"}}
{"name":"Circle of Power","type":"spell","img":"icons/magic/light/orb-shadow-blue.webp","effects":[{"_id":"kJdmHhTJH03zJxo2","changes":[{"key":"flags.midi-qol.advantage.ability.save.all","mode":0,"value":"1","priority":20},{"key":"flags.midi-qol.superSaver.all","mode":0,"value":"1","priority":20}],"disabled":false,"duration":{"startTime":null,"seconds":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"icon":"icons/magic/light/orb-shadow-blue.webp","label":"Circle of Power","origin":"Item.LTQm45DD4V2IqDpi","transfer":false,"flags":{"dae":{"stackable":"none","macroRepeat":"none","specialDuration":[],"transfer":false,"selfTarget":false,"selfTargetAlways":false,"durationExpression":""},"dnd5e-helpers":{"rest-effect":"Ignore"},"ActiveAuras":{"isAura":true,"aura":"Allies","radius":"30","alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"hostile":false,"onlyOnce":false,"displayTemp":true},"dfreds-convenient-effects":{"description":""},"core":{"statusId":""}},"tint":null}],"flags":{"core":{"sourceId":"Compendium.dnd5e.spells.uCud2s4TjMfjiXUb"},"midi-qol":{"onUseMacroName":"","effectActivation":false},"betterRolls5e":{"quickOther":{"context":"","value":true,"altValue":true,"type":"Boolean"},"quickDesc":{"value":true,"altValue":true,"type":"Boolean"},"quickSave":{"value":true,"altValue":true,"type":"Boolean"},"quickProperties":{"value":true,"altValue":true,"type":"Boolean"},"quickVersatile":{"value":false,"altValue":false,"type":"Boolean"},"quickFlavor":{"value":true,"altValue":true,"type":"Boolean"},"quickAttack":{"type":"Boolean","value":true,"altValue":true},"quickDamage":{"type":"Array","value":[],"altValue":[],"context":[]},"quickCharges":{"type":"Boolean","value":{"use":true,"resource":true},"altValue":{"use":true,"resource":true}},"quickTemplate":{"type":"Boolean","value":true,"altValue":true},"quickPrompt":{"type":"Boolean","value":false,"altValue":false}},"scene-packer":{"hash":"5517dcc2725d9c3f9845b639608127534ede5c37","sourceId":"Item.B8IrEtWEU0h9EtqY"},"itemacro":{"macro":{"data":{"_id":null,"name":"Spirit Guardians 0.8.85","type":"script","author":"devnIbfBHb74U9Zv","img":"icons/svg/dice-target.svg","scope":"global","command":"const lastArg = args[args.length -1];\n// Check when applying the effect - if the token is not the caster and it IS the tokens turn they take damage\nif (args[0] === \"on\" && args[1] !== lastArg.tokenId && lastArg.tokenId === game.combat?.current.tokenId) {\n    const sourceItem = await fromUuid(lastArg.origin);\n    let theActor = await fromUuid(lastArg.actorUuid);\n    if (theActor.actor) theActor = theActor.actor;\n    const itemData = mergeObject(duplicate(sourceItem.data), {\n        type: \"weapon\",\n        effects: [],\n        flags: {\n            \"midi-qol\": {\n                noProvokeReaction: true, // no reactions triggered\n                onUseMacroName: null // \n            },\n        },\n        data: {\n            actionType: \"save\",\n            save: {dc: Number.parseInt(args[3]), ability: \"wis\", scaling: \"flat\"},\n            damage: { parts: [[`${args[2]}d8`, \"radiant\"]] },\n            \"target.type\": \"self\",\n            components: {concentration: false, material: false, ritual: false, somatic: false, value: \"\", vocal: false},\n            duration: {units: \"inst\", value: undefined},\n            weaponType: \"improv\"\n        }\n    }, {overwrite: true, inlace: true, insertKeys: true, insertValues: true});\n    itemData.data.target.type = \"self\";\n    setProperty(itemData.flags, \"autoanimations.killAnim\", true);\n    itemData.flags.autoanimations.killAnim = true;;\n    const item = new CONFIG.Item.documentClass(itemData, { parent: theActor })\n    const options = { showFullCard: false, createWorkflow: true, versatile: false, configureDialog: false };\n    await MidiQOL.completeItemRoll(item, options);\n\n}","folder":null,"sort":0,"permission":{"default":0},"flags":{}},"name":"Spirit Guardians 10.0.10","type":"script","img":"icons/svg/dice-target.svg","scope":"global","command":"const version = \"10.0.10\";\ntry {\n    const lastArg = args[args.length -1];\n    // Check when applying the effect - if the token is not the caster and it IS the tokens turn they take damage\n    if (args[0] === \"on\" && args[1] !== lastArg.tokenId && lastArg.tokenId === game.combat?.current.tokenId) {\n        const sourceItem = await fromUuid(lastArg.origin);\n        let theActor = await fromUuid(lastArg.actorUuid);\n        if (theActor.actor) theActor = theActor.actor;\n        const itemData = mergeObject(duplicate(sourceItem.toObject(false)), {\n            type: \"weapon\",\n            effects: [],\n            flags: {\n                \"midi-qol\": {\n                    noProvokeReaction: true, // no reactions triggered\n                    onUseMacroName: null // \n                },\n            },\n            system: {\n                actionType: \"save\",\n                save: {dc: Number.parseInt(args[3]), ability: \"wis\", scaling: \"flat\"},\n                damage: { parts: [[`${args[2]}d8`, \"radiant\"]] },\n                \"target.type\": \"self\",\n                components: {concentration: false, material: false, ritual: false, somatic: false, value: \"\", vocal: false},\n                duration: {units: \"inst\", value: undefined},\n                weaponType: \"improv\"\n            }\n        }, {overwrite: true, inlace: true, insertKeys: true, insertValues: true});\n        itemData.system.target.type = \"self\";\n        setProperty(itemData.flags, \"autoanimations.killAnim\", true);\n        itemData.flags.autoanimations.killAnim = true;;\n        const item = new CONFIG.Item.documentClass(itemData, { parent: theActor })\n        const options = { showFullCard: false, createWorkflow: true, versatile: false, configureDialog: false };\n        await MidiQOL.completeItemRoll(item, options);\n    }\n} catch (err) {\n    console.error(`Spirit Guardians ${version}`, err);\n}","sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null}}},"gm-notes":{},"cf":{"id":"temp_lpjg4hxkuum","color":"#000000"},"rest-recovery":{"data":{"recovery":{"enabled":false}}},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"autoFailFriendly":false,"autoSaveFriendly":false,"rollOther":false,"critOther":false,"offHandWeapon":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false}},"system":{"description":{"value":"<div class=\"rd__b  rd__b--3\"><p>Divine energy radiates from you, distorting and diffusing magical energy within 30 feet of you. Until the spell ends, the sphere moves with you, centered on you. For the duration, each friendly creature in the area (including you) has advantage on saving throws against spells and other magical effects. Additionally, when an affected creature succeeds on a saving throw made against a spell or magical effect that allows it to make a saving throw to take only half damage, it instead takes no damage if it succeeds on the saving throw.</p></div><div class=\"rd__b  rd__b--3\"><p><strong>ACTIVE AURAS.</strong></p><p></p></div>","chat":"","unidentified":""},"source":"PHB pg. 278","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":"10","units":"minute"},"cover":null,"target":{"value":null,"width":null,"units":"","type":"self"},"range":{"value":null,"long":null,"units":"self"},"uses":{"value":0,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"","attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":0,"scaling":"spell"},"level":5,"school":"abj","components":{"vocal":true,"somatic":false,"material":false,"ritual":false,"concentration":true},"materials":{"value":"A holy symbol","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"level","formula":"1d8"}},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1661995926108,"modifiedTime":1685210700939,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"folder":null,"sort":0,"_id":"OU9Hofvwzt57gxQe"}
{"name":"Aura of Life","type":"spell","system":{"description":{"value":"<div class=\"rd__b  rd__b--3\"><p>Life-preserving energy radiates from you in an aura with a 30-foot radius. Until the spell ends, the aura moves with you, centered on you. Each nonhostile creature in the aura (including you) has resistance to necrotic damage, and its hit point maximum can't be reduced. In addition, a nonhostile, living creature regains 1 hit point when it starts its turn in the aura with 0 hit points.</p><div class=\"rd__spc-inline-post\"></div></div>","chat":"","unidentified":""},"source":"PHB","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":"10","units":"minute"},"cover":null,"target":{"value":null,"width":null,"units":"","type":"self"},"range":{"value":null,"long":null,"units":""},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"heal","attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"level":4,"school":"abj","components":{"vocal":true,"somatic":false,"material":false,"ritual":false,"concentration":true},"materials":{"value":"","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"none","formula":""}},"img":"icons/magic/life/cross-yellow-green.webp","flags":{"plutonium":{"page":"spells.html","source":"PHB","hash":"aura%20of%20life_phb","propDroppable":"spell"},"rest-recovery":{"data":{"recovery":{"enabled":false}}},"midi-qol":{"effectActivation":false},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"autoFailFriendly":false,"autoSaveFriendly":false,"rollOther":false,"critOther":false,"offHandWeapon":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false},"core":{"sourceId":"Actor.YPh5XDISqV1e9Zth.Item.8lDfCLWT5qiRT7lc"},"cf":{"id":"temp_lpjg4hxkuum"}},"effects":[{"label":"Aura of Life","icon":"icons/magic/life/cross-yellow-green.webp","changes":[{"key":"system.traits.dr.value","mode":0,"value":"necrotic","priority":20}],"transfer":false,"_id":"ckcMjhFPEXdq0z28","disabled":false,"duration":{"startTime":null,"seconds":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"origin":null,"tint":null,"flags":{"dfreds-convenient-effects":{"description":""},"dae":{"selfTarget":false,"selfTargetAlways":true,"stackable":"noneName","durationExpression":"","macroRepeat":"none","specialDuration":[]},"core":{"statusId":""},"ActiveAuras":{"isAura":true,"aura":"Allies","radius":"30","alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"displayTemp":true,"hostile":false,"onlyOnce":false}}}],"ownership":{"default":0,"l056gHuKc3178tdK":3,"Be8r6Sgxcs3sL08I":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1669682061284,"modifiedTime":1685623737444,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"_id":"Okywjza8OsAcDlgr"}
{"name":"Tasha's Hideous Laughter","type":"spell","system":{"description":{"value":"<div class=\"rd__b  rd__b--3\"><p>A creature of your choice that you can see within range perceives everything as hilariously funny and falls into fits of laughter if this spell affects it. The target must succeed on a Wisdom saving throw or fall @condition[prone], becoming @condition[incapacitated] and unable to stand up for the duration. A creature with an Intelligence score of 4 or less isn't affected.</p><div class=\"rd__spc-inline-post\"></div><p>At the end of each of its turns, and each time it takes damage, the target can make another Wisdom saving throw. The target has advantage on the saving throw if it's triggered by damage. On a success, the spell ends.</p></div>","chat":"","unidentified":""},"source":"PHB","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":1,"units":"minute"},"cover":null,"target":{"value":1,"width":null,"units":"","type":"creature"},"range":{"value":30,"long":null,"units":"ft"},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"save","attackBonus":null,"chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"wis","dc":null,"scaling":"spell"},"level":1,"school":"enc","components":{"vocal":true,"somatic":true,"material":true,"ritual":false,"concentration":true,"value":""},"materials":{"value":"tiny tarts and a feather that is waved in the air","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"always","prepared":true},"scaling":{"mode":"none","formula":""}},"img":"icons/creatures/magical/spirit-fire-yellow.webp","flags":{"plutonium":{"page":"spells.html","source":"PHB","hash":"tasha's%20hideous%20laughter_phb","propDroppable":"spell"},"rest-recovery":{"data":{"recovery":{"enabled":false}}},"midi-qol":{"effectActivation":false},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"autoFailFriendly":false,"rollOther":false,"critOther":false,"offHandWeapon":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false,"autoSaveFriendly":false},"core":{"sourceId":"Actor.CQaWddu2rSc1igDg.Item.gKdBEpA99HpAE3e1"},"cf":{"id":"temp_lpjg4hxkuum"}},"effects":[{"label":"Tasha's Hideous Laughter","icon":"icons/creatures/magical/spirit-fire-yellow.webp","changes":[{"key":"macro.CE","mode":0,"value":"Prone","priority":20},{"key":"macro.CE","mode":0,"value":"Incapacitated","priority":20},{"key":"flags.midi-qol.OverTime","mode":2,"value":"turn=end,\nsaveDC=@attributes.spelldc,\nsaveAbility=wis","priority":20}],"transfer":false,"_id":"Z9gPap0SCZODWM2k","disabled":false,"duration":{"startTime":null,"seconds":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"origin":null,"tint":null,"flags":{"dae":{"selfTarget":false,"selfTargetAlways":false,"stackable":"none","durationExpression":"","macroRepeat":"none","specialDuration":[]},"core":{"statusId":""},"ActiveAuras":{"isAura":false,"aura":"None","radius":null,"alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"displayTemp":false,"hostile":false,"onlyOnce":false}}}],"ownership":{"default":0,"Xvz9L40UsVHWsWpn":3,"Be8r6Sgxcs3sL08I":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1671396058316,"modifiedTime":1685635914550,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"_id":"QPc95ukgFgXAmIKP"}
{"name":"Goodberry","type":"spell","system":{"description":{"value":"<p><em>Put spell description here</em></p>","chat":"","unidentified":""},"source":"Basic Rules, Player's Handbook pg 246","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":"","units":"inst"},"cover":null,"target":{"value":null,"width":null,"units":"","type":"self"},"range":{"value":null,"long":null,"units":""},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"util","attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"level":1,"school":"trs","components":{"vocal":true,"somatic":true,"material":true,"ritual":false,"concentration":false},"materials":{"value":"a sprig of mistletoe","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"none","formula":""}},"img":"icons/consumables/plants/leaf-veins-glowing-green.webp","ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"flags":{"ddbimporter":{"id":137985,"definitionId":2126,"entityTypeId":435869154,"dndbeyond":{"lookup":"generic","lookupName":"generic","level":null,"castAtLevel":null},"sources":[{"sourceId":1,"pageNumber":null,"sourceType":2},{"sourceId":2,"pageNumber":246,"sourceType":1}],"tags":["Healing"],"version":"3.3.13","originalName":"Goodberry","effectsApplied":true},"cf":{"id":"temp_6q1ztzxb2o4","path":"Transmutation"},"core":{"sourceId":"Compendium.ddb-shared-compendia.ddb-spells.lt2MrwouJv2Z684d"},"walledtemplates":{"wallsBlock":"globalDefault","wallRestriction":"globalDefault"},"rest-recovery":{"data":{"recovery":{"enabled":false}}},"midi-qol":{"effectActivation":false,"onUseMacroName":"[postActiveEffects]ItemMacro"},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"autoFailFriendly":false,"autoSaveFriendly":false,"rollOther":false,"critOther":false,"offHandWeapon":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false},"itemacro":{"macro":{"name":"Goodberry","type":"script","scope":"global","command":"// ##################################################################################################\n// Read First!!!!\n// Spell - Goddberry\n// Creates a Goodberry item that expires and is deleted after 24h.\n// v0.1.0\n// Author: Elwin#1410, based on Crymic's Goodberry macro\n// Dependencies:\n//  - DAE\n//  - Item Macro\n//  - MidiQOL \"on use\" macro [preTargeting][preItemRoll][postActiveEffects]\n//  - Simple Calendar (optional)\n//  - About Time (optional)\n//\n// How to configure:\n// The item details must be:\n//   - Activation cost: 1 Action\n//   - Target: \"Self\"\n//   - Duration: Instantaneous\n//   - Action type: Utility\n//   - No damage should be configured\n//   - On Use Macros:\n//       ItemMacro | After Active Effects\n//   - This item macro code must be added to the ItemMacro code of the Goodberry item.\n//\n// Usage:\n// This item need to be used to activate. It creates a batch of berries that will expire in 24h.\n// The expiration is embeded in the item, so I can be copied to another actor and it will still expire at the\n// appropriate time.\n//\n// Description:\n// In the postActiveEffects phase (of source item):\n//   Creates a Goodberry item and adds it to the caster inventory. The expiration date and time is added to the name\n//   to differenciate each created batch and a flag is set with the batch expiration time, if Simple Calendar is present\n//   the date and time are formatted in text instead of worldtime seconds. If About Time is active,\n//   an event is added to delete the item from the caster. Data about this event is kept in a flag on the created item.\n// In the preTargeting phase (of created item):\n//   Verifies if the batch has expired, and if it's the case, deletes the batch and cancels the item use.\n//   If About Time is active, it verifies if the actorUuid from the event is the same as the one that used\n//   the item, if not, a new event is added to delete the item from the current actor.\n// In the preItemRoll phase (of created item):\n//   Forces fast forwarding and auto rolling damage because its a fixed value, so no dice rolling.\n// ###################################################################################################\n\n// Default name of the item\nconst defaultItemName = \"Goodberry\";\nconst spellDuration = 60 * 60 * 24;\nconst workflow = MidiQOL.Workflow.getWorkflow(args[0].uuid)\n// Text used for the created goodberry consumable and expiration warning messages\n// Note: you can update these text to localize it.\nconst goodberryDescription =\n  \"<p>Eating a berry restores 1 hit point, and the berry provides enough nourishment to sustain a creature for one day.</p>\";\nconst goodberryChatFlavor = \"[healing] 10 Berries (1 can be eaten per action)\";\nconst goodberryExpirationOnUseWarn = \"The berries lost their potency and vanishes\";\nconst goodberryExpirationEventWarn = \"Some berries lost their potency and vanishes from\";\n\n// Set to false to remove debug logging\nconst debug = true;\nconst dependencies = [\"dae\", \"itemacro\", \"midi-qol\"];\nif (!requirementsSatisfied(defaultItemName, dependencies)) {\n  return;\n}\n\n/**\n * If the requirements are met, returns true, false otherwise.\n *\n * @returns true if the requirements are met, false otherwise.\n */\nfunction requirementsSatisfied(name, dependencies) {\n  let missingDep = false;\n  dependencies.forEach((dep) => {\n    if (!game.modules.get(dep)?.active) {\n      const errorMsg = `${name}: ${dep} must be installed and active.`;\n      ui.notifications.error(errorMsg);\n      console.warn(errorMsg);\n      missingDep = true;\n    }\n  });\n  return !missingDep;\n}\n\nif (debug) {\n  console.error(defaultItemName, arguments);\n}\n\nif (args[0].tag === \"OnUse\" && args[0].macroPass === \"postActiveEffects\") {\n  const tokenActor = actor;\n  const expirationTime = game.time.worldTime + spellDuration;\n  let batchId = expirationTime;\n  if (game.modules.get(\"foundryvtt-simple-calendar\")?.active) {\n    const result = SimpleCalendar.api.formatTimestamp(expirationTime);\n    batchId = `${result.date} - ${result.time}`;\n  }\n  const newItemData = {\n    name: `${workflow.item.name})`,\n    type: \"consumable\",\n    img: \"icons/consumables/food/berries-ration-round-red.webp\",\n    system: {\n      description: {\n        value: goodberryDescription,\n      },\n      quantity: 10,\n      weight: 0.002,\n      rarity: \"common\",\n      activation: {\n        type: \"action\",\n        cost: 1,\n      },\n      target: { type: \"self\" },\n      uses: {\n        value: 1,\n        max: \"1\",\n        per: \"charges\",\n        autoDestroy: true,\n      },\n      actionType: \"heal\",\n      chatFlavor: goodberryChatFlavor,\n      damage: { parts: [[\"1\", \"healing\"]] },\n      consumableType: \"food\",\n    },\n  };\n  const [newItem] = await tokenActor.createEmbeddedDocuments(\"Item\", [newItemData]);\n  // When about time is present, register a callback to delete the item when it expires\n  if (game.modules.get(\"about-time\")?.active) {\n    const eventId = game.Gametime.doAt(expirationTime, deleteGoodberries, tokenActor.uuid);\n    if (eventId) {\n      const goodberryEvent = {\n        expirationTime: expirationTime,\n        eventId: eventId,\n        actorUuid: tokenActor.uuid,\n      };\n      newItem.setFlag(\"world\", \"goodberry\", goodberryEvent);\n    }\n  }\n}\n\nfunction getConsumableMacro() {\n  return `\n// Default name of the item\nconst defaultItemName = \"${defaultItemName}\";\nconst debug = \"${debug}\";\nconst goodberryExpirationEventWarn = \"${goodberryExpirationEventWarn}\";\nif (debug) {\n  console.error(defaultItemName, arguments);\n}\nif (args[0].tag === \"OnUse\" && args[0].macroPass === \"preTargeting\") {\n  const macroData = args[0];\n  const expirationTime = getProperty(workflow.item, \"flags.world.goodberry.expirationTime\") ?? 0;\n  if (game.time.worldTime >= expirationTime) {\n    ui.notifications.warn(\"${goodberryExpirationOnUseWarn}\");\n    await workflow.item.delete();\n    return false;\n  }\n  // When about time is present, register a callback to delete the item when it expires if not already registerd\n  if (game.modules.get(\"about-time\")?.active) {\n    if (item.getFlag(\"world\", \"goodberry\")?.actorUuid !== macroData.actorUuid) {\n        const eventId = game.Gametime.doAt(expirationTime, deleteGoodberries, macroData.actorUuid);\n        if (eventId) {\n            const goodberryEvent = {expirationTime: expirationTime, eventId: eventId, actorUuid: macroData.actorUuid};\n            item.setFlag(\"world\", \"goodberry\", goodberryEvent);\n        }\n    }\n  }\n  return true;\n} else if (args[0].tag === \"OnUse\" && args[0].macroPass === \"preItemRoll\") {\n  // Force fast forward and auto roll because its only a fixed value, there is no dice rolls.\n  setProperty(workflow, \"workflowOptions.fastForwardDamage\", true);\n  setProperty(workflow, \"workflowOptions.autoRollDamage\", \"always\");\n  return true;  \n}\n\n${deleteGoodberries.toString()}\n  `;\n}\n\nasync function deleteGoodberries(actorUuid) {\n  const tokenOrActor = await fromUuid(actorUuid);\n  let actor;\n  if (tokenOrActor instanceof CONFIG.Token.documentClass) {\n    actor = tokenOrActor.actor;\n  }\n  if (tokenOrActor instanceof CONFIG.Actor.documentClass) {\n    actor = tokenOrActor;\n  }\n  if (!actor) {\n    return;\n  }\n  const now = game.time.worldTime;\n  const itemsToDelete = actor.itemTypes.consumable.filter(\n    (it) =>\n      getProperty(it, \"flags.world.goodberry.expirationTime\") &&\n      now >= getProperty(it, \"flags.world.goodberry.expirationTime\")\n  );\n  if (itemsToDelete.length > 0) {\n    const deletedItems = await actor.deleteEmbeddedDocuments(\n      \"Item\",\n      itemsToDelete.map((it) => it.id)\n    );\n    ui.notifications.warn(goodberryExpirationEventWarn + ` ${actor.name}: ` + deletedItems.map((it) => it.name).join());\n  }\n}","author":"Be8r6Sgxcs3sL08I","_id":null,"img":"icons/svg/dice-target.svg","folder":null,"sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null}}},"exportSource":{"world":"test2","system":"dnd5e","coreVersion":"10.291","systemVersion":"2.2.1"}},"effects":[],"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1663621625017,"modifiedTime":1687655159473,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"_id":"RJn4TgfTiV1zQX7u"}
{"name":"Staggering Smite","type":"spell","system":{"description":{"value":"<div class=\"rd__b  rd__b--3\"><p>The next time you hit a creature with a melee weapon attack during this spell's duration, your weapon pierces both body and mind, and the attack deals an extra [[/r 4d6]] psychic damage to the target. The target must make a Wisdom saving throw. On a failed save, it has disadvantage on attack rolls and ability checks, and can't take reactions, until the end of its next turn.</p><div class=\"rd__spc-inline-post\"></div></div>","chat":"","unidentified":""},"source":"PHB","activation":{"type":"bonus","cost":1,"condition":""},"duration":{"value":"1","units":"minute"},"cover":null,"target":{"value":null,"width":null,"units":"","type":"self"},"range":{"value":null,"long":null,"units":"self"},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"other","attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"level":4,"school":"evo","components":{"vocal":true,"somatic":false,"material":false,"ritual":false,"concentration":true},"materials":{"value":"","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"none","formula":""}},"img":"icons/skills/melee/strike-axe-energy-pink.webp","flags":{"srd5e":{"page":"spells.html","source":"PHB","hash":"staggering%20smite_phb"},"spellTemplateManager":{"stmData":{"ignoreDuration":false,"spellTexture":"","useTexture":false,"alpha":50,"coneOrigin":1,"loopAnimations":true}},"midi-qol":{"onUseMacroName":"","effectActivation":false},"itemacro":{"macro":{"data":{"_id":null,"name":"Staggering Smite","type":"script","author":"WpiVAovmlZrRTFMX","img":"icons/svg/dice-target.svg","scope":"global","command":"if (![\"mwak\"].includes(args[0].itemData.data.actionType)) return {}; // melee weapon attack\nconst uuid = game.user.targets.first().actor.uuid;\nconst targets = Array.from(game.user.targets);\nconst hasEffectApplied = game.dfreds.effectInterface.hasEffectApplied('Staggering Smit', uuid);\nconst wait = async (ms) => new Promise((resolve)=> setTimeout(resolve, ms));\n\nlet effectData = {\n       \t\t\tlabel : \"Staggering Smite\",\n       \t\t\ticon : \"modules/GMmacros/img/phb-staggering-smite.webp\",\n        \t\tchanges: [{value: 1, mode: CONST.ACTIVE_EFFECT_MODES.OVERRIDE, priority: 20, key:\"flags.midi-qol.disadvantage.skill.all\"},{value: 1, mode: CONST.ACTIVE_EFFECT_MODES.OVERRIDE, priority: 20, key:\"flags.midi-qol.disadvantage.attack.all\"}], \n\t\t\tduration: {rounds: 1}, \n\t\t\tflags:{dae: {specialDuration: [\"turnEnd\"]}}\n\t\t\t}\n\n\nfor (const target of targets) {\nawait game.MonksTokenBar.requestRoll(targets,{request:'save:wis', silent: true});\nawait wait(5000)\n\nconst listMessages = game.messages.contents\nconst lastMessage = listMessages[listMessages.length - 1];\nconst spellDC = actor.data.data.attributes.spelldc\nlet tokenid = 'token'+target.id;\nlet saveRoll = lastMessage.data.flags[\"monks-tokenbar\"][tokenid].total\n\nif (saveRoll < spellDC) {\nif (!hasEffectApplied) {\n  await game.dfreds.effectInterface.addEffect({ effectName: 'Staggering Smit', uuid});\n  } \n}\n}\nlet spellLevel = 4;\nif (args[0].isCritical) spellLevel = spellLevel * 2;\nreturn{damageRoll: `${spellLevel}d6[psychic]`, flavor: \"Staggering Smite\"};","folder":null,"sort":0,"permission":{"default":0},"flags":{}},"name":"Staggering Smite","type":"script","scope":"global","command":"// Modules Required - Item Macro, MIDQOL, Dynamic Active Effects\n// Card settings - Target & range: Self\n// DAE settings - [1] flags.dnd5e.DamageBonusMacro / Custom / ItemMacro.Wrathful Smite \n\nif (![\"mwak\",\"rwak\"].includes(args[0].item.data.actionType)) return {}; \nif (args[0].hitTargetUuids.length === 0) return {}; // did not hit anyone\nlet selected = await MidiQOL.MQfromActorUuid(args[0].actorUuid); \nconst targetActor = game.user.targets.first().actor.uuid;\nconst targett = game.user.targets.first();\nlet DC = selected.data.data.attributes.spelldc;\nconst effectData = {\n        label: \"Staggering Smite\", \n        icon: \"modules/GMmacros/img/phb-staggering-smite.webp\",\n        flags: {\n          dae: {specialDuration: [\"turnEnd\"]}\n        },\n       changes: [\n\t      {value: 1, mode: CONST.ACTIVE_EFFECT_MODES.OVERRIDE, priority: 20, key:\"flags.midi-qol.disadvantage.skill.all\"},\n\t      {value: 1, mode: CONST.ACTIVE_EFFECT_MODES.OVERRIDE, priority: 20, key:\"flags.midi-qol.disadvantage.attack.all\"},\n\t      {key: \"macro.CE\", mode: 0, value: \"Reaction\", priority: 20}],\n\t     duration: {rounds: 1} \n       }\nconst actorD = canvas.tokens.controlled[0].actor;\nlet results = await game.MonksTokenBar.requestRoll([game.user.targets.first()],{request:'save:wis', silent: true, fastForward: false, dc: `${DC}`, flavor: \"Save against being frightened\"});\nlet tokenid = 'token'+targett.id;\nvar i = 0;\nwhile (results.data.flags['monks-tokenbar'][tokenid].total === undefined && i < 30) {\n     await new Promise(resolve => setTimeout(resolve, 500))\n         i++;\n      }\n\nif (results.data.flags['monks-tokenbar'][tokenid].passed === false) {\n     await MidiQOL.socket().executeAsGM(\"createEffects\", { actorUuid: targetActor, effects: [effectData] });\n}\n\nlet spellLevel = 4;\nif (args[0].isCritical) spellLevel = spellLevel * 2;\nreturn{damageRoll: `${spellLevel}d6[psychic]`, flavor: \"Staggering Smite\"};","author":"Be8r6Sgxcs3sL08I","_id":null,"img":"icons/svg/dice-target.svg","folder":null,"sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null}}},"core":{"sourceId":"Item.4zmIP1GW897LasOh"},"exportSource":{"world":"criador","system":"dnd5e","coreVersion":"0.8.8","systemVersion":"1.3.6"},"siftoolkit":{"SIFData":{"ignoreDuration":false,"texture":"","useTexture":false,"alpha":50,"coneOrigin":1,"loopAnimations":true,"playTemplateAudio":false,"playDamageAudio":false,"playSaveAudio":false,"clip":"","volume":100}},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"autoFailFriendly":false,"offHandWeapon":false,"ignoreTotalCover":false,"autoSaveFriendly":false},"cf":{"id":"temp_bj0kdv44v2"},"scene-packer":{"hash":"ed6ae6abff20410cd92a6ca5931c34cda251ce77","sourceId":"Item.gHeRRVA4bQKCFs8H"},"rest-recovery":{"data":{"recovery":{"enabled":false}}}},"effects":[{"_id":"ZjGlyQjY319huydD","changes":[{"key":"flags.dnd5e.DamageBonusMacro","mode":0,"value":"ItemMacro.Staggering Smite","priority":20}],"disabled":false,"duration":{"startTime":null,"rounds":10,"seconds":null,"combat":null,"turns":null,"startRound":null,"startTurn":null},"icon":"modules/plutonium/media/icon/spell/phb-staggering-smite.webp","label":"Staggering Smite","transfer":false,"flags":{"dae":{"stackable":"none","macroRepeat":"none","specialDuration":["1Hit:mwak","1Hit:rwak"],"transfer":false,"durationExpression":"","selfTarget":false,"selfTargetAlways":false},"ActiveAuras":{"isAura":false,"radius":"","aura":"None","alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"hostile":false,"onlyOnce":false,"displayTemp":false},"core":{"statusId":""},"dnd5e-helpers":{"rest-effect":"Ignore"},"dfreds-convenient-effects":{"description":""}},"tint":null,"origin":null}],"ownership":{"default":0,"l056gHuKc3178tdK":3,"Be8r6Sgxcs3sL08I":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1669682066617,"modifiedTime":1684984735784,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"_id":"SnjJtf3r27NpqNZI"}
{"name":"Thunderous Smite","type":"spell","system":{"description":{"value":"<div class=\"rd__b  rd__b--3\"><p>The first time you hit with a melee weapon attack during this spell's duration, your weapon rings with thunder that is audible within 300 feet of you, and the attack deals an extra [[/r 2d6]] thunder damage to the target. Additionally, if the target is a creature, it must succeed on a Strength saving throw or be pushed 10 feet away from you and knocked @condition[prone].</p><div class=\"rd__spc-inline-post\"></div></div>","chat":"","unidentified":""},"source":"PHB","activation":{"type":"bonus","cost":1,"condition":""},"duration":{"value":"1","units":"minute"},"cover":null,"target":{"value":null,"width":null,"units":"","type":"self"},"range":{"value":null,"long":null,"units":"self"},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"other","attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"level":1,"school":"evo","components":{"vocal":true,"somatic":false,"material":false,"ritual":false,"concentration":true},"materials":{"value":"","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"none","formula":""}},"img":"icons/magic/lightning/bolt-strike-wide-white.webp","flags":{"srd5e":{"page":"spells.html","source":"PHB","hash":"thunderous%20smite_phb"},"spellTemplateManager":{"stmData":{"ignoreDuration":false,"spellTexture":"","useTexture":false,"alpha":50,"coneOrigin":1,"loopAnimations":true}},"midi-qol":{"onUseMacroName":"","effectActivation":false},"itemacro":{"macro":{"data":{"_id":null,"name":"Thunderous Smite","type":"script","author":"WpiVAovmlZrRTFMX","img":"icons/svg/dice-target.svg","scope":"global","command":"if (![\"mwak\"].includes(args[0].itemData.data.actionType)) return {}; // melee weapon attack\nconst uuid = game.user.targets.first().actor.uuid;\nconst targett = game.user.targets.first();\nconst targets = Array.from(game.user.targets);\nconst hasEffectApplied = game.dfreds.effectInterface.hasEffectApplied('Prone', uuid);\nconst wait = async (ms) => new Promise((resolve)=> setTimeout(resolve, ms));\n\nfor (const target of targets) {\n\nif (target.actor.data.data.traits.ci.value.includes(\"prone\")) {\n  \t\tui.notifications.info(\"Imune to Prone!\");\n} else { \n\nawait game.MonksTokenBar.requestRoll(targets,{request:'save:str', silent: true});\nawait wait(5000)\n\nconst listMessages = game.messages.contents\nconst lastMessage = listMessages[listMessages.length - 1];\nconst spellDC = actor.data.data.attributes.spelldc\nlet tokenid = 'token'+target.id;\nlet saveRoll = lastMessage.data.flags[\"monks-tokenbar\"][tokenid].total\n\nif (saveRoll < spellDC) {\nif (!hasEffectApplied) {\n  await game.dfreds.effectInterface.addEffect({ effectName: 'Prone', uuid});\n  } \n}\n} }\n\nawait canvas.tokens.moveMany({dx:(targett.data.x/canvas.grid.size-token.data.x/canvas.grid.size)*2, dy:(targett.data.y/canvas.grid.size-token.data.y/canvas.grid.size)*2, ids: [targett.id]});\nlet spellLevel = 2;\nif (args[0].isCritical) spellLevel = spellLevel * 2;\nreturn{damageRoll: `${spellLevel}d6[thunder]`, flavor: \"Thunderous Smite\"};","folder":null,"sort":0,"permission":{"default":0},"flags":{}},"name":"Thunderous Smite","type":"script","scope":"global","command":"if (![\"mwak\"].includes(args[0].itemData.data.actionType)) return {}; // melee weapon attack\nif (args[0].hitTargetUuids.length === 0) return {}\nconst uuid = game.user.targets.first().actor.uuid;\nconst targett = game.user.targets.first();\nconst wait = async (ms) => new Promise((resolve)=> setTimeout(resolve, ms));\nlet selected = await MidiQOL.MQfromActorUuid(args[0].actorUuid); \n\nconst hasEffectApplied = game.dfreds.effectInterface.hasEffectApplied('Prone', game.user.targets.first().actor.uuid)\nif(!hasEffectApplied) {\n        const actorD = canvas.tokens.controlled[0].actor;\n        const DC = selected.data.data.attributes.spelldc;\n        let results = await game.MonksTokenBar.requestRoll([game.user.targets.first()],{request:'save:str', silent: true, fastForward: false, dc: `${DC}`, flavor: \"Save against being pushed prone\"});\n        let tokenid = 'token'+targett.id;\n        var i = 0;\n        while (results.data.flags['monks-tokenbar'][tokenid].total === undefined && i < 30) {\n            await new Promise(resolve => setTimeout(resolve, 500))\n            i++;\n        }\n             \n        if (results.data.flags['monks-tokenbar'][tokenid].passed === false) await game.dfreds.effectInterface.addEffect({effectName:'Prone', uuid: game.user.targets.first().actor.uuid, origin: canvas.tokens.controlled[0].actor.uuid})\n}\n\nawait canvas.tokens.moveMany({dx:(targett.data.x/canvas.grid.size-token.data.x/canvas.grid.size)*2, dy:(targett.data.y/canvas.grid.size-token.data.y/canvas.grid.size)*2, ids: [targett.id]});\n\nlet spellLevel = 2;\nif (args[0].isCritical) spellLevel = spellLevel * 2;\nreturn{damageRoll: `${spellLevel}d6[thunder]`, flavor: \"Thunderous Smite\"};","author":"Be8r6Sgxcs3sL08I","_id":null,"img":"icons/svg/dice-target.svg","folder":null,"sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null}}},"core":{"sourceId":"Item.y4OxsSifV43KWiLH"},"exportSource":{"world":"criador","system":"dnd5e","coreVersion":"0.8.8","systemVersion":"1.3.6"},"siftoolkit":{"SIFData":{"ignoreDuration":false,"texture":"","useTexture":false,"alpha":50,"coneOrigin":1,"loopAnimations":true,"playTemplateAudio":false,"playDamageAudio":false,"playSaveAudio":false,"clip":"","volume":100}},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false,"autoFailFriendly":false,"autoSaveFriendly":false,"offHandWeapon":false},"cf":{"id":"temp_bj0kdv44v2"},"scene-packer":{"hash":"9a9b1d4d626e8812924128103e0e40ad7ef665af","sourceId":"Item.LJ3KhMRxWEWbpxRc"},"rest-recovery":{"data":{"recovery":{"enabled":false}}}},"effects":[{"_id":"rZnn6dJ2qCXaajTU","changes":[{"key":"flags.dnd5e.DamageBonusMacro","mode":0,"value":"ItemMacro.Thunderous Smite","priority":20},{"key":"flags.midi-qol.thunderousSmite.level","mode":5,"value":"2","priority":20},{"key":"flags.midi-qol.thunderousDC.level","mode":0,"value":"@attributes.spelldc","priority":20}],"disabled":false,"duration":{"startTime":null,"rounds":10,"seconds":null,"combat":null,"turns":null,"startRound":null,"startTurn":null},"icon":"modules/plutonium/media/icon/spell/phb-thunderous-smite.webp","label":"Thunderous Smite","transfer":false,"flags":{"dae":{"stackable":"none","macroRepeat":"none","specialDuration":["1Hit:mwak","1Hit:rwak"],"transfer":false},"ActiveAuras":{"isAura":false,"radius":null,"aura":"None","alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"hostile":false,"onlyOnce":false}},"tint":null,"origin":null}],"ownership":{"default":0,"l056gHuKc3178tdK":3,"Be8r6Sgxcs3sL08I":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1669682066766,"modifiedTime":1686614779975,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"_id":"StTL0wDevBtJYioA"}
{"_id":"TGL4z244vlkKeZva","name":"Toll the Dead","type":"spell","img":"modules/GMmacros/img/xge-toll-the-dead.webp","effects":[],"folder":null,"sort":0,"flags":{"ddbimporter":{"id":138274,"definitionId":14615,"entityTypeId":435869154,"dndbeyond":{"lookup":"generic","lookupName":"generic","level":null,"castAtLevel":null},"sources":[{"sourceId":27,"pageNumber":169,"sourceType":1}],"tags":["Damage"]},"betterRolls5e":{"quickVersatile":{"altValue":true},"quickCharges":{"value":{"use":true,"resource":true},"altValue":{"use":true,"resource":true}}},"midi-qol":{"effectActivation":false,"onUseMacroName":"[preDamageRoll]ItemMacro"},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"autoFailFriendly":false,"offHandWeapon":false,"ignoreTotalCover":false},"core":{"sourceId":"Compendium.world.ddb-spells.eWALttYghEEA1qOa"},"scene-packer":{"hash":"9f7ff19882d5754133397d9eb2657cd5ce210bd1","sourceId":"Item.CHNM01gLo3kddfju"},"itemacro":{"macro":{"data":{"_id":null,"name":"Toll the Dead","type":"script","author":"devnIbfBHb74U9Zv","img":"icons/svg/dice-target.svg","scope":"global","command":"if (args[0].macroPass === \"preDamageRoll\") {\n    const target = await fromUuid(args[0].targetUuids[0]);\n    const needsD12 = target.actor.data.data.attributes.hp.value < target.actor.data.data.attributes.hp.max;\n    const theItem = await fromUuid(args[0].uuid);\n    let formula = theItem.data.data.damage.parts[0][0];\n    if (needsD12) \n        formula = formula.replace(\"d8\", \"d12\")\n    else \n        formula = formula.replace(\"d12\", \"d8\");\n    theItem.data.data.damage.parts[0][0] = formula;\n}","folder":null,"sort":0,"permission":{"default":0},"flags":{}}}},"cf":{"id":"temp_lpjg4hxkuum"},"siftoolkit":{"SIFData":{"ignoreDuration":false,"texture":"","useTexture":false,"alpha":50,"coneOrigin":1,"loopAnimations":true,"playTemplateAudio":false,"playDamageAudio":false,"playSaveAudio":false,"clip":"","volume":100}},"rest-recovery":{"data":{"recovery":{"enabled":false}}}},"system":{"description":{"value":"<p class=\"Core-Styles_Core-Body\">You point at one creature you can see within range, and the sound of a dolorous bell fills the air around it for a moment. The target must succeed on a Wisdom saving throw or take 1d8 necrotic damage. If the target is missing any of its hit points, it instead takes 1d12 necrotic damage.</p>\n<p class=\"Core-Styles_Core-Body\">The spells damage increases by one die when you reach 5th level (2d8 or 2d12), 11th level (3d8 or 3d12), and 17th level (4d8 or 4d12).</p>","chat":"<p class=\"Core-Styles_Core-Body\">You point at one creature you can see within range, and the sound of a dolorous bell fills the air around it for a moment. The target must succeed on a Wisdom saving throw or take 1d8 necrotic damage. If the target is missing any of its hit points, it instead takes 1d12 necrotic damage.</p>\n<p class=\"Core-Styles_Core-Body\">The spells damage increases by one die when you reach 5th level (2d8 or 2d12), 11th level (3d8 or 3d12), and 17th level (4d8 or 4d12).</p>","unidentified":""},"source":"Xanathar's Guide to Everything pg 169","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":null,"units":"inst"},"target":{"value":1,"width":null,"units":"","type":"creature"},"range":{"value":60,"long":null,"units":"ft"},"uses":{"value":0,"max":"0","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"save","attackBonus":0,"chatFlavor":"","critical":{"threshold":null,"damage":null},"damage":{"parts":[["1d12","necrotic"]],"versatile":""},"formula":"","save":{"ability":"wis","dc":null,"scaling":"spell"},"level":0,"school":"nec","components":{"value":"","vocal":true,"somatic":true,"material":false,"ritual":false,"concentration":false},"materials":{"value":"","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":false},"scaling":{"mode":"cantrip","formula":""},"attributes":{"spelldc":10},"attunement":null},"ownership":{"default":0,"QwT9izJ4aW8QVTjo":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.0.3","coreVersion":"10.291","createdTime":null,"modifiedTime":1671423465635,"lastModifiedBy":"Be8r6Sgxcs3sL08I"}}
{"name":"Investiture of Stone","type":"spell","system":{"description":{"value":"<div class=\"rd__b  rd__b--3\"><p>Until the spell ends, bits of rock spread across your body, and you gain the following benefits:</p><div class=\"rd__spc-inline-post\"><p></p></div><ul class=\"rd__list\"><li class=\"rd__li \">You have resistance to bludgeoning, piercing, and slashing damage from nonmagical attacks.</li><li class=\"rd__li \">You can use your action to create a small earthquake on the ground in a 15-foot radius centered on you. Other creatures on that ground must succeed on a Dexterity saving throw or be knocked @condition[prone].</li><li class=\"rd__li \">You can move across difficult terrain made of earth or stone without spending extra movement. You can move through solid earth or stone as if it was air and without destabilizing it, but you can't end your movement there. If you do so, you are ejected to the nearest unoccupied space, this spell ends, and you are @condition[stunned] until the end of your next turn.</li></ul></div>","chat":"","unidentified":""},"source":"XGE","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":"10","units":"minute"},"cover":null,"target":{"value":null,"width":null,"units":"","type":"self"},"range":{"value":null,"long":null,"units":"self"},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"save","attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"level":6,"school":"trs","components":{"vocal":true,"somatic":true,"material":false,"ritual":false,"concentration":true},"materials":{"value":"","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"none","formula":""}},"img":"icons/magic/earth/construct-stone-long-arms.webp","ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"flags":{"plutonium":{"page":"spells.html","source":"XGE","hash":"investiture%20of%20stone_xge","propDroppable":"spell"},"core":{"sourceId":"Actor.uEwtmlc84Te8YgjK.Item.d8ai3Scxxg9hBlsW"},"rest-recovery":{"data":{"recovery":{"enabled":false}}},"midi-qol":{"effectActivation":false},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"autoFailFriendly":false,"autoSaveFriendly":false,"rollOther":false,"critOther":false,"offHandWeapon":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false},"itemacro":{"macro":{"name":"Investiture of Stone","type":"script","scope":"global","command":"const lastArg = args[args.length - 1];\nconst thisToken = canvas.tokens.get(lastArg.tokenId);\n\nif (args[0] === \"on\") {\n  // If the dynamic active effect started\n    const updates = {\n        embedded: {\n            Item: {\n                \"Small Earthquake\": { //String\n                    type: \"spell\", // feat, spell\n                    img: \"icons/magic/earth/barrier-stone-explosion-debris.webp\", //Example: \"icons/magic/holy/projectiles-blades-salvo-yellow.webp\"\n                    type: \"spell\",\n                    system: {\n                        description: {\n                            value: \"<p>You can use your action to create a small earthquake on the ground in a 15-foot radius centered on you. Other creatures on that ground must succeed on a Dexterity saving throw or be knocked @condition[prone].</p>\", //String\n                        },\n                        activation: {\n                            type: \"action\", // action, bonus, crew, day, hour, lair, legendary, minute, none, reaction, special, reactiondamage, reactionmanual\n                            cost: 1, // Numeric\n                            condition: \"\" // String\n                        },\n                        target: {\n                        value: 15,\n                        width: null,\n                        units: \"ft\",\n                        type: \"sphere\",\n                        },\n                        range: {\n                        value: null,\n                        long: null,\n                        units: \"special\",\n                        },\n                        actionType: \"other\", // mwak, rwak, msak, rsak, save, heal, abil, util, other\n                        level: 6, // Numeric 1-9\n                        school: \"trans\", // abj, con, div, enc, evo, ill, nec, trs\n                        preparation: {\n                            mode: \"atwill\", // prepared, pact, always, atwill, innate\n                            prepared: true // true, false\n                        },\n                        save: {\n                        ability: \"dex\",\n                        dc: null,\n                        scaling: \"spell\",\n                        },\n                        },\n                        \"effects\": [\n                        {\n                        transfer: false,\n                        icon: \"icons/magic/earth/barrier-stone-explosion-debris.webp\",\n                        label: \"Small Earthquake\",\n                        changes: [\n                        {\n                        key: \"macro.CE\",\n                        mode: 0,\n                        value: \"Prone\",\n                        priority: \"20\"\n                        }],\n                      }]\n                   }\n                }\n            }\n        }\n    \n\n  //update the token and create the necessary attack spell\n await warpgate.mutate(thisToken.document, updates);\n ui.notifications.info(`Small Earthquake has been added to spells at will.`);\n}\nif (args[0] === \"off\") {\n  //Concentration broke or time expired, let's revert the token and remove the attack spell item\n await warpgate.revert(thisToken.document);\n}","author":"Be8r6Sgxcs3sL08I","_id":null,"img":"icons/svg/dice-target.svg","folder":null,"sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null}}},"cf":{"id":"temp_6q1ztzxb2o4"}},"effects":[{"label":"Investiture of Stone","icon":"icons/magic/earth/construct-stone-long-arms.webp","changes":[{"key":"system.traits.dr.custom","mode":0,"value":"Non-Magical Physical","priority":20},{"key":"macro.itemMacro","mode":0,"value":"@item","priority":20}],"transfer":false,"_id":"phQTgMHS0IgmVbtF","disabled":false,"duration":{"startTime":null,"seconds":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"origin":null,"tint":null,"flags":{"dfreds-convenient-effects":{"description":""},"dae":{"selfTarget":false,"selfTargetAlways":true,"stackable":"noneName","durationExpression":"","macroRepeat":"none","specialDuration":[]},"core":{"statusId":""},"ActiveAuras":{"isAura":false,"aura":"None","radius":"","alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"displayTemp":false,"hostile":false,"onlyOnce":false}}}],"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1685751194497,"modifiedTime":1685840687724,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"_id":"Tq1C2piePydqPTZn"}
{"name":"#[CF_tempEntity]","type":"weapon","flags":{"cf":{"id":"temp_l1iqp9ewh5e","name":"Magias_Adv_spl_efect","color":"#ce5fba","fontColor":"#FFFFFF","icon":"","sorting":"m","contents":["KHkVhwbSbCP8fi5j"],"children":[]}},"img":"icons/svg/item-bag.svg","system":{"description":{"value":"","chat":"","unidentified":""},"source":"","quantity":1,"weight":0,"price":{"value":0,"denomination":"gp"},"attunement":0,"equipped":false,"rarity":"","identified":true,"activation":{"type":"","cost":null,"condition":""},"duration":{"value":"","units":""},"cover":null,"target":{"value":null,"width":null,"units":"","type":""},"range":{"value":null,"long":null,"units":""},"uses":{"value":null,"max":"","per":null,"recovery":""},"consume":{"type":"","target":null,"amount":null},"ability":null,"actionType":null,"attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"armor":{"value":null},"hp":{"value":null,"max":null,"dt":null,"conditions":""},"weaponType":"simpleM","baseItem":"","properties":{},"proficient":true},"effects":[],"folder":null,"sort":0,"ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1684938880804,"modifiedTime":1684938885761,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"_id":"UBNEYFFjVi7LTtUb"}
{"name":"Sleet Storm","ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"type":"spell","system":{"description":{"value":"<p>Until the spell ends, freezing rain and sleet fall in a 20-foot-tall cylinder with a 40-foot radius centered on a point you choose within range. The area is heavily obscured, and exposed flames in the area are doused.</p><p>The ground in the area is covered with slick ice, making it difficult terrain. When a creature enters the spell's area for the first time on a turn or starts its turn there, it must make a Dexterity saving throw. On a failed save, it falls Prone.</p><p>If a creature is concentrating in the spell's area, the creature must make a successful Constitution saving throw against your spell save DC or lose concentration.</p>","chat":"","unidentified":""},"source":"SRD 5.1","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":"1","units":"minute"},"cover":null,"target":{"value":40,"width":null,"units":"ft","type":"cylinder"},"range":{"value":150,"long":null,"units":"ft"},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"util","attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"level":3,"school":"con","components":{"vocal":true,"somatic":true,"material":true,"ritual":false,"concentration":false},"materials":{"value":"A pinch of dust and a few drops of water.","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"none","formula":""}},"flags":{"core":{"sourceId":"Compendium.dnd5e.spells.dhqBY4TvVjxVmOZd"},"templatemacro":{"whenCreated":{"asGM":false,"command":"console.log(template);\nconsole.log(this);"},"whenEntered":{"asGM":false,"command":"await chrisPremades.macros.sleetstorm.sleetinZone(token, template);"},"whenLeft":{"asGM":false,"command":"await chrisPremades.macros.sleetstorm.sleetleaveZone(token, template);"},"whenStaying":{"asGM":false,"command":"await chrisPremades.macros.sleetstorm.sleetinZone(token, template);"},"whenTurnStart":{"asGM":false,"command":"await chrisPremades.macros.sleetstorm.sleetinZone(token, template);"}},"rest-recovery":{"data":{"recovery":{"enabled":false}}},"midi-qol":{"effectActivation":false,"onUseMacroName":"[postActiveEffects]ItemMacro"},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"autoFailFriendly":false,"autoSaveFriendly":false,"rollOther":false,"critOther":false,"offHandWeapon":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false},"itemacro":{"macro":{"name":"Sleet Storm","type":"script","scope":"global","command":"const lastArg = args[args.length - 1]\nconst uuid = lastArg.actorUuid\nconst hasEffectApplied = await game.dfreds.effectInterface.hasEffectApplied('Concentrating', uuid);\n\nif (!hasEffectApplied) {\n  game.dfreds.effectInterface.addEffect({ effectName: 'Concentrating', uuid });\n} else {\n  game.dfreds.effectInterface.removeEffect({ effectName: 'Concentrating', uuid });\n  await game.dfreds.effectInterface.addEffect({ effectName: 'Concentrating', uuid });\n  }","author":"Be8r6Sgxcs3sL08I","_id":null,"img":"icons/svg/dice-target.svg","folder":null,"sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null}}},"cf":{"id":"temp_5lmql55efox"}},"img":"icons/magic/water/projectile-beams-salvo-blue.webp","effects":[],"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1661787234181,"modifiedTime":1685749728759,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"_id":"VidDcXmpTTrALYEP"}
{"name":"Prismatic Spray","type":"spell","img":"modules/dae/icons/spray.png","effects":[{"_id":"gOnQpt6PVE9KUDZl","flags":{"core":{"statusId":""},"dae":{"stackable":"none","macroRepeat":"none","specialDuration":[],"transfer":false},"dnd5e-helpers":{"rest-effect":"Ignore"},"ActiveAuras":{"isAura":false,"aura":"None","radius":null,"alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"displayTemp":false,"hostile":false,"onlyOnce":false}},"changes":[],"duration":{"startTime":null,"seconds":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"icon":"modules/dae/icons/spray.png","label":"Prismatic Spray Active Effects","transfer":false,"disabled":false,"tint":null,"origin":null}],"flags":{"dynamiceffects":{"effects":[{"modSpecKey":"macro.itemMacro","value":"@target @spellLevel @item","mode":"+","targetSpecific":false,"id":1,"itemId":"8tAFQog6gg0Tkvzy","active":true,"_targets":[],"label":"Macro Item Macro"}],"equipActive":false,"alwaysActive":false,"activeEquipped":false},"itemacro":{"macro":{"data":{"_id":null,"name":"Prismatic Spray","type":"script","img":"icons/svg/dice-target.svg","scope":"global","command":"let doDamage = async (damageType, color, target, saved) => {\n  let damageRoll\n  if (saved) damageRoll = await new Roll(`10d6/2[${damageType}]`).roll();\n  else damageRoll = await new Roll(`10d6[${damageType}]`).roll();\n  const flavor = `Prismatic Spray ${color} - ${target.name} (${CONFIG.DND5E.damageTypes[damageType]}) Damage`;\n  await new MidiQOL.DamageOnlyWorkflow(casterActor, casterToken, damageRoll.total, damageType, [target], damageRoll, {flavor, itemCardId: \"new\", itemData: args[0].itemData});\n}\n\nconst casterToken = await fromUuid(args[0].tokenUuid);\nconst casterActor = await fromUuid(args[0].actorUuid)\n\nfor (let targetUuid of args[0].hitTargetUuids) {\n  let target = await fromUuid(targetUuid);\n  const saved = args[0].saveUuids.includes(targetUuid);\n  let effects = [(await new Roll(\"1d8\").roll()).total];\n  if (effects[0] === 8) {\n    effects = [(await new Roll(\"1d7\").roll()).total, (await new Roll(\"1d7\").roll()).total];\n  }\n  for (let effect of effects) {\n    switch (effect) {\n    case 1:\n      await doDamage(\"fire\", \"Red\", target, saved);\n      break;\n    case 2:\n      await doDamage(\"acid\", \"Orange\", target, saved);\n      break;\n    case 3:\n      await doDamage(\"lightning\", \"Yellow\", target, saved);\n      break;\n    case 4:\n      await doDamage(\"poison\", \"Green\", target, saved);\n      break;\n    case 5:\n      await doDamage(\"cold\", \"Blue\", target, saved);\n      break;\n    case 6:\n      await ChatMessage.create({flavor: `Prismatic Spray - Indigo`, content: `${target.name} is restrained. make a Constitution saving throw at the end of each of ${casterActor.name}'s turns.\n      \n      If ${target.name} successfully saves three times, the spell ends. If it fails its save three times, it permanently turns to stone and is subjected to the petrified condition. The successes and failures dont need to be consecutive; keep track of both until the target collects three of a kind.`});\n      if (game.dfreds?.effectInterface) {\n          game.dfreds.effectInterface.addEffect({effectName: \"Restrained\", uuid: target.uuid, overlay: false});\n      } else {\n        const restrained = CONFIG.statusEffects.find(se => se.id === \"restrained\");\n        if (restrained && token)\n          token.toggleEffect(restrained.icon, { overlay: false, active: true })\n      }\n      break;\n    case 7:\n      if (game.dfreds?.effectInterface) {\n          game.dfreds.effectInterface.addEffect({effectName: \"Blinded\", uuid: target.uuid, overlay: false});\n      } else {\n        const blinded = CONFIG.statusEffects.find(se => se.id === \"blinded\");\n        if (blinded && token)\n          token.toggleEffect(blinded.icon, { overlay: false, active: true })\n      }\n      await ChatMessage.create({flavor: `Prismatic Spray - Violet`, content: `${target.name} is blinded. Make a DC ${args[0].itemData.data.save.dc} Wisdom saving throw at the start of ${casterActor.name}'s next turn. A successful save ends the blindness. If ${target.name} fails that save, the it is transported to another plane of existence of the GMs choosing and is no longer blinded. (Typically, a creature that is on a plane that isnt its home plane is banished home, while other creatures are usually cast into the Astral or Ethereal planes.`});\n      break;\n    }\n  }\n}","folder":null,"sort":0,"permission":{"default":0},"flags":{}},"name":"Prismatic Spray","type":"script","scope":"global","command":"let doDamage = async (damageType, color, target, saved) => {\n  let damageRoll\n  if (saved) damageRoll = await new Roll(`10d6/2[${damageType}]`).roll();\n  else damageRoll = await new Roll(`10d6[${damageType}]`).roll();\n  const flavor = `Prismatic Spray ${color} - ${target.name} (${CONFIG.DND5E.damageTypes[damageType]}) Damage`;\n  await new MidiQOL.DamageOnlyWorkflow(casterActor, casterToken, damageRoll.total, damageType, [target], damageRoll, {flavor, itemCardId: args[0].itemCardId, itemData: args[0].itemData});\n}\n\nconst casterToken = await fromUuid(args[0].tokenUuid);\nconst casterActor = await fromUuid(args[0].actorUuid)\n\nfor (let targetUuid of args[0].hitTargetUuids) {\n  let target = await fromUuid(targetUuid);\n  const saved = args[0].saveUuids.includes(targetUuid);\n  let effects = [(await new Roll(\"1d8\").roll()).total];\n  if (effects[0] === 8) {\n    effects = [(await new Roll(\"1d7\").roll()).total, (await new Roll(\"1d7\").roll()).total];\n  }\n  for (let effect of effects) {\n    switch (effect) {\n    case 1:\n      await doDamage(\"fire\", \"Red\", target, saved);\n      break;\n    case 2:\n      await doDamage(\"acid\", \"Orange\", target, saved);\n      break;\n    case 3:\n      await doDamage(\"lightning\", \"Yellow\", target, saved);\n      break;\n    case 4:\n      await doDamage(\"poison\", \"Green\", target, saved);\n      break;\n    case 5:\n      await doDamage(\"cold\", \"Blue\", target, saved);\n      break;\n    case 6:\n\tif (saved) break;\n      await ChatMessage.create({flavor: `Prismatic Spray - Indigo`, content: `${target.name} is restrained. make a Constitution saving throw at the end of each of ${casterActor.name}'s turns.\n      \n      If ${target.name} successfully saves three times, the spell ends. If it fails its save three times, it permanently turns to stone and is subjected to the petrified condition. The successes and failures dont need to be consecutive; keep track of both until the target collects three of a kind.`});\n      if (game.dfreds?.effectInterface) {\n          game.dfreds.effectInterface.addEffect({effectName: \"Restrained\", uuid: target.uuid, overlay: false});\n      } else {\n        const restrained = CONFIG.statusEffects.find(se => se.id === \"restrained\");\n        if (restrained && token)\n          token.toggleEffect(restrained.icon, { overlay: false, active: true })\n      }\n      break;\n    case 7:\n\tif (saved) break;\n      if (game.dfreds?.effectInterface) {\n          game.dfreds.effectInterface.addEffect({effectName: \"Blinded\", uuid: target.uuid, overlay: false});\n      } else {\n        const blinded = CONFIG.statusEffects.find(se => se.id === \"blinded\");\n        if (blinded && token)\n          token.toggleEffect(blinded.icon, { overlay: false, active: true })\n      }\n      await ChatMessage.create({flavor: `Prismatic Spray - Violet`, content: `${target.name} is blinded. Make a DC ${args[0].itemData.data.save.dc} Wisdom saving throw at the start of ${casterActor.name}'s next turn. A successful save ends the blindness. If ${target.name} fails that save, the it is transported to another plane of existence of the GMs choosing and is no longer blinded. (Typically, a creature that is on a plane that isnt its home plane is banished home, while other creatures are usually cast into the Astral or Ethereal planes.`});\n      break;\n    }\n  }\n}","_id":null,"img":"icons/svg/dice-target.svg","folder":null,"sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null},"author":"j0ehn2MWXUxGfZMj"}},"favtab":{"isFavorite":true},"exportSource":{"world":"continent","system":"dnd5e","coreVersion":"10.291","systemVersion":"2.1.4"},"dae":{"activeEquipped":false,"alwaysActive":false},"core":{"sourceId":"Item.Cwed6QSIGGtisw7A"},"midi-qol":{"onUseMacroName":"[postActiveEffects]ItemMacro","effectActivation":false},"scene-packer":{"sourceId":"Item.h7NS7vY0Sy8P6hNk","hash":"3069085f219440edf76740547c19f4ab34c1eb4c"},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"autoFailFriendly":false,"autoSaveFriendly":false,"offHandWeapon":false,"ignoreTotalCover":false},"autoanimations":{"id":"3c1dc687-2c4a-42fd-af97-3a8069a5410c","label":"Prismatic Spray","macro":{"enable":false,"playWhen":"0"},"menu":"templatefx","primary":{"video":{"dbSection":"templatefx","menuType":"cone","animation":"breathweapon","variant":"fire02","color":"blue","enableCustom":false,"customPath":""},"sound":{"enable":true,"delay":0,"file":"Weapon%20Sounds/Astral_Imprisonment_target.mp3.mp3","repeat":1,"repeatDelay":250,"startTime":0,"volume":0.75},"options":{"contrast":0,"delay":0,"elevation":1000,"isMasked":false,"isWait":false,"occlusionAlpha":0.5,"occlusionMode":"3","opacity":1,"persistent":false,"persistType":"sequencerground","playbackRate":1,"removeTemplate":false,"repeat":1,"repeatDelay":250,"rotate":0,"saturate":0,"scale":"1","tint":false,"tintColor":"#FFFFFF","zIndex":1}},"secondary":{"enable":false,"video":{"dbSection":"static","menuType":"spell","animation":"curewounds","variant":"01","color":"blue","enableCustom":false,"customPath":""},"sound":{"enable":false,"delay":0,"repeat":1,"repeatDelay":250,"startTime":0,"volume":0.75},"options":{"addTokenWidth":false,"anchor":"0.5","contrast":0,"delay":0,"elevation":1000,"fadeIn":250,"fadeOut":500,"isMasked":false,"isRadius":true,"isWait":false,"opacity":1,"repeat":1,"repeatDelay":250,"saturate":0,"size":1.5,"tint":false,"tintColor":"#FFFFFF","zIndex":1}},"soundOnly":{"sound":{"enable":false,"delay":0,"repeat":1,"repeatDelay":250,"startTime":0,"volume":0.75}},"source":{"enable":false,"video":{"dbSection":"static","menuType":"energy","animation":"shimmer","variant":"01","color":"blue","enableCustom":false,"customPath":""},"sound":{"enable":false,"delay":0,"repeat":1,"repeatDelay":250,"startTime":0,"volume":0.75},"options":{"addTokenWidth":false,"anchor":"0.5","contrast":0,"delay":0,"elevation":1000,"fadeIn":250,"fadeOut":500,"isMasked":false,"isRadius":false,"isWait":true,"opacity":1,"repeat":1,"repeatDelay":250,"saturate":0,"size":1,"tint":false,"tintColor":"#FFFFFF","zIndex":1}},"target":{"enable":false,"video":{"dbSection":"static","menuType":"spell","animation":"curewounds","variant":"01","color":"blue","enableCustom":false,"customPath":""},"sound":{"enable":false,"delay":0,"repeat":1,"repeatDelay":250,"startTime":0,"volume":0.75},"options":{"addTokenWidth":false,"anchor":"0.5","contrast":0,"delay":0,"elevation":1000,"fadeIn":250,"fadeOut":500,"isMasked":false,"isRadius":false,"opacity":1,"persistent":false,"repeat":1,"repeatDelay":250,"saturate":0,"size":1,"tint":false,"tintColor":"#FFFFFF","unbindAlpha":false,"unbindVisibility":false,"zIndex":1}},"isEnabled":true,"isCustomized":true,"fromAmmo":false,"version":5},"cf":{"id":"temp_6q1ztzxb2o4"},"rest-recovery":{"data":{"recovery":{"enabled":false}}}},"system":{"description":{"value":"<p>Eight multicolored rays of light flash from your hand. Each ray is a different color and has a different power and purpose. Each creature in a 60-foot cone must make a Dexterity saving throw. For each target, roll a d8 to determine which color ray affects it.</p><ol><li><strong>Red</strong>. The target takes 10d6 fire damage on a failed save, or half as much damage on a successful one.</li><li><strong>Orange</strong>. The target takes 10d6 acid damage on a failed save, or half as much damage on a successful one.</li><li><strong>Yellow</strong>. The target takes 10d6 lightning damage on a failed save, or half as much damage on a successful one.</li><li><strong>Green</strong>. The target takes 10d6 poison damage on a failed save, or half as much damage on a successful one.</li><li><strong>Blue</strong>. The target takes 10d6 cold damage on a failed save, or half as much damage on a successful one.</li><li><strong>Indigo</strong>. On a failed save, the target is Restrained. It must then make a Constitution saving throw at the end of each of its turns. If it successfully saves three times, the spell ends. If it fails its save three times, it permanently turns to stone and is subjected to the Petrified condition. The successes and failures don't need to be consecutive; keep track of both until the target collects three of a kind.</li><li><strong>Violet</strong>. On a failed save, the target is Blinded. It must then make a Wisdom saving throw at the start of your next turn. A successful save ends the blindness. If it fails that save, the creature is transported to another plane of existence of the DM's choosing and is no longer Blinded. (Typically, a creature that is on a plane that isn't its home plane is banished home, while other creatures are usually cast into the Astral or Ethereal planes.)</li><li><strong>Special</strong>. The target is struck by two rays. Roll twice more, rerolling any 8.</li></ol>","chat":"","unidentified":""},"source":"","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":"","units":"inst"},"cover":null,"target":{"value":60,"width":null,"units":"ft","type":"cone"},"range":{"value":null,"long":null,"units":"self"},"uses":{"value":0,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"save","attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"dex","dc":25,"scaling":"spell"},"level":7,"school":"abj","components":{"vocal":true,"somatic":true,"material":false,"ritual":false,"concentration":false},"materials":{"value":"","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"level","formula":"1d8"}},"ownership":{"default":0,"devnIbfBHb74U9Zv":3,"Be8r6Sgxcs3sL08I":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1676504626636,"modifiedTime":1685890941245,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"_id":"XZyd175m5EGhfXl7"}
{"type":"spell","system":{"description":{"value":"<p>You conjure a mass of thick, sticky webbing at a point of your choice within range. The webs fill a 20-foot cube from that point for the duration. The webs are difficult terrain and lightly obscure their area.</p><p>If the webs arent anchored between two solid masses (such as walls or trees) or layered across a floor, wall, or ceiling, the conjured web collapses on itself, and the spell ends at the start of your next turn. Webs layered over a flat surface have a depth of 5 feet.</p><p>Each creature that starts its turn in the webs or that enters them during its turn must make a Dexterity saving throw. On a failed save, the creature is restrained as long as it remains in the webs or until it breaks free.</p><p>A creature restrained by the webs can use its action to make a Strength check against your spell save DC. If it succeeds, it is no longer restrained.</p><p>The webs are flammable. Any 5-foot cube of webs exposed to fire burns away in 1 round, dealing 2d4 fire damage to any creature that starts its turn in the fire.</p>","chat":"","unidentified":""},"source":"Basic Rules, Player's Handbook pg 289","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":"1","units":"hour"},"cover":null,"target":{"value":20,"width":null,"units":"ft","type":"cube"},"range":{"value":60,"long":null,"units":"ft"},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"util","attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"level":2,"school":"con","components":{"vocal":true,"somatic":true,"material":true,"ritual":false,"concentration":false},"materials":{"value":"","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"none","formula":""}},"name":"Web","flags":{"ddbimporter":{"id":138960,"definitionId":2305,"entityTypeId":435869154,"dndbeyond":{"lookup":"generic","lookupName":"generic","level":null,"castAtLevel":null},"originalName":"Zone of Truth","sources":[{"sourceId":1,"pageNumber":null,"sourceType":2},{"sourceId":2,"pageNumber":289,"sourceType":1}],"tags":["Control"],"version":"3.3.10","effectsApplied":true},"cf":{"id":"temp_5lmql55efox"},"core":{"sourceId":"Compendium.world.ddb-development-testing-ddb-spells.YEBIv8j5MGMhZUdo"},"templatemacro":{"whenCreated":{"asGM":false,"command":"console.log(template);\nconsole.log(this);"},"whenEntered":{"asGM":false,"command":"await chrisPremades.macros.web.winZone(token, template);"},"whenTurnStart":{"asGM":false,"command":"await chrisPremades.macros.web.winZone(token, template);"},"whenLeft":{"asGM":false,"command":"await chrisPremades.macros.web.wleaveZone(token, template);"},"whenStaying":{"asGM":false,"command":"await chrisPremades.macros.web.winZone(token, template);"}},"custom-character-sheet-sections":{"sectionName":""},"rest-recovery":{"data":{"recovery":{"enabled":false}}},"midi-qol":{"effectActivation":false,"onUseMacroName":"[postActiveEffects]ItemMacro"},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"autoFailFriendly":false,"autoSaveFriendly":false,"rollOther":false,"critOther":false,"offHandWeapon":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false},"itemacro":{"macro":{"name":"Web","type":"script","scope":"global","command":"const lastArg = args[args.length - 1]\nconst uuid = lastArg.actorUuid\nconst hasEffectApplied = await game.dfreds.effectInterface.hasEffectApplied('Concentrating', uuid);\n\nif (!hasEffectApplied) {\n  game.dfreds.effectInterface.addEffect({ effectName: 'Concentrating', uuid });\n} else {\n  game.dfreds.effectInterface.removeEffect({ effectName: 'Concentrating', uuid });\n  await game.dfreds.effectInterface.addEffect({ effectName: 'Concentrating', uuid });\n  }","author":"Be8r6Sgxcs3sL08I","_id":null,"img":"icons/svg/dice-target.svg","folder":null,"sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null}}}},"effects":[],"img":"icons/magic/control/debuff-chains-ropes-net-white.webp","_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1676798650073,"modifiedTime":1685749716005,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"ownership":{"default":0,"PQGBBcoVSwpUhViM":3,"Be8r6Sgxcs3sL08I":3},"folder":null,"sort":0,"_id":"Y5CExsBpbzV7TeDA"}
{"name":"Power Word Pain","type":"spell","system":{"description":{"value":"<div class=\"rd__b  rd__b--3\"><p>You speak a word of power that causes waves of intense pain to assail one creature you can see within range. If the target has 100 hit points or fewer, it is subject to crippling pain. Otherwise, the spell has no effect on it. A target is also unaffected if it is immune to being @condition[charmed].</p><div class=\"rd__spc-inline-post\"></div><p>While the target is affected by crippling pain, any speed it has can be no higher than 10 feet. The target also has disadvantage on attack rolls, ability checks, and saving throws, other than Constitution saving throws. Finally, if the target tries to cast a spell, it must first succeed on a Constitution saving throw, or the casting fails and the spell is wasted.</p><p>A target suffering this pain can make a Constitution saving throw at the end of each of its turns. On a successful save, the pain ends.</p></div>","chat":"","unidentified":""},"source":"XGE","activation":{"type":"action","cost":1,"condition":"target.attributes.hp.value <= 100"},"duration":{"value":"","units":"perm"},"cover":null,"target":{"value":null,"width":null,"units":"","type":""},"range":{"value":60,"long":null,"units":"ft"},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"save","attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"con","dc":null,"scaling":"spell"},"level":7,"school":"enc","components":{"vocal":true,"somatic":false,"material":false,"ritual":false,"concentration":false},"materials":{"value":"","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"none","formula":""}},"img":"icons/magic/control/voodoo-doll-pain-damage-yellow.webp","ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"flags":{"plutonium":{"page":"spells.html","source":"XGE","hash":"power%20word%20pain_xge","propDroppable":"spell"},"rest-recovery":{"data":{"recovery":{"enabled":false}}},"midi-qol":{"effectActivation":true},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"autoFailFriendly":false,"autoSaveFriendly":false,"rollOther":false,"critOther":false,"offHandWeapon":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false},"core":{"sourceId":"Actor.R2FJwP7Y7RlHZVTr.Item.lY5AJ0caKFILo7Dj"},"cf":{"id":"temp_lpjg4hxkuum"}},"effects":[{"label":"Power Word Pain","icon":"icons/magic/control/voodoo-doll-pain-damage-yellow.webp","changes":[{"key":"flags.midi-qol.OverTime","mode":5,"value":"turn=end,\nsaveDC=@attributes.spelldc,\nsaveAbility=con,\nallowIncapacitated=true,\nlabel=Save to overcome Pain","priority":20},{"key":"flags.midi-qol.disadvantage.attack.all","mode":0,"value":"1","priority":20},{"key":"flags.midi-qol.disadvantage.ability.save.all","mode":0,"value":"1","priority":20},{"key":"flags.midi-qol.advantage.ability.save.con","mode":0,"value":"1","priority":20},{"key":"flags.midi-qol.disadvantage.ability.check.all","mode":0,"value":"1","priority":20},{"key":"flags.midi-qol.advantage.ability.check.con","mode":0,"value":"1","priority":20},{"key":"system.attributes.movement.all","mode":0,"value":"10","priority":20}],"transfer":false,"_id":"ue2KUKxOjCKMTp5D","disabled":false,"duration":{"startTime":null,"seconds":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"origin":null,"tint":null,"flags":{"dfreds-convenient-effects":{"description":""},"dae":{"selfTarget":false,"selfTargetAlways":false,"stackable":"noneName","durationExpression":"","macroRepeat":"none","specialDuration":[]},"core":{"statusId":"Pain"},"ActiveAuras":{"isAura":false,"aura":"None","radius":"","alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"displayTemp":false,"hostile":false,"onlyOnce":false}}}],"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1684878186677,"modifiedTime":1684881676718,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"_id":"Ys4Y9WBkqqbrutAC"}
{"_id":"Z1R54lhVCtYLvPjs","name":"Searing Smite","type":"spell","img":"modules/GMmacros/img/phb-searing-smite.webp","effects":[{"_id":"6hAZJkE4UfjO7Adp","changes":[{"key":"flags.dnd5e.DamageBonusMacro","mode":0,"value":"ItemMacro.Searing Smite","priority":20},{"key":"flags.midi-qol.searingSmite.level","mode":5,"value":"@item.level","priority":20}],"disabled":false,"duration":{"startTime":null,"seconds":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"icon":"modules/GMmacros/img/phb-searing-smite.webp","label":"Searing Smite","origin":"Compendium.midi-qol.midiqol-sample-items.dlP9fWGo3ggfkOfm","transfer":false,"flags":{"dae":{"stackable":"none","macroRepeat":"none","specialDuration":["1Hit:mwak","1Hit:rwak"],"transfer":false,"durationExpression":""},"ActiveAuras":{"isAura":false,"radius":null,"aura":"None","alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"hostile":false,"onlyOnce":false,"displayTemp":false},"core":{"statusId":""},"dnd5e-helpers":{"rest-effect":"Ignore"}},"tint":null}],"folder":null,"sort":0,"flags":{"midi-qol":{"onUseMacroName":"","effectActivation":false},"core":{"sourceId":"Item.Z2bmzJrSSmIZdOFp"},"itemacro":{"macro":{"data":{"_id":null,"name":"Searing Smite","type":"script","author":"WpiVAovmlZrRTFMX","img":"icons/svg/dice-target.svg","scope":"global","command":"if (![\"mwak\"].includes(args[0].itemData.data.actionType)) return {}; // melee weapon attack\nconst uuid = game.user.targets.first().actor.uuid;\nconst targets = Array.from(game.user.targets);\nconst spldc = actor.data.data.attributes.spelldc\nconst wait = async (ms) => new Promise((resolve)=> setTimeout(resolve, ms));\n\nlet bsEffect = new ActiveEffect({label: \"Searing Smite\", icon: \"modules/GMmacros/img/phb-searing-smite.webp\", changes: [{value: `turn=start,damageRoll=1d6,type=fire,saveDC=${spldc},saveAbility=con,label=Searing Smite`, mode: CONST.ACTIVE_EFFECT_MODES.CUSTOM, priority: 20, key:\"flags.midi-qol.OverTime\"}], duration: {seconds: 60}});\n\n\nfor (const target of targets) {\nawait game.MonksTokenBar.requestRoll(targets,{request:'save:con', silent: true});\nawait wait(5000)\n\nconst listMessages = game.messages.contents\nconst lastMessage = listMessages[listMessages.length - 1];\nconst spellDC = actor.data.data.attributes.spelldc\nlet tokenid = 'token'+target.id;\nlet saveRoll = lastMessage.data.flags[\"monks-tokenbar\"][tokenid].total\n\nif (saveRoll < spellDC) {\n    for (let tokenUuid of args[0].hitTargetUuids) {\n        const target = await fromUuid(tokenUuid);\n        const targetActor = target.actor;\n        if (!targetActor) continue;\n        await MidiQOL.socket().executeAsGM(\"createEffects\", {actorUuid: targetActor.uuid, effects: [bsEffect.toObject()]})\n}}\n}\nconst spellLevel = actor.data.flags[\"midi-qol\"].searingSmite.level;\nif (args[0].isCritical) spellLevel = spellLevel * 2;\nreturn{damageRoll: `${spellLevel}d6[fire]`, flavor: \"Searing Smite\"};","folder":null,"sort":0,"permission":{"default":0},"flags":{}}}},"cf":{"id":"temp_bj0kdv44v2","color":"#000000"},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"autoFailFriendly":false,"autoSaveFriendly":false,"offHandWeapon":false,"ignoreTotalCover":false},"scene-packer":{"hash":"b95ef423e807b8edfe83babff5fb9d98177fdd1e","sourceId":"Item.CXkwfSQHWeyIa7aq"},"siftoolkit":{"SIFData":{"ignoreDuration":false,"texture":"","useTexture":false,"alpha":50,"coneOrigin":1,"loopAnimations":true,"playTemplateAudio":false,"playDamageAudio":false,"playSaveAudio":false,"clip":"","volume":100}},"autoanimations":{"killAnim":false,"below":false,"override":false,"targetToken":{"enable":false},"sourceToken":{"enable":false},"allSounds":{"explosion":{"audioExplodeEnabled":false,"file":"","delay":100,"volume":0.25},"item":{"enableAudio":false,"file":"","delay":100,"volume":0.25}},"autoOverride":{"enable":false},"version":4,"audio":{"a01":{"enable":false,"file":"","delay":100,"volume":0.25},"e01":{"enable":false,"file":"","delay":100,"volume":0.25}}},"rest-recovery":{"data":{"recovery":{"enabled":false}}}},"system":{"description":{"value":"<div class=\"rd__b  rd__b--3\">\n<p>The next time you hit a creature with a melee weapon attack during the spell's duration, your weapon flares with white-hot intensity, and the attack deals an extra [[/r 1d6]] fire damage to the target and causes the target to ignite in flames. At the start of each of its turns until the spell ends, the target must make a Constitution saving throw. On a failed save, it takes [[/r 1d6]] fire damage. On a successful save, the spell ends. If the target or a creature within 5 feet of it uses an action to put out the flames, or if some other effect douses the flames (such as the target being submerged in water), the spell ends.</p>\n<div class=\"rd__spc-inline-post\"></div>\n</div>\n<div class=\"rd__b  rd__b--3\">\n<div class=\"rd__b  rd__b--3\"><span class=\"rd__h rd__h--3\" data-title-index=\"1\">At Higher Levels.</span>\n<p>When you cast this spell using a spell slot of 2nd level or higher, the initial extra damage dealt by the attack increases by [[/r 1d6]] for each slot level above 1st.</p>\n<div class=\"rd__spc-inline-post\"></div>\n</div>\n<div class=\"rd__spc-inline-post\"></div>\n</div>","chat":"","unidentified":""},"source":"PHB pg. 219","activation":{"type":"bonus","cost":1,"condition":""},"duration":{"value":1,"units":"minute"},"cover":null,"target":{"value":null,"width":null,"units":"","type":"self"},"range":{"value":null,"long":null,"units":"self"},"uses":{"value":0,"max":"0","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"other","attackBonus":0,"chatFlavor":"","critical":null,"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell","value":""},"level":1,"school":"evo","components":{"vocal":true,"somatic":false,"material":false,"ritual":false,"concentration":true,"value":""},"materials":{"value":"","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"level","formula":"1d6"},"attributes":{"spelldc":10},"attunement":null},"ownership":{"default":0,"WpiVAovmlZrRTFMX":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":null,"modifiedTime":1684984683859,"lastModifiedBy":"Be8r6Sgxcs3sL08I"}}
{"name":"Color Spray","type":"spell","img":"icons/magic/unholy/strike-beam-blood-large-red-blue.webp","effects":[],"flags":{"srd5e":{"page":"spells.html","source":"PHB","hash":"sleep_phb"},"core":{"sourceId":"Compendium.plutonium.spells.AlbiBe8uZFPEeakZ"},"midi-qol":{"onUseMacroName":"[postActiveEffects]ItemMacro","effectActivation":false,"forceCEOff":true,"forceCEOn":false},"itemacro":{"macro":{"data":{"_id":null,"name":"Sleep","type":"script","author":"RtW728LVc3YeOwN6","img":"icons/svg/dice-target.svg","scope":"global","command":"// HP Pool Effect\n// Works with items like the sleep spell that apply an effect to targets whose total hp don't exceed a rolled value, in ascending order\n// Requires MidiQOL and DFred's Convenient Effects to work\n// The item should reference this as an On Use macro\n// The item also needs to have a damage formula whose type is set to \"No Damage\"\n// \"Don't Apply Convenient Effect\" should be checked on the item\n// The DFred's Convenient Effects module should have an effect that matches the item's name\n\nconst workflow = args[0];\n\nif(!workflow?.damageTotal || !workflow?.failedSaves || !workflow?.item) {\n    ui.notifications.warn(\"No valid workflow found.\")\n    return;\n}\n\nlet hpPool = workflow.damageTotal;\nconst effectTargets = [];\n\nworkflow.failedSaves\n    .sort((target1, target2) => target1.actor.data.data.attributes.hp.value - target2.actor.data.data.attributes.hp.value)\n    .some(target => {\n        const targetHp = target.actor.data.data.attributes.hp.value;\n        if(hpPool >= targetHp) {\n            hpPool -= targetHp;\n            effectTargets.push(target);\n            return false;\n        } \n        else return true;\n    });\n    \neffectTargets.forEach(target => {\n    // Probably could be rewritten to apply effects from the item itself or some other source\n    const effectName = workflow.item.name;\n    const uuid = target.actor.uuid;\n    game.dfreds.effectInterface.addEffect({ effectName: effectName, uuid })\n});","folder":null,"sort":0,"permission":{"default":0},"flags":{}}}},"siftoolkit":{"SIFData":{"ignoreDuration":false,"texture":"","useTexture":false,"alpha":50,"coneOrigin":1,"loopAnimations":true,"playTemplateAudio":false,"playDamageAudio":false,"playSaveAudio":false,"clip":"","volume":100}},"scene-packer":{"hash":"ec20c258192b364edf6e616ed5f7c3dd29d01c8f","sourceId":"Item.VfKTcRYSSuDj9Dhm"},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false,"autoFailFriendly":false,"autoSaveFriendly":false,"offHandWeapon":false},"rest-recovery":{"data":{"recovery":{"enabled":false}}},"cf":{"id":"temp_6q1ztzxb2o4"}},"system":{"description":{"value":"<div class=\"rd__b  rd__b--3\"><p>A dazzling array of flashing, colored light springs from your hand. Roll [[/r 6d10]]; the total is how many hit points of creatures this spell can effect. Creatures in a 15-foot cone originating from you are affected in ascending order of their current hit points (ignoring @condition[unconscious] creatures and creatures that can't see).</p><div class=\"rd__spc-inline-post\"><p></p></div><p>Starting with the creature that has the lowest current hit points, each creature affected by this spell is @condition[blinded] until the end of your next turn. Subtract each creature's hit points from the total before moving on to the creature with the next lowest hit points. A creature's hit points must be equal to or less than the remaining total for that creature to be affected.</p></div><div class=\"rd__b  rd__b--3\"><div class=\"rd__b  rd__b--3\"><p><span class=\"entry-title-inner\">At Higher Levels. </span>When you cast this spell using a spell slot of 2nd level or higher, roll an additional [[/r 2d10]] for each slot level above 1st.</p><div class=\"rd__spc-inline-post\"><p></p></div></div><div class=\"rd__spc-inline-post\"><p></p></div></div>","chat":"","unidentified":""},"source":"PHB","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":"","units":"inst"},"cover":null,"target":{"value":15,"width":null,"units":"ft","type":"cone"},"range":{"value":90,"long":null,"units":"ft"},"uses":{"value":0,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"util","attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[["6d10","midi-none"]],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"level":1,"school":"enc","components":{"vocal":true,"somatic":true,"material":true,"ritual":false,"concentration":false},"materials":{"value":"a pinch of fine sand, rose petals, or a cricket","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"always","prepared":true},"scaling":{"mode":"level","formula":"2d10"}},"ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1685640188475,"modifiedTime":1685669283279,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"_id":"ZnaBC1NwjMv63zZ5"}
{"name":"Grease","type":"spell","img":"icons/magic/air/fog-gas-smoke-orange.webp","effects":[],"flags":{"midi-qol":{"onUseMacroName":"[preActiveEffects]ItemMacro","effectActivation":false},"itemacro":{"macro":{"data":{"_id":null,"name":"Grease","type":"script","author":"jkdToQqzFl0mFXls","img":"icons/svg/dice-target.svg","scope":"global","command":"if (!game.modules.get(\"advanced-macros\")?.active) { ui.notifications.error(\"Advanced Macros is not enabled\"); return }\nif(args[0].tag === \"OnUse\"){\nAAhelpers.applyTemplate(args)\n\n}","folder":null,"sort":0,"permission":{"default":0},"flags":{}}}},"core":{"sourceId":"Item.c75EoQVhgTvlVbq1"},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"autoFailFriendly":false,"autoSaveFriendly":false,"offHandWeapon":false,"ignoreTotalCover":false},"templatemacro":{"whenCreated":{"asGM":false,"command":"console.log(template);\nconsole.log(this);"},"whenEntered":{"asGM":false,"command":"await chrisPremades.macros.grease.greaseInZone(token, template);"},"whenLeft":{"asGM":false,"command":"await chrisPremades.macros.grease.greaseOutZone(token, template);"},"whenTurnEnd":{"asGM":false,"command":"await chrisPremades.macros.grease.greaseInZone(token, template);"}},"rest-recovery":{"data":{"recovery":{"enabled":false}}},"cf":{"id":"temp_5lmql55efox"}},"system":{"description":{"value":"<p>Slick grease covers the ground in a 10-foot square centered on a point within range and turns it into difficult terrain for the duration.</p><p>When the grease appears, each creature standing in its area must succeed on a Dexterity saving throw or fall prone. A creature that enters the area or ends its turn there must also succeed on aDexterity saving throw or fall prone.</p>","chat":"","unidentified":""},"source":"PHB pg. 246","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":"1","units":"minute"},"cover":null,"target":{"value":10,"width":null,"units":"ft","type":"square"},"range":{"value":60,"long":0,"units":"ft"},"uses":{"value":0,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"save","attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"dex","dc":20,"scaling":"spell"},"level":1,"school":"con","components":{"vocal":true,"somatic":true,"material":true,"ritual":false,"concentration":false},"materials":{"value":"A bit of pork rind or butter","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"none","formula":""}},"ownership":{"default":0,"E4BVikjIkVl2lL2j":3,"Be8r6Sgxcs3sL08I":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1662274929957,"modifiedTime":1685653030245,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"_id":"a6sXcIqCBa4AA9oE"}
{"_id":"aB23YkFsI94D2cGu","name":"Absorb Elements","type":"spell","img":"icons/magic/defensive/shield-barrier-flaming-diamond-red.webp","effects":[{"_id":"iJ9E4fnIwXjfi1TP","flags":{"dae":{"stackable":"none","macroRepeat":"none","transfer":false,"specialDuration":["DamageDealt"]},"ActiveAuras":{"isAura":false,"ignoreSelf":false,"hidden":false,"height":false,"alignment":"","type":"","aura":"None","radius":null,"save":"","savedc":null,"hostile":false,"onlyOnce":false,"time":"None"},"core":{"statusId":""},"dnd5e-helpers":{"rest-effect":"Ignore"}},"changes":[{"key":"system.bonuses.msak.damage","mode":2,"value":"0","priority":20},{"key":"system.bonuses.mwak.damage","mode":2,"value":"0","priority":20}],"disabled":false,"duration":{"startTime":null,"rounds":2,"startTurn":1,"seconds":null,"combat":null,"turns":null,"startRound":null},"icon":"icons/magic/defensive/shield-barrier-flaming-diamond-red.webp","label":"Absorb Elements","tint":null,"transfer":false,"origin":null},{"_id":"8r9eWcqP6QyIbPWU","changes":[{"key":"system.traits.dr.value","mode":2,"value":"fire","priority":20}],"disabled":false,"duration":{"rounds":2,"startTime":null,"seconds":null,"combat":null,"turns":null,"startRound":null,"startTurn":null},"icon":"icons/magic/defensive/shield-barrier-flaming-diamond-red.webp","label":"Absorb Elements Resistance","origin":"Item.csBPw2sdmOigPnOV","transfer":false,"flags":{"dae":{"stackable":"none","macroRepeat":"none","specialDuration":["turnEnd"],"transfer":false},"dnd5e-helpers":{"rest-effect":"Ignore"},"ActiveAuras":{"isAura":false,"aura":"None","radius":null,"alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"hostile":false,"onlyOnce":false},"core":{"statusId":""}},"tint":null}],"folder":null,"sort":0,"flags":{"dynamiceffects":{"equipActive":[true,true,true],"alwaysActive":[true,true,true]},"mess":{"templateTexture":""},"dae":{"activeEquipped":false,"alwaysActive":false},"exportSource":{"world":"waterdeep-dungeon-of-the-mad-mage","system":"dnd5e","coreVersion":"0.7.9","systemVersion":"1.2.4"},"betterRolls5e":{"quickDesc":{"type":"Boolean","value":true,"altValue":true},"quickAttack":{"type":"Boolean","value":true,"altValue":true},"quickSave":{"type":"Boolean","value":true,"altValue":true},"quickDamage":{"type":"Array","value":[],"altValue":[],"context":[]},"quickVersatile":{"type":"Boolean","value":false,"altValue":false},"quickProperties":{"type":"Boolean","value":true,"altValue":true},"quickCharges":{"type":"Boolean","value":{"use":false,"resource":true},"altValue":{"use":false,"resource":true}},"quickTemplate":{"type":"Boolean","value":true,"altValue":true},"quickOther":{"type":"Boolean","value":true,"altValue":true,"context":""},"quickFlavor":{"type":"Boolean","value":true,"altValue":true},"quickPrompt":{"type":"Boolean","value":false,"altValue":false}},"itemacro":{"macro":{"data":{"_id":null,"name":"Absorb Elements","type":"script","author":"devnIbfBHb74U9Zv","img":"icons/svg/dice-target.svg","scope":"global","command":"let tactor;\nlet itemname = \"Absorb Elements\";\nif (args[0].tokenUuid) tactor = (await fromUuid(args[0].tokenUuid)).actor;\nelse tactor = game.actors.get(args[0].actorId);\n\nlet dialog = new Promise((resolve, reject) => {\n    new Dialog({\n        title: 'Choose a damage type',\n        content: `\n          <form class=\"flexcol\">\n            <div class=\"form-group\">\n              <select id=\"element\">\n                <option value=\"acid\">Acid</option>\n                <option value=\"cold\">Cold</option>\n                <option value=\"fire\">Fire</option>\n                <option value=\"lightning\">Lightning</option>\n                <option value=\"thunder\">Thunder</option>\n              </select>\n            </div>\n          </form>\n        `,\n        //select element type\n        buttons: {\n            yes: {\n                icon: '<i class=\"fas fa-bolt\"></i>',\n                label: 'Select',\n                callback: async (html) => {\n                    let element = html.find('#element').val();\n                    let effect =  tactor.effects.find(i => i.data.label === itemname);\n                    let changes = duplicate(effect.data.changes);\n                    changes[0].value = `${args[0].spellLevel}d6[${element}]`;\n                    changes[1].value = `${args[0].spellLevel}d6[${element}]`;\n                    await effect.update({changes});\n                    effect =  tactor.effects.find(i => i.data.label === `${itemname} Resistance`);\n                    changes = duplicate(effect.data.changes);\n                    changes[0].value = element;\n                    await effect.update({changes});\n                    resolve();\n                },\n            },\n        }\n    }).render(true);\n})\nawait dialog;","folder":null,"sort":0,"permission":{"default":0},"flags":{}}}},"midi-qol":{"onUseMacroName":"[postActiveEffects]ItemMacro","effectActivation":false},"core":{"sourceId":"Item.jwe2NqmH3YX6SMVx"},"autoanimations":{"killAnim":false,"below":false,"override":false,"targetToken":{"enable":false},"sourceToken":{"enable":false},"allSounds":{},"autoOverride":{"enable":false},"version":1},"favtab":{"isFavorite":false},"cf":{"id":"temp_lpjg4hxkuum","color":"#000000"},"siftoolkit":{"SIFData":{"ignoreDuration":false,"texture":"","useTexture":false,"alpha":50,"coneOrigin":1,"loopAnimations":true,"playTemplateAudio":false,"playDamageAudio":false,"playSaveAudio":false,"clip":"","volume":100}},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false,"autoFailFriendly":false,"offHandWeapon":false,"autoSaveFriendly":false},"rest-recovery":{"data":{"recovery":{"enabled":false}}}},"system":{"description":{"value":"<div class=\"rd__b  rd__b--3\"><p>The spell captures some of the incoming energy, lessening its effect on you and storing it for your next melee attack. You have resistance to the triggering damage type until the start of your next turn. Also, the first time you hit with a melee attack on your next turn, the target takes an extra [[/r 1d6]] damage of the triggering type, and the spell ends.</p><div class=\"rd__spc-inline-post\"></div></div><div class=\"rd__b  rd__b--3\"><div class=\"rd__b  rd__b--3\"><span class=\"rd__h rd__h--3\" data-title-index=\"37\"> <span class=\"entry-title-inner\">At Higher Levels.</span></span> <p>When you cast this spell using a spell slot of 2nd level or higher, the extra damage increases by [[/r 1d6]] for each slot level above 1st.</p><div class=\"rd__spc-inline-post\"></div></div><div class=\"rd__spc-inline-post\"></div></div>","chat":"","unidentified":""},"source":"XGE","activation":{"type":"reaction","cost":1,"condition":"which you take when you take acid, cold, fire, lightning, or thunder damage"},"duration":{"value":1,"units":"round"},"cover":null,"target":{"value":null,"width":null,"units":"","type":"self"},"range":{"value":null,"long":null,"units":"self"},"uses":{"value":0,"max":"0","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"util","attackBonus":0,"chatFlavor":"","critical":{"threshold":null,"damage":null},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"level":1,"school":"abj","components":{"vocal":false,"somatic":true,"material":false,"ritual":false,"concentration":false,"value":""},"materials":{"value":"","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"level","formula":"1d6"},"armor":{"value":10},"hp":{"value":0,"max":0,"dt":null,"conditions":""},"properties":{}},"ownership":{"default":0,"QwT9izJ4aW8QVTjo":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":null,"modifiedTime":1685892945655,"lastModifiedBy":"Be8r6Sgxcs3sL08I"}}
{"name":"Holy Weapon","type":"spell","system":{"description":{"value":"<div class=\"rd__b  rd__b--3\"><p>You imbue a weapon you touch with holy power. Until the spell ends, the weapon emits bright light in a 30-foot radius and dim light for an additional 30 feet. In addition, weapon attacks made with it deal an extra [[/r 2d8]] radiant damage on a hit. If the weapon isn't already a magic weapon, it becomes one for the duration.</p><div class=\"rd__spc-inline-post\"></div><p>As a bonus action on your turn, you can dismiss this spell and cause the weapon to emit a burst of radiance. Each creature of your choice that you can see within 30 feet of the weapon must make a Constitution saving throw. On a failed save, a creature takes [[/r 4d8]] radiant damage, and it is @condition[blinded] for 1 minute. On a successful save, a creature takes half as much damage and isn't @condition[blinded]. At the end of each of its turns, a @condition[blinded] creature can make a Constitution saving throw, ending the effect on itself on a success.</p></div>","chat":"","unidentified":""},"source":"XGE","activation":{"type":"bonus","cost":1,"condition":""},"duration":{"value":1,"units":"hour"},"cover":null,"target":{"value":null,"width":null,"units":"","type":""},"range":{"value":null,"long":null,"units":"touch"},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"","attackBonus":null,"chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"level":5,"school":"evo","components":{"vocal":true,"somatic":true,"material":false,"ritual":false,"concentration":true,"value":""},"materials":{"value":"","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"none","formula":""}},"img":"icons/weapons/swords/sword-gold-holy.webp","flags":{"plutonium":{"page":"spells.html","source":"XGE","hash":"holy%20weapon_xge","propDroppable":"spell"},"rest-recovery":{"data":{"recovery":{"enabled":false}}},"midi-qol":{"effectActivation":false},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false},"itemacro":{"macro":{"name":"Holy Weapon","type":"script","scope":"global","command":"const version = \"10.0.17\";\n\ntry {\n    let targetActor = game.user.targets.values().next().value.actor;\n    const targets = Array.from(game.user.targets);\n    let target = game.user.targets.first().actor.uuid;\n    const lastArg = args[args.length - 1];\n    let weapons = targetActor.items.filter(i => i.type === `weapon`);\n    let weapon_content = ``;\n    for (let weapon of weapons) {\n        weapon_content += `<option value=${weapon.id}>${weapon.name}</option>`;\n    }\n    if (args[0] === \"on\") {\n        let content = `\n    <div class=\"form-group\">\n    <label>Weapons : </label>\n    <select name=\"weapons\">\n        ${weapon_content}\n    </select>\n    </div>`;\n\n        new Dialog({\n            title: \"Choose a weapon\",\n            content,\n            buttons:\n            {\n                Ok:\n                {\n                    label: `Ok`,\n                    callback: (html) => {\n                        let itemId = html.find('[name=weapons]')[0].value;\n                        let weaponItem = targetActor.items.get(itemId);\n                        let copy_item = duplicate(weaponItem.toObject(false));\n                        DAE.setFlag(targetActor, `holy weapon`, {\n                            \"_id\" : itemId,\n                            \"system.damage\" : copy_item.system.damage,\n                            \"system.ability\": copy_item.system.ability,\n                            \"system.properties.mgc\": copy_item.system.properties.mgc,\n                            \"name\": copy_item.name\n                        }).then(() => {\n                            copy_item.system.damage.parts.push([\"2d8\",\"radiant\"]);\n                            copy_item.system.properties.mgc = true;\n                            copy_item.name = `${copy_item.name} (Holy weapon)`;\n                            targetActor.updateEmbeddedDocuments(\"Item\", [copy_item]);\n                            ChatMessage.create({content: copy_item.name + \" is empowered with holy weapon\"});\n                        });\n                    }\n                },\n                Cancel:\n                {\n                    label: `Cancel`\n                }\n            }\n        }).render(true);\n    }\n\n    if (args[0] === \"off\") {\n        const flag = DAE.getFlag(targetActor, `holy weapon`);\n        await targetActor.updateEmbeddedDocuments(\"Item\", [flag]);\n        DAE.unsetFlag(targetActor, `holy weapon`);\n        ChatMessage.create({content: flag.name + \" returns to normal\"});\n    }\n} catch (err)  {\n    console.error(`Shillelagh ${version}`, err);\n} \nconsole.log(copy_item.system.damage.parts)","author":"Be8r6Sgxcs3sL08I","_id":null,"img":"icons/svg/dice-target.svg","folder":null,"sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null}}},"core":{"sourceId":"Actor.YPh5XDISqV1e9Zth.Item.AuGguvaVm4gCkO1X"},"cf":{"id":"temp_6q1ztzxb2o4"}},"effects":[{"label":"Holy Weapon","icon":"icons/weapons/swords/sword-gold-holy.webp","changes":[{"key":"macro.itemMacro","mode":0,"value":"","priority":20}],"transfer":false,"_id":"eAp3LldHPCPoFKeY","disabled":false,"duration":{"startTime":null,"seconds":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"origin":null,"tint":null,"flags":{"dae":{"selfTarget":false,"selfTargetAlways":false,"stackable":"none","durationExpression":"","macroRepeat":"none","specialDuration":[]},"core":{"statusId":""},"ActiveAuras":{"isAura":false,"aura":"None","radius":null,"alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"displayTemp":false,"hostile":false,"onlyOnce":false}}}],"ownership":{"default":0,"l056gHuKc3178tdK":3,"Be8r6Sgxcs3sL08I":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1669682067571,"modifiedTime":1684720846019,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"_id":"bYWTuqPdGe949Lcf"}
{"name":"Giant Slayer Longsword","type":"weapon","img":"icons/weapons/swords/sword-guard-flanged-purple.webp","effects":[],"folder":null,"sort":0,"flags":{"core":{"sourceId":"Compendium.dnd5e.items.SXjs8JghAPBv7d6j"},"midi-qol":{"onUseMacroName":"[postActiveEffects]ItemMacro","criticalThreshold":"20","fumbleThreshold":null,"effectActivation":false},"magicitems":{"enabled":false,"equipped":false,"attuned":false,"charges":"0","chargeType":"c1","destroy":false,"destroyFlavorText":"reaches 0 charges: it crumbles into ashes and is destroyed.","rechargeable":false,"recharge":"0","rechargeType":"t1","rechargeUnit":"r1","sorting":"l"},"itemacro":{"macro":{"data":{"_id":null,"name":"Dragon Slayer Longsword","type":"script","author":"QwT9izJ4aW8QVTjo","img":"icons/svg/dice-target.svg","scope":"global","command":"if (![\"mwak\"].includes(args[0].item.data.actionType)) return {}; // melee weapon attack\nif (args[0].hitTargets.length < 1) return {}; // hit \nif (!args[0].isCritical) return {}; // critical\nactor = await fromUuid(args[0].actorUuid);\nlet target = await fromUuid(args[0].hitTargetUuids[0]);\nconst isGiant = [\"giant\"].some(type => (target?.actor.data.data.details.type?.value || \"\").toLowerCase().includes(type)); // is giant?\nconsole.error(target.actor.data.data.details.type)\nif (!isGiant) return {};\nconst damageRoll = await (new Roll(`1d1*999`)).roll()\nnew MidiQOL.DamageOnlyWorkflow(actor, token, damageRoll.total, null, target ? [target] : [], damageRoll, {flavor: \"Giant Slayer\", itemCardId: args[0].itemCardId})","folder":null,"sort":0,"permission":{"default":0},"flags":{}}}},"rest-recovery":{"data":{"recovery":{"enabled":false}}},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false,"autoFailFriendly":false,"autoSaveFriendly":false,"offHandWeapon":false},"cf":{"id":"temp_bnv1ahmj4k"}},"_id":"cIqscUcDPcGHpahb","system":{"description":{"value":"<p><em>(Requires attunement)</em></p>\n<p>You gain a +1 bonus to attack and damage rolls made with this magic weapon.</p>\n<p>When you hit a dragon with this weapon, the dragon takes an extra 3d6 damage of the weapon's type. For the purpose of this weapon, \"dragon\" refers to any creature with the dragon type, including dragon turtles and wyverns.</p>","chat":"","unidentified":""},"source":"DMG pg. 166","quantity":1,"weight":3,"price":8000,"attunement":2,"equipped":true,"rarity":"","identified":true,"activation":{"type":"action","cost":1,"condition":""},"duration":{"value":0,"units":""},"cover":null,"target":{"value":null,"width":null,"units":"","type":""},"range":{"value":5,"long":0,"units":"ft"},"uses":{"value":0,"max":"0","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"mwak","attackBonus":"1","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[["1d8 + @mod +1","slashing"]],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"armor":{"value":10},"hp":{"value":0,"max":0,"dt":null,"conditions":""},"weaponType":"martialM","baseItem":"","properties":{"amm":false,"hvy":false,"fin":false,"fir":false,"foc":false,"lgt":false,"lod":false,"rch":false,"rel":false,"ret":false,"spc":false,"thr":false,"two":false,"ver":true,"ada":false,"mgc":true,"sil":false,"nodam":false,"fulldam":false,"halfdam":false},"proficient":true,"attributes":{"spelldc":10}},"ownership":{"default":0,"QwT9izJ4aW8QVTjo":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":null,"modifiedTime":1686237908941,"lastModifiedBy":"Be8r6Sgxcs3sL08I"}}
{"_id":"e8HUctJp1VHZN4CV","name":"Potion of Fire Breath","type":"consumable","img":"icons/consumables/potions/bottle-bulb-corked-glowing-red.webp","data":{"description":{"value":"<p><em>After drinking this potion, you can use a bonus action to exhale a cone of fire of 15 feet from you (3 charges). The target must make a DC 14 Dexterity saving throw, taking 4d6 fire damage on a failed save, or half as much damage on a successful one. The effect ends after you exhale the fire three times or when 1 hour has passed.</em></p>\n<p><em>This potion's orange liquid flickers, and smoke fills the top of the container and wafts out whenever it is opened.</em></p>","chat":"","unidentified":""},"source":"DMG pg. 188","quantity":1,"weight":0.1,"price":300,"attunement":0,"equipped":false,"rarity":"uncommon","identified":true,"activation":{"type":"action","cost":1,"condition":""},"duration":{"value":1,"units":"hour"},"target":{"value":1,"width":null,"units":"","type":"creature"},"range":{"value":null,"long":null,"units":"touch"},"uses":{"value":1,"max":"1","per":"charges","autoDestroy":true,"autoUse":true},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"util","attackBonus":0,"chatFlavor":"","critical":{"threshold":null,"damage":null},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"consumableType":"potion","attributes":{"spelldc":10}},"effects":[],"folder":null,"sort":0,"permission":{"default":0,"1uVBPOTvhVPb6a7S":3},"flags":{"dynamiceffects":{"equipActive":true,"alwaysActive":false,"effects":[{"modSpecKey":"data.traits.dr.value","value":"fire","mode":"+","targetSpecific":false,"id":1,"itemId":"AENCWgyRd4Kp5gxG","active":true,"_targets":[]}]},"core":{"sourceId":"Compendium.Midi-SRD.MIDI SRD Items.KJKIdlYFwfpjWZPs"},"scene-packer":{"hash":"8fda54229ce8b873fc16ea8dd69e799b8a6c3b24","sourceId":"Item.kh594jBYxzZiBiNf"},"siftoolkit":{"SIFData":{"ignoreDuration":false,"texture":"","useTexture":false,"alpha":50,"coneOrigin":1,"loopAnimations":true,"playTemplateAudio":false,"playDamageAudio":false,"playSaveAudio":false,"clip":"","volume":100}},"rest-recovery":{"data":{"recovery":{"enabled":false}}},"midi-qol":{"effectActivation":false},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false},"magicitems":{"enabled":false,"equipped":false,"attuned":false,"charges":"0","chargeType":"c1","destroy":false,"destroyFlavorText":"reaches 0 charges: it crumbles into ashes and is destroyed.","rechargeable":false,"recharge":"0","rechargeType":"t1","rechargeUnit":"r1","sorting":"l"},"itemacro":{"macro":{"data":{"_id":null,"name":"Potion of Fire Breath","type":"script","author":"1uVBPOTvhVPb6a7S","img":"icons/svg/dice-target.svg","scope":"global","command":"const weaponData = {\n      name: \"Fire Breath\",\n      type: \"weapon\",\n      img: \"icons/creatures/abilities/dragon-fire-breath-orange.webp\",\n      data: {\n        equipped: true,\n        activation: { type: \"bonus\", cost: 1, condition: \"\",},\n        target: { value: 15, type: \"cone\", units: \"ft\", },\n        actionType: \"save\",\n\tuses: { value: 3, max: 3 },\n\tsave: { ability: \"dex\", dc: 14, scaling: \"flat\"},\n        damage: { parts: [[`4d6`, \"fire\"]], versatile: \"\" },\n\t}\n}\nawait actor.createEmbeddedDocuments(\"Item\", [weaponData]);","folder":null,"sort":0,"permission":{"default":0},"flags":{}}}},"cf":{"id":"temp_bnv1ahmj4k"}}}
{"_id":"eUs1fgUWJjnGBORK","name":"Crown of Madness","type":"spell","img":"modules/plutonium/media/icon/spell/phb-crown-of-madness.webp","data":{"description":{"value":"<div class=\"rd__b  rd__b--3\"><p>One humanoid of your choice that you can see within range must succeed on a Wisdom saving throw or become @condition[charmed] by you for the duration. While the target is @condition[charmed] in this way, a twisted crown of jagged iron appears on its head, and a madness glows in its eyes.</p><div class=\"rd__spc-inline-post\"></div><p>The @condition[charmed] target must use its action before moving on each of its turns to make a melee attack against a creature other than itself that you mentally choose. The target can act normally on its turn if you choose no creature or if none are within its reach.</p><p>On your subsequent turns, you must use your action to maintain control over the target, or the spell ends. Also, the target can make a Wisdom saving throw at the end of each of its turns. On a success, the spell ends.</p></div>","chat":"","unidentified":""},"source":"PHB","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":1,"units":"minute"},"target":{"value":0,"width":null,"units":"","type":""},"range":{"value":120,"long":null,"units":"ft"},"uses":{"value":null,"max":"","per":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"save","attackBonus":null,"chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"wis","dc":null,"scaling":"spell"},"level":2,"school":"enc","components":{"value":"","vocal":true,"somatic":true,"material":false,"ritual":false,"concentration":true},"materials":{"value":"","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"none","formula":""}},"effects":[{"_id":"urf91jgrd4qfofo8","changes":[{"key":"flags.midi-qol.OverTime","mode":0,"value":"turn=end,\nsaveAbility=wis,\nsaveDC=@attributes.spelldc","priority":"20"}],"disabled":false,"duration":{"startTime":null},"icon":"modules/dfreds-convenient-effects/images/charmed.svg","label":"Charmed","tint":null,"transfer":false,"flags":{"core":{"statusId":"Convenient Effect: Charmed"},"isConvenient":true,"convenientDescription":"No active effects","dae":{"stackable":"none","durationExpression":"","macroRepeat":"none","specialDuration":[],"transfer":false},"dnd5e-helpers":{"rest-effect":"Ignore"},"ActiveAuras":{"isAura":false,"aura":"None","radius":null,"alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"displayTemp":false,"hostile":false,"onlyOnce":false}},"selectedKey":"flags.midi-qol.OverTime"}],"folder":null,"sort":0,"permission":{"default":0,"QwT9izJ4aW8QVTjo":3},"flags":{"srd5e":{"page":"spells.html","source":"PHB","hash":"crown%20of%20madness_phb","propDroppable":"spell"},"scene-packer":{"hash":"3ce9004b8b6fda8be4cf426cdb6cb1ea0a86196d","sourceId":"Item.TJ2iW1iitdpJRWw4"},"siftoolkit":{"SIFData":{"ignoreDuration":false,"texture":"","useTexture":false,"alpha":50,"coneOrigin":1,"loopAnimations":true,"playTemplateAudio":false,"playDamageAudio":false,"playSaveAudio":false,"clip":"","volume":100}},"midi-qol":{"effectActivation":false,"forceCEOff":false},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false},"core":{"sourceId":"Item.TJ2iW1iitdpJRWw4"},"cf":{"id":"temp_lpjg4hxkuum"}}}
{"name":"Mind Sliver","type":"spell","img":"modules/GMmacros/img/mind_sliver.png","effects":[{"label":"Mind Sliver","icon":"modules/GMmacros/img/mind_sliver.png","changes":[{"key":"system.bonuses.abilities.save","mode":2,"value":"-1d4","priority":20}],"transfer":false,"_id":"ObNfO5gTcaAkTd0D","disabled":false,"duration":{"startTime":null,"seconds":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"origin":null,"tint":null,"flags":{"dfreds-convenient-effects":{"description":""},"dae":{"selfTarget":false,"selfTargetAlways":false,"stackable":"noneName","durationExpression":"","macroRepeat":"none","specialDuration":["turnEndSource","isSave"]},"core":{"statusId":""},"ActiveAuras":{"isAura":false,"aura":"None","radius":"","alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"displayTemp":false,"hostile":false,"onlyOnce":false}}}],"flags":{"srd5e":{"page":"spells.html","source":"TCE","hash":"mind%20sliver_tce"},"core":{"sourceId":"Compendium.plutonium.spells.UcSRbOtAiMYTScHV"},"midi-qol":{"onUseMacroName":"","effectActivation":false,"forceCEOff":false},"siftoolkit":{"SIFData":{"ignoreDuration":false,"texture":"","useTexture":false,"alpha":50,"coneOrigin":1,"loopAnimations":true,"playTemplateAudio":false,"playDamageAudio":false,"playSaveAudio":false,"clip":"","volume":100}},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false,"autoFailFriendly":false,"autoSaveFriendly":false,"offHandWeapon":false},"cf":{"id":"temp_lpjg4hxkuum"},"rest-recovery":{"data":{"recovery":{"enabled":false}}}},"system":{"description":{"value":"<div class=\"rd__b  rd__b--3\"><p>You drive a disorienting spike of psychic energy into the mind of one creature you can see within range. The target must succeed on an Intelligence saving throw or take [[/r 1d6]] psychic damage and subtract [[/r 1d4]] from the next saving throw it makes before the end of your next turn.</p><div class=\"rd__spc-inline-post\"></div><p>This spell's damage increases by [[/r 1d6]] when you reach certain levels: 5th level ([[/r 2d6]]), 11th level ([[/r 3d6]]), and 17th level ([[/r 4d6]]).</p></div>","chat":"","unidentified":""},"source":"TCE","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":"1","units":"round"},"cover":null,"target":{"value":1,"width":null,"units":"","type":"creature"},"range":{"value":60,"long":null,"units":"ft"},"uses":{"value":0,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"save","attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[["1d6","psychic"]],"versatile":""},"formula":"","save":{"ability":"int","dc":null,"scaling":"spell"},"level":0,"school":"enc","components":{"vocal":true,"somatic":false,"material":false,"ritual":false,"concentration":false},"materials":{"value":"","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"always","prepared":true},"scaling":{"mode":"cantrip","formula":"1d6"}},"ownership":{"default":0,"QwT9izJ4aW8QVTjo":3,"Be8r6Sgxcs3sL08I":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1684986243177,"modifiedTime":1684986555010,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"_id":"fPyvY0acMFVbJ7Zn"}
{"name":"Investiture of Wind","type":"spell","system":{"description":{"value":"<div class=\"rd__b  rd__b--3\"><p>Until the spell ends, wind whirls around you, and you gain the following benefits:</p><div class=\"rd__spc-inline-post\"><p></p></div><ul class=\"rd__list\"><li class=\"rd__li \">Ranged weapon attacks made against you have disadvantage on the attack roll.</li><li class=\"rd__li \">You gain a flying speed of 60 feet. If you are still flying when the spell ends, you fall, unless you can somehow prevent it.</li><li class=\"rd__li \">You can use your action to create a 15-foot cube of swirling wind centered on a point you can see within 60 feet of you. Each creature in that area must make a Constitution saving throw. A creature takes [[/r 2d10]] bludgeoning damage on a failed save, or half as much damage on a successful one. If a Large or smaller creature fails the save, that creature is also pushed up to 10 feet away from the center of the cube.</li></ul></div>","chat":"","unidentified":""},"source":"XGE","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":"10","units":"minute"},"cover":null,"target":{"value":null,"width":null,"units":"","type":"self"},"range":{"value":null,"long":null,"units":"self"},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"other","attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"level":6,"school":"trs","components":{"vocal":true,"somatic":true,"material":false,"ritual":false,"concentration":true},"materials":{"value":"","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"none","formula":""}},"img":"icons/skills/trades/music-singing-voice-blue.webp","ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"flags":{"plutonium":{"page":"spells.html","source":"XGE","hash":"investiture%20of%20wind_xge","propDroppable":"spell"},"rest-recovery":{"data":{"recovery":{"enabled":true,"custom_formula":""}}},"midi-qol":{"effectActivation":false},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"autoFailFriendly":false,"autoSaveFriendly":false,"rollOther":false,"critOther":false,"offHandWeapon":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false},"core":{"sourceId":"Actor.uEwtmlc84Te8YgjK.Item.LLNbphbSGQ7AyLZH"},"itemacro":{"macro":{"name":"Investiture of Wind","type":"script","scope":"global","command":"const lastArg = args[args.length - 1];\nconst thisToken = canvas.tokens.get(lastArg.tokenId);\n\nif (args[0] === \"on\") {\n  // If the dynamic active effect started\n    const updates = {\n        embedded: {\n            Item: {\n                \"Swirling Wind\": { //String\n                    type: \"spell\", // feat, spell\n                    img: \"icons/magic/air/wind-weather-snow-gusts.webp\", //Example: \"icons/magic/holy/projectiles-blades-salvo-yellow.webp\"\n                    type: \"spell\",\n                    system: {\n                        description: {\n                            value: \"<p>You can use your action to create a 15-foot cube of swirling wind centered on a point you can see within 60 feet of you. Each creature in that area must make a Constitution saving throw. A creature takes [[/r 2d10]] bludgeoning damage on a failed save, or half as much damage on a successful one. If a Large or smaller creature fails the save, that creature is also pushed up to 10 feet away from the center of the cube.</p>\", //String\n                        },\n                        activation: {\n                            type: \"action\", // action, bonus, crew, day, hour, lair, legendary, minute, none, reaction, special, reactiondamage, reactionmanual\n                            cost: 1, // Numeric\n                            condition: \"\" // String\n                        },\n                        target: {\n                        value: 15,\n                        width: null,\n                        units: \"ft\",\n                        type: \"cube\",\n                        },\n                        actionType: \"other\", // mwak, rwak, msak, rsak, save, heal, abil, util, other\n                        damage: {\n                            parts: [\n                                [ \"2d10\", \"bludgeoning\" ] // [\"Formula\", \"acid, bludgeoning, cold, fire, force, lightning, necrotic, piercing, poison, psychic, radiant, slashing, thunder, healing, temphp\"]\n                            ]\n                        },\n                        level: 6, // Numeric 1-9\n                        school: \"trans\", // abj, con, div, enc, evo, ill, nec, trs\n                        preparation: {\n                            mode: \"atwill\", // prepared, pact, always, atwill, innate\n                            prepared: true // true, false\n                        },\n                        save: {\n                        ability: \"con\",\n                        dc: null,\n                        scaling: \"spell\",\n                        },\n                        },\n\n                }\n            }\n        }\n    }\n  //update the token and create the necessary attack spell\n await warpgate.mutate(thisToken.document, updates);\n ui.notifications.info(`Swirling Wind has been added to spells at will.`);\n}\nif (args[0] === \"off\") {\n  //Concentration broke or time expired, let's revert the token and remove the attack spell item\n await warpgate.revert(thisToken.document);\n}","author":"Be8r6Sgxcs3sL08I","_id":null,"img":"icons/svg/dice-target.svg","folder":null,"sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null}}},"cf":{"id":"temp_6q1ztzxb2o4"}},"effects":[{"label":"Investiture of Wind","icon":"icons/skills/trades/music-singing-voice-blue.webp","changes":[{"key":"system.attributes.movement.fly","mode":4,"value":"60","priority":20},{"key":"macro.itemMacro","mode":0,"value":"@item","priority":20},{"key":"flags.midi-qol.grants.disadvantage.attack.rwak","mode":0,"value":"1","priority":20}],"disabled":false,"duration":{"startTime":null,"seconds":600,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"origin":null,"tint":null,"transfer":false,"flags":{"dfreds-convenient-effects":{"description":""},"dae":{"selfTarget":false,"selfTargetAlways":true,"stackable":"noneName","durationExpression":"","macroRepeat":"none","specialDuration":[]},"core":{"statusId":""},"ActiveAuras":{"isAura":false,"aura":"None","radius":"","alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"displayTemp":false,"hostile":false,"onlyOnce":false},"plutonium":{"dedupeId":"investiture-of-wind"}},"_id":"r5KK8FcMECFprJu1"}],"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1685751194882,"modifiedTime":1685834985752,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"_id":"g5F2Y3J9IVbaID0T"}
{"name":"Fear","type":"spell","img":"icons/magic/control/fear-fright-monster-purple-blue.webp","effects":[{"_id":"8LmJiBql9qC9LlPs","changes":[{"key":"StatusEffect","mode":0,"value":"Convenient Effect: Frightened","priority":20}],"disabled":false,"duration":{"startTime":null,"seconds":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"icon":"icons/magic/control/fear-fright-monster-purple-blue.webp","label":"Fear","transfer":false,"flags":{},"tint":null,"origin":null}],"flags":{"dynamiceffects":{"equipActive":true,"alwaysActive":false,"effects":[{"modSpecKey":"flags.dnd5e.conditions","value":"Frightened","mode":"+","targetSpecific":false,"id":1,"itemId":"QDrZkRDh3yKlVjlf","active":true,"_targets":[]}]},"dae":{"activeEquipped":false,"alwaysActive":false},"core":{"sourceId":"Compendium.Dynamic-Effects-SRD.DAE SRD Spells.HVWI8wdLs54LkhUX"},"midi-qol":{"onUseMacroName":"","effectActivation":false,"forceCEOff":false,"forceCEOn":false},"rest-recovery":{"data":{"recovery":{"enabled":false}}},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"autoFailFriendly":false,"autoSaveFriendly":false,"rollOther":false,"critOther":false,"offHandWeapon":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false},"cf":{"id":"temp_lpjg4hxkuum"}},"system":{"description":{"value":"<p>You project a phantasmal image of a creature's worst fears. Each creature in a 30-foot cone must succeed on a Wisdom saving throw or drop whatever it is holding and become Frightened for the duration.</p>\n<p>While Frightened by this spell, a creature must take the Dash action and move away from you by the safest available route on each of its turns, unless there is nowhere to move. If the creature ends its turn in a location where it doesn't have line of sight to you, the creature can make a Wisdom saving throw. On a successful save, the spell ends for that creature.</p>","chat":"","unidentified":""},"source":"PHB pg. 239","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":"1","units":"minute"},"cover":null,"target":{"value":30,"width":null,"units":"ft","type":"cone"},"range":{"value":null,"long":null,"units":"self"},"uses":{"value":0,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"save","attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"wis","dc":null,"scaling":"spell"},"level":3,"school":"ill","components":{"vocal":true,"somatic":true,"material":true,"ritual":false,"concentration":true},"materials":{"value":"A white feather or the heart of a hen.","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":false},"scaling":{"mode":"none","formula":""}},"ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1663114169164,"modifiedTime":1685727057278,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"_id":"gm64hlsUZjozjRSB"}
{"_id":"hJtxGFRQtTrzrnHd","name":"Chromatic Orb","type":"spell","img":"modules/GMmacros/img/ChromaticOrb.png","effects":[{"_id":"5dvypjBUJh2hekYB","changes":[{"key":"macro.itemMacro","mode":0,"value":"@item.level","priority":20}],"disabled":false,"duration":{"startTime":null,"seconds":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"icon":"modules/plutonium/media/icon/spell/phb-chromatic-orb.webp","label":"Chromatic Orb","transfer":false,"flags":{"dae":{"stackable":"none","macroRepeat":"none","specialDuration":[],"transfer":false},"dnd5e-helpers":{"rest-effect":"Ignore"},"ActiveAuras":{"isAura":false,"aura":"None","radius":null,"alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"hostile":false,"onlyOnce":false}},"tint":null,"origin":null}],"folder":null,"sort":0,"flags":{"srd5e":{"page":"spells.html","source":"PHB","hash":"chromatic%20orb_phb","propDroppable":"spell"},"siftoolkit":{"SIFData":{"ignoreDuration":false,"texture":"","useTexture":false,"alpha":50,"coneOrigin":1,"loopAnimations":true,"playTemplateAudio":false,"playDamageAudio":false,"clip":"","volume":100}},"itemacro":{"macro":{"data":{"_id":null,"name":"Chromatic Orb","type":"script","author":"QwT9izJ4aW8QVTjo","img":"icons/svg/dice-target.svg","scope":"global","command":"async function wait(ms) {\n  return new Promise(resolve => {\n    setTimeout(resolve, ms);\n  });\n}\nconst damage_types = [\"acid\", \"cold\", \"fire\", \"lightning\", \"poison\", \"thunder\"];\n\n(async () => {\n  if (args[0].hitTargets.length === 0) return {};\n  let actorD = game.actors.get(args[0].actor._id);\n  let tokenD = canvas.tokens.get(args[0].tokenId);\n  let damage_type = await choose(damage_types, 'Choose Damage Type : ');\n  let target = canvas.tokens.get(args[0].hitTargets[0].id);\n  let numDice = 2 + args[0].spellLevel\n  if (args[0].isCritical) numDice = numDice * 2;\n  let damageRoll = new Roll(`${numDice}d8`).evaluate({ async: false });\n  new MidiQOL.DamageOnlyWorkflow(actorD, tokenD, damageRoll.total, damage_type, [target], damageRoll, { flavor: `(${CONFIG.DND5E.damageTypes[damage_type]})`, itemCardId: args[0].itemCardId, useOther: false });\n})();\n\nasync function choose(options = [], prompt = ``) {\n  let value = await new Promise((resolve) => {\n\n    let dialog_options = (options[0] instanceof Array)\n      ? options.map(o => `<option value=\"${o[0]}\">${o[1]}</option>`).join(``)\n      : options.map(o => `<option value=\"${o}\">${o}</option>`).join(``);\n\n    let content = `<form><div class=\"form-group\"><label for=\"choice\">${prompt}</label><select id=\"choice\">${dialog_options}</select></div></form>`;\n\n    new Dialog({\n      content,\n      buttons: { OK: { label: `OK`, callback: async (html) => { resolve(html.find('#choice').val()); } } }\n    }).render(true);\n  });\n  return value;\n}","folder":null,"sort":0,"permission":{"default":0},"flags":{}}}},"midi-qol":{"criticalThreshold":"20","onUseMacroName":"[postActiveEffects]ItemMacro","fumbleThreshold":null,"effectActivation":false},"core":{"sourceId":"Item.FSWHquxHRK30GnwD"},"autoanimations":{"killAnim":false,"animLevel":false,"options":{"ammo":false,"loops":1,"loopDelay":250,"enableCustomExplosion":false,"customExplosion":""},"override":true,"allSounds":{"item":{"enableAudio":false},"explosion":{"audioExplodeEnabled":false}},"sourceToken":{"enable":false},"targetToken":{"enable":false},"animType":"t6","animName":"firebolt","color":"purple","explosion":true,"exAnimLevel":false,"explodeVariant":"explosion","explodeColor":"purple","explodeRadius":5,"explodeDelay":0},"cf":{"id":"temp_lpjg4hxkuum"},"rest-recovery":{"data":{"recovery":{"enabled":false}}},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"autoFailFriendly":false,"rollOther":false,"critOther":false,"offHandWeapon":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false}},"system":{"description":{"value":"<div class=\"rd__b  rd__b--3\"><p>You hurl a 4-inch-diameter sphere of energy at a creature that you can see within range. You choose acid, cold, fire, lightning, poison, or thunder for the type of orb you create, and then make a ranged spell attack against the target. If the attack hits, the creature takes [[/r 3d8]] damage of the type you chose.</p><div class=\"rd__spc-inline-post\"></div></div><div class=\"rd__b  rd__b--3\"><div class=\"rd__b  rd__b--3\"><span class=\"rd__h rd__h--3\" data-title-index=\"24\"> <span class=\"entry-title-inner help-subtle\">At Higher Levels.</span></span> <p>When you cast this spell using a spell slot of 2nd level or higher, the damage increases by [[/r 1d8]] for each slot level above 1st.</p><div class=\"rd__spc-inline-post\"></div></div><div class=\"rd__spc-inline-post\"></div></div>","chat":"","unidentified":""},"source":"PHB","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":null,"units":"inst"},"target":{"value":0,"width":null,"units":"","type":""},"range":{"value":90,"long":null,"units":"ft"},"uses":{"value":0,"max":"0","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"rsak","attackBonus":"0","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"level":1,"school":"evo","components":{"value":"","vocal":true,"somatic":true,"material":true,"ritual":false,"concentration":false},"materials":{"value":"a diamond worth at least 50 gp","consumed":false,"cost":50,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"level","formula":"1d8"}},"ownership":{"default":0,"QwT9izJ4aW8QVTjo":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.0.3","coreVersion":"10.291","createdTime":null,"modifiedTime":1671317372383,"lastModifiedBy":"Be8r6Sgxcs3sL08I"}}
{"name":"Sleep","type":"spell","img":"modules/GMmacros/img/phb-sleep.webp","effects":[],"folder":null,"sort":0,"flags":{"srd5e":{"page":"spells.html","source":"PHB","hash":"sleep_phb"},"core":{"sourceId":"Compendium.plutonium.spells.AlbiBe8uZFPEeakZ"},"midi-qol":{"onUseMacroName":"[postActiveEffects]ItemMacro","effectActivation":false,"forceCEOff":true,"forceCEOn":false},"autoanimations":{"killAnim":false,"override":false,"animType":"t1","animName":"","bards":{"bardAnim":"a1","bardTarget":true,"bardTargetAnim":"a1","bardTargetColor":"a1","bardSelf":true,"marker":true,"markerColor":"a1","markerColorTarget":"a1"},"spellVar":"a1","hmAnim":"a1","color":"n1","spellOptions":{"spellLoops":1},"uaStrikeType":"physical","dtvar":"dt1","divineSmite":{"dsEnable":false,"dsSelf":true,"dsSelfDelay":0,"dsSelfColor":"a1","dsTarget":true,"dsTargetDelay":1250,"dsTargetColor":"a1"},"explosion":false,"explodeVariant":"ev1","explodeColor":"","explodeRadius":"0","explodeLoop":"1","allSounds":{"explosion":{"audioExplodeEnabled":false,"file":"","delay":100,"volume":0.25},"item":{"enableAudio":false,"file":"","delay":100,"volume":0.25}},"selfRadius":"5","animTint":"#ffffff","auraOpacity":0.75,"ctaOption":false,"teleDist":30},"itemacro":{"macro":{"data":{"_id":null,"name":"Sleep","type":"script","author":"RtW728LVc3YeOwN6","img":"icons/svg/dice-target.svg","scope":"global","command":"// HP Pool Effect\n// Works with items like the sleep spell that apply an effect to targets whose total hp don't exceed a rolled value, in ascending order\n// Requires MidiQOL and DFred's Convenient Effects to work\n// The item should reference this as an On Use macro\n// The item also needs to have a damage formula whose type is set to \"No Damage\"\n// \"Don't Apply Convenient Effect\" should be checked on the item\n// The DFred's Convenient Effects module should have an effect that matches the item's name\n\nconst workflow = args[0];\n\nif(!workflow?.damageTotal || !workflow?.failedSaves || !workflow?.item) {\n    ui.notifications.warn(\"No valid workflow found.\")\n    return;\n}\n\nlet hpPool = workflow.damageTotal;\nconst effectTargets = [];\n\nworkflow.failedSaves\n    .sort((target1, target2) => target1.actor.data.data.attributes.hp.value - target2.actor.data.data.attributes.hp.value)\n    .some(target => {\n        const targetHp = target.actor.data.data.attributes.hp.value;\n        if(hpPool >= targetHp) {\n            hpPool -= targetHp;\n            effectTargets.push(target);\n            return false;\n        } \n        else return true;\n    });\n    \neffectTargets.forEach(target => {\n    // Probably could be rewritten to apply effects from the item itself or some other source\n    const effectName = workflow.item.name;\n    const uuid = target.actor.uuid;\n    game.dfreds.effectInterface.addEffect({ effectName: effectName, uuid })\n});","folder":null,"sort":0,"permission":{"default":0},"flags":{}}}},"siftoolkit":{"SIFData":{"ignoreDuration":false,"texture":"","useTexture":false,"alpha":50,"coneOrigin":1,"loopAnimations":true,"playTemplateAudio":false,"playDamageAudio":false,"playSaveAudio":false,"clip":"","volume":100}},"scene-packer":{"hash":"ec20c258192b364edf6e616ed5f7c3dd29d01c8f","sourceId":"Item.VfKTcRYSSuDj9Dhm"},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false,"autoFailFriendly":false,"autoSaveFriendly":false,"offHandWeapon":false},"rest-recovery":{"data":{"recovery":{"enabled":false}}},"cf":{"id":"temp_6q1ztzxb2o4"}},"_id":"hhJeL6b81aopAeqs","system":{"description":{"value":"<div class=\"rd__b  rd__b--3\"><p>This spell sends creatures into a magical slumber. Roll [[/r 5d8]]; the total is how many hit points of creatures this spell can affect. Creatures within 20 feet of a point you choose within range are affected in ascending order of their current hit points (ignoring <a href=\"https://5e.tools/conditionsdiseases.html#unconscious_phb\">unconscious</a> creatures).</p><div class=\"rd__spc-inline-post\"></div><p>Starting with the creature that has the lowest current hit points, each creature affected by this spell falls <a href=\"https://5e.tools/conditionsdiseases.html#unconscious_phb\">unconscious</a> until the spell ends, the sleeper takes damage, or someone uses an action to shake or slap the sleeper awake. Subtract each creature's hit points from the total before moving on to the creature with the next lowest hit points. A creature's hit points must be equal to or less than the remaining total for that creature to be affected.</p><p>Undead and creatures immune to being <a href=\"https://5e.tools/conditionsdiseases.html#charmed_phb\">charmed</a> aren't affected by this spell.</p></div><div class=\"rd__b  rd__b--3\"><div class=\"rd__b  rd__b--3\"><span class=\"rd__h rd__h--3\" data-title-index=\"7472\"> <span class=\"entry-title-inner\">At Higher Levels.</span></span> <p>When you cast this spell using a spell slot of 2nd level or higher, roll an additional [[/r 2d8]] for each slot level above 1st.</p><div class=\"rd__spc-inline-post\"></div></div><div class=\"rd__spc-inline-post\"></div></div>","chat":"","unidentified":""},"source":"PHB","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":null,"units":"inst"},"cover":null,"target":{"value":20,"width":null,"units":"ft","type":"sphere"},"range":{"value":90,"long":null,"units":"ft"},"uses":{"value":0,"max":"0","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"util","attackBonus":0,"chatFlavor":"","critical":null,"damage":{"parts":[["5d8","midi-none"]],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"level":1,"school":"enc","components":{"vocal":true,"somatic":true,"material":true,"ritual":false,"concentration":false,"value":""},"materials":{"value":"a pinch of fine sand, rose petals, or a cricket","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"always","prepared":true},"scaling":{"mode":"level","formula":"2d8"}},"ownership":{"default":0,"RtW728LVc3YeOwN6":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":null,"modifiedTime":1686593213817,"lastModifiedBy":"Be8r6Sgxcs3sL08I"}}
{"_id":"kooHw4Bs0e8Wzqu8","name":"#[CF_tempEntity]","type":"weapon","img":"icons/svg/item-bag.svg","effects":[],"folder":null,"sort":0,"flags":{"cf":{"id":"temp_bnv1ahmj4k","folderPath":[],"color":"#cbd723","fontColor":"#FFFFFF","name":"Item","children":[],"icon":"","sorting":"a","contents":["e8HUctJp1VHZN4CV","MtJ2H7j2NA83zJIV","cIqscUcDPcGHpahb","95u0EQIqNCZzYlky","GqezVlVybWXE4ebI"],"version":"2.4.5"}},"system":{"description":{"value":"","chat":"","unidentified":""},"source":"","quantity":1,"weight":0,"price":0,"attunement":0,"equipped":false,"rarity":"","identified":true,"activation":{"type":"","cost":0,"condition":""},"duration":{"value":null,"units":""},"cover":null,"target":{"value":null,"width":null,"units":"","type":""},"range":{"value":null,"long":null,"units":""},"uses":{"value":null,"max":"","per":null,"recovery":""},"consume":{"type":"","target":null,"amount":null},"ability":null,"actionType":null,"attackBonus":0,"chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"armor":{"value":10},"hp":{"value":0,"max":0,"dt":null,"conditions":""},"weaponType":"simpleM","baseItem":"","properties":{},"proficient":true},"ownership":{"default":0,"QwT9izJ4aW8QVTjo":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":null,"modifiedTime":1685996945908,"lastModifiedBy":"Be8r6Sgxcs3sL08I"}}
{"name":"Foresight","type":"spell","system":{"description":{"value":"<div class=\"rd__b  rd__b--3\"><p>You touch a willing creature and bestow a limited ability to see into the immediate future. For the duration, the target can't be surprised and has advantage on attack rolls, ability checks, and saving throws. Additionally, other creatures have disadvantage on attack rolls against the target for the duration.</p><div class=\"rd__spc-inline-post\"></div><p>This spell immediately ends if you cast it again before its duration ends.</p></div>","chat":"","unidentified":""},"source":"PHB","activation":{"type":"minute","cost":1,"condition":""},"duration":{"value":"8","units":"hour"},"cover":null,"target":{"value":null,"width":null,"units":"","type":"creature"},"range":{"value":null,"long":null,"units":"touch"},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"util","attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"level":9,"school":"div","components":{"vocal":true,"somatic":true,"material":true,"ritual":false,"concentration":false},"materials":{"value":"a hummingbird feather","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"none","formula":""}},"img":"icons/magic/symbols/rune-sigil-green-purple.webp","flags":{"plutonium":{"page":"spells.html","source":"PHB","hash":"foresight_phb","propDroppable":"spell"},"rest-recovery":{"data":{"recovery":{"enabled":false}}},"midi-qol":{"effectActivation":false,"forceCEOff":true,"forceCEOn":false},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false,"autoFailFriendly":false,"autoSaveFriendly":false,"offHandWeapon":false},"core":{"sourceId":"Actor.l17Codzmb868P2e7.Item.WNvoSl68p9fZkXdO"},"cf":{"id":"temp_lpjg4hxkuum"}},"effects":[{"label":"Foresight","icon":"icons/magic/symbols/rune-sigil-green-purple.webp","changes":[{"key":"flags.midi-qol.advantage.attack.all","mode":0,"value":"1","priority":20},{"key":"flags.midi-qol.advantage.ability.all","mode":0,"value":"1","priority":20},{"key":"flags.midi-qol.advantage.ability.save.all","mode":0,"value":"1","priority":20},{"key":"flags.midi-qol.grants.disadvantage.attack.all","mode":0,"value":"1","priority":20},{"key":"flags.dnd5e.initiativeAdv","mode":0,"value":"1","priority":20}],"transfer":false,"_id":"TrHZLww455R4SvSE","disabled":false,"duration":{"startTime":null,"seconds":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"origin":null,"tint":null,"flags":{"dfreds-convenient-effects":{"description":""},"dae":{"selfTarget":false,"selfTargetAlways":false,"stackable":"noneName","durationExpression":"","macroRepeat":"none","specialDuration":[]},"core":{"statusId":""},"ActiveAuras":{"isAura":false,"aura":"None","radius":"","alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"displayTemp":false,"hostile":false,"onlyOnce":false}}}],"ownership":{"default":0,"QEGPFkVbwvqQv8sl":3,"Be8r6Sgxcs3sL08I":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1669604448994,"modifiedTime":1686318020739,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"_id":"l9Y4XJYgAgW907UM"}
{"name":"Banishing Smite","type":"spell","img":"modules/plutonium/media/icon/spell/phb-banishing-smite.webp","effects":[{"_id":"KFr4G5i4TJlAOZdz","changes":[{"key":"flags.dnd5e.DamageBonusMacro","mode":0,"value":"ItemMacro.Banishing Smite","priority":20},{"key":"flags.midi-qol.banishingSmite.level","mode":5,"value":"5","priority":20}],"disabled":false,"duration":{"startTime":null,"rounds":10,"seconds":null,"combat":null,"turns":null,"startRound":null,"startTurn":null},"icon":"modules/plutonium/media/icon/spell/phb-banishing-smite.webp","label":"Banishing Smite","transfer":false,"flags":{"dae":{"stackable":"none","macroRepeat":"none","specialDuration":["1Hit:mwak","1Hit:rwak"],"transfer":false,"durationExpression":""},"ActiveAuras":{"isAura":false,"radius":null,"aura":"None","alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"hostile":false,"onlyOnce":false,"displayTemp":false},"core":{"statusId":""},"dnd5e-helpers":{"rest-effect":"Ignore"}},"tint":null,"origin":null}],"folder":null,"sort":0,"flags":{"srd5e":{"page":"spells.html","source":"PHB","hash":"banishing%20smite_phb"},"spellTemplateManager":{"stmData":{"ignoreDuration":false,"spellTexture":"","useTexture":false,"alpha":50,"coneOrigin":1,"loopAnimations":true}},"itemacro":{"macro":{"data":{"_id":null,"name":"Banishing Smite","type":"script","author":"WpiVAovmlZrRTFMX","img":"icons/svg/dice-target.svg","scope":"global","command":"// v1.0. Requires midi-qol and ATL.\nif (![\"mwak\",\"rwak\"].includes(args[0].item.data.actionType)) return {}; \nfor (let tokenUuid of args[0].hitTargetUuids) {\n    const target = await fromUuid(tokenUuid);\n    const targetActor = target.actor;\n    if (!targetActor) continue;\n\n}\nlet spellLevel = 5;\nif (args[0].isCritical) spellLevel = spellLevel * 2;\nreturn{damageRoll: `${spellLevel}d10[force]`, flavor: \"Banishing Smite: se o alvo ficar com 50HP ou menos, ele  banido por 1 min\"}","folder":null,"sort":0,"permission":{"default":0},"flags":{}},"name":"Banishing Smite","type":"script","scope":"global","command":"// v1.0. Requires midi-qol and ATL.\nif (![\"mwak\",\"rwak\"].includes(args[0].item.data.actionType)) return {}; \n if (args[0].hitTargetUuids.length === 0) return {}\nfor (let tokenUuid of args[0].hitTargetUuids) {\n    const target = await fromUuid(tokenUuid);\n    const targetActor = target.actor;\n    if (!targetActor) continue;\n\n}\nlet spellLevel = 5;\nif (args[0].isCritical) spellLevel = spellLevel * 2;\nreturn{damageRoll: `${spellLevel}d10[force]`, flavor: \"Banishing Smite: se o alvo ficar com 50HP ou menos, ele  banido por 1 min\"}","author":"Be8r6Sgxcs3sL08I","_id":null,"img":"icons/svg/dice-target.svg","folder":null,"sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null}}},"midi-qol":{"onUseMacroName":"","effectActivation":false},"core":{"sourceId":"Item.ifF2F2jHDU2MLnte"},"siftoolkit":{"SIFData":{"ignoreDuration":false,"texture":"","useTexture":false,"alpha":50,"coneOrigin":1,"loopAnimations":true,"playTemplateAudio":false,"playDamageAudio":false,"playSaveAudio":false,"clip":"","volume":100}},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"autoFailFriendly":false,"offHandWeapon":false,"ignoreTotalCover":false,"autoSaveFriendly":false},"cf":{"id":"temp_bj0kdv44v2"},"scene-packer":{"hash":"a4dbbcd91964ff0a54db4cd382b1dcd490a34b31","sourceId":"Item.O0DjEGjHV6ge0Ui9"},"rest-recovery":{"data":{"recovery":{"enabled":false}}}},"_id":"lPp5ru8rQbrI48yz","system":{"description":{"value":"<div class=\"rd__b  rd__b--3\"><p>The next time you hit a creature with a weapon attack before this spell ends, your weapon crackles with force, and the attack deals an extra [[/r 5d10]] force damage to the target. Additionally, if this attack reduces the target to 50 hit points or fewer, you banish it. If the target is native to a different plane of existence than the one you're on, the target disappears, returning to its home plane. If the target is native to the plane you're on, the creature vanishes into a harmless demiplane. While there, the target is <a href=\"https://5e.tools/conditionsdiseases.html#incapacitated_phb\" data-plut-hover=\"{&quot;page&quot;:&quot;conditionsdiseases.html&quot;,&quot;source&quot;:&quot;PHB&quot;,&quot;hash&quot;:&quot;incapacitated_phb&quot;}\">incapacitated</a>. It remains there until the spell ends, at which point the target reappears in the space it left or in the nearest unoccupied space if that space is occupied.</p><div class=\"rd__spc-inline-post\"></div></div>","chat":"","unidentified":""},"source":"PHB","activation":{"type":"bonus","cost":1,"condition":""},"duration":{"value":1,"units":"minute"},"cover":null,"target":{"value":null,"width":null,"units":"","type":"self"},"range":{"value":null,"long":null,"units":"self"},"uses":{"value":0,"max":"0","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"util","attackBonus":0,"chatFlavor":"","critical":null,"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"level":5,"school":"abj","components":{"vocal":true,"somatic":false,"material":false,"ritual":false,"concentration":true,"value":""},"materials":{"value":"","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"none","formula":""},"attunement":0},"ownership":{"default":0,"WpiVAovmlZrRTFMX":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":null,"modifiedTime":1686608500632,"lastModifiedBy":"Be8r6Sgxcs3sL08I"}}
{"name":"Phantasmal Killer","type":"spell","img":"icons/magic/control/fear-fright-monster-grin-purple-blue.webp","effects":[{"_id":"ZWOKGvc3niryANBh","changes":[{"key":"flags.midi-qol.OverTime","mode":2,"value":"turn=start, saveAbility=wis, saveDC=@attributes.spelldc, saveMagic=true, damageRoll=(@item.level)d10, damageType=psychic, savingThrow=true, damageBeforeSave=false","priority":20}],"disabled":false,"duration":{"startTime":null,"seconds":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"icon":"icons/magic/control/fear-fright-monster-grin-purple-blue.webp","label":"Phantasmal Killer","transfer":false,"flags":{},"tint":null,"origin":null}],"flags":{"dynamiceffects":{"equipActive":true,"alwaysActive":false,"effects":[{"modSpecKey":"flags.dnd5e.conditions","value":"Frightened","mode":"+","targetSpecific":false,"id":1,"itemId":"UWXxnmoLDNjm4DTU","active":true,"_targets":[]}]},"dae":{"activeEquipped":false,"alwaysActive":false},"core":{"sourceId":"Compendium.Dynamic-Effects-SRD.DAE SRD Spells.qHWBKyQxm3CTm2yS"},"midi-qol":{"onUseMacroName":"","effectActivation":false},"rest-recovery":{"data":{"recovery":{"enabled":false}}},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"autoFailFriendly":false,"autoSaveFriendly":false,"rollOther":false,"critOther":false,"offHandWeapon":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false},"cf":{"id":"temp_lpjg4hxkuum"}},"system":{"description":{"value":"<p>You tap into the nightmares of a creature you can see within range and create an illusory manifestation of its deepest fears, visible only to that creature. The target must make a Wisdom saving throw. On a failed save, the target becomes Frightened for the Duration. At the end of each of the targets turns before the spell ends, the target must succeed on a Wisdom saving throw or take 4d10 psychic damage. On a successful save, the spell ends.</p>\n<p><strong>At Higher Levels</strong>. When you cast this spell using a spell slot of 5th level or higher, the damage increases by 1d10 for each slot level above 4th.</p>","chat":"","unidentified":""},"source":"PHB pg. 265","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":"1","units":"minute"},"cover":null,"target":{"value":1,"width":null,"units":"","type":"creature"},"range":{"value":120,"long":0,"units":"ft"},"uses":{"value":0,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"save","attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[["4d10","psychic"]],"versatile":""},"formula":"","save":{"ability":"wis","dc":null,"scaling":"spell"},"level":4,"school":"ill","components":{"vocal":true,"somatic":true,"material":false,"ritual":false,"concentration":true},"materials":{"value":"","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":false},"scaling":{"mode":"level","formula":"1d10"}},"ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1663114169230,"modifiedTime":1685751117885,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"_id":"n4IHsz8nMdZEFlUJ"}
{"name":"Branding Smite 10.0.17","type":"spell","img":"icons/magic/fire/dagger-rune-enchant-flame-orange.webp","effects":[{"_id":"6hAZJkE4UfjO7Adp","changes":[{"key":"flags.dnd5e.DamageBonusMacro","mode":0,"value":"ItemMacro","priority":20},{"key":"flags.midi-qol.brandingSmite.level","mode":5,"value":"@item.level","priority":20}],"disabled":false,"duration":{"startTime":null,"seconds":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"icon":"icons/magic/fire/dagger-rune-enchant-flame-orange.webp","label":"Branding Smite","origin":"Compendium.midi-qol.midiqol-sample-items.dlP9fWGo3ggfkOfm","transfer":false,"flags":{"dae":{"stackable":"none","macroRepeat":"none","specialDuration":[],"transfer":false,"selfTarget":false,"selfTargetAlways":false,"durationExpression":""},"ActiveAuras":{"isAura":false,"radius":null,"aura":"None","alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"hostile":false,"onlyOnce":false},"core":{"statusId":""}},"tint":null}],"flags":{"midi-qol":{"onUseMacroName":"","effectActivation":false},"core":{"sourceId":"Item.Z2bmzJrSSmIZdOFp"},"itemacro":{"macro":{"data":{"_id":null,"name":"Branding Smite","type":"script","author":"devnIbfBHb74U9Zv","img":"icons/svg/dice-target.svg","scope":"global","command":"// v1.0. Requires midi-qol and ATL.\nconst version = \"0.9.52\";\ntry {\n    if (![\"mwak\",\"rwak\"].includes(args[0].item.data.actionType)) return {}; \n    if (args[0].hitTargetUuids.length === 0) return {}; // did not hit anyone\n    for (let tokenUuid of args[0].hitTargetUuids) {\n        const target = await fromUuid(tokenUuid);\n        const targetActor = target.actor;\n        if (!targetActor) continue;\n        // remvoe the invisible condition\n        const effect = targetActor?.effects.find(ef=> ef.data.label===game.i18n.localize(\"midi-qol.invisible\"));\n        if (effect) await MidiQOL.socket().executeAsGM(\"removeEffects\", {actorUuid: targetActor.uuid, effects:[effect.id]});\n        // create the dim light effect on the target\n        let bsEffect = new ActiveEffect({label: \"Branding Smite\", icon: \"systems/dnd5e/icons/spells/enchant-orange-2.jpg\", changes: [{value: 5, mode: CONST.ACTIVE_EFFECT_MODES.UPGRADE, priority: 20, key:\"ATL.dimLight\"}], duration: {seconds: 60}});\n        // 60 seconds is wrong - should look for the branding smite effect and use the remaining duration - but hey\n    \n        await MidiQOL.socket().executeAsGM(\"createEffects\", {actorUuid: targetActor.uuid, effects: [bsEffect.toObject()]})\n    }\n    Hooks.once(\"midi-qol.RollComplete\", (workflow) => {\n        console.log(\"Deleting concentration\")\n        const effect = MidiQOL.getConcentrationEffect(actor);\n        if (effect) effect.delete();\n        return true;\n    })\n    const spellLevel = actor.data.flags[\"midi-qol\"].brandingSmite.level;\n    return{damageRoll: `${spellLevel}d6[radiant]`, flavor: \"Branding Smite\"}\n} catch (err) {\n    console.error(`${args[0].itemData.name} - Branding Smite ${version}`, err);\n}","folder":null,"sort":0,"permission":{"default":0},"flags":{}},"name":"Branding Smite 10.0.17","type":"script","img":"icons/svg/dice-target.svg","scope":"global","command":"const version = \"10.0.17\";\ntry {\n    if (![\"mwak\",\"rwak\"].includes(args[0].item.system.actionType)) return {}; \n    if (args[0].hitTargetUuids.length === 0) return {}; // did not hit anyone\n    for (let tokenUuid of args[0].hitTargetUuids) {\n        const target = await fromUuid(tokenUuid);\n        const targetActor = target.actor;\n        if (!targetActor) continue;\n        // remvoe the invisible condition\n        const effects = targetActor?.effects.filter(ef=> ef.label===game.i18n.localize(\"midi-qol.invisible\")).map(ef=> ef.id);\n        if (effects) await MidiQOL.socket().executeAsGM(\"removeEffects\", {actorUuid: targetActor.uuid, effects});\n        // create the dim light effect on the target\n        let bsEffect = new ActiveEffect({label: \"Branding Smite\", icon: \"icons/magic/fire/dagger-rune-enchant-flame-orange.webp\", changes: [{value: 5, mode: CONST.ACTIVE_EFFECT_MODES.UPGRADE, priority: 20, key:\"ATL.dimLight\"}], duration: {seconds: 60}});\n        // 60 seconds is wrong - should look for the branding smite effect and use the remaining duration - but hey\n    \n        await MidiQOL.socket().executeAsGM(\"createEffects\", {actorUuid: targetActor.uuid, effects: [bsEffect.toObject()]})\n    }\n    const spellLevel = actor.flags[\"midi-qol\"].brandingSmite.level;\n    Hooks.once(\"midi-qol.RollComplete\", (workflow) => {\n        const effect = MidiQOL.getConcentrationEffect(actor);\n        if (effect) effect.delete();\n        return true;\n    })\n    return{damageRoll: `${spellLevel}d6[radiant]`, flavor: \"Branding Smite\"}\n} catch (err) {\n    console.error(`${args[0].itemData.name} - Branding Smite ${version}`, err);\n}","sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null}}},"cf":{"id":"temp_bj0kdv44v2","color":"#000000"},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"autoFailFriendly":false,"autoSaveFriendly":false,"offHandWeapon":false,"ignoreTotalCover":false},"spellTemplateManager":{"stmData":{"ignoreDuration":false,"spellTexture":"","useTexture":false,"alpha":50,"coneOrigin":1,"loopAnimations":true}},"rest-recovery":{"data":{"recovery":{"enabled":false}}}},"system":{"description":{"value":"<p>The next time you hit a creature with a weapon attack before this spell ends, the weapon gleams with astral radiance as you strike. The attack deals an extra 2d6 radiant damage to the target, which becomes visible if it's invisible, and the target sheds dim light in a 5-foot radius and can't become invisible until the spell ends.</p><p><strong>At Higher Levels.</strong> When you cast this spell using a spell slot of 3rd level or higher, the extra damage increases by 1d6 for each slot level above 2nd.</p><p>Requires ATE compatible with foundry v10 to do the lighting effects</p><p></p>","chat":"","unidentified":""},"source":"PHB pg. 219","activation":{"type":"bonus","cost":1,"condition":""},"duration":{"value":"1","units":"minute"},"cover":null,"target":{"value":null,"width":null,"units":"","type":"self"},"range":{"value":null,"long":null,"units":"self"},"uses":{"value":0,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"other","attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"level":2,"school":"evo","components":{"vocal":true,"somatic":false,"material":false,"ritual":false,"concentration":true},"materials":{"value":"","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"level","formula":"1d6"}},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1661995926153,"modifiedTime":1686608530907,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"ownership":{"default":0,"devnIbfBHb74U9Zv":3,"Be8r6Sgxcs3sL08I":3},"folder":null,"sort":0,"_id":"oUZRNyPtvOAAOkqO"}
{"name":"#[CF_tempEntity]","type":"weapon","flags":{"cf":{"id":"temp_6q1ztzxb2o4","name":"Magias_itemmacro","color":"#49a437","fontColor":"#FFFFFF","icon":"","sorting":"m","contents":["8IE0lszIgvk6neFK","t0QvGh4GR4Tl9Cfq","1BtolCJNJcPR9w1r","0xQyM0EkzCQGP1HJ","ZnaBC1NwjMv63zZ5","KaLnVaBNHOpDLEHF","HPvqkgIl1Y6F7Sdo","ycxLAvWCWp4S1tOt","CIdIlzrEbvKoL8Bv","IURWIs6belYf2Alj","RJn4TgfTiV1zQX7u","7LHvzm1F8aJpLzbf","bYWTuqPdGe949Lcf","qnRS11TpP24EOJQu","rdESvdGpC2ioHpy3","7HRCx2kiSHNnxArq","Tq1C2piePydqPTZn","g5F2Y3J9IVbaID0T","F6j4KmRGUvKWZ9kI","DdqUxw7Mdf9YRCJs","XZyd175m5EGhfXl7","hhJeL6b81aopAeqs","wm6lBWepcMtLTHR0","HqWYW8sSHhfaMWHf","GyNLdOWPJR8KBtfQ"],"children":[],"folderPath":[],"version":"2.5.7"}},"img":"icons/svg/item-bag.svg","system":{"description":{"value":"","chat":"","unidentified":""},"source":"","quantity":1,"weight":0,"price":0,"attunement":0,"equipped":false,"rarity":"","identified":true,"activation":{"type":"","cost":0,"condition":""},"duration":{"value":null,"units":""},"cover":null,"crewed":false,"target":{"value":null,"width":null,"units":"","type":""},"range":{"value":null,"long":null,"units":""},"uses":{"value":null,"max":"","per":null,"recovery":""},"consume":{"type":"","target":null,"amount":null},"ability":null,"actionType":null,"attackBonus":0,"chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"armor":{"value":10},"hp":{"value":0,"max":0,"dt":null,"conditions":""},"weaponType":"simpleM","baseItem":"","properties":{},"proficient":true},"effects":[],"folder":null,"sort":0,"ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.2.1","coreVersion":"10.291","createdTime":1668365380840,"modifiedTime":1688486129054,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"_id":"q8Yh36j3bvfOl3p4"}
{"name":"Wrathful Smite","type":"spell","img":"modules/plutonium/media/icon/spell/phb-wrathful-smite.webp","effects":[{"_id":"GJRQbsQVtQ5CJMe9","changes":[{"key":"flags.dnd5e.DamageBonusMacro","mode":0,"value":"ItemMacro.Wrathful Smite","priority":20}],"disabled":false,"duration":{"startTime":null,"rounds":10,"seconds":null,"combat":null,"turns":null,"startRound":null,"startTurn":null},"icon":"modules/plutonium/media/icon/spell/phb-wrathful-smite.webp","label":"Wrathful Smite","transfer":false,"flags":{"dae":{"stackable":"none","macroRepeat":"none","specialDuration":["1Hit:mwak","1Hit:rwak"],"transfer":false,"selfTarget":false,"selfTargetAlways":false,"durationExpression":""},"ActiveAuras":{"isAura":false,"radius":"","aura":"None","alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"hostile":false,"onlyOnce":false,"displayTemp":false},"dfreds-convenient-effects":{"description":""},"core":{"statusId":""}},"tint":null,"origin":null}],"flags":{"srd5e":{"page":"spells.html","source":"PHB","hash":"wrathful%20smite_phb"},"spellTemplateManager":{"stmData":{"ignoreDuration":false,"spellTexture":"","useTexture":false,"alpha":50,"coneOrigin":1,"loopAnimations":true}},"midi-qol":{"onUseMacroName":"","effectActivation":false},"itemacro":{"macro":{"data":{"_id":null,"name":"Wrathful Smite","type":"script","author":"WpiVAovmlZrRTFMX","img":"icons/svg/dice-target.svg","scope":"global","command":"if (![\"mwak\"].includes(args[0].itemData.data.actionType)) return {}; // melee weapon attack\nconst uuid = game.user.targets.first().actor.uuid;\nconst targets = Array.from(game.user.targets);\nconst hasEffectApplied = game.dfreds.effectInterface.hasEffectApplied('Frightened', uuid);\nconst wait = async (ms) => new Promise((resolve)=> setTimeout(resolve, ms));\n\nfor (const target of targets) {\n\nif (target.actor.data.data.traits.ci.value.includes(\"frightened\")) {\n  \t\tui.notifications.info(\"Imune to Frightened!\");\n} else { \n\nawait game.MonksTokenBar.requestRoll(targets,{request:'save:wis', silent: true});\nawait wait(5000)\n\nconst listMessages = game.messages.contents\nconst lastMessage = listMessages[listMessages.length - 1];\nconst spellDC = actor.data.data.attributes.spelldc\nlet tokenid = 'token'+target.id;\nlet saveRoll = lastMessage.data.flags[\"monks-tokenbar\"][tokenid].total\n\nif (saveRoll < spellDC) {\nif (!hasEffectApplied) {\n  await game.dfreds.effectInterface.addEffect({ effectName: 'Frightened', uuid});\n  } \n}\n} }\n\n\nlet spellLevel = 1;\nif (args[0].isCritical) spellLevel = spellLevel * 2;\nreturn{damageRoll: `${spellLevel}d6[psychic]`, flavor: \"Wrathful Smite\"};","folder":null,"sort":0,"permission":{"default":0},"flags":{}},"name":"Wrathful Smite","type":"script","scope":"global","command":"if (![\"mwak\"].includes(args[0].itemData.data.actionType)) return {}; // melee weapon attack\nif (args[0].hitTargetUuids.length === 0) return {}; // did not hit anyone\nconst uuid = game.user.targets.first().actor.uuid;\nconst targett = game.user.targets.first();\nconst wait = async (ms) => new Promise((resolve)=> setTimeout(resolve, ms));\nlet selected = await MidiQOL.MQfromActorUuid(args[0].actorUuid); \n\nconst hasEffectApplied = game.dfreds.effectInterface.hasEffectApplied('Frightened', game.user.targets.first().actor.uuid)\nif(!hasEffectApplied) {\n        const actorD = canvas.tokens.controlled[0].actor;\n        const DC = selected.data.data.attributes.spelldc;\n        let results = await game.MonksTokenBar.requestRoll([game.user.targets.first()],{request:'save:wis', silent: true, fastForward: false, dc: `${DC}`, flavor: \"Save against being Frightened\"});\n        let tokenid = 'token'+targett.id;\n        var i = 0;\n        while (results.data.flags['monks-tokenbar'][tokenid].total === undefined && i < 30) {\n            await new Promise(resolve => setTimeout(resolve, 500))\n            i++;\n        }\n              \n        if (results.data.flags['monks-tokenbar'][tokenid].passed === false) await game.dfreds.effectInterface.addEffect({effectName:'Frightened', uuid: game.user.targets.first().actor.uuid, origin: canvas.tokens.controlled[0].actor.uuid})\n}\n\nlet spellLevel = 1;\nif (args[0].isCritical) spellLevel = spellLevel * 2;\nreturn{damageRoll: `${spellLevel}d6[thunder]`, flavor: \"Wrathful Smite\"};","author":"Be8r6Sgxcs3sL08I","_id":null,"img":"icons/svg/dice-target.svg","folder":null,"sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null}}},"core":{"sourceId":"Item.umH5y4Dyea4HzJbx"},"exportSource":{"world":"criador","system":"dnd5e","coreVersion":"0.8.8","systemVersion":"1.3.6"},"siftoolkit":{"SIFData":{"ignoreDuration":false,"texture":"","useTexture":false,"alpha":50,"coneOrigin":1,"loopAnimations":true,"playTemplateAudio":false,"playDamageAudio":false,"playSaveAudio":false,"clip":"","volume":100}},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":true,"ignoreTotalCover":false,"autoFailFriendly":false,"offHandWeapon":false,"autoSaveFriendly":false},"cf":{"id":"temp_bj0kdv44v2"},"scene-packer":{"hash":"d36928938a5dc0512f0ecfe7bb288aa62d7ed943","sourceId":"Item.1pUyUwCxDuCvSIC3"},"rest-recovery":{"data":{"recovery":{"enabled":false}}}},"system":{"description":{"value":"<div class=\"rd__b  rd__b--3\"><p>The next time you hit with a melee weapon attack during this spell's duration, your attack deals an extra [[/r 1d6]] psychic damage. Additionally, if the target is a creature, it must make a Wisdom saving throw or be <a href=\"https://5e.tools/conditionsdiseases.html#frightened_phb\" data-plut-hover=\"{&quot;page&quot;:&quot;conditionsdiseases.html&quot;,&quot;source&quot;:&quot;PHB&quot;,&quot;hash&quot;:&quot;frightened_phb&quot;}\">frightened</a> of you until the spell ends. As an action, the creature can make a Wisdom check against your spell save DC to steel its resolve and end this spell.</p><div class=\"rd__spc-inline-post\"></div></div>","chat":"","unidentified":""},"source":"PHB","activation":{"type":"bonus","cost":1,"condition":""},"duration":{"value":"1","units":"minute"},"cover":null,"target":{"value":null,"width":null,"units":"","type":"self"},"range":{"value":null,"long":null,"units":"self"},"uses":{"value":0,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"other","attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"level":1,"school":"evo","components":{"vocal":true,"somatic":false,"material":false,"ritual":false,"concentration":true},"materials":{"value":"","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"none","formula":""}},"ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1684975127841,"modifiedTime":1686614757420,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"_id":"qUlZma5mEIh2Ps6t"}
{"name":"Illusory Dragon","type":"spell","system":{"description":{"value":"<div class=\"rd__b  rd__b--3\"><p>By gathering threads of shadow material from the Shadowfell, you create a Huge shadowy dragon in an unoccupied space that you can see within range. The illusion lasts for the spell's duration and occupies its space, as if it were a creature.</p><div class=\"rd__spc-inline-post\"></div><p>When the illusion appears, any of your enemies that can see it must succeed on a Wisdom saving throw or become @condition[frightened] of it for 1 minute. If a @condition[frightened] creature ends its turn in a location where it doesn't have line of sight to the illusion, it can repeat the saving throw, ending the effect on itself on a success.</p><p>As a bonus action on your turn, you can move the illusion up to 60 feet. At any point during its movement, you can cause it to exhale a blast of energy in a 60-foot cone originating from its space. When you create the dragon, choose a damage type: acid, cold, fire, lightning, necrotic, or poison. Each creature in the cone must make an Intelligence saving throw, taking [[/r 7d6]] damage of the chosen damage type on a failed save, or half as much damage on a successful one.</p><p>The illusion is tangible because of the shadow stuff used to create it, but attacks miss it automatically, it succeeds on all saving throws, and it is immune to all damage and conditions. A creature that uses an action to examine the dragon can determine that it is an illusion by succeeding on an Intelligence (@skill[Investigation]) check against your spell save DC. If a creature discerns the illusion for what it is, the creature can see through it and has advantage on saving throws against its breath.</p></div>","chat":"","unidentified":""},"source":"XGE","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":"1","units":"minute"},"cover":null,"target":{"value":null,"width":null,"units":"","type":""},"range":{"value":120,"long":null,"units":"ft"},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"cha","actionType":"other","attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"cha"},"level":8,"school":"ill","components":{"vocal":false,"somatic":true,"material":false,"ritual":false,"concentration":true},"materials":{"value":"","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"always","prepared":true},"scaling":{"mode":"none","formula":""}},"img":"icons/creatures/eyes/humanoid-single-purple-blue.webp","flags":{"plutonium":{"page":"spells.html","source":"XGE","hash":"illusory%20dragon_xge","propDroppable":"spell"},"rest-recovery":{"data":{"recovery":{"enabled":false}}},"midi-qol":{"effectActivation":false,"onUseMacroName":"[postActiveEffects]ItemMacro"},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"autoFailFriendly":false,"rollOther":false,"critOther":false,"offHandWeapon":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false,"autoSaveFriendly":false},"itemacro":{"macro":{"name":"Illusory Dragon","type":"script","scope":"global","command":"const summonType = \"Illusory Dragon\";\nlet selected = await MidiQOL.MQfromActorUuid(args[0].actorUuid); \nconst summonerDc = selected.data.data.attributes.spelldc\nasync function myEffectFunction(template) {\nlet effect = '';\neffect = 'modules/GMmacros/videos-gifs-animated/assets_animations_ring_CIRCLE_01.webm';\nnew Sequence()\n    .effect()\n        .file(effect)\n        .atLocation(template)\n        .center()\n        .JB2A()\n        .scale(1.0)\n        .wait(700)\n    .play()\n}\nconst callbacks = {\n    pre: async (template) => {\n        myEffectFunction(template);\n        await warpgate.wait(500);\n    },\n};\n\n\nlet dialog = new Promise((resolve, reject) => {\n    new Dialog({\n        title: 'Choose a damage type',\n        content: `\n          <form class=\"flexcol\">\n            <div class=\"form-group\">\n              <select id=\"element\">\n                <option value=\"acid\">Acid</option>\n                <option value=\"cold\">Cold</option>\n                <option value=\"fire\">Fire</option>\n                <option value=\"lightning\">Lightning</option>\n                <option value=\"necrotic\">Necrotic</option>\n                <option value=\"poison\">Poison</option>\n              </select>\n            </div>\n          </form>\n        `,\n        //select element type\n        buttons: {\n            yes: {\n                icon: '<i class=\"fas fa-bolt\"></i>',\n                label: 'Select',\n                callback: async (html) => {\n                let element = html.find('#element').val();\n\t\tconst updates = {\n\t\t\tactor: {\n        \t\t'name' :  `${element} Illusory Dragon`},\n\t\t\tembedded: { \n\t\t\t  Item: {\n\t \t\t\t\"Breath\" : {\n\t\t\t\t    'name': `${element} Breath`,\n\t  \t\t\t    'data.damage.parts': [[`7d6`,`${element}`]],\n\t\t\t\t    'system.save': {'dc': `${summonerDc}`},\n\t\t\t\t}\n \t\t\t       }\n\t\t    \t}\n\t\t}\n\t\tconst options = {controllingActor: actor};\n\t\twarpgate.spawn(summonType, updates, callbacks, options);\n                resolve();\n                },\n            },\n        }\n    }).render(true);\n})","author":"Be8r6Sgxcs3sL08I","_id":null,"img":"icons/svg/dice-target.svg","folder":null,"sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null}}},"core":{"sourceId":"Actor.CQaWddu2rSc1igDg.Item.wSWXBJnc53RP9HKM"},"cf":{"id":"temp_6q1ztzxb2o4"}},"effects":[],"ownership":{"default":0,"Xvz9L40UsVHWsWpn":3,"Be8r6Sgxcs3sL08I":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1671212940358,"modifiedTime":1685847469213,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"_id":"qnRS11TpP24EOJQu"}
{"name":"Investiture of Flame","type":"spell","system":{"description":{"value":"<div class=\"rd__b  rd__b--3\"><p>Flames race across your body, shedding bright light in a 30-foot radius and dim light for an additional 30 feet for the spell's duration. The flames don't harm you. Until the spell ends, you gain the following benefits:</p><div class=\"rd__spc-inline-post\"><p></p></div><ul class=\"rd__list\"><li class=\"rd__li \">You are immune to fire damage and have resistance to cold damage.</li><li class=\"rd__li \">Any creature that moves within 5 feet of you for the first time on a turn or ends its turn there takes [[/r 1d10]] fire damage.</li><li class=\"rd__li \">You can use your action to create a line of fire 15 feet long and 5 feet wide extending from you in a direction you choose. Each creature in the line must make a Dexterity saving throw. A creature takes [[/r 4d8]] fire damage on a failed save, or half as much damage on a successful one.</li></ul></div>","chat":"","unidentified":""},"source":"XGE","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":"10","units":"minute"},"cover":null,"target":{"value":null,"width":null,"units":"","type":"self"},"range":{"value":null,"long":null,"units":"self"},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"save","attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"level":6,"school":"trs","components":{"vocal":true,"somatic":true,"material":false,"ritual":false,"concentration":true},"materials":{"value":"","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"none","formula":""}},"img":"icons/magic/fire/elemental-fire-humanoid.webp","ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"flags":{"plutonium":{"page":"spells.html","source":"XGE","hash":"investiture%20of%20flame_xge","propDroppable":"spell"},"rest-recovery":{"data":{"recovery":{"enabled":false}}},"midi-qol":{"effectActivation":false,"onUseMacroName":"[postActiveEffects]function.chrisPremades.macros.investitureFlame.item"},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"autoFailFriendly":false,"autoSaveFriendly":false,"rollOther":false,"critOther":false,"offHandWeapon":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false},"core":{"sourceId":"Actor.uEwtmlc84Te8YgjK.Item.0qGUpn2qlgFtNGYw"},"itemacro":{"macro":{"name":"Investiture of Flame","type":"script","scope":"global","command":"const lastArg = args[args.length - 1];\nconst thisToken = canvas.tokens.get(lastArg.tokenId);\n\nif (args[0] === \"on\") {\n  // If the dynamic active effect started\n    const updates = {\n        embedded: {\n            Item: {\n                \"Line of Fire\": { //String\n                    type: \"spell\", // feat, spell\n                    img: \"icons/magic/fire/projectile-wave-arrow.webp\", //Example: \"icons/magic/holy/projectiles-blades-salvo-yellow.webp\"\n                    type: \"spell\",\n                    system: {\n                        description: {\n                            value: \"<p>You can use your action to create a line of fire 15 feet long and 5 feet wide extending from you in a direction you choose. Each creature in the line must make a Dexterity saving throw. A creature takes [[/r 4d8]] fire damage on a failed save, or half as much damage on a successful one.</p>\", //String\n                        },\n                        activation: {\n                            type: \"action\", // action, bonus, crew, day, hour, lair, legendary, minute, none, reaction, special, reactiondamage, reactionmanual\n                            cost: 1, // Numeric\n                            condition: \"\" // String\n                        },\n                        target: {\n                        value: 15,\n                        width: null,\n                        units: \"ft\",\n                        type: \"line\",\n                        },\n                        actionType: \"other\", // mwak, rwak, msak, rsak, save, heal, abil, util, other\n                        damage: {\n                            parts: [\n                                [ \"4d8\", \"fire\" ] // [\"Formula\", \"acid, bludgeoning, cold, fire, force, lightning, necrotic, piercing, poison, psychic, radiant, slashing, thunder, healing, temphp\"]\n                            ]\n                        },\n                        level: 6, // Numeric 1-9\n                        school: \"trans\", // abj, con, div, enc, evo, ill, nec, trs\n                        preparation: {\n                            mode: \"atwill\", // prepared, pact, always, atwill, innate\n                            prepared: true // true, false\n                        },\n                        save: {\n                        ability: \"dex\",\n                        dc: null,\n                        scaling: \"spell\",\n                        },\n                        },\n\n                }\n            }\n        }\n    }\n  //update the token and create the necessary attack spell\n await warpgate.mutate(thisToken.document, updates);\n ui.notifications.info(`Line of Fire has been added to spells at will.`);\n}\nif (args[0] === \"off\") {\n  //Concentration broke or time expired, let's revert the token and remove the attack spell item\n await warpgate.revert(thisToken.document);\n}","author":"Be8r6Sgxcs3sL08I","_id":null,"img":"icons/svg/dice-target.svg","folder":null,"sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null}}},"cf":{"id":"temp_6q1ztzxb2o4"}},"effects":[{"label":"Investiture of Flame","icon":"icons/magic/fire/elemental-fire-humanoid.webp","changes":[{"key":"macro.itemMacro","mode":0,"value":"@item","priority":20}],"transfer":false,"_id":"AZYKPR95u94G8h8U","disabled":false,"duration":{"startTime":null,"seconds":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"origin":null,"tint":null,"flags":{"dfreds-convenient-effects":{"description":"test"},"dae":{"selfTarget":false,"selfTargetAlways":false,"stackable":"noneName","durationExpression":"","macroRepeat":"none","specialDuration":[]},"core":{"statusId":""},"ActiveAuras":{"isAura":false,"aura":"None","radius":"","alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"displayTemp":false,"hostile":false,"onlyOnce":false},"effectmacro":{"onDelete":{"script":"await chrisPremades.macros.investitureFlame.effectEnd(token);"}}}},{"label":"Investiture of Flame","icon":"icons/magic/fire/elemental-fire-humanoid.webp","changes":[{"key":"flags.midi-qol.OverTime","mode":0,"value":"turn=start,\nsaveAbility=dex,\nsaveDC=@attributes.spelldc,\ndamageRoll=1d10,\ndamageType=fire","priority":20}],"transfer":false,"_id":"zk7aIVo0C6mguTru","disabled":false,"duration":{"startTime":null,"seconds":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"origin":null,"tint":null,"flags":{"dfreds-convenient-effects":{"description":""},"dae":{"selfTarget":false,"selfTargetAlways":false,"stackable":"noneName","durationExpression":"","macroRepeat":"none","specialDuration":[]},"core":{"statusId":""},"ActiveAuras":{"isAura":true,"aura":"All","radius":"5","alignment":"","type":"","ignoreSelf":true,"height":false,"hidden":false,"displayTemp":true,"hostile":false,"onlyOnce":true}}}],"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1685751193752,"modifiedTime":1686772242491,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"_id":"rdESvdGpC2ioHpy3"}
{"name":"Black Tentacles","ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"type":"spell","system":{"description":{"value":"<p>Squirming, ebony tentacles fill a 20-foot square on ground that you can see within range. For the Duration, these tentacles turn the ground in the area into difficult terrain.</p><p>When a creature enters the affected area for the first time on a turn or starts its turn there, the creature must succeed on a Dexterity saving throw or take 3d6 bludgeoning damage and be @JournalEntry[Restrained] by the tentacles until the spell ends. A creature that starts its turn in the area and is already @JournalEntry[Restrained] by the tentacles takes 3d6 bludgeoning damage.</p><p>A creature @JournalEntry[Restrained] by the tentacles can use its action to make a Strength or Dexterity check (its choice) against your spell save DC. On a success, it frees itself.</p>","chat":"","unidentified":""},"source":"Basic Rules, Player's Handbook","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":"1","units":"minute"},"cover":null,"target":{"value":20,"width":null,"units":"ft","type":"square"},"range":{"value":90,"long":null,"units":"ft"},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"save","attackBonus":"","chatFlavor":"[3d6 - bludgeoning] Any creature that enters the affected area for the first time on a turn, starts its turn there, or already restrained by the tentacles.","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"level":4,"school":"con","components":{"vocal":true,"somatic":true,"material":true,"ritual":false,"concentration":true},"materials":{"value":"a piece of tentacle from a giant octopus or a giant squid","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":false},"scaling":{"mode":"none","formula":""}},"flags":{"ddbimporter":{"id":3218,"definitionId":2014,"entityTypeId":435869154,"dndbeyond":{"lookup":"classSpell","class":"Warlock","level":7,"characterClassId":116570746,"spellLevel":4,"ability":"cha","mod":4,"dc":15,"cantripBoost":false,"overrideDC":false,"id":3218,"entityTypeId":435869154,"healingBoost":0,"usesSpellSlot":true},"originalName":"Black Tentacles","sources":[{"sourceId":1,"pageNumber":null,"sourceType":2},{"sourceId":2,"pageNumber":null,"sourceType":1}],"tags":["Damage","Control"],"version":"3.4.23","effect":{"applyStart":true,"handleStartRoll":true,"autoDamageIfCondition":true,"applyEnd":false,"applyEntry":true,"applyImmediate":true,"everyEntry":false,"conditionEffect":true,"damageEffect":true,"removeOnOff":true,"allowVsRemoveCondition":true,"removalCheck":["str","dex"],"removalSave":null,"saveRemoves":false,"condition":"Restrained","dice":"3d6[bludgeoning]","damageType":"bludgeoning","save":"dex","sequencerFile":"jb2a.black_tentacles.dark_purple"},"effectsApplied":true,"importId":"LcPaJ2JvQf4Nz6op"},"midiProperties":{"magicdam":true,"magiceffect":true,"nodam":false,"fulldam":false,"halfdam":false,"autoFailFriendly":false,"autoSaveFriendly":false,"rollOther":false,"critOther":false,"offHandWeapon":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false},"spell-class-filter-for-5e":{"parentClass":"warlock"},"itemacro":{"macro":{"data":{"name":"Black Tentacles","type":"script","scope":"global","command":"if(!game.modules.get(\"ActiveAuras\")?.active) {\n  ui.notifications.error(\"ActiveAuras is not enabled\");\n  return;\n}\n\nconst lastArg = args[args.length - 1];\n\nasync function wait(ms) { return new Promise(resolve => { setTimeout(resolve, ms); }); }\n\nfunction getHighestAbility(actor, abilities) {\n  if (typeof abilities === \"string\") {\n    return abilities;\n  } else if (Array.isArray(abilities)) {\n    return abilities.reduce((prv, current) => {\n      if (actor.system.abilities[current].value > actor.system.abilities[prv].value) return current;\n      else return prv;\n    }, abilities[0]);\n  }\n}\n\nfunction getCantripDice(actor) {\n  const level = actor.type === \"character\" ? actor.system.details.level : actor.system.details.cr;\n  return 1 + Math.floor((level + 1) / 6);\n}\n\n\nasync function attemptRemoval(targetToken, condition, item) {\n  if (game.dfreds.effectInterface.hasEffectApplied(condition, targetToken.document.uuid)) {\n    new Dialog({\n      title: `Use action to attempt to remove ${condition}?`,\n      buttons: {\n        one: {\n          label: \"Yes\",\n          callback: async () => {\n            const caster = item.parent;\n            const saveDc = caster.system.attributes.spelldc;\n            const removalCheck = item.system.flags.ddbimporter.effect.removalCheck;\n            const removalSave = item.system.flags.ddbimporter.effect.removalSave;\n            const ability = removalCheck ? getHighestAbility(targetToken.actor.data, removalCheck) : getHighestAbility(targetToken.actor.data, removalSave);\n            const type = removalCheck ? \"check\" : \"save\";\n            const flavor = `${condition} (via ${item.name}) : ${CONFIG.DND5E.abilities[ability]} ${type} vs DC${saveDc}`;\n            const rollResult = removalCheck\n              ? (await targetToken.actor.rollAbilityTest(ability, { flavor })).total\n              : (await targetToken.actor.rollAbilitySave(ability, { flavor })).total;\n\n            if (rollResult >= saveDc) {\n              game.dfreds.effectInterface.removeEffect({ effectName: condition, uuid: targetToken.document.uuid });\n            } else {\n              if (rollResult < saveDc) ChatMessage.create({ content: `${targetToken.name} fails the ${type} for ${item.name}, still has the ${condition} condition.` });\n            }\n          },\n        },\n        two: {\n          label: \"No\",\n          callback: () => {},\n        },\n      },\n    }).render(true);\n  }\n}\n\nasync function applyCondition(condition, targetToken, item, itemLevel) {\n  if (!game.dfreds.effectInterface.hasEffectApplied(condition, targetToken.document.uuid)) {\n    const caster = item.parent;\n    const workflowItemData = duplicate(item.data);\n    workflowItemData.system.target = { value: 1, units: \"\", type: \"creature\" };\n    workflowItemData.system.save.ability = item.flags.ddbimporter.effect.save;\n    workflowItemData.system.components.concentration = false;\n    workflowItemData.system.level = itemLevel;\n    workflowItemData.system.duration = { value: null, units: \"inst\" };\n    workflowItemData.system.target = { value: null, width: null, units: \"\", type: \"creature\" };\n    workflowItemData.system.preparation.mode = \"atwill\";\n    setProperty(workflowItemData, \"flags.itemacro\", {});\n    setProperty(workflowItemData, \"flags.midi-qol\", {});\n    setProperty(workflowItemData, \"flags.dae\", {});\n    setProperty(workflowItemData, \"effects\", []);\n    delete workflowItemData._id;\n    workflowItemData.name = `${workflowItemData.name}: ${item.name} Condition save`;\n\n    const saveTargets = [...game.user?.targets].map((t )=> t.id);\n    game.user.updateTokenTargets([targetToken.id]);\n    const saveItem = new CONFIG.Item.documentClass(workflowItemData, { parent: caster });\n    const options = { showFullCard: false, createWorkflow: true, configureDialog: true };\n    const result = await MidiQOL.completeItemUse(saveItem, {}, options);\n\n    game.user.updateTokenTargets(saveTargets);\n    const failedSaves = [...result.failedSaves];\n    if (failedSaves.length > 0) {\n      await game.dfreds.effectInterface.addEffect({ effectName: condition, uuid: failedSaves[0].document.uuid });\n    }\n\n    return result;\n  }\n}\n\nasync function attachSequencerFileToTemplate(templateUuid, sequencerFile, originUuid) {\n  if (game.modules.get(\"sequencer\")?.active) {\n    if (Sequencer.Database.entryExists(sequencerFile)) {\n      console.debug(`Trying to apply sequencer effect (${sequencerFile}) to ${templateUuid} from ${originUuid}`, sequencerFile);\n      const template = await fromUuid(templateUuid);\n      new Sequence()\n      .effect()\n        .file(Sequencer.Database.entryExists(sequencerFile))\n        .size({\n          width: canvas.grid.size * (template.data.width / canvas.dimensions.distance),\n          height: canvas.grid.size * (template.data.width / canvas.dimensions.distance),\n        })\n        .persist(true)\n        .origin(originUuid)\n        .belowTokens()\n        .opacity(0.5)\n        .attachTo(template, { followRotation: true })\n        .stretchTo(template, { attachTo: true})\n      .play();\n    }\n  }\n}\n\n\nasync function rollItemDamage(targetToken, itemUuid, itemLevel) {\n  const item = await fromUuid(itemUuid);\n  const caster = item.parent;\n  const isCantrip = item.flags.ddbimporter.effect.isCantrip;\n  const damageDice = item.flags.ddbimporter.effect.dice;\n  const damageType = item.flags.ddbimporter.effect.damageType;\n  const saveAbility = item.flags.ddbimporter.effect.save;\n  const casterToken = canvas.tokens.placeables.find((t) => t.actor?.uuid === caster.uuid);\n  const scalingDiceArray = item.system.scaling.formula.split(\"d\");\n  const scalingDiceNumber = itemLevel - item.system.level;\n  const upscaledDamage =  isCantrip\n    ? `${getCantripDice(caster.data)}d${scalingDiceArray[1]}[${damageType}]`\n    : scalingDiceNumber > 0 ? `${scalingDiceNumber}d${scalingDiceArray[1]}[${damageType}] + ${damageDice}` : damageDice;\n  const damageRoll = await new Roll(upscaledDamage).evaluate({ async: true });\n  if (game.dice3d) game.dice3d.showForRoll(damageRoll);\n  const workflowItemData = duplicate(item.data);\n  workflowItemData.system.target = { value: 1, units: \"\", type: \"creature\" };\n  workflowItemData.system.save.ability = saveAbility;\n  workflowItemData.system.components.concentration = false;\n  workflowItemData.system.level = itemLevel;\n  workflowItemData.system.duration = { value: null, units: \"inst\" };\n  workflowItemData.system.target = { value: null, width: null, units: \"\", type: \"creature\" };\n\n  setProperty(workflowItemData, \"flags.itemacro\", {});\n  setProperty(workflowItemData, \"flags.midi-qol\", {});\n  setProperty(workflowItemData, \"flags.dae\", {});\n  setProperty(workflowItemData, \"effects\", []);\n  delete workflowItemData._id;\n  workflowItemData.name = `${workflowItemData.name}: Turn Entry Damage`;\n\n  await new MidiQOL.DamageOnlyWorkflow(\n    caster,\n    casterToken,\n    damageRoll.total,\n    damageType,\n    [targetToken],\n    damageRoll,\n    {\n      flavor: `(${CONFIG.DND5E.damageTypes[damageType]})`,\n      itemCardId: \"new\",\n      itemData: workflowItemData,\n      isCritical: false,\n    }\n  );\n}\n\nif (args[0].tag === \"OnUse\" && args[0].macroPass === \"preActiveEffects\") {\n  const safeName = lastArg.itemData.name.replace(/\\s|'|\\.|/g, \"_\");\n  const dataTracker = {\n    randomId: randomID(),\n    targetUuids: lastArg.targetUuids,\n    startRound: game.combat.round,\n    startTurn: game.combat.turn,\n    spellLevel: lastArg.spellLevel,\n  };\n\n  const item = await fromUuid(lastArg.itemUuid);\n  // await item.update(dataTracker);\n  await DAE.unsetFlag(item, `${safeName}Tracker`);\n  await DAE.setFlag(item, `${safeName}Tracker`, dataTracker);\n\n  const ddbEffectFlags = lastArg.item.flags.ddbimporter?.effect;\n  if (ddbEffectFlags) {\n    const sequencerFile = ddbEffectFlags.sequencerFile;\n    if (sequencerFile) {\n      await attachSequencerFileToTemplate(lastArg.templateUuid, sequencerFile, lastArg.itemUuid)\n    }\n    if (ddbEffectFlags.isCantrip) {\n      const cantripDice = getCantripDice(lastArg.actor);\n      args[0].spellLevel = cantripDice;\n      ddbEffectFlags.cantripDice = cantripDice;\n      let newEffects = args[0].item.effects.map((effect) => {\n        effect.changes = effect.changes.map((change) => {\n          change.value = change.value.replace(\"@cantripDice\", cantripDice)\n          return change;\n        });\n        return effect;\n      });\n      args[0].item.effects = duplicate(newEffects);\n      args[0].itemData.effects = duplicate(newEffects);\n    }\n    const template = await fromUuid(lastArg.templateUuid);\n    await template.update({\"flags.effect\": ddbEffectFlags});\n\n    if (ddbEffectFlags.applyImmediate) {\n      console.debug(\"Applying immediate effect\");\n      await wait(500);\n      const condition = ddbEffectFlags.condition;\n      for (const token of lastArg.failedSaves) {\n        if (!game.dfreds.effectInterface.hasEffectApplied(condition, token.actor.uuid)) {\n          console.debug(`Applying ${condition} to ${token.name}`);\n          await game.dfreds.effectInterface.addEffect({ effectName: condition, uuid: token.actor.uuid });\n        }\n      };\n    }\n  }\n\n  console.debug(\"ItemMacro: Pre-apply finised, applying effect to template\")\n\n  return await game.modules.get(\"ActiveAuras\").api.AAHelpers.applyTemplate(args);\n\n} else if (args[0].tag === \"OnUse\" && args[0].macroPass === \"postActiveEffects\") {\n  if (lastArg.item.flags.ddbimporter?.effect?.applyImmediate) {\n    const condition = lastArg.item.flags.ddbimporter.effect.condition;\n    for (const token of lastArg.failedSaves) {\n      if (!game.dfreds.effectInterface.hasEffectApplied(condition, token.actor.uuid)) {\n        console.debug(`Applying ${condition} to ${token.name}`);\n        await game.dfreds.effectInterface.addEffect({ effectName: condition, uuid: token.actor.uuid });\n      }\n    };\n  }\n} else if (args[0] == \"on\" || args[0] == \"each\") {\n  const safeName = (lastArg.efData.name ?? lastArg.efData.label).replace(/\\s|'|\\.|/g, \"_\");\n  const item = await fromUuid(lastArg.efData.origin);\n  const ddbEffectFlags = item.flags.ddbimporter.effect;\n  // sometimes the round info has not updated, so we pause a bit\n  if (args[0] == \"each\") await wait(500);\n  const targetItemTracker = DAE.getFlag(item.parent, `${safeName}Tracker`);\n  const originalTarget = targetItemTracker.targetUuids.includes(lastArg.tokenUuid);\n  const target = canvas.tokens.get(lastArg.tokenId);\n  const targetTokenTrackerFlag = DAE.getFlag(target, `${safeName}Tracker`);\n  const targetedThisCombat = targetTokenTrackerFlag && targetItemTracker.randomId === targetTokenTrackerFlag.randomId;\n  const targetTokenTracker = targetedThisCombat\n    ? targetTokenTrackerFlag\n    : {\n      randomId: targetItemTracker.randomId,\n      round: game.combat.round,\n      turn: game.combat.turn,\n      hasLeft: false,\n      condition: ddbEffectFlags.condition,\n    };\n\n  const castTurn = targetItemTracker.startRound === game.combat.round && targetItemTracker.startTurn === game.combat.turn;\n  const isLaterTurn = game.combat.round > targetTokenTracker.round || game.combat.turn > targetTokenTracker.turn;\n  const everyEntry = hasProperty(item.data, \"flags.ddbimporter.effect.everyEntry\")\n    ? item.flags.ddbimporter.effect.everyEntry\n    : false;\n\n  // if:\n  // not cast turn, and not part of the original target\n  // AND one of the following\n  // not original template and have not yet had this effect applied this combat OR\n  // has been targeted this combat, left and re-entered effect, and is a later turn\n\n  const autoDamageIfCondition = hasProperty(ddbEffectFlags, \"autoDamageIfCondition\") ? ddbEffectFlags.autoDamageIfCondition : false;\n  const hasConditionStart = game.dfreds.effectInterface.hasEffectApplied(targetTokenTracker.condition, target.actor.uuid);\n  const applyAutoConditionDamage = autoDamageIfCondition && hasConditionStart;\n\n  if (ddbEffectFlags.conditionEffect && !hasConditionStart) {\n    if (castTurn && originalTarget) {\n      console.debug(`Token ${target.name} is part of the original target for ${item.name}`);\n    } else if (everyEntry || !targetedThisCombat || (targetedThisCombat && isLaterTurn)) {\n      console.debug(`Token ${target.name} is targeted for immediate save vs condition with ${item.name}, using the following factors`, { originalTarget, castTurn, targetedThisCombat, targetTokenTracker, isLaterTurn });\n      targetTokenTracker.hasLeft = false;\n      await applyCondition(targetTokenTracker.condition, target, item, targetItemTracker.spellLevel);\n    } else {\n      console.debug(`Token ${target.name} has not evaluated for condition application`);\n    }\n  }\n  if (ddbEffectFlags.damageEffect) {\n    if (castTurn && originalTarget) {\n      console.debug(`Token ${target.name} is part of the original target for ${item.name}`);\n    } else if ((!targetedThisCombat && !autoDamageIfCondition) || //if auto damage applied by conditional save\n      (targetedThisCombat && ((targetTokenTracker.hasLeft && isLaterTurn) || (applyAutoConditionDamage && isLaterTurn)))\n    ) {\n      console.debug(`Token ${target.name} is targeted for immediate damage with ${item.name}, using the following factors`, { originalTarget, castTurn, targetedThisCombat, targetTokenTracker, isLaterTurn });\n      targetTokenTracker.hasLeft = false;\n      await rollItemDamage(target, lastArg.efData.origin, targetItemTracker.spellLevel);\n    } else {\n      console.debug(`Token ${target.name} has not evaluated for damage application`);\n    }\n  }\n\n  targetTokenTracker.turn = game.combat.turn;\n  targetTokenTracker.round = game.combat.round;\n  await DAE.setFlag(target, `${safeName}Tracker`, targetTokenTracker);\n  const allowVsRemoveCondition = item.flags.ddbimporter.effect.allowVsRemoveCondition;\n  const hasConditionAppliedEnd = game.dfreds.effectInterface.hasEffectApplied(targetTokenTracker.condition, target.document.uuid);\n  const currentTokenCombatTurn = game.combat.current.tokenId === lastArg.tokenId;\n  if (currentTokenCombatTurn && allowVsRemoveCondition && hasConditionAppliedEnd) {\n    console.log(`Asking ${target.name} wants to remove ${targetTokenTracker.condition}`);\n    await attemptRemoval(target, targetTokenTracker.condition, item);\n  }\n} else if (args[0] == \"off\") {\n  const safeName = (lastArg.efData.name ?? lastArg.efData.label).replace(/\\s|'|\\.|/g, \"_\");\n  const targetToken = await fromUuid(lastArg.tokenUuid);\n  const targetTokenTracker = await DAE.getFlag(targetToken, `${safeName}Tracker`);\n  const removeOnOff = hasProperty(lastArg, \"efData.flags.ddbimporter.effect.removeOnOff\")\n    ? lastArg.efData.flags.ddbimporter.effect.removeOnOff\n    : true;\n\n  if (targetTokenTracker?.condition && removeOnOff && game.dfreds.effectInterface.hasEffectApplied(targetTokenTracker.condition, lastArg.tokenUuid)) {\n    console.debug(`Removing ${targetTokenTracker.condition} from ${targetToken.name}`);\n    game.dfreds.effectInterface.removeEffect({ effectName: targetTokenTracker.condition, uuid: lastArg.tokenUuid });\n  }\n\n  if (targetTokenTracker) {\n    targetTokenTracker.hasLeft = true;\n    await DAE.setFlag(targetToken, `${safeName}Tracker`, targetTokenTracker);\n  }\n}\n"},"options":{},"apps":{},"compendium":null,"name":"Black Tentacles","type":"script","scope":"global","command":"return await game.modules.get(\"ActiveAuras\").api.AAHelpers.applyTemplate(args);","author":"roRDywD19pu2VxlC","_id":null,"img":"icons/svg/dice-target.svg","folder":null,"sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null}}},"midi-qol":{"onUseMacroName":"[preActiveEffects]ItemMacro","forceCEOff":true,"effectActivation":false,"forceCEOn":false},"scene-packer":{"hash":"d221cf611ab151f8301a2787103a2c98c076b908","sourceId":"Item.vMS8r03H0PV4hirt"},"core":{"sourceId":"Item.bsEiRq4iO1QgPMqa"},"exportSource":{"world":"spelljammer-adventures-in-space","system":"dnd5e","coreVersion":"11.302","systemVersion":"2.2.1"},"rest-recovery":{"data":{"recovery":{"enabled":false}}},"cf":{"id":"temp_6q1ztzxb2o4"}},"img":"icons/magic/nature/vines-thorned-curled-glow-teal-purple.webp","effects":[{"changes":[{"key":"system.attributes.movement.all","mode":0,"value":"/2","priority":20}],"duration":{"seconds":60,"startTime":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"tint":null,"transfer":false,"disabled":false,"flags":{"dae":{"transfer":false,"stackable":"none","macroRepeat":"none","selfTarget":false,"selfTargetAlways":false,"durationExpression":"","specialDuration":[]},"ddbimporter":{"disabled":false,"effect":{"applyStart":true,"handleStartRoll":true,"autoDamageIfCondition":true,"applyEnd":false,"applyEntry":true,"applyImmediate":true,"everyEntry":false,"conditionEffect":true,"damageEffect":true,"removeOnOff":true,"allowVsRemoveCondition":true,"removalCheck":["str","dex"],"removalSave":null,"saveRemoves":false,"condition":"Restrained","dice":"3d6[bludgeoning]","damageType":"bludgeoning","save":"dex","sequencerFile":"jb2a.black_tentacles.dark_purple"}},"midi-qol":{"forceCEOff":true},"ActiveAuras":{"isAura":true,"aura":"All","radius":"","alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"onlyOnce":false,"save":"str","savedc":null,"displayTemp":true,"hostile":false},"dfreds-convenient-effects":{"description":""},"core":{"statusId":""},"effectmacro":{"onTurnStart":{"script":"const sourceItem = origin;\nconst tokenOrActor = actor;\nconst theActor = tokenOrActor.actor ? tokenOrActor.actor : tokenOrActor;\nconst damageType = \"bludgeoning\";\nconst spellDC = origin.parent.system.attributes.spelldc;\nconst uuid = actor.uuid;\nconst hasEffectApplied = await game.dfreds.effectInterface.hasEffectApplied('Restrained', uuid);\nconst hasCheckApplied = await game.dfreds.effectInterface.hasEffectApplied('Black Tentacles Check', uuid);\nlet saveAbility = \"dex\";\n\nif (hasEffectApplied)\n{\nconst content = `<p>Would you like to use your action to make a saving throw to escape Restrained?</p><form class=\"flexcol\"><table width=\"100%\"><tbody><tr><th>Strength</th><th>Dexterity (Disadvantaged)</th></tr><tr><td style=\"text-align: center;vertical-align: middle;\"><input type=\"radio\" value=\"str\" id=\"strength\" name=\"strength\" style=\"margin: 0 auto;\"></td><td style=\"text-align: center;vertical-align: middle;\"><input type=\"radio\" value=\"dex\" id=\"dexterity\" name=\"dexterity\" style=\"margin: 0 auto;\"></td></tr></tbody></table></form>`;\nawait new Dialog({\ntitle: \"Saving Throw\",\ncontent: content,\n\tbuttons: {\n\t\tdamage: {\n\t\t\tlabel: \"Continue\", callback: async (html) => {\n\t\t\t\tconst dexterity = html.find('input#dexterity')[0];\n\t\t\t\tconst strength = html.find('input#strength')[0];\n\t\t\t\tsaveAbility = dexterity && dexterity.checked ? dexterity.value : strength && strength.checked ? strength.value : null;\n\t\t\t\tconst itemData = mergeObject(\n\t\t\t\t\tduplicate(sourceItem.system),\n\t\t\t\t\t{\n\t\t\t\t\tname: \"Black Tentacles Damage\",\n\t\t\t\t\ttype: \"weapon\",\n\t\t\t\t\teffects: [],\n\t\t\t\t\tflags: {\n\t\t\t\t\t\t\"midi-qol\": {\n\t\t\t\t\t\t\tnoProvokeReaction: true,\n\t\t\t\t\t\t\tonUseMacroName: null\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\"midiProperties\": {\n\t\t\t\t\t\t\tfulldam: true \n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\tsystem: {\n\t\t\t\t\t\tequipped: true,\n\t\t\t\t\t\tactionType: \"save\",\n\t\t\t\t\t\tsave: { dc: spellDC, ability: saveAbility, scaling: \"flat\" },\n\t\t\t\t\t\tdamage: { parts: [[`3d6`, damageType]] },\n\t\t\t\t\t\t\"target.type\": \"self\",\n\t\t\t\t\t\tcomponents: { concentration: false, material: false, ritual: false, somatic: false, value: \"\", vocal: false },\n\t\t\t\t\t\tduration: { units: \"inst\", value: undefined },\n\t\t\t\t\t\tweaponType: \"improv\",\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\t{ overwrite: true, inlace: true, insertKeys: true, insertValues: true }\n\t\t\t\t);\n\t\t\t\tsetProperty(itemData.flags, \"autoanimations.killAnim\", true);\n\t\t\t\tconst item = new CONFIG.Item.documentClass(itemData, { parent: theActor });\n\t\t\t\tconst options = { showFullCard: false, createWorkflow: true, versatile: false, configureDialog: false, workflowOptions: {autoRollDamage: 'always'} };\n\t\t\t\tconst saveResult = await MidiQOL.completeItemUse(item, {}, options);\n\t\t\t\tsaveResult.failedSaves.size !== 1 && await game.dfreds.effectInterface.removeEffect({ effectName: 'Restrained', uuid });\n\t\t\t}\n\t\t},\n\t\tcancel: { label: \"Cancel\", callback: () => false }\n\t},\n\tdefault: \"Cancel\"\n}).render(true);\n!hasCheckApplied && await game.dfreds.effectInterface.addEffect({ effectName: 'Black Tentacles Check', uuid });\n}\n\nelse if (!hasEffectApplied)\n{\nconst itemData = mergeObject(\n\tduplicate(sourceItem.system),\n\t{\n\tname: \"Black Tentacles Damage\",\n\ttype: \"weapon\",\n\teffects: [],\n\tflags: {\n\t\t\"midi-qol\": {\n\t\t  noProvokeReaction: true,\n\t\t  onUseMacroName: null\n\t\t},\n\t\t\"midiProperties\": {\n\t\t\tnodam: true\n\t\t},\n\t},\n\tsystem: {\n\t\tequipped: true,\n\t\tactionType: \"save\",\n\t\tsave: { dc: spellDC, ability: saveAbility, scaling: \"flat\" },\n\t\tdamage: { parts: [[`3d6`, damageType]] },\n\t\t\"target.type\": \"self\",\n\t\tcomponents: { concentration: false, material: false, ritual: false, somatic: false, value: \"\", vocal: false },\n\t\tduration: { units: \"inst\", value: undefined },\n\t\tweaponType: \"improv\",\n\t},\n\t},\n\t{ overwrite: true, inlace: true, insertKeys: true, insertValues: true }\n);\nitemData.system.target.type = \"self\";\nsetProperty(itemData.flags, \"autoanimations.killAnim\", true);\nconst item = new CONFIG.Item.documentClass(itemData, { parent: theActor });\nconst options = { showFullCard: false, createWorkflow: true, versatile: false, configureDialog: false, workflowOptions: {autoRollDamage: 'always'} };\nconst saveResult = await MidiQOL.completeItemUse(item, {}, options);\nsaveResult.failedSaves.size === 1 && await game.dfreds.effectInterface.addEffect({ effectName: 'Restrained', uuid });\n!hasCheckApplied && await game.dfreds.effectInterface.addEffect({ effectName: 'Black Tentacles Check', uuid });\n}"},"onCreate":{"script":"const sourceItem = origin;\nconst tokenOrActor = actor;\nconst theActor = tokenOrActor.actor ? tokenOrActor.actor : tokenOrActor;\nconst damageType = \"bludgeoning\";\nconst spellDC = origin.parent.system.attributes.spelldc;\nconst uuid = actor.uuid;\nconst saveAbility = \"dex\";\nconst hasCheckApplied = await game.dfreds.effectInterface.hasEffectApplied('Black Tentacles Check', uuid);\nif(hasCheckApplied) return;\nawait game.dfreds.effectInterface.addEffect({ effectName: 'Black Tentacles Check', uuid });\n\nconst itemData = mergeObject(\nduplicate(sourceItem.system),\n{\nname: \"Black Tentacles Damage\",\n  type: \"weapon\",\n  effects: [],\n  flags: {\n\t\"midi-qol\": {\n\t  noProvokeReaction: true,\n\t  onUseMacroName: null\n\t},\"midiProperties\": {\n\t  nodam: true \n\t  },\n  },\n  system: {\n\tequipped: true,\n\tactionType: \"save\",\n\tsave: { dc: spellDC, ability: saveAbility, scaling: \"flat\" },\n\tdamage: { parts: [[`3d6`, damageType]] },\n\t\"target.type\": \"self\",\n\tcomponents: { concentration: false, material: false, ritual: false, somatic: false, value: \"\", vocal: false },\n\tduration: { units: \"inst\", value: undefined },\n\tweaponType: \"improv\",\n  },\n},\n{ overwrite: true, inlace: true, insertKeys: true, insertValues: true }\n);\nitemData.system.target.type = \"self\";\nsetProperty(itemData.flags, \"autoanimations.killAnim\", true);\nconst item = new CONFIG.Item.documentClass(itemData, { parent: theActor });\nconst options = { showFullCard: false, createWorkflow: true, versatile: false, configureDialog: false, workflowOptions: {autoRollDamage: 'always'} };\nconst saveResult = await MidiQOL.completeItemUse(item, {}, options);\nif (saveResult.failedSaves.size == 1) {\n\tawait game.dfreds.effectInterface.addEffect({ effectName: 'Restrained', uuid });\n}"},"onDelete":{"script":"await effect.delete()"}}},"icon":"icons/creatures/tentacles/tentacles-octopus-black-pink.webp","_id":"CB0Yivd2QutvxJ8v","origin":null,"label":""}],"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1685422612472,"modifiedTime":1687658997723,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"_id":"t0QvGh4GR4Tl9Cfq"}
{"name":"Fly","type":"spell","img":"icons/magic/control/energy-stream-link-white.webp","effects":[{"_id":"VVu9uaQR0UaAvbBr","flags":{"dae":{}},"changes":[{"key":"system.attributes.movement.fly","value":"60","mode":4,"priority":20}],"disabled":false,"duration":{"startTime":null,"seconds":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"icon":"icons/magic/control/energy-stream-link-white.webp","label":"Fly","tint":null,"transfer":false,"origin":null}],"flags":{"dynamiceffects":{"equipActive":true,"alwaysActive":false,"effects":[{"modSpecKey":"data.attributes.speed.special","value":"60ft Fly","mode":"+","targetSpecific":false,"id":1,"itemId":"BE3x0mPPgMviE9GR","active":true,"_targets":[]}]},"dae":{"activeEquipped":false,"alwaysActive":false},"core":{"sourceId":"Item.j9p6foCgoUumzm8F"},"midi-qol":{"onUseMacroName":"","effectActivation":false,"forceCEOn":false,"forceCEOff":false},"rest-recovery":{"data":{"recovery":{"enabled":false}}},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"autoFailFriendly":false,"autoSaveFriendly":false,"rollOther":false,"critOther":false,"offHandWeapon":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false},"cf":{"id":"temp_lpjg4hxkuum"}},"system":{"description":{"value":"<p>You touch a willing creature. The target gains a flying speed of 60 feet for the Duration. When the spell ends, the target falls if it is still aloft, unless it can stop the fall.</p>\n<p><strong>At Higher Levels.</strong> When you cast this spell using a spell slot of 4th level or higher, you can target one additional creature for each slot level above 3rd.</p>","chat":"","unidentified":""},"source":"PHB pg. 243","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":"10","units":"minute"},"cover":null,"target":{"value":1,"width":null,"units":"","type":"creature"},"range":{"value":null,"long":null,"units":"touch"},"uses":{"value":0,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"util","attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"level":3,"school":"trs","components":{"vocal":true,"somatic":true,"material":true,"ritual":false,"concentration":true},"materials":{"value":"A wing feather from any bird","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":false},"scaling":{"mode":"level","formula":""}},"ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1663114169184,"modifiedTime":1685728568631,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"_id":"uibQwUoZJJXgcL0i"}
{"name":"Spiritual Weapon","type":"spell","system":{"description":{"value":"<div class=\"rd__b  rd__b--3\"><p>You create a floating, spectral weapon within range that lasts for the duration or until you cast this spell again. When you cast the spell, you can make a melee spell attack against a creature within 5 feet of the weapon. On a hit, the target takes force damage equal to [[/r 1d8]] + your spellcasting ability modifier.</p><div class=\"rd__spc-inline-post\"></div><p>As a bonus action on your turn, you can move the weapon up to 20 feet and repeat the attack against a creature within 5 feet of it.</p><p>The weapon can take whatever form you choose. Clerics of deities who are associated with a particular weapon (as St. Cuthbert is known for his mace and Thor for his hammer) make this spell's effect resemble that weapon.</p></div><div class=\"rd__b  rd__b--3\"><div class=\"rd__b  rd__b--3\"><span class=\"rd__h rd__h--3\" data-title-index=\"1\"> <span class=\"entry-title-inner\">At Higher Levels.</span></span> <p>When you cast this spell using a spell slot of 3rd level or higher, the damage increases by [[/r 1d8]] for every two slot levels above 2nd.</p><div class=\"rd__spc-inline-post\"></div></div><div class=\"rd__spc-inline-post\"></div></div>","chat":"","unidentified":""},"source":"PHB","activation":{"type":"bonus","cost":1,"condition":""},"duration":{"value":"1","units":"minute"},"cover":null,"crewed":false,"target":{"value":null,"width":null,"units":"none","type":""},"range":{"value":60,"long":null,"units":"ft"},"uses":{"value":null,"max":"","per":null,"recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"wis","actionType":"other","attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"wis"},"level":2,"school":"evo","components":{"vocal":true,"somatic":true,"material":false,"ritual":false,"concentration":false},"materials":{"value":"","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"none","formula":""}},"img":"icons/weapons/swords/sword-winged-pink.webp","ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"flags":{"srd5e":{"page":"spells.html","source":"PHB","hash":"spiritual%20weapon_phb","propDroppable":"spell"},"spellTemplateManager":{"stmData":{"ignoreDuration":false,"spellTexture":"","useTexture":false,"alpha":50,"coneOrigin":1,"loopAnimations":true}},"midi-qol":{"criticalThreshold":"20","onUseMacroName":"[postActiveEffects]ItemMacro","effectActivation":false,"forceCEOff":false,"forceCEOn":false,"onUseMacroParts":{"items":{"0":{"macroName":"ItemMacro","option":"postActiveEffects"}}}},"itemacro":{"macro":{"data":{"_id":null,"name":"Spiritual Weapon","type":"script","author":"rbM5nB1AbUwbj4yJ","img":"icons/svg/dice-target.svg","scope":"global","command":"// need de Warp Gate and sequencer\n// also needs a Spiritual Weapon NPC actor\nconst summonType = \"Spiritual Weapon\";\nconst modificador = actor.data.data.abilities.wis.value\nconst cer = actor.data.data.details.level\nconst updates = {\n  actor: {\n      'data.abilities.wis' : {value: modificador},\n      'data.details.cr' : cer\n  }\n}\n\nChatMessage.create({ content: `An Spiritual Weapon has been summoned!` });\n\nasync function myEffectFunction(template) {\n//prep summoning area\nlet effect = '';\n\neffect = 'modules/automated-evocations/assets/animations/ring_CIRCLE_01.webm';\n\nnew Sequence()\n    .sound()\n        .file(\"sound/Weapon-Spell/melee_hit.mp3\")\n    .effect()\n        .file(effect)\n        .atLocation(template)\n        .center()\n        .JB2A()\n        .scale(1.0)\n        .wait(700)\n    .effect()\n          .file(\"modules/automated-evocations/assets/animations/electric_blast_01.webm\")\n          .atLocation(template)\n          .center()\n          .randomRotation()\n          .scale(.3)\n          .repeats(6, 100, 170, 250, 320, 400)\n    .play()\n}\n\nasync function postEffects(template, token) {\n//bring in our minion\nnew Sequence()\n    .animation()\n        .on(token)\n            .fadeIn(500)\n    .play()\n}\n\nconst callbacks = {\n    pre: async (template) => {\n        myEffectFunction(template);\n        await warpgate.wait(500);\n    },\n    post: async (template, token) => {\n    postEffects(template,token);\n    await warpgate.wait(500);\n    }\n};\n\nconst options = {controllingActor: actor};\n\nwarpgate.spawn(summonType, updates, callbacks, options);","folder":null,"sort":0,"permission":{"default":0},"flags":{}},"name":"Spiritual Weapon","type":"script","scope":"global","command":"// need de Warp Gate and sequencer & also needs a Spiritual Weapon NPC actor\n\nconst actorD = game.actors.get(args[0].actor._id);\nconst spellLevel = args[0].spellLevel;\nconst summonType = \"Spiritual Weapon\";\nconst modificador = actor.data.data.abilities.wis.value\nconst cer = actor.system.details.level\n\nif (spellLevel > 3){\ndamageScale = Math.floor((spellLevel)/2);\n} else {\ndamageScale = 1\n}\n\nconst updates = {\n  token : {\n\t'name': `Spt Wp nvl ${spellLevel}`,\n\t'displayName': 50\n  },\n  actor: {\n      'data.abilities.wis' : {value: modificador},\n      'data.details.cr' : cer\n  },\n  embedded: { Item: {\n        \"Attack\":{\n            'data.damage.parts': [[`${damageScale}d8 + @mod`, 'force']],\n        }\n    }}\n}\n\nChatMessage.create({ content: `An Spiritual Weapon has been summoned!` });\n\nasync function myEffectFunction(template) {\n\nnew Sequence()\n    .sound()\n       .file(\"sound/Weapon-Spell/melee_hit.mp3\")\n    .effect()\n       .file(\"modules/jb2a_patreon/Library/Generic/Impact/GroundCrackImpact_02_Regular_Orange_600x600.webm\")\n       .atLocation(template)\n       .center()\n       .scale(.2)\n    .play()\n}\n\nasync function postEffects(template, token) {\n//bring in our minion\nnew Sequence()\n    .animation()\n        .on(token)\n            .fadeIn(500)\n    .play()\n}\n\nconst callbacks = {\n    pre: async (template) => {\n        myEffectFunction(template);\n        await warpgate.wait(500);\n    },\n    post: async (template, token) => {\n    postEffects(template,token);\n    await warpgate.wait(500);\n    }\n};\n\nconst options = {controllingActor: actor};\n\nwarpgate.spawn(summonType, updates, callbacks, options);","author":"Be8r6Sgxcs3sL08I","_id":null,"img":"icons/svg/dice-target.svg","folder":null,"sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null}}},"siftoolkit":{"SIFData":{"alpha":50,"coneOrigin":1,"ignoreDuration":false,"loopAnimations":true,"texture":"","useTexture":false}},"core":{"sourceId":"Item.qjLXWsYbKlzxWD3Z"},"rest-recovery":{"data":{"recovery":{"enabled":false}}},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false,"autoFailFriendly":false,"offHandWeapon":false,"autoSaveFriendly":false},"cf":{"id":"temp_6q1ztzxb2o4"}},"effects":[],"_stats":{"systemId":"dnd5e","systemVersion":"2.2.1","coreVersion":"10.291","createdTime":1688478928993,"modifiedTime":1688483825934,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"_id":"wm6lBWepcMtLTHR0"}
{"name":"Ray of Sickness","type":"spell","system":{"description":{"value":"<div class=\"rd__b  rd__b--3\"><p>A ray of sickening greenish energy lashes out toward a creature within range. Make a ranged spell attack against the target. On a hit, the target takes [[/r 2d8]] poison damage and must make a Constitution saving throw. On a failed save, it is also @condition[poisoned] until the end of your next turn.</p><div class=\"rd__spc-inline-post\"></div></div><div class=\"rd__b  rd__b--3\"><div class=\"rd__b  rd__b--3\"><span class=\"rd__h rd__h--3\" data-title-index=\"1\"> <span class=\"entry-title-inner\">At Higher Levels.</span></span> <p>When you cast this spell using a spell slot of 2nd level or higher, the damage increases by [[/r 1d8]] for each slot level above 1st.</p><div class=\"rd__spc-inline-post\"></div></div><div class=\"rd__spc-inline-post\"></div></div>","chat":"","unidentified":""},"source":"PHB","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":"","units":"inst"},"cover":null,"target":{"value":null,"width":null,"units":"","type":""},"range":{"value":60,"long":null,"units":"ft"},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"rsak","attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[["2d8","poison"]],"versatile":""},"formula":"","save":{"ability":"con","dc":null,"scaling":"spell"},"level":1,"school":"nec","components":{"vocal":true,"somatic":true,"material":false,"ritual":false,"concentration":false},"materials":{"value":"","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"level","formula":"1d8"}},"img":"icons/magic/light/beam-rays-green.webp","ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"flags":{"plutonium":{"page":"spells.html","source":"PHB","hash":"ray%20of%20sickness_phb","propDroppable":"spell"},"rest-recovery":{"data":{"recovery":{"enabled":false}}},"midi-qol":{"fumbleThreshold":null,"effectActivation":false,"forceCEOff":false,"forceCEOn":false},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"autoFailFriendly":false,"autoSaveFriendly":false,"rollOther":false,"critOther":false,"offHandWeapon":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false},"itemacro":{"macro":{"name":"Ray of Sickness","type":"script","scope":"global","command":"// Criar um DFeffect","author":"Be8r6Sgxcs3sL08I","_id":null,"img":"icons/svg/dice-target.svg","folder":null,"sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null}}},"core":{"sourceId":"Actor.aPsy28VvUP9LaaJV.Item.b8fciSKgHnw6elk0"},"cf":{"id":"temp_lpjg4hxkuum"}},"effects":[],"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1685631294094,"modifiedTime":1685656942890,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"_id":"xUS6yLmCT15NqYQg"}
{"name":"Synaptic Static","type":"spell","system":{"description":{"value":"<div class=\"rd__b  rd__b--3\"><p>You choose a point within range and cause psychic energy to explode there. Each creature in a 20-foot-radius sphere centered on that point must make an Intelligence saving throw. A creature with an Intelligence score of 2 or lower can't be affected by this spell. A target takes [[/r 8d6]] psychic damage on a failed save, or half as much damage on a successful one.</p><div class=\"rd__spc-inline-post\"></div><p>After a failed save, a target has muddled thoughts for 1 minute. During that time, it rolls a [[/r d6]] and subtracts the number rolled from all its attack rolls and ability checks, as well as its Constitution saving throws to maintain concentration. The target can make an Intelligence saving throw at the end of each of its turns, ending the effect on itself on a success.</p></div>","chat":"","unidentified":""},"source":"XGE","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":"","units":"inst"},"cover":null,"crewed":false,"target":{"value":20,"width":null,"units":"ft","type":"sphere"},"range":{"value":120,"long":null,"units":"ft"},"uses":{"value":null,"max":"","per":null,"recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"save","attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[["8d6","psychic"]],"versatile":""},"formula":"","save":{"ability":"int","dc":null,"scaling":"spell"},"level":5,"school":"enc","components":{"vocal":true,"somatic":true,"material":false,"ritual":false,"concentration":false},"materials":{"value":"","consumed":false,"cost":0,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"none","formula":""}},"img":"icons/magic/lightning/bolts-strike-salvo-blue.webp","flags":{"plutonium":{"page":"spells.html","source":"XGE","hash":"synaptic%20static_xge","propDroppable":"spell"},"rest-recovery":{"data":{"recovery":{"enabled":false}}},"midi-qol":{"effectActivation":false,"forceCEOff":false,"forceCEOn":false},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false,"autoFailFriendly":false,"autoSaveFriendly":false,"offHandWeapon":false},"core":{"sourceId":"Actor.l17Codzmb868P2e7.Item.hRzK5o1QqEZj1kXt"},"cf":{"id":"temp_lpjg4hxkuum"}},"effects":[{"label":"Synaptic Static","icon":"icons/magic/lightning/bolts-strike-salvo-blue.webp","changes":[{"key":"flags.midi-qol.OverTime","mode":0,"value":"turn=end,\nsaveAbility=int,\nsaveDC=@attributes.spelldc","priority":20},{"key":"system.bonuses.abilities.check","mode":2,"value":"-1d6","priority":20},{"key":"flags.midi-qol.concentrationSaveBonus","mode":2,"value":"-1d6","priority":20},{"key":"system.bonuses.All-Attacks","mode":2,"value":"-1d6","priority":20}],"transfer":false,"_id":"eGl3ebeVoSQ1AjCW","disabled":false,"duration":{"startTime":null,"seconds":60,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"origin":null,"tint":null,"flags":{"dfreds-convenient-effects":{"description":""},"dae":{"selfTarget":false,"selfTargetAlways":false,"stackable":"noneName","durationExpression":"","macroRepeat":"none","specialDuration":[]},"core":{"statusId":""},"ActiveAuras":{"isAura":false,"aura":"None","radius":"","alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"displayTemp":false,"hostile":false,"onlyOnce":false}}}],"ownership":{"default":0,"QEGPFkVbwvqQv8sl":3,"Be8r6Sgxcs3sL08I":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.2.1","coreVersion":"10.291","createdTime":1669603614379,"modifiedTime":1688219693417,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"_id":"xaEjEihMhwxUg5MC"}
{"name":"Find Familiar","type":"spell","system":{"description":{"value":"<div class=\"rd__b  rd__b--3\"><p>You gain the service of a familiar, a spirit that takes an animal form you choose: @creature[bat], @creature[cat], @creature[crab], @creature[frog] (toad), @creature[hawk], @creature[lizard], @creature[octopus], @creature[owl], @creature[poisonous snake], fish (@creature[quipper]), @creature[rat], @creature[raven], @creature[sea horse], @creature[spider], or @creature[weasel]. Appearing in an unoccupied space within range, the familiar has the statistics of the chosen form, though it is a celestial, fey, or fiend (your choice) instead of a beast.</p><div class=\"rd__spc-inline-post\"></div><p><i class=\"ve-muted\">Additional <a href=\"https://5etools-mirror-1.github.io/bestiary.html#blankhash,flstmiscellaneous:familiar=1\">animal form choices</a> may be available at the DM's discretion.</i></p><p>Your familiar acts independently of you, but it always obeys your commands. In combat, it rolls its own initiative and acts on its own turn. A familiar can't attack, but it can take other actions as normal.</p><p>When the familiar drops to 0 hit points, it disappears, leaving behind no physical form. It reappears after you cast this spell again. As an action, you can temporarily dismiss the familiar to a pocket dimension. Alternatively, you can dismiss it forever. As an action while it is temporarily dismissed, you can cause it to reappear in any unoccupied space within 30 feet of you. Whenever the familiar drops to 0 hit points or disappears into the pocket dimension, it leaves behind in its space anything it was wearing or carrying.</p><p>While your familiar is within 100 feet of you, you can communicate with it telepathically. Additionally, as an action, you can see through your familiar's eyes and hear what it hears until the start of your next turn, gaining the benefits of any special senses that the familiar has. During this time, you are @condition[deafened||deaf] and @condition[blinded||blind] with regard to your own senses.</p><p>You can't have more than one familiar at a time. If you cast this spell while you already have a familiar, you instead cause it to adopt a new form. Choose one of the forms from the above list. Your familiar transforms into the chosen creature.</p><p>Finally, when you cast a spell with a range of touch, your familiar can deliver the spell as if it had cast the spell. Your familiar must be within 100 feet of you, and it must use its reaction to deliver the spell when you cast it. If the spell requires an attack roll, you use your attack modifier for the roll.</p></div>","chat":"","unidentified":""},"source":"PHB","activation":{"type":"hour","cost":1,"condition":""},"duration":{"value":"","units":"inst"},"cover":null,"target":{"value":5,"width":null,"units":"ft","type":"space"},"range":{"value":10,"long":null,"units":"ft"},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"util","attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"level":1,"school":"con","components":{"vocal":true,"somatic":true,"material":true,"ritual":true,"concentration":false},"materials":{"value":"10 gp worth of charcoal, incense, and herbs that must be consumed by fire in a brass brazier","consumed":true,"cost":10,"supply":0},"preparation":{"mode":"prepared","prepared":true},"scaling":{"mode":"none","formula":""}},"img":"icons/creatures/birds/corvid-call-sound-glowing.webp","ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"flags":{"plutonium":{"page":"spells.html","source":"PHB","hash":"find%20familiar_phb","propDroppable":"spell"},"itemacro":{"macro":{"name":"Find Familiar","type":"script","scope":"global","command":"await warpgate.spawn(\"Nome do Familiar\")","author":"Be8r6Sgxcs3sL08I","_id":null,"img":"icons/svg/dice-target.svg","folder":null,"sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null}}},"rest-recovery":{"data":{"recovery":{"enabled":false}}},"midi-qol":{"effectActivation":false,"onUseMacroName":"[postActiveEffects]ItemMacro"},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"autoFailFriendly":false,"autoSaveFriendly":false,"rollOther":false,"critOther":false,"offHandWeapon":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false},"core":{"sourceId":"Actor.aPsy28VvUP9LaaJV.Item.vWmjN3mMfGqdvXfs"},"cf":{"id":"temp_6q1ztzxb2o4"}},"effects":[],"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1685631287575,"modifiedTime":1685655008263,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"_id":"ycxLAvWCWp4S1tOt"}
