{"name":"Bardic Inspiration","type":"feat","img":"icons/skills/melee/unarmed-punch-fist.webp","effects":[{"_id":"GrZ2AlujZEWCppJt","changes":[{"key":"flags.midi-qol.optional.BardicInspiration.attack.all","mode":5,"value":"1@scale.bard.inspiration","priority":20},{"key":"flags.midi-qol.optional.BardicInsiration.save.all","mode":5,"value":"1@scale.bard.inspiration","priority":20},{"key":"flags.midi-qol.optional.BardicInspiration.check.all","mode":5,"value":"1@scale.bard.inspiration","priority":20},{"key":"flags.midi-qol.optional.BardicInspiration.label","mode":5,"value":"Bardic Inspiration","priority":20},{"key":"flags.midi-qol.optional.BardicInspiration.skill.all","mode":2,"value":"1@scale.bard.inspiration","priority":20}],"disabled":false,"duration":{"startTime":null,"seconds":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"icon":"icons/skills/melee/unarmed-punch-fist.webp","label":"Inspired","origin":"Item.dQvh9dejF0s0d9nk","transfer":false,"flags":{"dae":{"stackable":"none","macroRepeat":"none","specialDuration":[],"transfer":false,"durationExpression":"","selfTarget":false,"selfTargetAlways":false},"ActiveAuras":{"isAura":false,"radius":null,"aura":"None","alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"hostile":false,"onlyOnce":false,"displayTemp":false},"core":{"statusId":""},"dnd5e-helpers":{"rest-effect":"Ignore"}},"tint":null}],"flags":{"core":{"sourceId":"Compendium.dnd5e.classfeatures.hpLNiGq7y67d2EHA"},"midi-qol":{"onUseMacroName":"[postActiveEffects]ItemMacro","effectActivation":false,"forceCEOff":true,"forceCEOn":false},"betterRolls5e":{"quickOther":{"context":"","value":true,"altValue":true},"quickDesc":{"value":true,"altValue":true},"quickProperties":{"value":true,"altValue":true},"quickFlavor":{"value":true,"altValue":true},"quickCharges":{"value":{"use":true},"altValue":{"use":true}}},"magicitems":{"enabled":false,"equipped":false,"attuned":false,"charges":"0","chargeType":"c1","destroy":false,"destroyFlavorText":"reaches 0 charges: it crumbles into ashes and is destroyed.","rechargeable":false,"recharge":"0","rechargeType":"t1","rechargeUnit":"r1","sorting":"l"},"cf":{"id":"temp_57npufvo0j"},"favtab":{"isFavorite":true},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"selfEffect":false,"autoFailFriendly":false,"offHandWeapon":false,"ignoreTotalCover":false,"autoSaveFriendly":false},"scene-packer":{"sourceId":"Item.7xFPEKTL9nGsRvtI","hash":"c71820d219a2e34c5def824fa9bece1a81c060ba"},"spellTemplateManager":{"stmData":{"ignoreDuration":false,"spellTexture":"","useTexture":false,"alpha":50,"coneOrigin":1,"loopAnimations":true}},"rest-recovery":{"data":{"recovery":{"enabled":false}}},"itemacro":{"macro":{"name":"Bardic Inspiration","type":"script","scope":"global","command":"token.actor.update({\"data.resources.tertiary.value\": token.actor.data.data.resources.tertiary.value - 1});","author":"Be8r6Sgxcs3sL08I","_id":null,"img":"icons/svg/dice-target.svg","folder":null,"sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null}}}},"system":{"description":{"value":"<p>You can inspire others through stirring words or music. To do so, you use a bonus action on your turn to choose one creature other than yourself within 60 feet of you who can hear you. That creature gains one Bardic Inspiration die, a d6. Once within the next 10 minutes, the creature can roll the die and add the number rolled to one ability check, attack roll, or saving throw it makes. The creature can wait until after it rolls the d20 before deciding to use the Bardic Inspiration die, but must decide before the GM says whether the roll succeeds or fails. Once the Bardic Inspiration die is rolled, it is lost. A creature can have only one Bardic Inspiration die at a time.</p>\n<p>You can use this feature a number of times equal to your Charisma modifier (a minimum of once).</p>\n<p>You regain any expended uses when you finish a long rest.</p>\n<p>Your Bardic Inspiration die changes when you reach certain levels in this class. The die becomes a d8 at 5th level, a d10 at 10th level, and a d12 at 15th level.</p>\n<h3><em>**Midi-qol note: The Other Formula is removed as it is not  required.<br /><br /></em><strong>You must ensure your bard has the dnd1.6 bard class not the older 1.5 version or scaling won't work.</strong></h3>","chat":"","unidentified":""},"source":"PHB pg. 53","activation":{"type":"bonus","cost":1,"condition":""},"duration":{"value":"10","units":"minute"},"cover":null,"target":{"value":1,"width":null,"units":"","type":"creature"},"range":{"value":60,"long":null,"units":"ft"},"uses":{"value":5,"max":"@abilities.cha.mod","per":"sr","recovery":""},"consume":{"type":"attribute","target":"resources.tertiary.value","amount":1},"ability":"","actionType":"util","attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"type":{"value":"","subtype":""},"requirements":"Bard 1","recharge":{"value":null,"charged":false}},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1661995926163,"modifiedTime":1685240846476,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"folder":null,"sort":0,"_id":"0joPVfl47Uw72R9d"}
{"name":"Maneuvers: Brace","type":"feat","img":"icons/skills/melee/weapons-crossed-swords-yellow.webp","effects":[{"_id":"tyr9bqr24wew5lex","changes":[{"key":"system.bonuses.All-Damage","mode":2,"value":"+1d((2*floor(((@classes.fighter.levels)-2)/8))+8)","priority":5}],"disabled":false,"duration":{"startTime":null,"rounds":1,"seconds":null,"combat":null,"turns":null,"startRound":null,"startTurn":null},"icon":"icons/skills/melee/weapons-crossed-swords-yellow.webp","label":"Maneuvers: Brace","origin":"Actor.67GUmdTadYmGXD8W.Item.EbURPL9F8boGsK20","transfer":false,"flags":{"core":{"statusId":""},"dae":{"stackable":"none","durationExpression":"","macroRepeat":"none","specialDuration":["1Attack"],"transfer":false,"selfTarget":false,"selfTargetAlways":false},"ActiveAuras":{"isAura":false,"aura":"None","radius":"","alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"displayTemp":false,"hostile":false,"onlyOnce":false},"dfreds-convenient-effects":{"description":""}},"tint":null}],"flags":{"ddbimporter":{"id":"2439086","entityTypeId":"222216831","componentId":1306902,"componentTypeId":258900837,"class":"Fighter","subclass":"Battle Master","importId":"28pyz8r4w0vt0973"},"infusions":{"infused":false},"obsidian":{"source":{"type":"class","text":"Fighter"}},"scene-packer":{"hash":"b13bfd16b6a3c3e60f72110d7241dae140f20e36","sourceId":"Item.rZN9xErT3g3Nfwle"},"spellTemplateManager":{"stmData":{"ignoreDuration":false,"spellTexture":"","useTexture":false,"alpha":50,"coneOrigin":1,"loopAnimations":true}},"midi-qol":{"effectActivation":false,"onUseMacroName":"[postActiveEffects]ItemMacro"},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"autoFailFriendly":false,"autoSaveFriendly":false,"offHandWeapon":false,"ignoreTotalCover":false},"magicitems":{"enabled":false,"equipped":false,"attuned":false,"charges":"0","chargeType":"c1","destroy":false,"destroyFlavorText":"reaches 0 charges: it crumbles into ashes and is destroyed.","rechargeable":false,"recharge":"0","rechargeType":"t1","rechargeUnit":"r1","sorting":"l"},"favtab":{"isFavorite":true},"itemacro":{"macro":{"data":{"_id":null,"name":"Maneuvers: Brace","type":"script","author":"ldRsJ6Yp5qPydWA1","img":"icons/svg/dice-target.svg","scope":"global","command":"","folder":null,"sort":0,"permission":{"default":0},"flags":{}},"name":"Maneuvers: Brace","type":"script","scope":"global","command":"let sourceActor = this.actor;\nlet SupDie = sourceActor.items.getName('Superiority Die');\nlet SupDieUses = SupDie.system.uses.value;\n      if (SupDieUses <= 0) return {};\n        if (!SupDie) {\n            ui.notifications.warn('Source actor does not appear to have a Bardic Inspiration feature!');\n            return;}\nSupDie.update({'system.uses.value': SupDieUses - 1});","author":"Be8r6Sgxcs3sL08I","_id":null,"img":"icons/svg/dice-target.svg","folder":null,"sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null}}},"core":{"sourceId":"Item.QCt9G1ryLky9enrK"},"cf":{"id":"temp_pbbargtiogk","path":"Manobras - Battle Master Novo","color":"#b74e4e"},"exportSource":{"world":"test","system":"dnd5e","coreVersion":"9.269","systemVersion":"1.6.1"},"rest-recovery":{"data":{"recovery":{"enabled":false}}}},"system":{"description":{"value":"<p><strong>CLIQUE ANTES ANTES DE ATACAR. DEPOIS ATAQUE.</strong></p><p>When a creature you can see moves into the reach you have with the melee weapon you're wielding, you can use your reaction to expend one superiority die and make one attack against the creature, using that weapon. If the attack hits, add the superiority die to the weapon's damage roll.</p><p></p>","chat":"","unidentified":""},"source":"PHB p74","activation":{"type":"special","cost":1,"condition":""},"duration":{"value":null,"units":""},"cover":null,"target":{"value":null,"width":null,"units":"","type":"self"},"range":{"value":null,"long":null,"units":""},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"attribute","target":"","amount":1},"ability":"","actionType":"other","attackBonus":0,"chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"type":{"value":"","subtype":""},"requirements":"Fighter: Battlemaster","recharge":{"value":null,"charged":false},"attunement":0},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1668450899415,"modifiedTime":1685305439897,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"_id":"1AcD9QJQvFsfyzZ1"}
{"name":"Channel Divinity: Vow of Enmity","type":"feat","system":{"description":{"value":"<div class=\"rd__b  rd__b--1\"><p>As a bonus action, you can utter a vow of enmity against a creature you can see within 10 feet of you, using your Channel Divinity. You gain advantage on attack rolls against the creature for 1 minute or until it drops to 0 hit points or falls @condition[unconscious].</p></div><p><strong>Colocar a seguinte macro na barra GM.</strong></p><p><strong>Depois chamar ela pelo Actor on Use Macros (Before attack Roll)</strong></p><p></p><blockquote><p><span style=\"font-family:monospace\">const workflow = MidiQOL.Workflow.getWorkflow(args[0].uuid) const tactor = (Array.from(workflow.targets))[0]?.actor; if (tactor?.effects.find(</span><span class=\"hljs-params\" style=\"box-sizing:border-box;user-select:none\"><span style=\"font-family:monospace\">i</span></span><span style=\"font-family:monospace\">=&gt;i.data.label === \"Vow of Enmity\")) workflow.advantage = \"true\";</span></p></blockquote><p></p><p></p>","chat":"","unidentified":""},"source":"PHB","activation":{"type":"bonus","cost":1,"condition":""},"duration":{"value":"","units":""},"cover":null,"target":{"value":null,"width":null,"units":"","type":""},"range":{"value":10,"long":null,"units":"ft"},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"other","attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"flat"},"type":{"value":"","subtype":""},"requirements":"Paladin 3 (Vengeance)","recharge":{"value":null,"charged":false}},"ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"img":"icons/magic/fire/projectile-wave-arrow.webp","flags":{"plutonium":{"page":"subclassFeature","source":"PHB","hash":"channel%20divinity%3a%20vow%20of%20enmity_paladin_phb_vengeance_phb_3_phb"},"rest-recovery":{"data":{"recovery":{"enabled":false}}},"midi-qol":{"effectActivation":false},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"autoFailFriendly":false,"autoSaveFriendly":false,"rollOther":false,"critOther":false,"offHandWeapon":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false},"magicitems":{"enabled":false,"equipped":false,"attuned":false,"charges":"0","chargeType":"c1","destroy":false,"destroyFlavorText":"reaches 0 charges: it crumbles into ashes and is destroyed.","rechargeable":false,"recharge":"0","rechargeType":"t1","rechargeUnit":"r1","sorting":"l"},"core":{"sourceId":"Scene.LXVuI8bVxJAkCHEg.Token.TwWckXehskU6oWll.Item.k8CaWAceZ4V4ZQRu"},"cf":{"id":"temp_mt8pdupg5f"}},"effects":[{"label":"Vow of Enmity","icon":"icons/magic/fire/projectile-wave-arrow.webp","changes":[],"transfer":false,"_id":"vCZlEcuRLCCtz5So","disabled":false,"duration":{"startTime":null,"seconds":60,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"origin":null,"tint":null,"flags":{"dfreds-convenient-effects":{"description":""},"dae":{"selfTarget":false,"selfTargetAlways":false,"stackable":"noneName","durationExpression":"","macroRepeat":"none","specialDuration":[]},"core":{"statusId":""},"ActiveAuras":{"isAura":false,"aura":"None","radius":"","alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"displayTemp":false,"hostile":false,"onlyOnce":false}}}],"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1685907057796,"modifiedTime":1685907812418,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"_id":"1f2ijhqxOr4FPVeT"}
{"name":"Maneuvers: Menacing Attack","type":"feat","img":"icons/skills/melee/blade-tip-chipped-blood-red.webp","effects":[{"label":"Maneuvers: Menacing Attack","icon":"icons/skills/melee/blade-tip-chipped-blood-red.webp","changes":[{"key":"flags.dnd5e.DamageBonusMacro","mode":0,"value":"ItemMacro","priority":20}],"transfer":true,"_id":"oY9QXoe5XwUXjaiH","disabled":false,"duration":{"startTime":null,"seconds":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"origin":null,"tint":null,"flags":{"dfreds-convenient-effects":{"description":""},"dae":{"selfTarget":false,"selfTargetAlways":false,"stackable":"noneName","durationExpression":"","macroRepeat":"none","specialDuration":[]},"core":{"statusId":""},"ActiveAuras":{"isAura":false,"aura":"None","radius":"","alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"displayTemp":false,"hostile":false,"onlyOnce":false}}}],"flags":{"ddbimporter":{"id":"53570","entityTypeId":"222216831","componentId":22,"componentTypeId":258900837,"class":"Fighter","subclass":"Battle Master","importId":"ye6nz9f4x9n3v7lu","ignoreIcon":true,"ignoreItemImport":true,"retainResourceConsumption":true},"infusions":{"infused":false},"obsidian":{"source":{"type":"class","text":"Fighter"}},"spellTemplateManager":{"stmData":{"ignoreDuration":false,"spellTexture":"","useTexture":false,"alpha":50,"coneOrigin":1,"loopAnimations":true}},"midi-qol":{"effectActivation":false,"onUseMacroName":""},"midiProperties":{"nodam":false,"halfdam":false,"fulldam":true,"rollOther":false,"critOther":false,"concentration":false,"magicdam":false,"magiceffect":false,"toggleEffect":false,"ignoreTotalCover":false,"autoFailFriendly":false,"autoSaveFriendly":false,"offHandWeapon":false},"magicitems":{"enabled":false,"equipped":false,"attuned":false,"charges":"0","chargeType":"c1","destroy":false,"destroyFlavorText":"reaches 0 charges: it crumbles into ashes and is destroyed.","rechargeable":false,"recharge":"0","rechargeType":"t1","rechargeUnit":"r1","sorting":"l"},"itemacro":{"macro":{"data":{"_id":null,"name":"Maneuvers: Trip Attack","type":"script","author":"ldRsJ6Yp5qPydWA1","img":"icons/svg/dice-target.svg","scope":"global","command":"","folder":null,"sort":0,"permission":{"default":0},"flags":{}},"name":"Maneuvers: Menacing Attack","type":"script","scope":"global","command":"if (args[0].hitTargets.length < 1) return {};\nlet sourceActor = this.actor;\nlet SupDie = sourceActor.items.getName('Superiority Die');\nlet SupDieUses = SupDie.system.uses.value;\n         if (SupDieUses <= 0) return {};\n         if (!SupDie) {\n            ui.notifications.warn('Source actor does not appear to have a Superiority Die feature!');\n            return;}\nconst targetActor = game.user.targets.first().actor.uuid;         \nconst uuid = game.user.targets.first().actor.uuid;\nlet target = Array.from(game.user.targets)[0];\nconst hasEffectApplied = game.dfreds.effectInterface.hasEffectApplied('Frightened', uuid);\nconst immunity = target.actor.system.traits.ci.value.has(\"frightened\");\nif(immunity === true) {\n  ui.notifications.info(\"They are immune to frightened!\");\n  return;\n}\n       \nconst targets = Array.from(game.user.targets);\nlet me = canvas.tokens.controlled[0].actor;\nlet meath = actor.data.data.abilities.str.mod\nlet meacr = actor.data.data.abilities.dex.mod\nlet bestSkill = meacr > meath ? meacr : meath;\nlet prof = me.data.data.attributes.prof\nlet DCtotal = 8+bestSkill+prof\n\nconst pcActor = MidiQOL.MQfromActorUuid(args[0].actorUuid);\n\tconst dActor = canvas.tokens.controlled[0].actor;\n\tconst fighterLevel = actor.getRollData().classes.fighter?.levels;\n\n\tif (fighterLevel > 17) superiorityDie = \"12\";\n   \t else if (fighterLevel > 9) superiorityDie = \"10\";\n  \t else if (fighterLevel > 0) superiorityDie = \"8\";\n\nlet dialog = new Promise((resolve, reject) => {\n        new Dialog({\n            // localize this text\n            title: \"Battle Master: Menacing Attack\",\n            content: \"<p>Deseja usar o Maneuvers: Menacing Attack (+1 dado dano e wis save para ver se fica frightned)?</p>\",\n            buttons: {\n                one: {\n                    icon: '<p> </p><img src = \"icons/svg/light.svg\" width=\"60\" height=\"60\"></>',\n                    label: \"<p>Sim</p>\",\n                    callback: () => resolve(\"SIM\")\n                },\n                two: {\n                    icon: '<p> </p><img src = \"icons/svg/hazard.svg\" width=\"60\" height=\"60\"></>',\n                    label: \"<p>Não</p>\",\n                    callback: () => { resolve(\"NAO\") }\n                }\n            },\n            default: \"two\"\n        }).render(true);\n    });\n\n     const effectData = {\n        label: \"Menacing\", \n        icon: \"icons/skills/melee/blade-tip-chipped-blood-red.webp\",\n        flags: {\n          \"dae\": {\n           \"specialDuration\": [\n            \"turnEndSource\"\n          ]},\n        },\n        changes: [\n          {key: \"macro.CE\", mode: 0, value: \"Frightened\", priority: 20} // macro to apply the damage\n                ],\n      }\n\n    let choiceACBonus = await dialog;\n    const baseDice = 1\n    if (choiceACBonus === \"SIM\") {\n    SupDie.update({'system.uses.value': SupDieUses - 1});\n    const targets = Array.from(game.user.targets);\n    const wait = async (ms) => new Promise((resolve)=> setTimeout(resolve, ms));\n    for (const target of targets) {\n            await game.MonksTokenBar.requestRoll(targets,{request:\"save:wis\", silent: true, dc: DCtotal});\n            await wait(11000)\n            const listMessages = game.messages.contents\n            const lastMessage = listMessages[listMessages.length - 1];\n            let tokenid = 'token'+target.id;\n            let saveRoll = lastMessage.data.flags[\"monks-tokenbar\"][tokenid].total\n            if (saveRoll < DCtotal) {\n            if (!hasEffectApplied) {\n     \t    await MidiQOL.socket().executeAsGM(\"createEffects\", { actorUuid: targetActor, effects: [effectData] });\n        }}}\nconst diceMult = args[0].isCritical ? 2: 1;\nreturn {damageRoll: `${diceMult}d${superiorityDie}`, flavor: \"Menacing Attack\"};\n}","author":"Be8r6Sgxcs3sL08I","_id":null,"img":"icons/svg/dice-target.svg","folder":null,"sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null}}},"favtab":{"isFavorite":true},"scene-packer":{"hash":"64fd1a74503f9c54de9d845e9f9eabe3eed74db2","sourceId":"Item.VLl5Q3p1phT9lDdQ"},"core":{"sourceId":"Item.bpSu08y0CydFPHEi"},"cf":{"id":"temp_pbbargtiogk","path":"Manobras - Battle Master Novo","color":"#b74e4e"},"exportSource":{"world":"test","system":"dnd5e","coreVersion":"9.269","systemVersion":"1.6.1"},"rest-recovery":{"data":{"recovery":{"enabled":false}}}},"system":{"description":{"value":"<p><strong>NÃO USE A SKILL. ATAQUE NORMALMENTE. VAI PEDIR SE VC QUER DA O DANO E PEDIR O TESTE DE WISDOW.</strong></p><p> <span style=\"font-family:'Helvetica Neue', Helvetica, Arial, sans-serif\">hen you hit a creature with a weapon attack, you can expend one superiority die to attempt to frighten the target. You add the superiority die to the attack's damage roll, and the target must make a Wisdom saving throw. On a failed save, it is frightened of you until the end of your next turn.</span></p><p><span style=\"font-family:Signika, sans-serif\">SAVE DC = 8 + your proficiency bonus + your Strength or Dexterity modifier (your choice)</span></p><details><summary><strong>SETUP:</strong></summary><p>Please remember to link the use of this ability to a character sheet resource under the item details Resource Consumption dropdown.</p><img src=\"https://user-images.githubusercontent.com/76136571/161775726-fb67bb97-5fd1-45c5-8301-bbb17e2d0f1d.png\" width=\"569\" /></details><p> </p><details><summary><strong>VERSION INFO</strong></summary><p>v1.2 May 7 2022</p><p>jbowens #0415 (Discord)</p><p>https://github.com/jbowensii/More-Automated-Spells-Items-and-Feats.git</p></details>","chat":"","unidentified":""},"source":"PHB p74","activation":{"type":"special","cost":null,"condition":""},"duration":{"value":null,"units":"inst"},"cover":null,"target":{"value":1,"width":null,"units":"","type":"creature"},"range":{"value":null,"long":null,"units":""},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"attribute","target":"","amount":1},"ability":"str","actionType":"save","attackBonus":"0","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[["0 + @flags.dae.SuperiorityDie[Superiority]",""]],"versatile":""},"formula":"","save":{"ability":"wis","dc":null,"scaling":"str"},"type":{"value":"","subtype":""},"requirements":"Fighter: Battlemaster","recharge":{"value":null,"charged":false},"attunement":0},"ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1668460261749,"modifiedTime":1685305648289,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"_id":"2aKLnXXTVG345aqE"}
{"name":"Maneuvers: Grappling Strike","type":"feat","img":"icons/skills/melee/blade-tip-chipped-blood-red.webp","effects":[],"flags":{"ddbimporter":{"id":"53570","entityTypeId":"222216831","componentId":22,"componentTypeId":258900837,"class":"Fighter","subclass":"Battle Master","importId":"ye6nz9f4x9n3v7lu","ignoreIcon":true,"ignoreItemImport":true,"retainResourceConsumption":true},"infusions":{"infused":false},"obsidian":{"source":{"type":"class","text":"Fighter"}},"spellTemplateManager":{"stmData":{"ignoreDuration":false,"spellTexture":"","useTexture":false,"alpha":50,"coneOrigin":1,"loopAnimations":true}},"midi-qol":{"effectActivation":false,"onUseMacroName":"[postActiveEffects]ItemMacro","overTimeSkillRoll":"ath"},"midiProperties":{"nodam":false,"halfdam":false,"fulldam":false,"rollOther":false,"critOther":false,"concentration":false,"magicdam":false,"magiceffect":false,"toggleEffect":false,"ignoreTotalCover":false,"autoFailFriendly":false,"autoSaveFriendly":false,"offHandWeapon":false},"magicitems":{"enabled":false,"equipped":false,"attuned":false,"charges":"0","chargeType":"c1","destroy":false,"destroyFlavorText":"reaches 0 charges: it crumbles into ashes and is destroyed.","rechargeable":false,"recharge":"0","rechargeType":"t1","rechargeUnit":"r1","sorting":"l"},"itemacro":{"macro":{"data":{"_id":null,"name":"Maneuvers: Grappling Strike","type":"script","author":"ldRsJ6Yp5qPydWA1","img":"icons/svg/dice-target.svg","scope":"global","command":"/*****\nFighter Battlemaster Maneuvers: Grappling Strike\n\nUSEAGE : ACTIVATE AFTER ATTACK\nThis Maneuver must be activated AFTER the character makes an attack and knows that a HIT was successful.  \nThis will activate any bonuses, saves, effects and extra damage to the TARGET.  \nA Superiority Die will be expended immediately.\n\nv1.2 May 7 2022 jbowens #0415 (Discord) https://github.com/jbowensii/More-Automated-Spells-Items-and-Feats.git \n*****/\n\nif (args[0].macroPass === \"preSave\") {\n\n    // define Actor, Target and Item\n    const pcActor = MidiQOL.MQfromActorUuid(args[0].actorUuid);\n    const targetActor = args[0].targets[0].actor;\n    const theItem = MidiQOL.Workflow.getWorkflow(args[0].uuid).item;\n\n    // check to make sure only one target is selected\n    if ((args[0].targetUuids.length < 1) || (args[0].targetUuids.length > 1)) {\n        ui.notifications.error(\"You need to select a single target.\");\n        await incrementResource(pcActor, \"Superiority Dice\", 1);\n        return;\n    }\n\n    let superiorityDie = pcActor.getFlag(\"dae\", \"SuperiorityDie\");\n    if (superiorityDie === null) {\n        ui.notifications.error(\"Superiority Die feature is missing on the character sheet.\");\n        await incrementResource(pcActor, \"Superiority Dice\", 1);\n        return;\n    }\n\n    // Set the DC and setup the saving throw\n    let pcAthSkillTotal = pcActor.data.data.skills[\"ath\"].total;\n    const roll = await(new Roll(`1d20 + ${pcAthSkillTotal} + ${superiorityDie}`)).roll();\n    theItem.data.data.save.dc = roll.total;\n    theItem.data.data.save.scaling = \"flat\";\n\n    let skill = \"acr\";\n    if (targetActor.data.data.skills.ath.passive > targetActor.data.data.skills.acr.passive) skill = \"ath\";\n    setProperty(theItem.data.flags, \"midi-qol.overTimeSkillRoll\", skill);\n\n} else if (args[0].macroPass === \"postActiveEffects\") {\n    const item = MidiQOL.Workflow.getWorkflow(args[0].uuid).item;\n    item.data.data.save.ability = \"str\";\n}\nreturn;\n\n//---------------------------------- MY FUNCTIONS -------------------------------------------\n\n// Increment available resource\nasync function incrementResource(testActor, resourceName, numValue) {\n    let actorDup = duplicate(testActor);\n    let resources = Object.values(actorDup.data.resources);\n    let foundResource = resources.find(i => i.label.toLowerCase() === resourceName.toLowerCase());\n    if (foundrResource) {\n        foundResource.value = foundResource.value + numValue;\n        await testActor.update(actorDup);\n    } else ui.notifications.error(\"You have not setup a Superiority Dice resource.\");\n    return;\n}","folder":null,"sort":0,"permission":{"default":0},"flags":{}},"name":"Maneuvers: Grappling Strike  (Manual)","type":"script","scope":"global","command":"let me = canvas.tokens.controlled[0].actor;\nlet athRoll = await me.rollSkill(\"ath\");\n\nlet sourceActor = this.actor;\nlet SupDie = sourceActor.items.getName('Superiority Die');\nlet SupDieUses = SupDie.system.uses.value;\n         if (SupDieUses <= 0) return {};\n         if (!SupDie) {\n            ui.notifications.warn('Source actor does not appear to have a Superiority Die feature!');\n            return;}\nSupDie.update({'system.uses.value': SupDieUses - 1});\n\nconst pcActor = MidiQOL.MQfromActorUuid(args[0].actorUuid);\nconst fighterLevel = actor.getRollData().classes.fighter?.levels;\nif (fighterLevel > 17) superiorityDie = \"12\";\n   \telse if (fighterLevel > 9) superiorityDie = \"10\";\n  \telse if (fighterLevel > 0) superiorityDie = \"8\";\n\n\nlet suproll = await new Roll(`1d${superiorityDie}`).evaluate()\n  await suproll.toMessage({\n    flavor: \"Superiority Die\",\n    speaker: ChatMessage.getSpeaker({token: token.document})\n  })\n\nconst uuid = game.user.targets.first().actor.uuid;\nconst hasEffectApplied = game.dfreds.effectInterface.hasEffectApplied('Grappled', uuid);\n\nconst targets = Array.from(game.user.targets);\nlet target = Array.from(game.user.targets)[0];\nlet getAcr = target.actor.data.data.skills.acr.total;\nlet getAth = target.actor.data.data.skills.ath.total;\nlet bestSkill = getAcr > getAth ? \"acr\" : \"ath\";\nconst wait = async (ms) => new Promise((resolve)=> setTimeout(resolve, ms));\n\nfor (const target of targets) {\nawait game.MonksTokenBar.requestRoll(targets,{request:`skill:${bestSkill}`, silent: true});\nawait wait(11000)\nconst listMessages = game.messages.contents\nconst lastMessage = listMessages[listMessages.length - 1];\nlet tokenid = 'token'+target.id;\nlet saveRoll = lastMessage.data.flags[\"monks-tokenbar\"][tokenid].total\nlet saveDC = athRoll.total+suproll.total\nif (saveRoll < saveDC) {\nif (!hasEffectApplied) {\n  await game.dfreds.effectInterface.addEffect({ effectName: 'Grappled', uuid});\n  success = \"Agarrão com Sucesso\";\n  let the_message = `${me.name} <span style=\"color: blue\"><b> ${success}</b> </span> ${target.name}.`;\n    ChatMessage.create({\n    user: game.user._id,\n    speaker: ChatMessage.getSpeaker({actor: me}),\n    content: the_message,});\n   }\n }\n}","author":"Be8r6Sgxcs3sL08I","_id":null,"img":"icons/svg/dice-target.svg","folder":null,"sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null}}},"favtab":{"isFavorite":true},"scene-packer":{"hash":"7da3efb9c4921980239c7622f1322e072e73d6d0","sourceId":"Item.t5Mejpm54bIkDtzo"},"core":{"sourceId":"Item.bpSu08y0CydFPHEi"},"cf":{"id":"temp_pbbargtiogk","path":"Manobras - Battle Master Novo","color":"#b74e4e"},"exportSource":{"world":"test","system":"dnd5e","coreVersion":"9.269","systemVersion":"1.6.1"},"rest-recovery":{"data":{"recovery":{"enabled":false}}}},"system":{"description":{"value":"<p><strong>MARQUE O ALVO, CLIQUE.</strong></p><p><span style=\"font-family:'Helvetica Neue', Helvetica, Arial, sans-serif\">Immediately after you hit a creature with a melee attack on your turn, you can expend one superiority die and then try to grapple the target as a bonus action (see the Player's Handbook for rules on grappling). Add the superiority die to your Strength (Athletics) check.</span></p><p></p>","chat":"","unidentified":""},"source":"TCoE p42","activation":{"type":"bonus","cost":1,"condition":""},"duration":{"value":"","units":"inst"},"cover":null,"target":{"value":1,"width":null,"units":"","type":"creature"},"range":{"value":null,"long":null,"units":""},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"attribute","target":"","amount":1},"ability":"str","actionType":"other","attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"flat"},"type":{"value":"","subtype":""},"requirements":"Fighter: Battlemaster","recharge":{"value":null,"charged":false}},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1668460261776,"modifiedTime":1685305665909,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"_id":"2zrKieM0x9nC0gJF"}
{"name":"#[CF_tempEntity]","type":"weapon","flags":{"cf":{"id":"temp_l7snfkbanc","name":"Ranger","color":"#4dc421","fontColor":"#0a0a0a","icon":"","sorting":"m","contents":["pkcWXwxgirR9leT3"],"children":[]}},"img":"icons/svg/item-bag.svg","system":{"description":{"value":"","chat":"","unidentified":""},"source":"","quantity":1,"weight":0,"price":{"value":0,"denomination":"gp"},"attunement":0,"equipped":false,"rarity":"","identified":true,"activation":{"type":"","cost":null,"condition":""},"duration":{"value":"","units":""},"cover":null,"target":{"value":null,"width":null,"units":"","type":""},"range":{"value":null,"long":null,"units":""},"uses":{"value":null,"max":"","per":null,"recovery":""},"consume":{"type":"","target":null,"amount":null},"ability":null,"actionType":null,"attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"armor":{"value":null},"hp":{"value":null,"max":null,"dt":null,"conditions":""},"weaponType":"simpleM","baseItem":"","properties":{},"proficient":true},"effects":[],"folder":null,"sort":0,"ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1686175640442,"modifiedTime":1686175651040,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"_id":"3WV5BClsAsUKDv0A"}
{"name":"#[CF_tempEntity]","type":"weapon","flags":{"cf":{"id":"temp_arnwcbydlr","name":"Sorcerer","color":"#34aeb7","fontColor":"#000000","icon":"","sorting":"m","contents":["M0L5MgKcRckl3qLn","jTEHcbeil3nRk5I2"],"children":[]}},"img":"icons/svg/item-bag.svg","system":{"description":{"value":"","chat":"","unidentified":""},"source":"","quantity":1,"weight":0,"price":{"value":0,"denomination":"gp"},"attunement":0,"equipped":false,"rarity":"","identified":true,"activation":{"type":"","cost":null,"condition":""},"duration":{"value":"","units":""},"cover":null,"target":{"value":null,"width":null,"units":"","type":""},"range":{"value":null,"long":null,"units":""},"uses":{"value":null,"max":"","per":null,"recovery":""},"consume":{"type":"","target":null,"amount":null},"ability":null,"actionType":null,"attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"armor":{"value":null},"hp":{"value":null,"max":null,"dt":null,"conditions":""},"weaponType":"simpleM","baseItem":"","properties":{},"proficient":true},"effects":[],"folder":null,"sort":0,"ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1686175527644,"modifiedTime":1686175664528,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"_id":"3axjmP7eQ1jwTkvo"}
{"name":"Maneuvers: Commander’s Strike","type":"feat","img":"icons/skills/melee/weapons-crossed-swords-yellow.webp","effects":[{"_id":"tyr9bqr24wew5lex","changes":[{"key":"system.bonuses.All-Damage","mode":2,"value":"+1d((2*floor(((@classes.fighter.levels)-2)/8))+8)","priority":5}],"disabled":false,"duration":{"startTime":null,"rounds":1,"seconds":null,"combat":null,"turns":null,"startRound":null,"startTurn":null},"icon":"icons/skills/melee/weapons-crossed-swords-yellow.webp","label":"Maneuvers: Commander’s Strike","origin":"Actor.67GUmdTadYmGXD8W.Item.EbURPL9F8boGsK20","transfer":false,"flags":{"core":{"statusId":""},"dae":{"stackable":"none","durationExpression":"","macroRepeat":"none","specialDuration":["1Attack"],"transfer":false,"selfTarget":false,"selfTargetAlways":false},"ActiveAuras":{"isAura":false,"aura":"None","radius":"","alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"displayTemp":false,"hostile":false,"onlyOnce":false},"dfreds-convenient-effects":{"description":""}},"tint":null}],"flags":{"ddbimporter":{"id":"2439086","entityTypeId":"222216831","componentId":1306902,"componentTypeId":258900837,"class":"Fighter","subclass":"Battle Master","importId":"28pyz8r4w0vt0973"},"infusions":{"infused":false},"obsidian":{"source":{"type":"class","text":"Fighter"}},"scene-packer":{"hash":"b13bfd16b6a3c3e60f72110d7241dae140f20e36","sourceId":"Item.rZN9xErT3g3Nfwle"},"spellTemplateManager":{"stmData":{"ignoreDuration":false,"spellTexture":"","useTexture":false,"alpha":50,"coneOrigin":1,"loopAnimations":true}},"midi-qol":{"effectActivation":false,"onUseMacroName":"[postActiveEffects]ItemMacro"},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"autoFailFriendly":false,"autoSaveFriendly":false,"offHandWeapon":false,"ignoreTotalCover":false},"magicitems":{"enabled":false,"equipped":false,"attuned":false,"charges":"0","chargeType":"c1","destroy":false,"destroyFlavorText":"reaches 0 charges: it crumbles into ashes and is destroyed.","rechargeable":false,"recharge":"0","rechargeType":"t1","rechargeUnit":"r1","sorting":"l"},"favtab":{"isFavorite":true},"itemacro":{"macro":{"data":{"_id":null,"name":"Maneuvers: Brace","type":"script","author":"ldRsJ6Yp5qPydWA1","img":"icons/svg/dice-target.svg","scope":"global","command":"","folder":null,"sort":0,"permission":{"default":0},"flags":{}},"name":"Maneuvers: Commander’s Strike","type":"script","scope":"global","command":"let sourceActor = this.actor;\nlet SupDie = sourceActor.items.getName('Superiority Die');\nlet SupDieUses = SupDie.system.uses.value;\n      if (SupDieUses <= 0) return {};\n        if (!SupDie) {\n            ui.notifications.warn('Source actor does not appear to have a Bardic Inspiration feature!');\n            return;}\nSupDie.update({'system.uses.value': SupDieUses - 1});","author":"Be8r6Sgxcs3sL08I","_id":null,"img":"icons/svg/dice-target.svg","folder":null,"sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null}}},"core":{"sourceId":"Item.QCt9G1ryLky9enrK"},"cf":{"id":"temp_pbbargtiogk","path":"Manobras - Battle Master Novo","color":"#b74e4e"},"exportSource":{"world":"test","system":"dnd5e","coreVersion":"9.269","systemVersion":"1.6.1"},"rest-recovery":{"data":{"recovery":{"enabled":false}}}},"system":{"description":{"value":"<p><strong>INSTRUÇÃO: MARQUE O ALIADO COMO ALVO. CLIQUE NA SKILL. O MARCADO ATACA E GANHA O BONUS.</strong></p><p>When you take the Attack action on your turn, you can forgo one of your attacks and use a bonus action to direct one of your companions to strike. When you do so, choose a friendly creature who can see or hear you and expend one superiority die. That creature can immediately use its reaction to make one weapon attack, adding the superiority die to the attack's damage roll.</p><p></p><p></p>","chat":"","unidentified":""},"source":"PHB p74","activation":{"type":"special","cost":1,"condition":""},"duration":{"value":null,"units":""},"cover":null,"target":{"value":null,"width":null,"units":"","type":"creature"},"range":{"value":null,"long":null,"units":""},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"attribute","target":"","amount":1},"ability":"","actionType":"other","attackBonus":0,"chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"type":{"value":"","subtype":""},"requirements":"Fighter: Battlemaster","recharge":{"value":null,"charged":false},"attunement":0},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1668450899415,"modifiedTime":1685305448963,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"_id":"42lGKN4WGae14Gtj"}
{"name":"Sharpshooter","type":"feat","img":"modules/plutonium/media/icon/feat/phb-sharpshooter.webp","effects":[],"flags":{"srd5e":{"page":"feats.html","source":"PHB","hash":"sharpshooter_phb"},"scene-packer":{"hash":"9fd171752720474d437de9954299f196ea004f6f","sourceId":"Item.Kdf2scNnsUiJxiLF"},"siftoolkit":{"SIFData":{"ignoreDuration":false,"texture":"","useTexture":false,"alpha":50,"coneOrigin":1,"loopAnimations":true,"playTemplateAudio":false,"playDamageAudio":false,"playSaveAudio":false,"clip":"","volume":100}},"magicitems":{"enabled":false,"equipped":false,"attuned":false,"charges":"0","chargeType":"c1","destroy":false,"destroyFlavorText":"reaches 0 charges: it crumbles into ashes and is destroyed.","rechargeable":false,"recharge":"0","rechargeType":"t1","rechargeUnit":"r1","sorting":"l"},"midi-qol":{"effectActivation":false,"forceCEOff":true,"onUseMacroName":"[postActiveEffects]ItemMacro"},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false},"itemacro":{"macro":{"data":{"_id":null,"name":"Sharpshooter","type":"script","author":"RtW728LVc3YeOwN6","img":"icons/svg/dice-target.svg","scope":"global","command":"const uuid = canvas.tokens.controlled[0].actor.uuid;\nconst hasEffectApplied = await game.dfreds.effectInterface.hasEffectApplied('Sharpshooter', uuid);\n\nif (!hasEffectApplied) {\n  game.dfreds.effectInterface.addEffect({ effectName: 'Sharpshooter', uuid });\n} else {\ngame.dfreds.effectInterface.removeEffect({ effectName: 'Sharpshooter', uuid });\n}","folder":null,"sort":0,"permission":{"default":0},"flags":{}},"name":"Sharpshooter","type":"script","scope":"global","command":"// aplica o DF effect. Clicar novamente tira.\n\nconst uuid = canvas.tokens.controlled[0].actor.uuid;\nconst hasEffectApplied = await game.dfreds.effectInterface.hasEffectApplied('Sharpshooter', uuid);\nconst current = token.actor.getFlag(\"dnd5e\", \"helpersIgnoreCover\")\n\nif (!hasEffectApplied) {\n  game.dfreds.effectInterface.addEffect({ effectName: 'Sharpshooter', uuid });\n  token.actor.setFlag(\"dnd5e\", \"helpersIgnoreCover\", 2); \n}else {\ngame.dfreds.effectInterface.removeEffect({ effectName: 'Sharpshooter', uuid });\ntoken.actor.setFlag(\"dnd5e\", \"helpersIgnoreCover\", 0); }","author":"Be8r6Sgxcs3sL08I","_id":null,"img":"icons/svg/dice-target.svg","folder":null,"sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null}}},"core":{"sourceId":"Item.Kdf2scNnsUiJxiLF"},"cf":{"id":"temp_a5umw776e9r"},"rest-recovery":{"data":{"recovery":{"enabled":false}}}},"system":{"description":{"value":"<div><div class=\"rd__b  rd__b--3\"><p><strong>CLIQUE PARA USAR. CLIQUE NOVAMENTE PARA DESLIGAR.</strong></p><p></p><p>You have mastered ranged weapons and can make shots that others find impossible. You gain the following benefits:</p><div class=\"rd__spc-inline-post\"><p></p></div><ul class=\"rd__list\"><li class=\"rd__li \">Attacking at long range doesn't impose disadvantage on your ranged weapon attack rolls.</li><li class=\"rd__li \">Your ranged weapon attacks ignore half cover and three-quarters cover.</li><li class=\"rd__li \">Before you make an attack with a ranged weapon that you are proficient with, you can choose to take a -5 penalty to the attack roll. If the attack hits, you add +10 to the attack's damage.</li></ul></div></div>","chat":"","unidentified":""},"source":"PHB","activation":{"type":"special","cost":1,"condition":""},"duration":{"value":0,"units":""},"target":{"value":null,"width":null,"units":"","type":"self"},"range":{"value":null,"long":null,"units":"self"},"uses":{"value":0,"max":"0","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"other","attackBonus":null,"chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"requirements":"","recharge":{"value":0,"charged":true}},"ownership":{"default":0,"7kalUs4ntSwRjAK4":3,"RtW728LVc3YeOwN6":3,"Be8r6Sgxcs3sL08I":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.0.3","coreVersion":"10.290","createdTime":1668518710237,"modifiedTime":1668521047511,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"_id":"5jEcb3i1e8neRf83"}
{"name":"Berserk","type":"feat","system":{"description":{"value":"<div class=\"rd__b  rd__b--3\"><p>Whenever the golem starts its turn with 40 hit points or fewer, roll a [[/r d6]]. On a 6, the golem goes berserk. On each of its turns while berserk, the golem attacks the nearest creature it can see. If no creature is near enough to move to and attack, the golem attacks an object, with preference for an object smaller than itself. Once the golem goes berserk, it continues to do so until it is destroyed or regains all its hit points.</p><div class=\"rd__spc-inline-post\"></div><p>The golem's creator, if within 60 feet of the berserk golem, can try to calm it by speaking firmly and persuasively. The golem must be able to hear its creator, who must take an action to make a DC <span class=\"rd__dc\">15</span> Charisma (Persuasion) check. If the check succeeds, the golem ceases being berserk. If it takes damage while still at 40 hit points or fewer, the golem might go berserk again.</p></div>","chat":"","unidentified":""},"source":"MM","activation":{"type":"","cost":0,"condition":""},"duration":{"value":null,"units":""},"target":{"value":null,"width":null,"units":"","type":""},"range":{"value":null,"long":null,"units":""},"uses":{"value":null,"max":"","per":null,"recovery":""},"consume":{"type":null,"target":null,"amount":null},"ability":"","actionType":"save","attackBonus":0,"chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"cha","dc":15,"scaling":"str"},"requirements":"","recharge":{"value":null,"charged":false}},"img":"icons/creatures/reptiles/lizard-mouth-glowing-red.webp","flags":{"plutonium":{"page":"monsterTrait","source":"MM","hash":"berserk_flesh%20golem_mm_mm"},"midi-qol":{"effectActivation":false},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false},"magicitems":{"enabled":false,"equipped":false,"attuned":false,"charges":"0","chargeType":"c1","destroy":false,"destroyFlavorText":"reaches 0 charges: it crumbles into ashes and is destroyed.","rechargeable":false,"recharge":"0","rechargeType":"t1","rechargeUnit":"r1","sorting":"l"},"core":{"sourceId":"Scene.V3MxnI9gjrfdinfI.Token.IS9rhGCukYJybIgC.Item.CiNA0pEYTXtSnkYe"},"cf":{"id":"temp_9j6qvpvxiy"}},"effects":[{"label":"Berserk","icon":"icons/creatures/reptiles/lizard-mouth-glowing-red.webp","changes":[],"transfer":true,"_id":"5AduO1YxrCjP3PQi","disabled":false,"duration":{"startTime":null,"seconds":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"origin":null,"tint":null,"flags":{"effectmacro":{"onTurnStart":{"script":"let me = canvas.tokens.controlled[0]\nconst value = me.actor.data.data.attributes.hp.value\nconst uuid = canvas.tokens.controlled[0].actor.uuid\nif (value < 40) {\nconst rolltest = await new Roll(\"1d6\").evaluate()\nrolltest.toMessage();\n\nif (rolltest.total > 5) {\nconst effect = actor.effects.find(e => e.data.label === \"Berserk\");\nawait actor.deleteEmbeddedDocuments(\"ActiveEffect\", [effect.id]);\ngame.dfreds.effectInterface.addEffect({ effectName: 'Berserk Golem', uuid })\n} else {return{}}\n} else {return{}}"}},"dae":{"selfTarget":false,"selfTargetAlways":false,"stackable":"none","durationExpression":"","macroRepeat":"none","specialDuration":[]},"core":{"statusId":""},"ActiveAuras":{"isAura":false,"aura":"None","radius":null,"alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"displayTemp":false,"hostile":false,"onlyOnce":false}}}],"ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.0.3","coreVersion":"10.290","createdTime":1670193851147,"modifiedTime":1670205385132,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"_id":"72sCYo0RfzrFUvdM"}
{"name":"Pact of the Blade","type":"feat","img":"icons/skills/melee/weapons-crossed-swords-teal.webp","effects":[{"_id":"rdzjc17hnpzeair1","changes":[{"key":"macro.itemMacro","mode":0,"value":"","priority":20}],"disabled":false,"duration":{"startTime":null,"seconds":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"icon":"icons/skills/melee/weapons-crossed-swords-teal.webp","label":"Pact Weapon","origin":"Actor.UCbX5ijUdxjuah9y.Item.P8nGLulRWB80PKA3","transfer":false,"flags":{"dae":{"selfTarget":false,"stackable":"none","durationExpression":"","macroRepeat":"none","specialDuration":[],"transfer":false},"core":{"statusId":""}},"tint":null}],"flags":{"core":{"sourceId":"Compendium.dnd5e.classfeatures.9dSSa68mIPoX2ezA"},"scene-packer":{"hash":"aff9b2a87a3046a56cc8a42c073147760f102371","sourceId":"Item.sBt7w78mvhbgLOLs"},"midi-qol":{"effectActivation":false},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"autoFailFriendly":false,"offHandWeapon":false,"ignoreTotalCover":false,"autoSaveFriendly":false},"itemacro":{"macro":{"_id":null,"name":"Pact of the Blade","type":"script","author":"DnCk9xKG0jv0KBqj","img":"icons/svg/dice-target.svg","scope":"global","command":"const folderName = \"Melee Weapons\"; // Criar pasta contendo apenas armas corpo-a-corpo\nconst lastArg = args[args.length - 1];\nconst actor = game.actors.get(lastArg.actorId);\n\nif ( args[0] === \"on\" ) {\n\tconst weapons = game.items.filter(i => i.folder?.name === folderName);\n\tconst options = weapons.map(w => `<option value=${w.id}>${w.name}</option>`).join(\"\");\n\tnew Dialog({\n\t\ttitle: \"Pact of the Blade: Usage Configuration\",\n\t\tcontent: `<form><div class=\"form-group\"><label>Choose weapon form:</label><select id=\"pact-weapon\">${options}</select></div></form>`,\n\t\tbuttons: {\n\t\t\tcancel: {\n\t\t\t\tlabel: \"Cancel\",\n\t\t\t\ticon: '<i class=\"fas fa-times\"></i>'\n\t\t\t},\n\t\t\tok: {\n\t\t\t\tlabel: \"Ok\",\n\t\t\t\ticon: '<i class=\"fas fa-check\"></i>',\n\t\t\t\tcallback: async html => {\n\t\t\t\t\tconst weaponId = html.find(\"#pact-weapon\")[0].value;\n\t\t\t\t\tconst weaponData = game.items.get(weaponId).toObject();\n\t\t\t\t\tChatMessage.create({\n\t\t\t\t\t\tspeaker: ChatMessage.getSpeaker({actor}),\n\t\t\t\t\t\tcontent: `${weaponData.name} created as Pact Weapon.`\n\t\t\t\t\t});\n\t\t\t\t\tweaponData.data.proficient = true;\n\t\t\t\t\tweaponData.data.properties.mgc = true;\n\t\t\t\t\tweaponData.name = `${weaponData.name} [Pact Weapon]`;\n\t\t\t\t\tconst [pactWeapon] = await actor.createEmbeddedDocuments(\"Item\", [weaponData]);\n\t\t\t\t\tactor.setFlag(\"world\", \"pactWeaponId\", pactWeapon.id);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\trender: html => html.find(\"select\").focus(),\n\t\tdefault: \"ok\"\n\t}).render(true);\n}\n\nif ( args[0] === \"off\" ) {\n\tconst pactWeaponId = actor.getFlag(\"world\", \"pactWeaponId\");\n\tif ( !actor.items.get(pactWeaponId) ) return;\n\tactor.deleteEmbeddedDocuments(\"Item\", [pactWeaponId]);\n\tactor.unsetFlag(\"world\", \"pactWeaponId\");\n}","folder":null,"sort":0,"permission":{"default":0},"flags":{}}},"exportSource":{"world":"2","system":"dnd5e","coreVersion":"9.280","systemVersion":"1.6.3"},"rest-recovery":{"data":{"recovery":{"enabled":false}}},"magicitems":{"enabled":false,"equipped":false,"attuned":false,"charges":"0","chargeType":"c1","destroy":false,"destroyFlavorText":"reaches 0 charges: it crumbles into ashes and is destroyed.","rechargeable":false,"recharge":"0","rechargeType":"t1","rechargeUnit":"r1","sorting":"l"},"cf":{"id":"temp_xkcn7ug77da"}},"system":{"description":{"value":"<p>You can use your action to create a pact weapon in your empty hand. You can choose the form that this melee weapon takes each time you create it. You are proficient with it while you wield it. This weapon counts as magical for the purpose of overcoming resistance and immunity to nonmagical attacks and damage.</p><p>Your pact weapon disappears if it is more than 5 feet away from you for 1 minute or more. It also disappears if you use this feature again, if you dismiss the weapon (no action required), or if you die.</p><p>You can transform one magic weapon into your pact weapon by performing a special ritual while you hold the weapon. You perform the ritual over the course of 1 hour, which can be done during a short rest. You can then dismiss the weapon, shunting it into an extradimensional space, and it appears whenever you create your pact weapon thereafter. You can't affect an artifact or a sentient weapon in this way. The weapon ceases being your pact weapon if you die, if you perform the 1-hour ritual on a different weapon, or if you use a 1-hour ritual to break your bond to it. The weapon appears at your feet if it is in the extradimensional space when the bond breaks.</p>","chat":"","unidentified":""},"source":"PHB pg. 107","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":null,"units":""},"cover":null,"target":{"value":null,"width":null,"units":"","type":"self"},"range":{"value":null,"long":null,"units":""},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"util","attackBonus":0,"chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"type":{"value":"","subtype":""},"requirements":"Warlock 3","recharge":{"value":null,"charged":false},"attunement":0},"ownership":{"default":0,"Be8r6Sgxcs3sL08I":3,"05k4ub2VgC3VLxAg":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1672591446048,"modifiedTime":1686175596447,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"_id":"771NEJjgU7nb9lqL"}
{"name":"Maneuvers: Disarming Attack","type":"feat","img":"icons/skills/melee/blade-tip-chipped-blood-red.webp","effects":[{"label":"Maneuvers: Disarming Attack","icon":"icons/skills/melee/blade-tip-chipped-blood-red.webp","changes":[{"key":"flags.dnd5e.DamageBonusMacro","mode":0,"value":"ItemMacro","priority":20}],"transfer":true,"_id":"I4M2F9fecPcRB5aV","disabled":false,"duration":{"startTime":null,"seconds":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"origin":null,"tint":null,"flags":{"dae":{"selfTarget":false,"selfTargetAlways":false,"stackable":"none","durationExpression":"","macroRepeat":"none","specialDuration":[]},"core":{"statusId":""},"ActiveAuras":{"isAura":false,"aura":"None","radius":null,"alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"displayTemp":false,"hostile":false,"onlyOnce":false}}}],"flags":{"ddbimporter":{"id":"2439086","entityTypeId":"222216831","componentId":1306902,"componentTypeId":258900837,"class":"Fighter","subclass":"Battle Master","importId":"28pyz8r4w0vt0973"},"infusions":{"infused":false},"obsidian":{"source":{"type":"class","text":"Fighter"}},"scene-packer":{"hash":"b13bfd16b6a3c3e60f72110d7241dae140f20e36","sourceId":"Item.rZN9xErT3g3Nfwle"},"spellTemplateManager":{"stmData":{"ignoreDuration":false,"spellTexture":"","useTexture":false,"alpha":50,"coneOrigin":1,"loopAnimations":true}},"midi-qol":{"effectActivation":false,"onUseMacroName":""},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false},"magicitems":{"enabled":false,"equipped":false,"attuned":false,"charges":"0","chargeType":"c1","destroy":false,"destroyFlavorText":"reaches 0 charges: it crumbles into ashes and is destroyed.","rechargeable":false,"recharge":"0","rechargeType":"t1","rechargeUnit":"r1","sorting":"l"},"favtab":{"isFavorite":true},"itemacro":{"macro":{"data":{"_id":null,"name":"Maneuvers: Brace","type":"script","author":"ldRsJ6Yp5qPydWA1","img":"icons/svg/dice-target.svg","scope":"global","command":"","folder":null,"sort":0,"permission":{"default":0},"flags":{}},"name":"Maneuvers: Disarming Attack","type":"script","scope":"global","command":"if (args[0].hitTargets.length < 1) return {};\nlet sourceActor = this.actor;\nlet SupDie = sourceActor.items.getName('Superiority Die');\nlet SupDieUses = SupDie.system.uses.value;\n      if (SupDieUses <= 0) return {};\n        if (!SupDie) {\n            ui.notifications.warn('Source actor does not appear to have a Bardic Inspiration feature!');\n            return;}\n            \nconst pcActor = MidiQOL.MQfromActorUuid(args[0].actorUuid);\n\tconst dActor = canvas.tokens.controlled[0].actor;\n\tconst fighterLevel = actor.getRollData().classes.fighter?.levels;\n\n\tif (fighterLevel > 17) superiorityDie = \"12\";\n   \t else if (fighterLevel > 9) superiorityDie = \"10\";\n  \t else if (fighterLevel > 0) superiorityDie = \"8\";\n\nlet dialog = new Promise((resolve, reject) => {\n        new Dialog({\n            // localize this text\n            title: \"Battle Master:Disarming Attack\",\n            content: \"<p>Deseja usar o Battle Master:Disarming Attack (+1 dado dano e chance disarmar)?</p>\",\n            buttons: {\n                one: {\n                    icon: '<p> </p><img src = \"icons/svg/light.svg\" width=\"60\" height=\"60\"></>',\n                    label: \"<p>Sim</p>\",\n                    callback: () => resolve(\"SIM\")\n                },\n                two: {\n                    icon: '<p> </p><img src = \"icons/svg/hazard.svg\" width=\"60\" height=\"60\"></>',\n                    label: \"<p>Não</p>\",\n                    callback: () => { resolve(\"NAO\") }\n                }\n            },\n            default: \"two\"\n        }).render(true);\n    });\n\n    let choiceACBonus = await dialog;\n    const baseDice = 1\n    if (choiceACBonus === \"SIM\") {\nSupDie.update({'system.uses.value': SupDieUses - 1});\nconst targets = Array.from(game.user.targets);\nfor (const target of targets) {\nawait game.MonksTokenBar.requestRoll(targets,{request:\"save:str\", silent: true});\n}\n    const diceMult = args[0].isCritical ? 2: 1;\n    return {damageRoll: `${diceMult}d${superiorityDie}`, flavor: \"Disarming Attack\"};\n} \nelse {return}","author":"Be8r6Sgxcs3sL08I","_id":null,"img":"icons/svg/dice-target.svg","folder":null,"sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null}}},"core":{"sourceId":"Item.QCt9G1ryLky9enrK"},"cf":{"id":"temp_pbbargtiogk","path":"Manobras - Battle Master Novo","color":"#b74e4e"},"exportSource":{"world":"test","system":"dnd5e","coreVersion":"9.269","systemVersion":"1.6.1"},"rest-recovery":{"data":{"recovery":{"enabled":false}}}},"system":{"description":{"value":"<p><strong>NÃO USE A SKILL. ATAQUE NORMALMENTE. ESCOLHA SE VAI USAR O DANO EXTRA (SÓ APARECE SE ACERTAR). SE USAR VAI APARECER UM TESTE PARA O ALVO. COMPARE MANUALMENTE COM SEU DC.</strong></p><p>When you hit a creature with a weapon attack, you can expend one superiority die to attempt to disarm the target, forcing it to drop one item of your choice that it's holding. You add the superiority die to the attack's damage roll, and the target must make a Strength saving throw. On a failed save, it drops the object you choose. The object lands at its feet.</p><p><span style=\"font-family:Signika, sans-serif\">SAVE DC = 8 + your proficiency bonus + your Strength or Dexterity modifier (your choice)</span></p>","chat":"","unidentified":""},"source":"PHB p74","activation":{"type":"special","cost":1,"condition":""},"duration":{"value":null,"units":""},"cover":null,"target":{"value":null,"width":null,"units":"","type":"self"},"range":{"value":null,"long":null,"units":"self"},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"attribute","target":"","amount":1},"ability":"","actionType":"","attackBonus":0,"chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"type":{"value":"","subtype":""},"requirements":"Fighter: Battlemaster","recharge":{"value":null,"charged":false},"attunement":0},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1668450899415,"modifiedTime":1685300189634,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"_id":"7AwS2jy8smavcjOF"}
{"name":"#[CF_tempEntity]","type":"weapon","flags":{"cf":{"id":"temp_mt8pdupg5f","name":"Paladin","color":"#e4de25","fontColor":"#1c1c1c","icon":"","sorting":"m","contents":["1f2ijhqxOr4FPVeT","psp5X0ES66RwIiXc"],"children":[]}},"img":"icons/svg/item-bag.svg","system":{"description":{"value":"","chat":"","unidentified":""},"source":"","quantity":1,"weight":0,"price":{"value":0,"denomination":"gp"},"attunement":0,"equipped":false,"rarity":"","identified":true,"activation":{"type":"","cost":null,"condition":""},"duration":{"value":"","units":""},"cover":null,"target":{"value":null,"width":null,"units":"","type":""},"range":{"value":null,"long":null,"units":""},"uses":{"value":null,"max":"","per":null,"recovery":""},"consume":{"type":"","target":null,"amount":null},"ability":null,"actionType":null,"attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"armor":{"value":null},"hp":{"value":null,"max":null,"dt":null,"conditions":""},"weaponType":"simpleM","baseItem":"","properties":{},"proficient":true},"effects":[],"folder":null,"sort":0,"ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1685907149601,"modifiedTime":1686175617570,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"_id":"DBGqtxqyQJgYfTYT"}
{"name":"Maneuvers: Precision Attack","type":"feat","img":"icons/skills/melee/strike-sword-steel-yellow.webp","effects":[{"_id":"og6qejg1f0p7b8ws","changes":[{"key":"flags.midi-qol.onUseMacroName","mode":0,"value":"ItemMacro.Maneuvers: Precision Attack,preCheckHits","priority":1}],"disabled":false,"duration":{"startTime":null,"seconds":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"icon":"icons/skills/melee/strike-sword-steel-yellow.webp","label":"Maneuvers: Precision Attack","origin":"Actor.67GUmdTadYmGXD8W.Item.RryNpmf0SaXo2jua","transfer":true,"flags":{"core":{"statusId":""},"dae":{"stackable":"none","durationExpression":"","macroRepeat":"none","specialDuration":[],"transfer":true,"selfTarget":false,"selfTargetAlways":false},"ActiveAuras":{"isAura":false,"aura":"None","radius":null,"alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"displayTemp":false,"hostile":false,"onlyOnce":false}},"tint":null}],"flags":{"ddbimporter":{"id":"53565","entityTypeId":"222216831","componentId":17,"componentTypeId":258900837,"class":"Fighter","subclass":"Battle Master","importId":"28pyz8r4w0vt0973"},"infusions":{"infused":false},"obsidian":{"source":{"type":"class","text":"Fighter"}},"scene-packer":{"hash":"bbbf69e0d31acc1da5db1f8561a179bd9d62bc06","sourceId":"Item.lJsVElwBNGj9xuB1"},"spellTemplateManager":{"stmData":{"ignoreDuration":false,"spellTexture":"","useTexture":false,"alpha":50,"coneOrigin":1,"loopAnimations":true}},"midi-qol":{"effectActivation":false},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false,"autoFailFriendly":false,"autoSaveFriendly":false,"offHandWeapon":false},"magicitems":{"enabled":false,"equipped":false,"attuned":false,"charges":"0","chargeType":"c1","destroy":false,"destroyFlavorText":"reaches 0 charges: it crumbles into ashes and is destroyed.","rechargeable":false,"recharge":"0","rechargeType":"t1","rechargeUnit":"r1","sorting":"l"},"itemacro":{"macro":{"data":{"_id":null,"name":"Maneuvers: Precision Attack","type":"script","author":"ldRsJ6Yp5qPydWA1","img":"icons/svg/dice-target.svg","scope":"global","command":"/*****\nFighter Battlemaster Maneuver: Precision Attack\n\nUSEAGE : PLACE HOLDER\nThis item should be placed on the character that has the Precision Attack Manuever.  \nThis items places an effect on the Actor that allows the rolling of a Superiority Die to \nbe added to the attack Roll before the TO HIT is evaluated.\n\nv1.2 May 7 2022 jbowens #0415 (Discord) https://github.com/jbowensii/More-Automated-Spells-Items-and-Feats.git \n*****/\nconst workflow = MidiQOL.Workflow.getWorkflow(args[0].uuid);\n\nif (args[0].macroPass === \"preCheckHits\") {\n    const theItem = workflow;\n\n    if ((theItem != null) && (theItem.name != \"Maneuvers: Precision Attack\")) {\n        // define Actor, Target and Item\n        const pcActor = MidiQOL.MQfromActorUuid(args[0].actorUuid);\n\n        // Find Superiority Dice Resource\n        let resource = await findSheetResource(pcActor, \"Superiority Dice\");\n        if (!resource) {\n            ui.notifications.error(\"Could not find a recource labeled 'Superiority Dice'...\");\n            return;\n        }\n\n        // No more Superiority Dice\n        let superiorityDice = resource.value;\n        if (superiorityDice < 1) return;\n\n        // check to make sure only one target is selected\n        if ((args[0].targetUuids.length < 1) || (args[0].targetUuids.length > 1)) {\n            ui.notifications.error(\"You need to select a single target.\");\n            return;\n        }\n\n        let superiorityDie = pcActor.getFlag(\"dae\", \"SuperiorityDie\");\n        if (superiorityDie === null) {\n            ui.notifications.error(\"You are not a fighter battle master of at least 3rd level!\");\n            return;\n        }\n\n        // make sure the attempted hit was made with a weapon attack\n        if (![\"mwak\", \"rwak\"].includes(args[0].item.data.actionType)) {\n            ui.notifications.error(\"Precision Attack only works with a weapon attack\");\n            return;\n        }\n\n        // create a dialog and prompt to spend a superiority die\n        let useSuperiorityDie = false;\n        if (superiorityDice > 0) {\n            let dialog = new Promise((resolve, reject) => {\n                new Dialog({\n                    // localize this text\n                    title: \"Battle Master: Precision Attack\",\n                    content: \"<p>Use Precision Attack (cost 1 Superiority Die)?</p>\",\n                    buttons: {\n                        one: {\n                            icon: '<p> </p><img src = \"icons/skills/targeting/crosshair-triple-strike-orange.webp\" width=\"60\" height=\"60\"></>',\n                            label: \"<p>Yes</p>\",\n                            callback: () => resolve(true)\n                        },\n                        two: {\n                            icon: '<p> </p><img src = \"systems/dnd5e/icons/skills/weapon_28.jpg\" width=\"60\" height=\"60\"></>',\n                            label: \"<p>No</p>\",\n                            callback: () => { resolve(false) }\n                        }\n                    },\n                    default: \"two\"\n                }).render(true);\n            });\n            useSuperiorityDie = await dialog;\n        } else return;\n\n        if (!useSuperiorityDie) return;\n\n        // if YES subtract a superiorty die\n        await decrimentSheetResource(pcActor, \"Superiority Dice\", 1);\n\n        // get the live MIDI-QOL workflow so we can make changes\n        let newRoll = new Roll(`${workflow.attackRoll.result} + ${superiorityDie}`, workflow.actor.getRollData());\n        newRoll = await newRoll.evaluate({ async: true });\n        workflow.attackRoll = newRoll;\n        workflow.attackRollTotal = newRoll.total;\n        workflow.attackRollHTML = await workflow.attackRoll.render(newRoll);\n\n        return;\n    }\n}\nreturn;\n\n//---------------------------------- MY FUNCTIONS -------------------------------------\n\n// Test for available resource\n// Return resource object\nasync function findSheetResource(testActor, resourceName) {\n    let resources = Object.values(testActor.data.data.resources);\n    let foundResource = resources.find(i => i.label.toLowerCase() === resourceName.toLowerCase());\n    return foundResource;\n}\n\n// Decriment available resource\nasync function decrimentSheetResource(testActor, resourceName, numValue) {\n    let actorDup = duplicate(testActor);\n    let resources = Object.values(actorDup.data.resources);\n    let foundResource = resources.find(i => i.label.toLowerCase() === resourceName.toLowerCase());\n    foundResource.value = foundResource.value - numValue;\n    await testActor.update(actorDup);\n    return;\n}","folder":null,"sort":0,"permission":{"default":0},"flags":{}},"name":"Maneuvers: Precision Attack","type":"script","scope":"global","command":"let sourceActor = this.actor;\nlet SupDie = sourceActor.items.getName('Superiority Die');\nlet SupDieUses = SupDie.system.uses.value;\n         if (SupDieUses <= 0) return {};\n         if (!SupDie) {\n            ui.notifications.warn('Source actor does not appear to have a Superiority Die feature!');\n            return;}\n\nconst pcActor = MidiQOL.MQfromActorUuid(args[0].actorUuid);\n\tconst dActor = canvas.tokens.controlled[0].actor;\n\tconst fighterLevel = actor.getRollData().classes.fighter?.levels;\n\tif (fighterLevel > 17) superiorityDie = \"12\";\n   \t else if (fighterLevel > 9) superiorityDie = \"10\";\n  \t else if (fighterLevel > 0) superiorityDie = \"8\";\n\nconst workflow = MidiQOL.Workflow.getWorkflow(args[0].uuid);\n\nif (args[0].macroPass === \"preCheckHits\") {\n    const theItem = workflow;\n\n    if ((theItem != null) && (theItem.name != \"Maneuvers: Precision Attack\")) {\n        // define Actor, Target and Item\n        const pcActor = MidiQOL.MQfromActorUuid(args[0].actorUuid);\n\n        // check to make sure only one target is selected\n        if ((args[0].targetUuids.length < 1) || (args[0].targetUuids.length > 1)) {\n            ui.notifications.error(\"You need to select a single target.\");\n            return;\n        }\n\n        // make sure the attempted hit was made with a weapon attack\n        if (![\"mwak\", \"rwak\"].includes(args[0].item.data.actionType)) {\n            ui.notifications.error(\"Precision Attack only works with a weapon attack\");\n            return;\n        }\n\n        // create a dialog and prompt to spend a superiority die\n        let useSuperiorityDie = false;\n        if (SupDieUses > 0) {\n            let dialog = new Promise((resolve, reject) => {\n                new Dialog({\n                    // localize this text\n                    title: \"Battle Master: Precision Attack\",\n                    content: `<p>Use Precision Attack <b>(Attack roll = ${workflow.attackRoll.total})</b>?</p>`,\n                    buttons: {\n                        one: {\n                            icon: '<p> </p><img src = \"icons/svg/light.svg\" width=\"60\" height=\"60\"></>',\n                            label: \"<p>Yes</p>\",\n                            callback: () => resolve(true)\n                        },\n                        two: {\n                            icon: '<p> </p><img src = \"icons/svg/hazard.svg\" width=\"60\" height=\"60\"></>',\n                            label: \"<p>No</p>\",\n                            callback: () => { resolve(false) }\n                        }\n                    },\n                    default: \"two\"\n                }).render(true);\n            });\n            useSuperiorityDie = await dialog;\n        } else return;\n\n        if (!useSuperiorityDie) return;\n\n        // if YES subtract a superiorty die\n        SupDie.update({'system.uses.value': SupDieUses - 1});\n\n        // get the live MIDI-QOL workflow so we can make changes\n        let newRoll = new Roll(`${workflow.attackRoll.result} + 1d${superiorityDie}`, workflow.actor.getRollData());\n        newRoll = await newRoll.evaluate({ async: true });\n        workflow.attackRoll = newRoll;\n        workflow.attackRollTotal = newRoll.total;\n        workflow.attackRollHTML = await workflow.attackRoll.render(newRoll);\n\n        return;\n    }\n}\nreturn;","author":"Be8r6Sgxcs3sL08I","_id":null,"img":"icons/svg/dice-target.svg","folder":null,"sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null}}},"core":{"sourceId":"Item.agdqkK2J5m95X9ww"},"favtab":{"isFavorite":true},"cf":{"id":"temp_pbbargtiogk","path":"Manobras - Battle Master Novo","color":"#b74e4e"},"exportSource":{"world":"test","system":"dnd5e","coreVersion":"9.269","systemVersion":"1.6.1"},"rest-recovery":{"data":{"recovery":{"enabled":false}}}},"system":{"description":{"value":"<p><strong>NÃO USE A SKILL. ATAQUE NORMALMENTE. VAI ROLAR O DADO DE ATK E MOSTRAR O RESULTADO. SE VC QUISER USAR ELE VAI ROLAR O DADO PARA SOMAR NO ATK.</strong></p><p><span style=\"font-family:'Helvetica Neue', Helvetica, Arial, sans-serif\">When you make a weapon attack roll against a creature, you can expend one superiority die to add it to the roll. You can use this maneuver before or after making the attack roll, but before any effects of the attack are applied.</span></p><p></p><p></p><p></p><details><summary></summary><p>v1.2 May 7 2022</p><p>jbowens #0415 (Discord)</p><p>https://github.com/jbowensii/More-Automated-Spells-Items-and-Feats.git</p></details>","chat":"","unidentified":""},"source":"PHB p74","activation":{"type":"special","cost":1,"condition":""},"duration":{"value":null,"units":""},"cover":null,"target":{"value":null,"width":null,"units":"","type":"self"},"range":{"value":null,"long":null,"units":""},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"attribute","target":"","amount":1},"ability":"","actionType":"other","attackBonus":0,"chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"type":{"value":"","subtype":""},"requirements":"Fighter: Battlemaster","recharge":{"value":null,"charged":false},"attunement":0},"ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1668460261762,"modifiedTime":1685300192175,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"_id":"Ef0QhFbkvRxgLt5B"}
{"_id":"FHRLqeAelrKvxWqQ","name":"Defensive Flourish","type":"feat","img":"icons/equipment/shield/heater-crystal-blue.webp","effects":[{"_id":"udWHSFElMFDSxSdR","changes":[{"key":"flags.dnd5e.DamageBonusMacro","mode":0,"value":"ItemMacro.Defensive Flourish","priority":30}],"disabled":false,"duration":{"startTime":null,"seconds":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"icon":"systems/dnd5e/icons/skills/weapon_16.jpg","label":"Defensive Flourish","transfer":true,"flags":{"dae":{"stackable":"none","macroRepeat":"none","specialDuration":[],"transfer":true},"ActiveAuras":{"isAura":false,"aura":"None","radius":null,"alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"hostile":false,"onlyOnce":false}},"tint":null,"origin":null}],"folder":null,"sort":0,"flags":{"srd5e":{"page":"classfeatures.html","source":"XGE","hash":"defensive%20flourish_bard_xge_swords_xge_3_xge"},"spellTemplateManager":{"stmData":{"ignoreDuration":false,"spellTexture":"","useTexture":false,"alpha":50,"coneOrigin":1,"loopAnimations":true}},"midi-qol":{"onUseMacroName":"","criticalThreshold":"20","effectActivation":false},"magicitems":{"enabled":false,"equipped":false,"attuned":false,"charges":"0","chargeType":"c1","destroy":false,"destroyFlavorText":"reaches 0 charges: it crumbles into ashes and is destroyed.","rechargeable":false,"recharge":"0","rechargeType":"t1","rechargeUnit":"r1","sorting":"l"},"core":{"sourceId":"Item.GBtHJIfJjufFkUzW"},"itemacro":{"macro":{"data":{"_id":null,"name":"Defensive Flourish2","type":"script","author":"rbM5nB1AbUwbj4yJ","img":"icons/svg/dice-target.svg","scope":"global","command":"//Defensive Flourish\n// v1.0. Requires midi-qol and times-up.\n\n//hit?\nif (![\"mwak\",\"rwak\"].includes(args[0].item.data.actionType)) return {}; // weapon attack\nif (args[0].hitTargets.length < 1) return {};\ntoken = canvas.tokens.get(args[0].tokenId);\nactor = token.actor;\nif (!actor || !token || args[0].hitTargets.length < 1) return {};\nlet target = canvas.tokens.get(args[0].hitTargets[0]._id);\nif (game.combat) {\n  let combatTime = game.combat.round + game.combat.turn /100;\n  let lastTime = getProperty(token.data.flags, \"midi-qol.flourishAttackTime\");\n  if (combatTime === lastTime) {\n   MidiQOL.warn(\"Blade Flourish Damage: Already done a Blade Flourish this turn\");\n   return {};\n  }\n}\nlet foundEnemy = true;\nlet useSneak = actor.data.flags.dae?.autoSneak;\nif (!useSneak) {\nlet dialog = new Promise((resolve, reject) => {\n      new Dialog({\n      // localize this text\n      title: \"Conditional Damage\",\n      content: `<p>Use Defensive Flourish?</p>`+(!foundEnemy ? \"<p>Only Nuetral creatures nearby</p>\" : \"\"),\n      buttons: {\n          one: {\n              icon: '<i class=\"fas fa-check\"></i>',\n              label: \"Confirm\",\n              callback: () => resolve(true)\n          },\n          two: {\n              icon: '<i class=\"fas fa-times\"></i>',\n              label: \"Cancel\",\n              callback: () => {resolve(false)}\n          }\n      },\n      default: \"two\"\n      }).render(true);\n    });\n    useSneak = await dialog;\n}\n\n\n//roll\nconst level = actor.items.getName(\"Bard\").data.data.levels;\nlet bardicDice = level < 5 ? 6 : level >= 5 ? 8 : level >= 15 ? 12 : null;\nconst roll = new Roll(`1d${bardicDice}`);\nroll.toMessage({});\n\n\n// create effect\nconst effect = {\nlabel: \"Defensive Flourish\", icon: \"systems/dnd5e/icons/skills/weapon_16.jpg\", \nchanges: [{value: `${roll.terms[0].total}`, mode: CONST.ACTIVE_EFFECT_MODES.ADD, priority: 20, key:\"data.attributes.ac.value\"}],duration: {rounds: 1}, flags:{dae: {specialDuration: [\"turnStart\"]}}\n};\nif(token){\n  let effectPresent = !!token.actor.effects.find(e => e.data.label === effect.label);\n  if(effectPresent) removeEffect({ actor : token.actor, effectLabel : effect.label });\n  else addEffect({ actor : token.actor, effectData : effect });\n}\nasync function removeEffect({ actor, effectLabel }){\n  if(!actor || !effectLabel) return;\n  let effect = actor.effects.find(e => e.data.label === effectLabel);\n  if(!effect) return;\n\n  await actor.deleteEmbeddedEntity(\"ActiveEffect\", [effect.id]);\n}\nasync function addEffect({ actor, effectData }){\n  if(!actor || !effectData) return;\n  await actor.createEmbeddedEntity(\"ActiveEffect\", effectData );\n}\n\nreturn {damageRoll: `${roll.terms[0].total}`, flavor: \"Defensive Flourish\"};","folder":null,"sort":0,"permission":{"default":0},"flags":{}}}},"siftoolkit":{"SIFData":{"ignoreDuration":false,"texture":"","useTexture":false,"alpha":50,"coneOrigin":1,"loopAnimations":true,"playTemplateAudio":false,"playDamageAudio":false,"clip":"","volume":100}},"rest-recovery":{"data":{"recovery":{"enabled":false}}},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false,"autoFailFriendly":false,"autoSaveFriendly":false,"offHandWeapon":false},"cf":{"id":"temp_57npufvo0j"}},"system":{"description":{"value":"<div class=\"rd__b  rd__b--1\"><p>You can expend one use of your Bardic Inspiration to cause the weapon to deal extra damage to the target you hit. The damage equals the number you roll on the Bardic Inspiration die. You also add the number rolled to your AC until the start of your next turn.</p></div>","chat":"","unidentified":""},"source":"XGE","activation":{"type":"special","cost":1,"condition":""},"duration":{"value":null,"units":""},"cover":null,"target":{"value":null,"width":null,"units":"","type":""},"range":{"value":null,"long":null,"units":""},"uses":{"value":0,"max":"0","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"other","attackBonus":"20","chatFlavor":"","critical":null,"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"flat"},"type":{"value":"","subtype":""},"requirements":"Bard 3 (Swords)","recharge":{"value":null,"charged":false}},"ownership":{"default":0,"rbM5nB1AbUwbj4yJ":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":null,"modifiedTime":1686175686600,"lastModifiedBy":"Be8r6Sgxcs3sL08I"}}
{"name":"Ghost Walk","type":"feat","system":{"description":{"value":"<div class=\"rd__b  rd__b--1\"><p><i>13th-level Phantom feature</i></p><p>You can phase partially into the realm of the dead, becoming like a ghost. As a bonus action, you assume a spectral form. While in this form, you have a flying speed of 10 feet, you can hover, and attack rolls have disadvantage against you. You can also move through creatures and objects as if they were difficult terrain, but you take [[/r 1d10]] force damage if you end your turn inside a creature or an object.</p><p>You stay in this form for 10 minutes or until you end it as a bonus action. To use this feature again, you must finish a long rest or destroy one of your soul trinkets as part of the bonus action you use to activate Ghost Walk.</p></div>","chat":"","unidentified":""},"source":"TCE","activation":{"type":"bonus","cost":1,"condition":""},"duration":{"value":"","units":""},"cover":null,"target":{"value":null,"width":null,"units":"","type":""},"range":{"value":null,"long":null,"units":""},"uses":{"value":1,"max":"1","per":"lr","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"other","attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"flat"},"type":{"value":"","subtype":""},"requirements":"Rogue 13 (Phantom)","recharge":{"value":null,"charged":false}},"ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"img":"modules/plutonium/media/icon/spell/phb-conjure-minor-elementals.webp","flags":{"plutonium":{"page":"subclassFeature","source":"TCE","hash":"ghost%20walk_rogue_phb_phantom_tce_13_tce"},"dnd5e":{"advancementOrigin":"uI9hkHsFMxX3rqdN.2mzj8AElUFMr0RRi"},"rest-recovery":{"data":{"recovery":{"enabled":false}}},"midi-qol":{"effectActivation":false},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"autoFailFriendly":false,"autoSaveFriendly":false,"rollOther":false,"critOther":false,"offHandWeapon":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false},"magicitems":{"enabled":false,"equipped":false,"attuned":false,"charges":"0","chargeType":"c1","destroy":false,"destroyFlavorText":"reaches 0 charges: it crumbles into ashes and is destroyed.","rechargeable":false,"recharge":"0","rechargeType":"t1","rechargeUnit":"r1","sorting":"l"},"core":{"sourceId":"Actor.mAm9jLD3kldyAttd.Item.QCezAxAXOiIWiNPG"},"cf":{"id":"temp_6squr94sv2"}},"effects":[{"label":"Ghost Walk","icon":"modules/plutonium/media/icon/mighty-force.svg","changes":[{"key":"flags.midi-qol.grants.disadvantage.attack.all","mode":0,"value":"1","priority":20},{"key":"system.attributes.movement.fly","mode":4,"value":"10","priority":20}],"transfer":false,"_id":"aw10BIrxhfbWUSWc","disabled":false,"duration":{"startTime":null,"seconds":600,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"origin":null,"tint":null,"flags":{"dfreds-convenient-effects":{"description":""},"dae":{"selfTarget":false,"selfTargetAlways":false,"stackable":"noneName","durationExpression":"","macroRepeat":"none","specialDuration":[]},"core":{"statusId":""},"ActiveAuras":{"isAura":false,"aura":"None","radius":"","alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"displayTemp":false,"hostile":false,"onlyOnce":false}}}],"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1684884751132,"modifiedTime":1686175993272,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"_id":"GVcCKdnP5RZ2sqn5"}
{"_id":"HF68OzFHbBUWEVuh","name":"Crusher","type":"feat","img":"modules/GMmacros/img/crusher.png","effects":[{"_id":"3oY5yGLLMA3ZS2gk","changes":[{"key":"flags.dnd5e.DamageBonusMacro","mode":0,"value":"ItemMacro.Crusher","priority":20}],"disabled":false,"duration":{"startTime":null,"seconds":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"icon":"modules/GMmacros/img/crusher.png","label":"Crusher","transfer":true,"flags":{"dae":{"stackable":"none","macroRepeat":"none","specialDuration":[],"transfer":true},"ActiveAuras":{"isAura":false,"aura":"None","radius":null,"alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"hostile":false,"onlyOnce":false},"dnd5e-helpers":{"rest-effect":"Ignore"}},"tint":null,"origin":null}],"folder":null,"sort":0,"flags":{"srd5e":{"page":"feats.html","source":"TCE","hash":"crusher_tce","propDroppable":"feat","isStandardDragDrop":true},"spellTemplateManager":{"stmData":{"ignoreDuration":false,"spellTexture":"","useTexture":false,"alpha":50,"coneOrigin":1,"loopAnimations":true}},"magicitems":{"enabled":false,"equipped":false,"attuned":false,"charges":"0","chargeType":"c1","destroy":false,"destroyFlavorText":"reaches 0 charges: it crumbles into ashes and is destroyed.","rechargeable":false,"recharge":"0","rechargeType":"t1","rechargeUnit":"r1","sorting":"l"},"itemacro":{"macro":{"data":{"_id":null,"name":"Crusher","type":"script","author":"QwT9izJ4aW8QVTjo","img":"icons/svg/dice-target.svg","scope":"global","command":"if (args[0].hitTargets.length === 0) return {};\nif (![\"bludgeoning\"].includes(args[0].item.data.damage.parts[0][1])) return {};\nif (game.combat) {\n  let combatTime = game.combat.round + game.combat.turn /100;\n  let lastTime = getProperty(token.data.flags, \"midi-qol.crusherAttackTime\");\n  if (combatTime === lastTime) {\n   MidiQOL.warn(\"Crusher: Already done used crusher this turn\");\n   return {};\n  }\n}\nlet target  = Array.from(game.user.targets)[0].actor;\n\nif (args[0].isCritical) {\nconst efffectData = {\nlabel: \"Crusher\", icon: \"modules/GMmacros/img/1%20Desvantagem_defender.png\", \nchanges: [\n{value: 1, mode: CONST.ACTIVE_EFFECT_MODES.OVERRIDE, priority: 20, key:\"flags.midi-qol.grants.advantage.attack.all\"}],\nduration: {rounds: 1}\n}\nawait target.createEmbeddedEntity(\"ActiveEffect\", efffectData);\nif (game.combat) {\n  let combatTime = game.combat.round + game.combat.turn /100;\n  let lastTime = getProperty(token.data.flags, \"midi-qol.crusherAttackTime\");\n  if (combatTime !== lastTime) {\n     await token.setFlag(\"midi-qol\", \"crusherAttackTime\", combatTime)\n  }\n}\n}\nreturn {}","folder":null,"sort":0,"permission":{"default":0},"flags":{}}}},"core":{"sourceId":"Item.Zp0iEo3BYVdM8MDj"},"siftoolkit":{"SIFData":{"ignoreDuration":false,"texture":"","useTexture":false,"alpha":50,"coneOrigin":1,"loopAnimations":true,"playTemplateAudio":false,"playDamageAudio":false,"clip":"","volume":100}},"cf":{"id":"temp_a5umw776e9r"}},"system":{"description":{"value":"<div>\n\t\t\t\t\n\t\t\t\t<div class=\"rd__b  rd__b--3\"><p>You are practiced in the art of crushing your enemies, granting you the following benefits:</p><div class=\"rd__spc-inline-post\"></div><ul class=\"rd__list\"><li class=\"rd__li \">Increase your Strength or Constitution by 1, to a maximum of 20.</li><li class=\"rd__li \">Once per turn, when you hit a creature with an attack that deals bludgeoning damage, you can move it 5 feet to an unoccupied space, provided the target is no more than one size larger than you.</li><li class=\"rd__li \">When you score a critical hit that deals bludgeoning damage to a creature, attack rolls against that creature are made with advantage until the start of your next turn.</li></ul></div>\n\t\t\t</div>","chat":"","unidentified":""},"source":"TCE","activation":{"type":"","cost":0,"condition":""},"duration":{"value":0,"units":""},"cover":null,"target":{"value":0,"width":null,"units":"","type":""},"range":{"value":0,"long":0,"units":null},"uses":{"value":0,"max":0,"per":"","recovery":""},"consume":{"type":"","target":null,"amount":null},"ability":"","actionType":"","attackBonus":0,"chatFlavor":"","critical":null,"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"type":{"value":"","subtype":""},"requirements":"","recharge":{"value":0,"charged":true}},"ownership":{"default":0,"QwT9izJ4aW8QVTjo":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":null,"modifiedTime":1686175699526,"lastModifiedBy":"Be8r6Sgxcs3sL08I"}}
{"name":"Psychic Blades","type":"feat","system":{"description":{"value":"<div class=\"rd__b  rd__b--1\"><p>When you join the College of Whispers at 3rd level, you gain the ability to make your weapon attacks magically toxic to a creature's mind.</p><p>When you hit a creature with a weapon attack, you can expend one use of your Bardic Inspiration to deal an extra [[/r 2d6]] psychic damage to that target. You can do so only once per round on your turn.</p><p>The psychic damage increases when you reach certain levels in this class, increasing to [[/r 3d6]] at 5th level, [[/r 5d6]] at 10th level, and [[/r 8d6]] at 15th level.</p></div>","chat":"","unidentified":""},"source":"XGE","activation":{"type":"special","cost":0,"condition":"When you hit a creature with a weapon attack"},"duration":{"value":"","units":""},"cover":null,"target":{"value":null,"width":null,"units":"","type":""},"range":{"value":null,"long":null,"units":""},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"other","attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[["@scale.college-of-whispers.psychic-blades","psychic"]],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"flat"},"type":{"value":"","subtype":""},"requirements":"Bard 3 (Whispers)","recharge":{"value":null,"charged":false}},"img":"modules/GMmacros/img/psychblade.png","flags":{"plutonium":{"page":"subclassFeature","source":"XGE","hash":"psychic%20blades_bard_phb_whispers_xge_3_xge"},"dnd5e":{"advancementOrigin":"JMva8CeLgRMDis7Y.IZ2WvKV7dT0N9U0M"},"rest-recovery":{"data":{"recovery":{"enabled":false}}},"midi-qol":{"effectActivation":false},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"autoFailFriendly":false,"rollOther":false,"critOther":false,"offHandWeapon":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false,"autoSaveFriendly":false},"magicitems":{"enabled":false,"equipped":false,"attuned":false,"charges":"0","chargeType":"c1","destroy":false,"destroyFlavorText":"reaches 0 charges: it crumbles into ashes and is destroyed.","rechargeable":false,"recharge":"0","rechargeType":"t1","rechargeUnit":"r1","sorting":"l"},"itemacro":{"macro":{"name":"Psychic Blades","type":"script","scope":"global","command":"const version = \"10.0.13\"\ntry {\n    if (![\"mwak\",\"rwak\"].includes(args[0].itemData.system.actionType)) return {}; // weapon attack\n    if (args[0].hitTargets.length < 1) return {};\n    let sourceActor = this.actor;\n    let bardicInspiration = sourceActor.items.getName('Bardic Inspiration');\n    let bardicInspirationUses = bardicInspiration.system.uses.value;\n    // Have we got any left?\n    if (bardicInspirationUses <= 0) return {};\n\n    token = canvas.tokens.get(args[0].tokenId);\n    actor = token.actor;\n    if (!actor || !token || args[0].hitTargets.length < 1) return {};\n    let target = canvas.tokens.get(args[0].hitTargets[0].id ?? args[0].hitTargers[0]._id);\n    if (!target) MidiQOL.error(\"Sneak attack macro failed\");\n  \n    if (game.combat) {\n      const combatTime = `${game.combat.id}-${game.combat.round + game.combat.turn /100}`;\n      const lastTime = actor.getFlag(\"midi-qol\", \"sneakAttackTime\");\n      if (combatTime === lastTime) {\n       MidiQOL.warn(\"Psychic Blades Damage: Already done a Psychic Blades attack this turn\");\n       return {};\n      }\n    }\n    let foundEnemy = true;\n    let isSneak = true;\n    let useSneak = getProperty(actor.data, \"flags.dae.autoSneak\");\n    if (!useSneak) {\n        let dialog = new Promise((resolve, reject) => {\n          new Dialog({\n          // localize this text\n          title: \"Conditional Damage\",\n          content: `<p>Use Psychic Blades?</p>`+(!foundEnemy ? \"<p>Only Nuetral creatures nearby</p>\" : \"\"),\n          buttons: {\n              one: {\n                  icon: '<i class=\"fas fa-check\"></i>',\n                  label: \"Confirm\",\n                  callback: () => resolve(true)\n              },\n              two: {\n                  icon: '<i class=\"fas fa-times\"></i>',\n                  label: \"Cancel\",\n                  callback: () => {resolve(false)}\n              }\n          },\n          default: \"two\"\n          }).render(true);\n        });\n        useSneak = await dialog;\n    }\n    if (!useSneak) return {}\n\nbardicInspiration.update({'system.uses.value': bardicInspirationUses - 1});\n\n    const diceMult = args[0].isCritical ? 2: 1;\n    const bardLevels = actor.getRollData().classes.bard?.levels\n    if (bardLevels > 14) {\n\tbarddice=8 } else if (bardLevels > 9){\n \tbarddice=5 } else if (bardLevels > 4){\n\tbarddice=3 } else {\n\tbarddice=2 } \n    if (game.combat) {\n      const combatTime = `${game.combat.id}-${game.combat.round + game.combat.turn /100}`;\n      const lastTime = actor.getFlag(\"midi-qol\", \"sneakAttackTime\");\n      if (combatTime !== lastTime) {\n         await actor.setFlag(\"midi-qol\", \"sneakAttackTime\", combatTime)\n      }\n    }\n    // How to check that we've already done one this turn?\n    return {damageRoll: `${barddice * diceMult}d6`, flavor: \"Psych Blade\"};\n} catch (err) {\n    console.error(`${args[0].itemData.name} - Sneak Attack ${version}`, err);\n}","author":"Be8r6Sgxcs3sL08I","_id":null,"img":"icons/svg/dice-target.svg","folder":null,"sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null}}},"core":{"sourceId":"Actor.CQaWddu2rSc1igDg.Item.OiwgxKIu14kljhoA"},"cf":{"id":"temp_57npufvo0j"}},"effects":[{"label":"Psychic Blades","icon":"modules/GMmacros/img/psychblade.png","changes":[{"key":"flags.dnd5e.DamageBonusMacro","mode":0,"value":"ItemMacro","priority":20}],"transfer":true,"_id":"MorVsNoBOgcDb4IR","disabled":false,"duration":{"startTime":null,"seconds":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"origin":null,"tint":null,"flags":{"dae":{"selfTarget":false,"selfTargetAlways":false,"stackable":"none","durationExpression":"","macroRepeat":"none","specialDuration":[]},"core":{"statusId":""},"ActiveAuras":{"isAura":false,"aura":"None","radius":null,"alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"displayTemp":false,"hostile":false,"onlyOnce":false}}}],"ownership":{"default":0,"Xvz9L40UsVHWsWpn":3,"Be8r6Sgxcs3sL08I":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1671212943046,"modifiedTime":1685240848474,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"_id":"Hto0IaGIC3PNmOjy"}
{"name":"Arcane Recovery","type":"feat","system":{"description":{"value":"<div class=\"rd__b  rd__b--3\"><p>You have learned to regain some of your magical energy by studying your spellbook. Once per day when you finish a short rest, you can choose expended spell slots to recover. The spell slots can have a combined level that is equal to or less than half your wizard level (rounded up), and none of the slots can be 6th level or higher.</p><div class=\"rd__spc-inline-post\"></div><p>For example, if you're a 4th-level wizard, you can recover up to two levels worth of spell slots.</p><p>You can recover either a 2nd-level spell slot or two 1st-level spell slots.</p></div>","chat":"","unidentified":""},"source":"PHB","activation":{"type":"special","cost":null,"condition":""},"duration":{"value":"","units":""},"cover":null,"target":{"value":null,"width":null,"units":"","type":"self"},"range":{"value":null,"long":null,"units":"self"},"uses":{"value":1,"max":"1","per":"lr","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"util","attackBonus":"","chatFlavor":"The wizard can recover this number worth of spells slots (of 5th-level or lower):","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"type":{"value":"class","subtype":""},"requirements":"Wizard 1","recharge":{"value":null,"charged":false}},"ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"effects":[],"flags":{"plutonium":{"page":"classFeature","source":"PHB","hash":"arcane%20recovery_wizard_phb_1_phb","propDroppable":"classFeature"},"rest-recovery":{"data":{"recovery":{"enabled":false}}},"midi-qol":{"effectActivation":false,"onUseMacroName":"[postActiveEffects]ItemMacro"},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"autoFailFriendly":false,"autoSaveFriendly":false,"rollOther":false,"critOther":false,"offHandWeapon":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false},"magicitems":{"enabled":false,"equipped":false,"attuned":false,"charges":"0","chargeType":"c1","destroy":false,"destroyFlavorText":"reaches 0 charges: it crumbles into ashes and is destroyed.","rechargeable":false,"recharge":"0","rechargeType":"t1","rechargeUnit":"r1","sorting":"l"},"itemacro":{"macro":{"name":"Arcane Recovery","type":"script","scope":"global","command":"// Arcane Recovery\n// required modules: itemacro\n\n// get spell object and wizard levels.\nconst levels = actor.getRollData().classes.wizard.levels;\nconst spells = foundry.utils.duplicate(actor.system.spells);\n\n// bail out if you can't use this item again.\nconst available = item.system.uses.value > 0;\nif (!available) {\n  ui.notifications.warn(\"DND5E.AbilityUseUnavailableHint\", {localize: true});\n  return;\n}\n\n// attained spell levels, then mapping to value and max.\nconst level_maps = Array.fromRange(6).reduce((acc, i) => {\n  const s = spells[`spell${i+1}`];\n  if(s.max > 0) acc.push(s);\n  return acc;\n}, []);\n\n// bail out if there are no missing valid spell slots.\nif (!level_maps.some(s => s.value !== s.max)) {\n  ui.notifications.warn(\"You are not missing any valid spell slots.\");\n  return;\n}\n\nconst use = await item.use();\nif (!use) return;\n\nconst maxVal = Math.ceil(levels / 2);\nlet spent = 0;\n\nlet content = `<p name=\"header\">Recovering spell slots: <strong>${spent}</strong> / ${maxVal}.</p> <hr> <form>`;\nfor (let i = 0; i < level_maps.length; i++) {\n  const val = i + 1;\n  const name = `level${val}`;\n  content += `\n  <div class=\"form-group\">\n    <label style=\"text-align:center\"><strong>${val.ordinalString()}-level</strong></label>\n    <div class=\"form-fields\">`;\n  for (let j = 0; j < level_maps[i].max; j++) {\n    const cd = j < level_maps[i].value ? \"checked disabled\" : \"\";\n    content += `<input type=\"checkbox\" value=\"${val}\" name=\"${name}\" ${cd}></input>`;\n  }\n  content += \"</div></div>\";\n}\ncontent += \"</form> <hr>\";\n\nconst dialog = new Dialog({\n  title: \"Arcane Recovery\",\n  content,\n  buttons: {\n    go: {\n      icon: `<i class=\"fa-solid fa-hat-wizard\"></i>`,\n      label: \"Recover\",\n      callback: async (html) => {\n        if (spent > maxVal || spent < 1) {\n          ui.notifications.warn(\"Invalid number of slots to recover.\");\n          return dialog.render(true);\n        }\n        for (let i = 0; i < 9; i++) {\n          const selector = `input[name=level${i+1}]:checked`;\n          const val = html[0].querySelectorAll(selector).length;\n          spells[`spell${i+1}`].value = val;\n\t}\n        await actor.update({\"system.spells\": spells});\n        ui.notifications.info(\"Spell slots recovered!\");\n      }\n    }\n  },\n  render: (html) => {\n    html[0].addEventListener(\"change\", function () {\n      const selector = \"input:checked:not(:disabled)\";\n      const inputs = html[0].querySelectorAll(selector);\n      spent = Array.from(inputs).reduce((acc, node) => {\n        return acc + Number(node.value);\n      }, 0);\n      const hint = `Recovering spell slots: <strong>${spent}</strong> / ${maxVal}.`;\n      html[0].querySelector(\"[name=header]\").innerHTML = hint;\n    });\n  }\n}).render(true);","author":"Be8r6Sgxcs3sL08I","_id":null,"img":"icons/svg/dice-target.svg","folder":null,"sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null}}},"core":{"sourceId":"Item.XaF9Ie2nDkUa1jqF"},"cf":{"id":"temp_esxozmjvd1"}},"img":"icons/magic/earth/explosion-lava-stone-green.webp","_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1685997041771,"modifiedTime":1685998718450,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"_id":"LuQXQJihCu2IGFeX"}
{"name":"Metamagic: Twinned Spell","type":"feat","img":"icons/magic/time/clock-stopwatch-white-blue.webp","effects":[],"flags":{"itemacro":{"macro":{"name":"Metamagic: Twinned Spell","type":"script","scope":"global","command":"const points = actor.items.get(item.system.consume.target).system.uses.value;\nif (points === 0) {\n    ui.notifications.warn(\"Not enough sorcery points to cast spell\");\n    return false;\n}\nconst spellList = actor.items.filter(s=>\n    s.type === \"spell\" \n    && s.system.target.type !== \"self\" \n    && s.system.target.value === 1\n    && (s.system.preparation.mode !== \"prepared\" || s.system.preparation.prepared)\n);\n\nif (spellList.length === 0) return false;\nd = new Promise(resolve => {\n    const buttons = {}\n    spellList.forEach(s => {\n        buttons[s.name] =  {\n            label: `\n                <div class=\"flexrow twinned-spell center\" >\n                     <div class=\"item-image\"> <image src=${s.img} width=\"40\" height=\"40\" style=\"margin:0px\"></div>\n                    <div class=\"text\">${s.name}</div>\n                </div>`,\n\n            callback: () => resolve(s.uuid)\n        }\n    });\n\n    const style = `\n    <style>\n        .twinned-spell .dialog-buttons {\n            flex-direction: column;\n            gap: 2px;\n        }\n        .twinned-spell .center {\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            height: 40px;\n        }\n        .twinned-spell .text {\n            flex: 3 0 auto\n        }\n    </style>`;\n    new Dialog({\n        title: \"Twinned Spell\",\n        content: style + \"Choose a spell\",\n        buttons,\n        close: () => resolve(undefined),\n        default: spellList[0].name\n    }, {width: 275, classes: [\"dialog\", \"twinned-spell\"]}).render(true);\n});\nconst result = await d;\nif (!result) return false;\nconst theSpell = (await fromUuid(result)).clone({\"system.target.value\": 2}, {keepId: true});\nconst consume = Math.max(1, theSpell.system.level);\n\nif (points < consume) {\n    ui.notifications.warn(\"Not enough sorcery points to cast spell\");\n    return false;\n}\nitem.system.consume.amount = consume;\nconst hookId = Hooks.on(\"dnd5e.preUseItem\", (hookItem, config, options) => {\n    if (hookItem !== item) return;\n    options.configureDialog = false;\n    config.consumeResource = true;\n    config.consumeResource = true;\n    Hooks.off(\"dnd5e.preUseItem\", hookId);\n});\nspellResult = await MidiQOL.completeItemRoll(theSpell);\nreturn spellResult ? true : false;","author":"ZDFhNjE2NDMyYTY1","_id":null,"img":"icons/svg/dice-target.svg","folder":null,"sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null}}},"magicitems":{"enabled":false,"equipped":false,"attuned":false,"charges":"0","chargeType":"c1","destroy":false,"destroyFlavorText":"reaches 0 charges: it crumbles into ashes and is destroyed.","rechargeable":false,"recharge":"0","rechargeType":"t1","rechargeUnit":"r1","sorting":"l"},"midi-qol":{"effectActivation":false,"onUseMacroName":"[preItemRoll]ItemMacro"},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"autoFailFriendly":false,"autoSaveFriendly":false,"offHandWeapon":false,"ignoreTotalCover":false},"core":{"sourceId":"Actor.PhSL4D1P32OagGXW.Item.ceDjOH1Qhv6ArCY3"},"cf":{"id":"temp_arnwcbydlr"},"rest-recovery":{"data":{"recovery":{"enabled":false}}}},"system":{"description":{"value":"<p>When you cast a spell that targets only one creature and doesn't have a range of self, you can spend a number of sorcery points equal to the spell's level to target a second creature in range with the same spell (1 sorcery point if the spell is a cantrip).</p><p>To be eligible, a spell must be incapable of targeting more than one creature at the spell's current level. For example, magic missile and scorching ray aren't eligible, but ray of frost and chromatic orb are.</p><p>Midi-qol: You must set the resource consumption to Font of Magic after adding the feature to an actor.</p>","chat":"","unidentified":""},"source":"PHB pg. 102","activation":{"type":"special","cost":1,"condition":""},"duration":{"value":"","units":""},"cover":null,"target":{"value":null,"width":null,"units":"","type":"self"},"range":{"value":null,"long":null,"units":""},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"charges","target":"qTydC5cRYMjjGZgN","amount":1},"ability":"","actionType":"util","attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"type":{"value":"","subtype":""},"requirements":"Sorcerer 3","recharge":{"value":null,"charged":false}},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1666525351328,"modifiedTime":1686175533871,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"folder":null,"sort":0,"_id":"M0L5MgKcRckl3qLn"}
{"name":"#[CF_tempEntity]","type":"weapon","flags":{"cf":{"id":"temp_9j6qvpvxiy","name":"Creatures","color":"#cf7d7d","fontColor":"#FFFFFF","icon":"","sorting":"m","contents":["72sCYo0RfzrFUvdM","YkmHsCiEOF3AkjZD"],"children":[]}},"img":"icons/svg/item-bag.svg","system":{"description":{"value":"","chat":"","unidentified":""},"source":"","quantity":1,"weight":0,"price":0,"attunement":0,"equipped":false,"rarity":"","identified":true,"activation":{"type":"","cost":0,"condition":""},"duration":{"value":null,"units":""},"cover":null,"target":{"value":null,"width":null,"units":"","type":""},"range":{"value":null,"long":null,"units":""},"uses":{"value":null,"max":"","per":null,"recovery":""},"consume":{"type":"","target":null,"amount":null},"ability":null,"actionType":null,"attackBonus":0,"chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"armor":{"value":10},"hp":{"value":0,"max":0,"dt":null,"conditions":""},"weaponType":"simpleM","baseItem":"","properties":{},"proficient":true},"effects":[],"folder":null,"sort":0,"ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1670205371822,"modifiedTime":1686175680731,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"_id":"M6B7DwEEgB1YzW6r"}
{"_id":"MB7Xpd7MStklaV4x","name":"Parry","type":"feat","img":"icons/skills/melee/weapons-crossed-swords-white-blue.webp","effects":[{"_id":"Tspniu1tm7U04xZa","changes":[{"key":"system.attributes.ac.bonus","mode":2,"value":"3","priority":20}],"disabled":false,"duration":{"startTime":null,"seconds":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"icon":"systems/dnd5e/icons/skills/weapon_21.jpg","label":"Parry","transfer":false,"flags":{"dae":{"stackable":"none","macroRepeat":"none","specialDuration":["isAttacked"],"transfer":false},"dnd5e-helpers":{"rest-effect":"Ignore"},"ActiveAuras":{"isAura":false,"aura":"None","radius":null,"alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"hostile":false,"onlyOnce":false}},"tint":null,"origin":null}],"folder":null,"sort":0,"flags":{"core":{"sourceId":"Item.r4qRqWx4O2o6D5Dw"},"siftoolkit":{"SIFData":{"ignoreDuration":false,"texture":"","useTexture":false,"alpha":50,"coneOrigin":1,"loopAnimations":true,"playTemplateAudio":false,"playDamageAudio":false,"clip":"","volume":100}},"magicitems":{"enabled":false,"equipped":false,"attuned":false,"charges":"0","chargeType":"c1","destroy":false,"destroyFlavorText":"reaches 0 charges: it crumbles into ashes and is destroyed.","rechargeable":false,"recharge":"0","rechargeType":"t1","rechargeUnit":"r1","sorting":"l"},"rest-recovery":{"data":{"recovery":{"enabled":false}}}},"system":{"description":{"value":"<section class=\"secret\">\n<p>The gladiator adds 3 to its <strong>AC</strong> against one melee Attack that would hit it. To do so, the gladiator must see the attacker and be wielding a melee weapon.</p>\n</section>\n<p>The gladiator adds 3 to its <strong>AC</strong> against one melee Attack that would hit it.</p>","chat":"","unidentified":""},"source":"","activation":{"type":"reaction","cost":1,"condition":""},"duration":{"value":null,"units":"inst"},"target":{"value":null,"width":null,"units":"","type":"self"},"range":{"value":null,"long":null,"units":"self"},"uses":{"value":0,"max":"0","per":"","recovery":"","type":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"","attackBonus":0,"chatFlavor":"","critical":null,"damage":{"parts":[],"versatile":"","value":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell","value":""},"requirements":"","recharge":{"value":null,"charged":false}},"ownership":{"default":0,"QwT9izJ4aW8QVTjo":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.0.3","coreVersion":"10.290","createdTime":null,"modifiedTime":1668441794601,"lastModifiedBy":"Be8r6Sgxcs3sL08I"}}
{"_id":"NIsuq7rBKk3TIy0n","name":"Piercer","type":"feat","img":"modules/GMmacros/img/Spear_pierc.png","effects":[{"_id":"NxmtQmOXKW9HvWnt","changes":[{"key":"flags.dnd5e.DamageBonusMacro","mode":0,"value":"ItemMacro.Piercer","priority":20}],"disabled":false,"duration":{"startTime":null,"seconds":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"icon":"modules/GMmacros/img/Spear_pierc.png","label":"Piercer","transfer":true,"flags":{"dae":{"stackable":"none","macroRepeat":"none","specialDuration":[],"transfer":true},"dnd5e-helpers":{"rest-effect":"Ignore"},"ActiveAuras":{"isAura":false,"aura":"None","radius":null,"alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"hostile":false,"onlyOnce":false}},"tint":null,"origin":null}],"folder":null,"sort":0,"flags":{"srd5e":{"page":"feats.html","source":"TCE","hash":"piercer_tce"},"core":{"sourceId":"Item.TTEseFoyoaq57zZq"},"siftoolkit":{"SIFData":{"ignoreDuration":false,"texture":"","useTexture":false,"alpha":50,"coneOrigin":1,"loopAnimations":true,"playTemplateAudio":false,"playDamageAudio":false,"clip":"","volume":100}},"magicitems":{"enabled":false,"equipped":false,"attuned":false,"charges":"0","chargeType":"c1","destroy":false,"destroyFlavorText":"reaches 0 charges: it crumbles into ashes and is destroyed.","rechargeable":false,"recharge":"0","rechargeType":"t1","rechargeUnit":"r1","sorting":"l"},"itemacro":{"macro":{"data":{"_id":null,"name":"Piercer","type":"script","author":"QwT9izJ4aW8QVTjo","img":"icons/svg/dice-target.svg","scope":"global","command":"if (args[0].hitTargets.length === 0) return {};\nlet target = canvas.tokens.get(args[0].hitTargets[0]?._id)\nif (![\"piercing\"].includes(args[0].item.data.damage.parts[0][1])) return {};\nif(!target) return;\nif (args[0].isCritical) {\n    let damageRoll = new Roll(\"1d6\").roll()\n    new MidiQOL.DamageOnlyWorkflow(actor, token, damageRoll.total, \"piercing\", [target], damageRoll, {flavor: \"Piercer - bonus critical damage\", itemCardId: args[0].itemCardId})\n}\nlet roll = args[0].damageRoll;\nlet dieSize = roll.terms[0].faces;\nlet lowDice = Math.min(... roll.terms[0].values)\nconst content = `Reroll damage? \\n Previous lowest dice result: ${lowDice} on 1d${dieSize}`\nlet d = new Dialog({\n    title: \"Piercer Reroll\",\n    content: content,\n    buttons: {\n        one: {\n            icon:'<i class=\"fas fa-dice\"></i>',\n            label: \"Reroll\",\n            callback: () =>{\n                let damageRoll = new Roll(`1d${dieSize} - ${lowDice}`).roll()\n                new MidiQOL.DamageOnlyWorkflow(actor, token, damageRoll.total, \"piercing\", [target], damageRoll, {flavor: \"Piercer - reroll damage adjustment\", itemCardId: args[0].itemCardId})\n            }\n        }\n    }\n})\nd.render(true)","folder":null,"sort":0,"permission":{"default":0},"flags":{}}}},"cf":{"id":"temp_a5umw776e9r"}},"system":{"description":{"value":"<div>\n\t\t\t\t\n\t\t\t\t<div class=\"rd__b  rd__b--3\"><p>You have achieved a penetrating precision in combat, granting you the following benefits:</p><div class=\"rd__spc-inline-post\"></div><ul class=\"rd__list\"><li class=\"rd__li \">Increase your Strength or Dexterity by 1, to a maximum of 20.</li><li class=\"rd__li \">Once per turn, when you hit a creature with an attack that deals piercing damage, you can reroll one of the attack's damage dice, and you must use the new roll.</li><li class=\"rd__li \">When you score a critical hit that deals piercing damage to a creature, you can roll one additional damage die when determining the extra piercing damage the target takes.</li></ul></div>\n\t\t\t</div>","chat":"","unidentified":""},"source":"TCE","activation":{"type":"","cost":0,"condition":""},"duration":{"value":0,"units":""},"cover":null,"target":{"value":0,"width":null,"units":"","type":""},"range":{"value":0,"long":0,"units":null},"uses":{"value":0,"max":0,"per":"","recovery":""},"consume":{"type":"","target":null,"amount":null},"ability":"","actionType":"","attackBonus":0,"chatFlavor":"","critical":null,"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"type":{"value":"","subtype":""},"requirements":"","recharge":{"value":0,"charged":true}},"ownership":{"default":0,"QwT9izJ4aW8QVTjo":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":null,"modifiedTime":1686175670567,"lastModifiedBy":"Be8r6Sgxcs3sL08I"}}
{"name":"#[CF_tempEntity]","type":"weapon","flags":{"cf":{"id":"temp_57npufvo0j","name":"Bard","color":"#cf54b4","fontColor":"#FFFFFF","icon":"","sorting":"m","contents":["0joPVfl47Uw72R9d","Hto0IaGIC3PNmOjy","FHRLqeAelrKvxWqQ"],"children":[],"folderPath":[],"version":"2.5.7"}},"img":"icons/svg/item-bag.svg","system":{"description":{"value":"","chat":"","unidentified":""},"source":"","quantity":1,"weight":0,"price":{"value":0,"denomination":"gp"},"attunement":0,"equipped":false,"rarity":"","identified":true,"activation":{"type":"","cost":null,"condition":""},"duration":{"value":"","units":""},"cover":null,"target":{"value":null,"width":null,"units":"","type":""},"range":{"value":null,"long":null,"units":""},"uses":{"value":null,"max":"","per":null,"recovery":""},"consume":{"type":"","target":null,"amount":null},"ability":null,"actionType":null,"attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"armor":{"value":null},"hp":{"value":null,"max":null,"dt":null,"conditions":""},"weaponType":"simpleM","baseItem":"","properties":{},"proficient":true},"effects":[],"folder":null,"sort":0,"ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1685233501943,"modifiedTime":1686175686600,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"_id":"P7iAqKRroCMFqkcb"}
{"name":"Maneuvers: Lunging Attack","type":"feat","img":"icons/skills/melee/weapons-crossed-swords-yellow.webp","effects":[{"label":"Maneuvers: Lunging Attack","icon":"icons/skills/melee/weapons-crossed-swords-yellow.webp","changes":[{"key":"flags.dnd5e.DamageBonusMacro","mode":0,"value":"ItemMacro","priority":20}],"transfer":true,"_id":"0pIDL4gnN7udYghH","disabled":false,"duration":{"startTime":null,"seconds":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"origin":null,"tint":null,"flags":{"dfreds-convenient-effects":{"description":""},"dae":{"selfTarget":false,"selfTargetAlways":false,"stackable":"noneName","durationExpression":"","macroRepeat":"none","specialDuration":[]},"core":{"statusId":""},"ActiveAuras":{"isAura":false,"aura":"None","radius":"","alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"displayTemp":false,"hostile":false,"onlyOnce":false}}}],"flags":{"ddbimporter":{"id":"2439086","entityTypeId":"222216831","componentId":1306902,"componentTypeId":258900837,"class":"Fighter","subclass":"Battle Master","importId":"28pyz8r4w0vt0973"},"infusions":{"infused":false},"obsidian":{"source":{"type":"class","text":"Fighter"}},"scene-packer":{"hash":"65ff9c8e20629d3c4948b27d2cc17b2f1bdb3b57","sourceId":"Item.MSuui3XF9riJQkVV"},"spellTemplateManager":{"stmData":{"ignoreDuration":false,"spellTexture":"","useTexture":false,"alpha":50,"coneOrigin":1,"loopAnimations":true}},"midi-qol":{"effectActivation":false,"onUseMacroName":""},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false,"autoFailFriendly":false,"autoSaveFriendly":false,"offHandWeapon":false},"magicitems":{"enabled":false,"equipped":false,"attuned":false,"charges":"0","chargeType":"c1","destroy":false,"destroyFlavorText":"reaches 0 charges: it crumbles into ashes and is destroyed.","rechargeable":false,"recharge":"0","rechargeType":"t1","rechargeUnit":"r1","sorting":"l"},"favtab":{"isFavorite":true},"itemacro":{"macro":{"data":{"_id":null,"name":"Maneuvers: Lunging Attack","type":"script","author":"ldRsJ6Yp5qPydWA1","img":"icons/svg/dice-target.svg","scope":"global","command":"/*****\nFighter Battlemaster Maneuvers: Lunging Attack\n\n*** AWAITING SOLUTION FROM MIDI TO GET THIS TO WORK WITH RANGE CHECKING ***\n\nUSEAGE : ACTIVATE BEFORE ATTACK\nThis Maneuver must be activated BEFORE the character makes an attack.  \nThis will setup any bonuses and effects on the TARGET character.  \nA Superiority Die will be expended immediately.\n\nv1.2 May 7 2022 jbowens #0415 (Discord) https://github.com/jbowensii/More-Automated-Spells-Items-and-Feats.git \n*****/\n\n// Activate on preActiveEffects\nif (args[0].macroPass === \"preItemRoll\") {\n\n    // Item itself defining the workflow \n    const theItem = MidiQOL.Workflow.getWorkflow(args[0].uuid).item;\n\n    // make sure the attempted hit was made with a melee weapon attack\n    if ((theItem != null) && (theItem.name != \"Maneuvers: Lunging Attack\")) {\n        if (![\"mwak\"].includes(args[0].item.data.actionType)) {\n            ui.notifications.error(\"Lunging Attack only works with a melee weapon attack\");\n            await incrementResource(pcActor, \"Superiority Dice\", 1);\n            return;\n        }\n        else {\n            let range = theItem.data.data.range.value;\n            theItem.data.data.range.value = (range + 5);\n        }\n    }\n}\nreturn;\n\n//---------------------------------- MY FUNCTIONS -------------------------------------------\n\n// Increment available resource\nasync function incrementResource(testActor, resourceName, numValue) {\n    let actorDup = duplicate(testActor);\n    let resources = Object.values(actorDup.data.resources);\n    let foundResource = resources.find(i => i.label.toLowerCase() === resourceName.toLowerCase());\n    if (foundrResource) {\n        foundResource.value = foundResource.value + numValue;\n        await testActor.update(actorDup);\n    } else ui.notifications.error(\"You have not setup a Superiority Dice resource.\");\n    return;\n}","folder":null,"sort":0,"permission":{"default":0},"flags":{}},"name":"Maneuvers: Lunging Attack","type":"script","scope":"global","command":"if (args[0].hitTargets.length < 1) return {};\nlet sourceActor = this.actor;\nlet SupDie = sourceActor.items.getName('Superiority Die');\nlet SupDieUses = SupDie.system.uses.value;\n      if (SupDieUses <= 0) return {};\n      if (!SupDie) {\n            ui.notifications.warn('Source actor does not appear to have a Superiority Die feature!');\n            return;}\n\nconst pcActor = MidiQOL.MQfromActorUuid(args[0].actorUuid);\n\tconst dActor = canvas.tokens.controlled[0].actor;\n\tconst fighterLevel = actor.getRollData().classes.fighter?.levels;\n\tif (fighterLevel > 17) superiorityDie = \"12\";\n   \t else if (fighterLevel > 9) superiorityDie = \"10\";\n  \t else if (fighterLevel > 0) superiorityDie = \"8\";\n\nlet dialog = new Promise((resolve, reject) => {\n        new Dialog({\n            // localize this text\n            title: \"Battle Master:Disarming Attack\",\n            content: \"<p>Deseja usar o Maneuvers: Lunging Attack (+5 alcance + Dado Sup no dano)?</p>\",\n            buttons: {\n                one: {\n                    icon: '<p> </p><img src = \"icons/svg/light.svg\" width=\"60\" height=\"60\"></>',\n                    label: \"<p>Sim</p>\",\n                    callback: () => resolve(\"SIM\")\n                },\n                two: {\n                    icon: '<p> </p><img src = \"icons/svg/hazard.svg\" width=\"60\" height=\"60\"></>',\n                    label: \"<p>Não</p>\",\n                    callback: () => { resolve(\"NAO\") }\n                }\n            },\n            default: \"two\"\n        }).render(true);\n    });\n\n    let choiceACBonus = await dialog;\n    const baseDice = 1\n    if (choiceACBonus === \"SIM\") {\n    SupDie.update({'system.uses.value': SupDieUses - 1});\n    const diceMult = args[0].isCritical ? 2: 1;\n    return {damageRoll: `${diceMult}d${superiorityDie}`, flavor: \"Maneuvers: Lunging Attack\"};\n}","author":"Be8r6Sgxcs3sL08I","_id":null,"img":"icons/svg/dice-target.svg","folder":null,"sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null}}},"core":{"sourceId":"Item.QCt9G1ryLky9enrK"},"cf":{"id":"temp_pbbargtiogk","path":"Manobras - Battle Master Novo","color":"#b74e4e"},"exportSource":{"world":"test","system":"dnd5e","coreVersion":"9.269","systemVersion":"1.6.1"},"rest-recovery":{"data":{"recovery":{"enabled":false}}}},"system":{"description":{"value":"<p><strong>DEPOIS DE VC ACERTAR E SE QUISER USAR </strong><span style=\"text-decoration:underline\"><strong><span style=\"text-decoration:underline\">vai aparecer a opção pra vc </span></strong></span><strong>PARA CONSUMIR UMA CARGA.</strong></p><p>When you make a melee weapon attack on your turn, you can expend one superiority die to increase your reach for that attack by 5 feet. If you hit, you add the superiority die to the attack's damage roll.</p><details><summary></summary><p>v1.2 May 7 2022</p><p>jbowens #0415 (Discord)</p><p>https://github.com/jbowensii/More-Automated-Spells-Items-and-Feats.git</p></details>","chat":"","unidentified":""},"source":"PHB p74","activation":{"type":"special","cost":null,"condition":""},"duration":{"value":"","units":""},"cover":null,"target":{"value":null,"width":null,"units":"","type":"self"},"range":{"value":null,"long":null,"units":""},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"attribute","target":"","amount":1},"ability":"","actionType":"other","attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"type":{"value":"","subtype":""},"requirements":"Fighter: Battlemaster","recharge":{"value":null,"charged":false}},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1668460261752,"modifiedTime":1685300191036,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"_id":"P8ooaTBO7IoC3E0M"}
{"name":"Maneuvers: Parry","type":"feat","system":{"description":{"value":"<p><strong>AUTOMÁTICO AO LEVAR DANO APARECE PRA USAR. CLIQUE NO BOTÃO QUE APARECE.</strong></p><p><span style=\"font-family:'Helvetica Neue', Helvetica, Arial, sans-serif\">When another creature damages you with a melee attack, you can use your reaction and expend one superiority die to reduce the damage by the number you roll on your superiority die + your Dexterity modifier.</span></p>","chat":"","unidentified":""},"source":"","activation":{"type":"reactiondamage","cost":1,"condition":""},"duration":{"value":null,"units":""},"cover":null,"target":{"value":null,"width":null,"units":"","type":"self"},"range":{"value":null,"long":null,"units":"self"},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"other","attackBonus":0,"chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"type":{"value":"","subtype":""},"requirements":"","recharge":{"value":null,"charged":false}},"img":"icons/skills/melee/weapons-crossed-swords-white-blue.webp","effects":[{"label":"Maneuvers: Parry","icon":"icons/skills/melee/weapons-crossed-swords-white-blue.webp","changes":[{"key":"flags.midi-qol.DR.all","mode":2,"value":"1d((2*floor(((@classes.fighter.levels)-2)/8))+8)+@abilities.dex.mod","priority":20}],"transfer":false,"_id":"r9kLX1Vznq9N3kMf","disabled":false,"duration":{"startTime":null,"seconds":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"origin":null,"tint":null,"flags":{"dae":{"selfTarget":false,"selfTargetAlways":false,"stackable":"none","durationExpression":"","macroRepeat":"none","specialDuration":["1Reaction"]},"core":{"statusId":""},"ActiveAuras":{"isAura":false,"aura":"None","radius":"","alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"displayTemp":false,"hostile":false,"onlyOnce":false},"dfreds-convenient-effects":{"description":""}}}],"ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"flags":{"rest-recovery":{"data":{"recovery":{"enabled":false}}},"magicitems":{"enabled":false,"equipped":false,"attuned":false,"charges":"0","chargeType":"c1","destroy":false,"destroyFlavorText":"reaches 0 charges: it crumbles into ashes and is destroyed.","rechargeable":false,"recharge":"0","rechargeType":"t1","rechargeUnit":"r1","sorting":"l"},"core":{"sourceId":"Actor.sFHOUICbuzzUsgDq.Item.KNIhTYKFHq9zSPaw"},"cf":{"id":"temp_pbbargtiogk","path":"Manobras - Battle Master Novo","color":"#b74e4e"},"itemacro":{"macro":{"name":"Maneuvers: Parry","type":"script","scope":"global","command":"// success = args[0].evaluate;\n//let me = canvas.tokens.controlled[0].actor;\n//let the_message = `${me.name} <span style=\"color: blue\"><b> Rolou ${success}</b> </span>.`;\n//    ChatMessage.create({\n//    user: game.user._id,\n//    speaker: ChatMessage.getSpeaker({actor: me}),\n//    content: the_message,});\n\nlet sourceActor = this.actor;\nlet SupDie = sourceActor.items.getName('Superiority Die');\nlet SupDieUses = SupDie.system.uses.value;\n         if (SupDieUses <= 0) return {};\n         if (!SupDie) {\n            ui.notifications.warn('Source actor does not appear to have a Superiority Die feature!');\n            return;}\nSupDie.update({'system.uses.value': SupDieUses - 1});","author":"Be8r6Sgxcs3sL08I","_id":null,"img":"icons/svg/dice-target.svg","folder":null,"sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null}}},"midi-qol":{"effectActivation":false,"onUseMacroName":"[postActiveEffects]ItemMacro"},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"autoFailFriendly":false,"autoSaveFriendly":false,"rollOther":false,"critOther":false,"offHandWeapon":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false}},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1668483364476,"modifiedTime":1685300191906,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"_id":"POig9QTOn1chPZMd"}
{"_id":"PxVvrCaS6nNqQP32","name":"Defensive Duelist","type":"feat","img":"modules/plutonium/media/icon/feat/phb-defensive-duelist.webp","effects":[{"_id":"Yfdhxr0RlIevApNR","changes":[{"key":"system.attributes.ac.value","mode":2,"value":"@attributes.prof","priority":20}],"disabled":false,"duration":{"startTime":null,"seconds":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"icon":"modules/plutonium/media/icon/feat/phb-defensive-duelist.webp","label":"Defensive Duelist","transfer":false,"flags":{"dae":{"stackable":"none","macroRepeat":"none","specialDuration":["isAttacked"],"transfer":false},"dnd5e-helpers":{"rest-effect":"Ignore"},"ActiveAuras":{"isAura":false,"aura":"None","radius":null,"alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"hostile":false,"onlyOnce":false}},"tint":null,"origin":null}],"folder":null,"sort":0,"flags":{"srd5e":{"page":"feats.html","source":"PHB","hash":"defensive%20duelist_phb"},"siftoolkit":{"SIFData":{"ignoreDuration":false,"texture":"","useTexture":false,"alpha":50,"coneOrigin":1,"loopAnimations":true,"playTemplateAudio":false,"playDamageAudio":false,"clip":"","volume":100}},"magicitems":{"enabled":false,"equipped":false,"attuned":false,"charges":"0","chargeType":"c1","destroy":false,"destroyFlavorText":"reaches 0 charges: it crumbles into ashes and is destroyed.","rechargeable":false,"recharge":"0","rechargeType":"t1","rechargeUnit":"r1","sorting":"l"},"core":{"sourceId":"Item.hAfqQJzdW4Zp2rzR"},"rest-recovery":{"data":{"recovery":{"enabled":false}}},"cf":{"id":"temp_a5umw776e9r"}},"system":{"description":{"value":"<div>\n\t\t\t\t<p><i>Prerequisite: Prerequisite: Dexterity 13 or higher</i></p>\n\t\t\t\t<div class=\"rd__b  rd__b--3\"><p>When you are wielding a finesse weapon with which you are proficient and another creature hits you with a melee attack, you can use your reaction to add your proficiency bonus to your AC for that attack, potentially causing the attack to miss you.</p><div class=\"rd__spc-inline-post\"></div></div>\n\t\t\t</div>","chat":"","unidentified":""},"source":"PHB","activation":{"type":"reaction","cost":1,"condition":""},"duration":{"value":0,"units":""},"cover":null,"target":{"value":null,"width":null,"units":"","type":"self"},"range":{"value":null,"long":null,"units":"self"},"uses":{"value":0,"max":"0","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"","attackBonus":0,"chatFlavor":"","critical":null,"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"type":{"value":"","subtype":""},"requirements":"Dexterity 13 or higher","recharge":{"value":0,"charged":true}},"ownership":{"default":0,"rbM5nB1AbUwbj4yJ":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":null,"modifiedTime":1686175696667,"lastModifiedBy":"Be8r6Sgxcs3sL08I"}}
{"name":"#[CF_tempEntity]","type":"weapon","flags":{"cf":{"id":"temp_pbbargtiogk","path":"Manobras - Battle Master Novo","color":"#b74e4e","name":"Manobras - Battle Master Novo","children":[],"folderPath":[],"fontColor":"#FFFFFF","icon":null,"sorting":"a","contents":["q4vm68A7g0oWbZcK","dBkFrvqDpDO9tFzY","1AcD9QJQvFsfyzZ1","42lGKN4WGae14Gtj","zEhZAdAGu5O2SM0c","7AwS2jy8smavcjOF","hiyodUOZbdU7DDKq","bjrNIKzXNRvZxjE8","rzgx3wkUnqGwthgd","YKHm5j973LYuDNu1","2zrKieM0x9nC0gJF","P8ooaTBO7IoC3E0M","qeWOHadco9BlUtgS","2aKLnXXTVG345aqE","POig9QTOn1chPZMd","Ef0QhFbkvRxgLt5B","hCd7iD7WCRkiFo6P","fK0LckWJcTkaKAJR","mWWX4mek55sYbSQd","kXJf3aDVq204ff4h","sIhEzONHmjvO8mAB","frSGWpRpOrEpSutm","of4iYuXmwzeDf3Bj"],"version":"2.5.7"}},"img":"icons/svg/item-bag.svg","system":{"description":{"value":"","chat":"","unidentified":""},"source":"","quantity":1,"weight":0,"price":{"value":0,"denomination":"gp"},"attunement":0,"equipped":false,"rarity":"","identified":true,"activation":{"type":"","cost":null,"condition":""},"duration":{"value":"","units":""},"cover":null,"target":{"value":null,"width":null,"units":"","type":""},"range":{"value":null,"long":null,"units":""},"uses":{"value":null,"max":"","per":null,"recovery":""},"consume":{"type":"","target":null,"amount":null},"ability":null,"actionType":null,"attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"armor":{"value":null},"hp":{"value":null,"max":null,"dt":null,"conditions":""},"weaponType":"simpleM","baseItem":"","properties":{},"proficient":true},"effects":[],"folder":null,"sort":0,"ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1685300193611,"modifiedTime":1685305221483,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"_id":"RXGd0RHaOJJAivbJ"}
{"_id":"XV39u9gMK1grwlfh","name":"#[CF_tempEntity]","type":"weapon","img":"icons/svg/item-bag.svg","effects":[],"folder":null,"sort":0,"flags":{"cf":{"id":"temp_a5umw776e9r","folderPath":[],"color":"#000000","fontColor":"#FFFFFF","name":"Feats - Talentos","children":[],"icon":"","contents":["5jEcb3i1e8neRf83","xsqMiTTUCo6MgjDj","lINjzvvdJj0AFDGQ","NIsuq7rBKk3TIy0n","PxVvrCaS6nNqQP32","HF68OzFHbBUWEVuh"],"sorting":"a","version":"2.5.5"}},"system":{"description":{"value":"","chat":"","unidentified":""},"source":"","quantity":1,"weight":0,"price":0,"attunement":0,"equipped":false,"rarity":"","identified":true,"activation":{"type":"","cost":0,"condition":""},"duration":{"value":null,"units":""},"cover":null,"target":{"value":null,"width":null,"units":"","type":""},"range":{"value":null,"long":null,"units":""},"uses":{"value":null,"max":"","per":null,"recovery":""},"consume":{"type":"","target":null,"amount":null},"ability":null,"actionType":null,"attackBonus":0,"chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"armor":{"value":10},"hp":{"value":0,"max":0,"dt":null,"conditions":""},"weaponType":"simpleM","baseItem":"","properties":{},"proficient":true},"ownership":{"default":0,"QwT9izJ4aW8QVTjo":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":null,"modifiedTime":1686175699526,"lastModifiedBy":"Be8r6Sgxcs3sL08I"}}
{"name":"Maneuvers: Goading Attack","type":"feat","img":"icons/skills/melee/blade-tip-chipped-blood-red.webp","effects":[{"label":"Maneuvers: Goading Attack","icon":"icons/skills/melee/blade-tip-chipped-blood-red.webp","changes":[{"key":"flags.dnd5e.DamageBonusMacro","mode":0,"value":"ItemMacro","priority":20}],"transfer":true,"_id":"PP9XKjlIp6lLzsck","disabled":false,"duration":{"startTime":null,"seconds":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"origin":null,"tint":null,"flags":{"dae":{"selfTarget":false,"selfTargetAlways":false,"stackable":"none","durationExpression":"","macroRepeat":"none","specialDuration":[]},"core":{"statusId":""},"ActiveAuras":{"isAura":false,"aura":"None","radius":null,"alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"displayTemp":false,"hostile":false,"onlyOnce":false}}}],"flags":{"ddbimporter":{"id":"53570","entityTypeId":"222216831","componentId":22,"componentTypeId":258900837,"class":"Fighter","subclass":"Battle Master","importId":"ye6nz9f4x9n3v7lu","ignoreIcon":true,"ignoreItemImport":true,"retainResourceConsumption":true},"infusions":{"infused":false},"obsidian":{"source":{"type":"class","text":"Fighter"}},"spellTemplateManager":{"stmData":{"ignoreDuration":false,"spellTexture":"","useTexture":false,"alpha":50,"coneOrigin":1,"loopAnimations":true}},"midi-qol":{"effectActivation":false,"onUseMacroName":""},"midiProperties":{"nodam":false,"halfdam":false,"fulldam":true,"rollOther":false,"critOther":false,"concentration":false,"magicdam":false,"magiceffect":false,"toggleEffect":false,"ignoreTotalCover":false},"magicitems":{"enabled":false,"equipped":false,"attuned":false,"charges":"0","chargeType":"c1","destroy":false,"destroyFlavorText":"reaches 0 charges: it crumbles into ashes and is destroyed.","rechargeable":false,"recharge":"0","rechargeType":"t1","rechargeUnit":"r1","sorting":"l"},"itemacro":{"macro":{"data":{"_id":null,"name":"Maneuvers: Trip Attack","type":"script","author":"ldRsJ6Yp5qPydWA1","img":"icons/svg/dice-target.svg","scope":"global","command":"","folder":null,"sort":0,"permission":{"default":0},"flags":{}},"name":"Maneuvers: Goading Attack","type":"script","scope":"global","command":"if (args[0].hitTargets.length < 1) return {};\nlet sourceActor = this.actor;\nlet SupDie = sourceActor.items.getName('Superiority Die');\nlet SupDieUses = SupDie.system.uses.value;\n      if (SupDieUses <= 0) return {};\n      if (SupDieUses <= 0) return {};\n      if (!SupDie) {\n            ui.notifications.warn('Source actor does not appear to have a Superiority Die feature!');\n            return;}\n\n\nconst pcActor = MidiQOL.MQfromActorUuid(args[0].actorUuid);\n\tconst dActor = canvas.tokens.controlled[0].actor;\n\tconst fighterLevel = actor.getRollData().classes.fighter?.levels;\n\n\tif (fighterLevel > 17) superiorityDie = \"12\";\n   \t else if (fighterLevel > 9) superiorityDie = \"10\";\n  \t else if (fighterLevel > 0) superiorityDie = \"8\";\n\nlet dialog = new Promise((resolve, reject) => {\n        new Dialog({\n            // localize this text\n            title: \"Battle Master:Disarming Attack\",\n            content: \"<p>Deseja usar o Maneuvers: Goading Attack (+1 dado dano e wis save para ver se ele vai atacar só vc)?</p>\",\n            buttons: {\n                one: {\n                    icon: '<p> </p><img src = \"icons/svg/light.svg\" width=\"60\" height=\"60\"></>',\n                    label: \"<p>Sim</p>\",\n                    callback: () => resolve(\"SIM\")\n                },\n                two: {\n                    icon: '<p> </p><img src = \"icons/svg/hazard.svg\" width=\"60\" height=\"60\"></>',\n                    label: \"<p>Não</p>\",\n                    callback: () => { resolve(\"NAO\") }\n                }\n            },\n            default: \"two\"\n        }).render(true);\n    });\n\n    let choiceACBonus = await dialog;\n    const baseDice = 1\n    if (choiceACBonus === \"SIM\") {\n    SupDie.update({'system.uses.value': SupDieUses - 1});\nconst targets = Array.from(game.user.targets);\nfor (const target of targets) {\nawait game.MonksTokenBar.requestRoll(targets,{request:\"save:wis\", silent: true});\n}\n    const diceMult = args[0].isCritical ? 2: 1;\n    return {damageRoll: `${diceMult}d${superiorityDie}`, flavor: \"Maneuvers: Goading Attack\"};\n} \nelse {return}","author":"Be8r6Sgxcs3sL08I","_id":null,"img":"icons/svg/dice-target.svg","folder":null,"sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null}}},"favtab":{"isFavorite":true},"scene-packer":{"hash":"c08d22d1d001507d1eddb8912bb12bfe7d7044e0","sourceId":"Item.IhpAiSlCvVhm7ojr"},"core":{"sourceId":"Item.bpSu08y0CydFPHEi"},"cf":{"id":"temp_pbbargtiogk","path":"Manobras - Battle Master Novo","color":"#b74e4e"},"exportSource":{"world":"test","system":"dnd5e","coreVersion":"9.269","systemVersion":"1.6.1"},"rest-recovery":{"data":{"recovery":{"enabled":false}}}},"system":{"description":{"value":"<p><strong>NÃO USE A SKILL. ATAQUE NORMALMENTE. ESCOLHA SE VAI USAR O GOADING. SE USAR ELE PEDE UM TESTE E ADICIONA O DANO. O RESTO É MANUAL.</strong></p><p><span style=\"font-family:'Helvetica Neue', Helvetica, Arial, sans-serif\">When you hit a creature with a weapon attack, you can expend one superiority die to attempt to goad the target into attacking you. You add the superiority die to the attack's damage roll, and the target must make a Wisdom saving throw. On a failed save, the target has disadvantage on all attack rolls against targets other than you until the end of your next turn.</span></p><details><summary></summary><img src=\"https://user-images.githubusercontent.com/76136571/161775726-fb67bb97-5fd1-45c5-8301-bbb17e2d0f1d.png\" width=\"569\" /></details><p> </p><details><summary><strong>VERSION INFO</strong></summary><p>v0.5 May 7 2022</p><p>jbowens #0415 (Discord)</p><p>https://github.com/jbowensii/More-Automated-Spells-Items-and-Feats.git</p></details>","chat":"","unidentified":""},"source":"PHB p74","activation":{"type":"special","cost":null,"condition":""},"duration":{"value":null,"units":"inst"},"cover":null,"target":{"value":null,"width":null,"units":"","type":"self"},"range":{"value":null,"long":null,"units":"self"},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"attribute","target":"","amount":1},"ability":"str","actionType":"","attackBonus":"0","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[["0 + @flags.dae.SuperiorityDie[Superiority]",""]],"versatile":""},"formula":"","save":{"ability":"wis","dc":null,"scaling":"str"},"type":{"value":"","subtype":""},"requirements":"Fighter: Battlemaster","recharge":{"value":null,"charged":false},"attunement":0},"ownership":{"default":0,"ldRsJ6Yp5qPydWA1":3,"Be8r6Sgxcs3sL08I":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1668471173896,"modifiedTime":1685300190783,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"_id":"YKHm5j973LYuDNu1"}
{"name":"Legendary Resistance 10.0.10","type":"feat","img":"icons/equipment/shield/kite-wooden-oak-glow.webp","effects":[{"_id":"FniO7deC5cNc9vuy","changes":[{"key":"flags.midi-qol.optional.LegRes.save.all","mode":5,"value":"success","priority":20},{"key":"flags.midi-qol.optional.LegRes.count","mode":5,"value":"@resources.legres.value","priority":20}],"disabled":false,"duration":{"startTime":null,"seconds":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"icon":"icons/equipment/shield/kite-wooden-oak-glow.webp","label":"Legendary Resistance","origin":"Item.rO1EWt1SPvUJg7k3","transfer":true,"flags":{"dae":{"stackable":"none","macroRepeat":"none","specialDuration":[],"transfer":true,"selfTarget":false,"selfTargetAlways":false,"durationExpression":""},"ActiveAuras":{"isAura":false,"radius":null,"aura":"None","alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"hostile":false,"onlyOnce":false},"core":{"statusId":""}},"tint":null}],"flags":{"betterRolls5e":{"critRange":{"type":"String","value":""},"critDamage":{"type":"String","value":""},"quickDesc":{"type":"Boolean","value":true,"altValue":true},"quickAttack":{"type":"Boolean","value":true,"altValue":true},"quickSave":{"type":"Boolean","value":true,"altValue":true},"quickDamage":{"type":"Array","value":[],"altValue":[],"context":[]},"quickProperties":{"type":"Boolean","value":true,"altValue":true},"quickCharges":{"type":"Boolean","value":{"use":true,"resource":true,"charge":false},"altValue":{"use":true,"resource":true,"charge":false}},"quickTemplate":{"type":"Boolean","value":true,"altValue":true},"quickOther":{"type":"Boolean","value":true,"altValue":true,"context":""},"quickFlavor":{"type":"Boolean","value":true,"altValue":true},"quickPrompt":{"type":"Boolean","value":false,"altValue":false}},"midi-qol":{"onUseMacroName":"","effectActivation":false},"magicitems":{"enabled":false,"equipped":false,"attuned":false,"charges":"0","chargeType":"c1","destroy":false,"destroyFlavorText":"reaches 0 charges: it crumbles into ashes and is destroyed.","rechargeable":false,"recharge":"0","rechargeType":"t1","rechargeUnit":"r1","sorting":"l"},"core":{"sourceId":"Item.rO1EWt1SPvUJg7k3"},"cf":{"id":"temp_9j6qvpvxiy","color":"#000000"},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false},"rest-recovery":{"data":{"recovery":{"enabled":false}}}},"system":{"description":{"value":"<div class=\"rd__b  rd__b--3\"><p>If the legendary creature fails a saving throw, it can choose to succeed instead.</p><div class=\"rd__spc-inline-post\"><p></p></div></div>","chat":"","unidentified":""},"source":"MM","activation":{"type":"none","cost":0,"condition":"If the creature fails a saving throw, it can choose to succeed instead."},"duration":{"value":null,"units":""},"cover":null,"target":{"value":null,"width":null,"units":"","type":""},"range":{"value":null,"long":null,"units":""},"uses":{"value":3,"max":"3","per":"day","recovery":""},"consume":{"type":"attribute","target":"","amount":1},"ability":"","actionType":"other","attackBonus":0,"chatFlavor":"","critical":{"threshold":null,"damage":null},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"flat"},"type":{"value":"","subtype":""},"requirements":"","recharge":{"value":null,"charged":false}},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1661995926170,"modifiedTime":1686175680731,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"ownership":{"default":0,"devnIbfBHb74U9Zv":3,"Be8r6Sgxcs3sL08I":3},"folder":null,"sort":0,"_id":"YkmHsCiEOF3AkjZD"}
{"name":"Sneak Attack","type":"feat","img":"modules/GMmacros/img/Sneak-attac.png","effects":[{"_id":"Ns5pHr7gcYPTJ7HU","flags":{"dae":{"stackable":false,"transfer":true,"specialDuration":[],"macroRepeat":"none"},"ActiveAuras":{"isAura":false,"ignoreSelf":false,"hidden":false,"height":false,"aura":"None","radius":null,"alignment":"","type":"","save":"","savedc":null}},"changes":[{"key":"flags.dnd5e.DamageBonusMacro","mode":0,"value":"ItemMacro.Sneak Attack","priority":30}],"disabled":false,"duration":{"startTime":null,"seconds":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"icon":"systems/dnd5e/icons/skills/violet_27.jpg","label":"Sneak Attack","origin":"Actor.DMTSWfQs8whM5FtE.OwnedItem.Phll73Y1o1t6Park","tint":null,"transfer":true}],"flags":{"dae":{"activeEquipped":false,"alwaysActive":false},"exportSource":{"world":"storm-kings-thunder","system":"dnd5e","coreVersion":"0.7.9","systemVersion":"1.2.3"},"magicitems":{"enabled":false,"equipped":false,"attuned":false,"charges":"0","chargeType":"c1","destroy":false,"destroyFlavorText":"reaches 0 charges: it crumbles into ashes and is destroyed.","rechargeable":false,"recharge":"0","rechargeType":"t1","rechargeUnit":"r1","sorting":"l"},"itemacro":{"macro":{"data":{"_id":null,"name":"Sneak Attack","type":"script","author":"WpiVAovmlZrRTFMX","img":"icons/svg/dice-target.svg","scope":"global","command":"const version = \"0.9.52\"\ntry {\n    if (![\"mwak\",\"rwak\"].includes(args[0].itemData.data.actionType)) return {}; // weapon attack\n    if (args[0].itemData.data.actionType === \"mwak\" && !args[0].itemData.data.properties?.fin) \n      return {}; // ranged or finesse\n    if (args[0].hitTargets.length < 1) return {};\n    token = canvas.tokens.get(args[0].tokenId);\n    actor = token.actor;\n    if (!actor || !token || args[0].hitTargets.length < 1) return {};\n    const rogueLevels = actor.getRollData().classes.rogue?.levels;\n    let target = canvas.tokens.get(args[0].hitTargets[0].id ?? args[0].hitTargers[0]._id);\n    if (!target) MidiQOL.error(\"Sneak attack macro failed\");\n    \n    if (game.combat) {\n      const combatTime = `${game.combat.id}-${game.combat.round + game.combat.turn /100}`;\n      const lastTime = actor.getFlag(\"midi-qol\", \"sneakAttackTime\");\n      if (combatTime === lastTime) {\n       MidiQOL.warn(\"Sneak Attack Damage: Already done a sneak attack this turn\");\n       return {};\n      }\n    }\n    let foundEnemy = true;\n    let isSneak = args[0].advantage;\n    \n    if (!isSneak) {\n      foundEnemy = false;\n      let nearbyEnemy = canvas.tokens.placeables.filter(t => {\n        let nearby = (t.actor &&\n             t.actor?.id !== args[0].actor._id && // not me\n             t.id !== target.id && // not the target\n             t.actor?.data.data.attributes?.hp?.value > 0 && // not incapacitated\n             t.data.disposition !== target.data.disposition && // not an ally\n             MidiQOL.getDistance(t, target, false) <= 5 // close to the target\n         );\n        foundEnemy = foundEnemy || (nearby && t.data.disposition === -target.data.disposition)\n        return nearby;\n      });\n      isSneak = nearbyEnemy.length > 0;\n    }\n    if (!isSneak) {\n      MidiQOL.warn(\"Sneak Attack Damage: No advantage/ally next to target\");\n      return {};\n    }\n    let useSneak = getProperty(actor.data, \"flags.dae.autoSneak\");\n    if (!useSneak) {\n        let dialog = new Promise((resolve, reject) => {\n          new Dialog({\n          // localize this text\n          title: \"Conditional Damage\",\n          content: `<p>Use Sneak attack?</p>`+(!foundEnemy ? \"<p>Only Nuetral creatures nearby</p>\" : \"\"),\n          buttons: {\n              one: {\n                  icon: '<i class=\"fas fa-check\"></i>',\n                  label: \"Confirm\",\n                  callback: () => resolve(true)\n              },\n              two: {\n                  icon: '<i class=\"fas fa-times\"></i>',\n                  label: \"Cancel\",\n                  callback: () => {resolve(false)}\n              }\n          },\n          default: \"two\"\n          }).render(true);\n        });\n        useSneak = await dialog;\n    }\n    if (!useSneak) return {}\n    const diceMult = args[0].isCritical ? 2: 1;\n    const baseDice = Math.ceil(rogueLevels/2);\n    if (game.combat) {\n      const combatTime = `${game.combat.id}-${game.combat.round + game.combat.turn /100}`;\n      const lastTime = actor.getFlag(\"midi-qol\", \"sneakAttackTime\");\n      if (combatTime !== lastTime) {\n         await actor.setFlag(\"midi-qol\", \"sneakAttackTime\", combatTime)\n      }\n    }\n    // How to check that we've already done one this turn?\n    return {damageRoll: `${baseDice * diceMult}d6`, flavor: \"Sneak Attack\"};\n} catch (err) {\n    console.error(`${args[0].itemData.name} - Sneak Attack ${version}`, err);\n}","folder":null,"sort":0,"permission":{"default":0},"flags":{}},"name":"Sneak Attack","type":"script","scope":"global","command":"const version = \"0.9.52\"\ntry {\n    if (![\"mwak\",\"rwak\"].includes(args[0].itemData.data.actionType)) return {}; // weapon attack\n    if (args[0].itemData.data.actionType === \"mwak\" && !args[0].itemData.data.properties?.fin) \n      return {}; // ranged or finesse\n    if (args[0].hitTargets.length < 1) return {};\n    token = canvas.tokens.get(args[0].tokenId);\n    actor = token.actor;\n    if (!actor || !token || args[0].hitTargets.length < 1) return {};\n    const rogueLevels = actor.getRollData().classes.rogue?.levels;\n    let target = canvas.tokens.get(args[0].hitTargets[0].id ?? args[0].hitTargers[0]._id);\n    if (!target) MidiQOL.error(\"Sneak attack macro failed\");\n    \n    if (game.combat) {\n      const combatTime = `${game.combat.id}-${game.combat.round + game.combat.turn /100}`;\n      const lastTime = actor.getFlag(\"midi-qol\", \"sneakAttackTime\");\n      if (combatTime === lastTime) {\n       MidiQOL.warn(\"Sneak Attack Damage: Already done a sneak attack this turn\");\n       return {};\n      }\n    }\n    let foundEnemy = true;\n    let isSneak = args[0].advantage;\n    \n    if (!isSneak) {\n      foundEnemy = false;\n      let nearbyEnemy = canvas.tokens.placeables.filter(t => {\n        let nearby = (t.actor &&\n             t.actor?.id !== args[0].actor._id && // not me\n             t.id !== target.id && // not the target\n             t.actor?.data.data.attributes?.hp?.value > 0 && // not incapacitated\n             t.data.disposition !== target.data.disposition && // not an ally\n             MidiQOL.getDistance(t, target, false) <= 5 // close to the target\n         );\n        foundEnemy = foundEnemy || (nearby && t.data.disposition === -target.data.disposition)\n        return nearby;\n      });\n      isSneak = nearbyEnemy.length > 0;\n    }\n    if (!isSneak) {\n      MidiQOL.warn(\"Sneak Attack Damage: No advantage/ally next to target\");\n      return {};\n    }\n    let useSneak = getProperty(actor.data, \"flags.dae.autoSneak\");\n    if (!useSneak) {\n        let dialog = new Promise((resolve, reject) => {\n          new Dialog({\n          // localize this text\n          title: \"Conditional Damage\",\n          content: `<p>Use Sneak attack?</p>`+(!foundEnemy ? \"<p>Only Nuetral creatures nearby</p>\" : \"\"),\n          buttons: {\n              one: {\n                  icon: '<i class=\"fas fa-check\"></i>',\n                  label: \"Confirm\",\n                  callback: () => resolve(true)\n              },\n              two: {\n                  icon: '<i class=\"fas fa-times\"></i>',\n                  label: \"Cancel\",\n                  callback: () => {resolve(false)}\n              }\n          },\n          default: \"two\"\n          }).render(true);\n        });\n        useSneak = await dialog;\n    }\n    if (!useSneak) return {}\n    const diceMult = args[0].isCritical ? 2: 1;\n    const baseDice = Math.ceil(rogueLevels/2);\n    game.macros.getName(\"Sneak_video_macro\").execute(args[0]);\n    if (game.combat) {\n      const combatTime = `${game.combat.id}-${game.combat.round + game.combat.turn /100}`;\n      const lastTime = actor.getFlag(\"midi-qol\", \"sneakAttackTime\");\n      if (combatTime !== lastTime) {\n         await actor.setFlag(\"midi-qol\", \"sneakAttackTime\", combatTime)\n      }\n    }\n    // How to check that we've already done one this turn?\n    return {damageRoll: `${baseDice * diceMult}d6`, flavor: \"Sneak Attack\"};\n\n} catch (err) {\n    console.error(`${args[0].itemData.name} - Sneak Attack ${version}`, err);\n}","author":"Be8r6Sgxcs3sL08I","_id":null,"img":"icons/svg/dice-target.svg","folder":null,"sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null}}},"betterRolls5e":{"critRange":{"value":null},"critDamage":{"value":""},"quickDesc":{"value":true,"altValue":true},"quickProperties":{"value":true,"altValue":true},"quickOther":{"value":true,"altValue":true},"quickFlavor":{"value":true,"altValue":true}},"core":{"sourceId":"Item.bhuz5hzr0YsHJd1N"},"favtab":{"isFavorite":false},"autoanimations":{"killAnim":false,"override":false,"animType":"t1","animName":"","hmAnim":"a1","color":"a1","dtvar":"dt1","explosion":false,"explodeVariant":"ev1","explodeColor":"","explodeRadius":"0","explodeLoop":"1","selfRadius":"5","animTint":"#ffffff","auraOpacity":0.75,"ctaOption":false,"animLevel":false,"bards":{"bardAnim":"a1","bardTarget":true,"bardTargetAnim":"a1","bardTargetColor":"a1","bardSelf":true,"marker":true,"markerColor":"a1","markerColorTarget":"a1"},"spellVar":"a1","rangedOptions":{"rangeDmgType":""},"spellOptions":{"spellLoops":1},"uaStrikeType":"physical","divineSmite":{"dsEnable":false,"dsSelf":true,"dsSelfDelay":0,"dsSelfColor":"a1","dsTarget":true,"dsTargetDelay":1250,"dsTargetColor":"a1"},"exAnimLevel":false,"impactVar":"a1","allSounds":{"explosion":{"audioExplodeEnabled":false,"file":"","delay":100,"volume":0.25},"item":{"enableAudio":false,"file":"","delay":100,"volume":0.25}},"teleDist":30,"templates":{"tempType":"a1","tempAnim":"","tempColor":"","tempLoop":1,"customAnim":false,"customPath":""}},"cf":{"id":"temp_6squr94sv2","color":"#000000"},"scene-packer":{"hash":"94883b5265c70b12b1399bd2c956daed75b07d8c"},"siftoolkit":{"SIFData":{"ignoreDuration":false,"texture":"","useTexture":false,"alpha":50,"coneOrigin":1,"loopAnimations":true,"playTemplateAudio":false,"playDamageAudio":false,"playSaveAudio":false,"clip":"","volume":100}},"rest-recovery":{"data":{"recovery":{"enabled":false}}}},"system":{"description":{"value":"<p>Beginning at 1st level, you know how to strike subtly and exploit a foe's distraction. Once per turn, you can deal an extra [[/r 1d6]] damage to one creature you hit with an attack if you have advantage on the attack roll. The attack must use a finesse or a ranged weapon.</p>\n<p>You don't need advantage on the attack roll if another enemy of the target is within 5 feet of it, that enemy isn't <a href=\"https://5e.tools/conditionsdiseases.html#incapacitated_phb\">incapacitated</a>, and you don't have disadvantage on the attack roll.</p>\n<p>The amount of the extra damage increases as you gain levels in this class, as shown in the Sneak Attack column of the Rogue table.</p>\n<p>Updated 0.8.97 for v9</p>","chat":"","unidentified":""},"source":"PHB","activation":{"type":"special","cost":0,"condition":""},"duration":{"value":24,"units":"hour"},"target":{"value":null,"width":null,"units":"","type":"self"},"range":{"value":null,"long":null,"units":"self"},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":null,"actionType":"","attackBonus":0,"chatFlavor":"","critical":null,"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"requirements":"Rogue 1","recharge":{"value":null,"charged":false},"armor":{"value":10},"hp":{"value":0,"max":0,"dt":null,"conditions":""},"properties":{},"attributes":{"spelldc":10},"attunement":null},"ownership":{"default":0,"devnIbfBHb74U9Zv":3,"WpiVAovmlZrRTFMX":3,"Be8r6Sgxcs3sL08I":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.0.3","coreVersion":"10.290","createdTime":1668399315705,"modifiedTime":1668399611295,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"_id":"a6HgKxP24tT5SyQE"}
{"name":"Maneuvers: Evasive Footwork","type":"feat","img":"icons/magic/perception/shadow-stealth-eyes-purple.webp","effects":[{"label":"Maneuvers: Evasive Footwork","icon":"icons/magic/perception/shadow-stealth-eyes-purple.webp","changes":[{"key":"system.attributes.ac.bonus","mode":2,"value":"1d((2*floor(((@classes.fighter.levels)-2)/8))+8)","priority":20}],"transfer":false,"_id":"TinQ4yqWRtfAcnmi","disabled":false,"duration":{"startTime":null,"seconds":null,"combat":null,"rounds":null,"turns":1,"startRound":null,"startTurn":null},"origin":null,"tint":null,"flags":{"dae":{"selfTarget":false,"selfTargetAlways":false,"stackable":"none","durationExpression":"","macroRepeat":"none","specialDuration":[]},"core":{"statusId":""},"ActiveAuras":{"isAura":false,"aura":"None","radius":null,"alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"displayTemp":false,"hostile":false,"onlyOnce":false}}}],"flags":{"ddbimporter":{"id":"2439086","entityTypeId":"222216831","componentId":1306902,"componentTypeId":258900837,"class":"Fighter","subclass":"Battle Master","importId":"28pyz8r4w0vt0973"},"infusions":{"infused":false},"obsidian":{"source":{"type":"class","text":"Fighter"}},"scene-packer":{"hash":"4045229a820dffe156e080ec49956ac48893941e","sourceId":"Item.WkQYI28COW9L29Su"},"spellTemplateManager":{"stmData":{"ignoreDuration":false,"spellTexture":"","useTexture":false,"alpha":50,"coneOrigin":1,"loopAnimations":true}},"midi-qol":{"effectActivation":false,"onUseMacroName":"[postActiveEffects]ItemMacro"},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"autoFailFriendly":false,"autoSaveFriendly":false,"offHandWeapon":false,"ignoreTotalCover":false},"magicitems":{"enabled":false,"equipped":false,"attuned":false,"charges":"0","chargeType":"c1","destroy":false,"destroyFlavorText":"reaches 0 charges: it crumbles into ashes and is destroyed.","rechargeable":false,"recharge":"0","rechargeType":"t1","rechargeUnit":"r1","sorting":"l"},"favtab":{"isFavorite":true},"itemacro":{"macro":{"data":{"_id":null,"name":"Maneuvers: Brace","type":"script","author":"ldRsJ6Yp5qPydWA1","img":"icons/svg/dice-target.svg","scope":"global","command":"","folder":null,"sort":0,"permission":{"default":0},"flags":{}},"name":"Maneuvers: Evasive Footwork","type":"script","scope":"global","command":"let sourceActor = this.actor;\nlet SupDie = sourceActor.items.getName('Superiority Die');\nlet SupDieUses = SupDie.system.uses.value;\n      if (SupDieUses <= 0) return {};\n         if (!SupDie) {\n            ui.notifications.warn('Source actor does not appear to have a Superiority Die feature!');\n            return;}\nSupDie.update({'system.uses.value': SupDieUses - 1});","author":"Be8r6Sgxcs3sL08I","_id":null,"img":"icons/svg/dice-target.svg","folder":null,"sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null}}},"core":{"sourceId":"Item.QCt9G1ryLky9enrK"},"cf":{"id":"temp_pbbargtiogk","path":"Manobras - Battle Master Novo","color":"#b74e4e"},"exportSource":{"world":"test","system":"dnd5e","coreVersion":"9.269","systemVersion":"1.6.1"},"rest-recovery":{"data":{"recovery":{"enabled":false}}}},"system":{"description":{"value":"<p><strong>CLIQUE NA SKILL. ELA FICA NA SUA ARMOR ATÉ FINAL DO TURNO. NÃO TEM COMO MUDAR ISSO. VC PODE DELETAR O EFEITO SE QUISER</strong></p><p>When you move, you can expend one superiority die, rolling the die and adding the number rolled to your AC until you stop moving.</p><p></p>","chat":"","unidentified":""},"source":"PHB p74","activation":{"type":"special","cost":null,"condition":""},"duration":{"value":null,"units":""},"cover":null,"target":{"value":null,"width":null,"units":"","type":"self"},"range":{"value":null,"long":null,"units":""},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"attribute","target":"","amount":1},"ability":"","actionType":"other","attackBonus":0,"chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"type":{"value":"","subtype":""},"requirements":"Fighter: Battlemaster","recharge":{"value":null,"charged":false},"attunement":0},"ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1668460261779,"modifiedTime":1685305473560,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"_id":"bjrNIKzXNRvZxjE8"}
{"name":"Evasion","type":"feat","system":{"description":{"value":"<div class=\"rd__b  rd__b--3\"><p>Beginning at 7th level, you can nimbly dodge out of the way of certain area effects, such as a red dragon's fiery breath or an @spell[ice storm] spell. When you are subjected to an effect that allows you to make a Dexterity saving throw to take only half damage, you instead take no damage if you succeed on the saving throw, and only half damage if you fail.</p><div class=\"rd__spc-inline-post\"></div></div>","chat":"","unidentified":""},"source":"PHB","activation":{"type":"","cost":0,"condition":""},"duration":{"value":"","units":""},"cover":null,"target":{"value":null,"width":null,"units":"","type":""},"range":{"value":null,"long":null,"units":""},"uses":{"value":null,"max":"","per":null,"recovery":""},"consume":{"type":"","target":null,"amount":null},"ability":"","actionType":"","attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"type":{"value":"class","subtype":""},"requirements":"Monk 7, Rogue 7","recharge":{"value":null,"charged":false}},"ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"effects":[{"label":"Evasion","icon":"icons/magic/light/beam-red-orange.webp","changes":[{"key":"flags.midi-qol.superSaver.dex","mode":0,"value":"1","priority":20}],"disabled":false,"duration":{"startTime":null,"seconds":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"origin":null,"tint":null,"transfer":true,"flags":{"dfreds-convenient-effects":{"description":""},"dae":{"selfTarget":false,"selfTargetAlways":false,"stackable":"none","durationExpression":"","macroRepeat":"none","specialDuration":[]},"core":{"statusId":""},"ActiveAuras":{"isAura":false,"aura":"None","radius":"undefined","alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"displayTemp":false,"hostile":false,"onlyOnce":false},"plutonium":{"dedupeId":"evasion"}},"_id":"Bx1vYB11G0tF5rVj"}],"flags":{"plutonium":{"page":"classFeature","source":"PHB","hash":"evasion_rogue_phb_7_phb"},"magicitems":{"enabled":false,"equipped":false,"attuned":false,"charges":"0","chargeType":"c1","destroy":false,"destroyFlavorText":"reaches 0 charges: it crumbles into ashes and is destroyed.","rechargeable":false,"recharge":"0","rechargeType":"t1","rechargeUnit":"r1","sorting":"l"},"dnd5e":{"advancementOrigin":"aXWuAugp05MZDXJX.gheyUE76MzrEcSOe"},"core":{"sourceId":"Scene.V3MxnI9gjrfdinfI.Token.zRo7HDtQPdJGRuQN.Item.xdSFe0CSdBEuWX9w"},"cf":{"id":"temp_6squr94sv2"}},"img":"icons/magic/light/beam-red-orange.webp","_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1684884750731,"modifiedTime":1684885228854,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"_id":"cGyukUVwpn59kDMk"}
{"name":"Maneuvers: Bait and Switch","type":"feat","img":"icons/magic/perception/shadow-stealth-eyes-purple.webp","effects":[],"flags":{"ddbimporter":{"id":"2439086","entityTypeId":"222216831","componentId":1306902,"componentTypeId":258900837,"class":"Fighter","subclass":"Battle Master","importId":"28pyz8r4w0vt0973"},"infusions":{"infused":false},"obsidian":{"source":{"type":"class","text":"Fighter"}},"scene-packer":{"hash":"0252143b5203a6e39899a292c1d083d7658022ae","sourceId":"Item.e2rwzhaSa423KUbq"},"spellTemplateManager":{"stmData":{"ignoreDuration":false,"spellTexture":"","useTexture":false,"alpha":50,"coneOrigin":1,"loopAnimations":true}},"midi-qol":{"effectActivation":false,"onUseMacroName":"[preActiveEffects]ItemMacro"},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false,"autoFailFriendly":false,"autoSaveFriendly":false,"offHandWeapon":false},"magicitems":{"enabled":false,"equipped":false,"attuned":false,"charges":"0","chargeType":"c1","destroy":false,"destroyFlavorText":"reaches 0 charges: it crumbles into ashes and is destroyed.","rechargeable":false,"recharge":"0","rechargeType":"t1","rechargeUnit":"r1","sorting":"l"},"favtab":{"isFavorite":true},"itemacro":{"macro":{"data":{"_id":null,"name":"Maneuvers: Bait and Switch","type":"script","author":"ldRsJ6Yp5qPydWA1","img":"icons/svg/dice-target.svg","scope":"global","command":"/*****\nFighter Battlemaster Maneuver: Bait and Switch\n\nUSEAGE : ACTIVATE ANYTIME\nThis is a utility Maneuver and can be used whenever your character can take an action.  \nThis will setup any bonuses and effects on the TARGET actor.  \nA Superiority Die will be expended immediately.\n\nv1.2 May 7 2022 jbowens #0415 (Discord) https://github.com/jbowensii/More-Automated-Spells-Items-and-Feats.git \n*****/\n\n// Activate on preActiveEffects\nif (args[0].macroPass === \"preActiveEffects\") {\n\n    // define Actor, Target and Workflow\n    const pcActor = MidiQOL.MQfromActorUuid(args[0].actorUuid);\n    const targetActor = args[0].targets[0].actor;\n    let pcToken = token;\n    let targetToken = await fromUuid(args[0].hitTargetUuids[0]);\n    const workflow = MidiQOL.Workflow.getWorkflow(args[0].uuid);\n\n    // check to make sure only one target is selected\n    if ((args[0].targetUuids.length < 1) || (args[0].targetUuids.length > 1)) {\n        ui.notifications.error(\"You need to select a single target.\");\n        await incrementResource(pcActor, \"Superiority Dice\", 1);\n        return;\n    }\n\n    // check to make sure target is not incapacitated\n    if (!(targetActor.data.data.attributes.hp.value > 0)) {\n        ui.notifications.error(\"Your target must be conscious!\");\n        await incrementResource(pcActor, \"Superiority Dice\", 1);\n        return;\n    }\n\n    let superiorityDie = pcActor.getFlag(\"dae\", \"SuperiorityDie\");\n    if (superiorityDie === null) {\n        ui.notifications.error(\"You are not a fighter battlemaster of at least level 3!\");\n        await incrementResource(pcActor, \"Superiority Dice\", 1);\n        return;\n    }\n\n    // Roll superiority die for AC Bonus result\n    const acBonusRoll = await(new Roll(`${superiorityDie}`)).roll();\n\n    //prompt for who gets the AC bonus\n    let dialog = new Promise((resolve, reject) => {\n        new Dialog({\n            // localize this text\n            title: \"Battle Master: Bait and Switch\",\n            content: \"<p>Who gets the AC bonus for 1 turn You or Target?</p>\",\n            buttons: {\n                one: {\n                    icon: '<p> </p><img src = \"systems/dnd5e/icons/skills/water_09.jpg\" width=\"60\" height=\"60\"></>',\n                    label: \"<p>You</p>\",\n                    callback: () => resolve(\"YOU\")\n                },\n                two: {\n                    icon: '<p> </p><img src = \"systems/dnd5e/icons/skills/shadow_19.jpg\" width=\"60\" height=\"60\"></>',\n                    label: \"<p>Target</p>\",\n                    callback: () => { resolve(\"TARGET\") }\n                }\n            },\n            default: \"two\"\n        }).render(true);\n    });\n\n    let choiceACBonus = await dialog;\n\n    if (choiceACBonus === \"YOU\") {\n        // Set Actor Active Effect for AC bonus\n        await pcActor.createEmbeddedDocuments(\"ActiveEffect\", [{\n            \"changes\": [{ \"key\": \"data.attributes.ac.bonus\", \"mode\": 2, \"value\": `${acBonusRoll.total}`, \"priority\": \"20\" }],\n            \"label\": \"Bait and Switch AC Bonus\",\n            \"duration\": { seconds: 0, rounds: 0, turns: 1 },\n            \"origin\": args[0].itemUuid,\n            \"icon\": \"systems/dnd5e/icons/skills/gray_10.jpg\",\n        }]);\n    } else {\n        // Set Target Active Effect for AC bonus\n        await targetActor.createEmbeddedDocuments(\"ActiveEffect\", [{\n            \"changes\": [{ \"key\": \"data.attributes.ac.bonus\", \"mode\": 2, \"value\": `${acBonusRoll.total}`, \"priority\": \"20\" }],\n            \"label\": \"Bait and Switch AC Bonus\",\n            \"duration\": { seconds: 0, rounds: 0, turns: 1 },\n            \"origin\": args[0].itemUuid,\n            \"icon\": \"systems/dnd5e/icons/skills/gray_10.jpg\",\n        }]);\n    }\n\n    // Swap the token positions positions on the canvas\n    await SwapTokens(pcToken, targetToken, canvas);\n}\nreturn;\n\n//---------------------------------- MY FUNCTIONS -------------------------------------------\n\nasync function SwapTokens(pcMoveToken, targetMoveToken, thisCanvas) {\n    let targetCenter = targetMoveToken.object.center;\n    let pcCenter = pcMoveToken.center;\n    let snappedPosition = null;\n\n    thisCanvas.grid.diagonalRule = \"EUCL\";\n    const diagonalRule = canvas.grid.diagonRule;\n\n    // Move Actor to OLD Target Location\n    let travelRay = new Ray(pcCenter, targetCenter); //  create a ray to measure the angle to travel\n    let angle = travelRay.angle;\n    travelRay = Ray.fromAngle(pcMoveToken.data.x, pcMoveToken.data.y, angle, travelRay.distance);\n    snappedPosition = canvas.grid.getSnappedPosition(travelRay.B.x, travelRay.B.y);\n    canvas.grid.diagonalRule = diagonalRule;\n    await pcMoveToken.document.update(canvas.grid.getSnappedPosition(travelRay.B.x, travelRay.B.y));\n\n    // Move Target to OLD Actor Location\n    travelRay = new Ray(targetCenter, pcCenter); //  create a ray to measure the angle to travel\n    angle = travelRay.angle;\n    travelRay = Ray.fromAngle(targetMoveToken.data.x, targetMoveToken.data.y, angle, travelRay.distance);\n    snappedPosition = canvas.grid.getSnappedPosition(travelRay.B.x, travelRay.B.y);\n    canvas.grid.diagonalRule = diagonalRule;\n    await targetMoveToken.data.document.update(canvas.grid.getSnappedPosition(travelRay.B.x, travelRay.B.y));\n\n    return;\n}\n\n// Increment available resource\nasync function incrementResource(testActor, resourceName, numValue) {\n    let actorDup = duplicate(testActor);\n    let resources = Object.values(actorDup.data.resources);\n    let foundResource = resources.find(i => i.label.toLowerCase() === resourceName.toLowerCase());\n    if (foundrResource) {\n        foundResource.value = foundResource.value + numValue;\n        await testActor.update(actorDup);\n    } else ui.notifications.error(\"You have not setup a Superiority Dice resource.\");\n    return;\n}","folder":null,"sort":0,"permission":{"default":0},"flags":{}},"name":"Maneuvers: Bait and Switch","type":"script","scope":"global","command":"/*****\nFighter Battlemaster Maneuver: Bait and Switch\n\nUSEAGE : ACTIVATE ANYTIME\nThis is a utility Maneuver and can be used whenever your character can take an action.  \nThis will setup any bonuses and effects on the TARGET actor.  \nA Superiority Die will be expended immediately.\n\nv1.2 May 7 2022 jbowens #0415 (Discord) https://github.com/jbowensii/More-Automated-Spells-Items-and-Feats.git \n*****/\n\n// Activate on preActiveEffects\nif (args[0].macroPass === \"preActiveEffects\") {\nlet sourceActor = this.actor;\nlet SupDie = sourceActor.items.getName('Superiority Die');\nlet SupDieUses = SupDie.system.uses.value;\n         if (SupDieUses <= 0) return {};\n        if (!SupDie) {\n            ui.notifications.warn('Source actor does not appear to have a Bardic Inspiration feature!');\n            return;}\nSupDie.update({'system.uses.value': SupDieUses - 1});\n    // define Actor, Target and Workflow\n    const pcActor = MidiQOL.MQfromActorUuid(args[0].actorUuid);\n    const targetActor = args[0].targets[0].actor;\n    let pcToken = token;\n    let targetToken = await fromUuid(args[0].hitTargetUuids[0]);\n    const workflow = MidiQOL.Workflow.getWorkflow(args[0].uuid);\n\n    // check to make sure only one target is selected\n    if ((args[0].targetUuids.length < 1) || (args[0].targetUuids.length > 1)) {\n        ui.notifications.error(\"You need to select a single target.\");\n        await incrementResource(pcActor, \"Superiority Dice\", 1);\n        return;\n    }\n\n    // check to make sure target is not incapacitated\n    if (!(targetActor.data.data.attributes.hp.value > 0)) {\n        ui.notifications.error(\"Your target must be conscious!\");\n        await incrementResource(pcActor, \"Superiority Dice\", 1);\n        return;\n    }\n\n   // Roll superiority die for AC Bonus result\n\tconst pActor = canvas.tokens.controlled[0].actor;\n\tconst fighterLevel = actor.getRollData().classes.fighter?.levels;\n\n\tif (fighterLevel > 17) superiorityDie = \"1d12\";\n   \t else if (fighterLevel > 9) superiorityDie = \"1d10\";\n  \t else if (fighterLevel > 0) superiorityDie = \"1d8\";\n   \n    \n// Roll superiority die for AC Bonus result\nconst rollacbonus  = await new Roll(`${superiorityDie}`).evaluate({async: true});\nawait rollacbonus.toMessage({\n  speaker: ChatMessage.getSpeaker({actor: token.actor})\n});\n\n\n\n    //prompt for who gets the AC bonus\n    let dialog = new Promise((resolve, reject) => {\n        new Dialog({\n            // localize this text\n            title: \"Battle Master: Bait and Switch\",\n            content: \"<p>Who gets the AC bonus for 1 turn You or Target?</p>\",\n            buttons: {\n                one: {\n                    icon: '<p> </p><img src = \"icons/svg/down.svg\" width=\"60\" height=\"60\"></>',\n                    label: \"<p>Você</p>\",\n                    callback: () => resolve(\"YOU\")\n                },\n                two: {\n                    icon: '<p> </p><img src = \"icons/svg/regen.svg\" width=\"60\" height=\"60\"></>',\n                    label: \"<p>Alvo</p>\",\n                    callback: () => { resolve(\"TARGET\") }\n                }\n            },\n            default: \"two\"\n        }).render(true);\n    });\n\n    let choiceACBonus = await dialog;\n\n    if (choiceACBonus === \"YOU\") {\n        // Set Actor Active Effect for AC bonus\n        await pcActor.createEmbeddedDocuments(\"ActiveEffect\", [{\n            \"changes\": [{ \"key\": \"system.attributes.ac.bonus\", \"mode\": 2, \"value\": `${rollacbonus.total}`, \"priority\": \"20\" }],\n            \"label\": \"Bait and Switch AC Bonus\",\n            \"origin\": args[0].itemUuid,\n            \"icon\": \"icons/magic/perception/shadow-stealth-eyes-purple.webp\",\n\t    \"flags\": {\n              \"dae\": {\n                \"specialDuration\": [\n                  \"turnStartSource\"]}}\n        }]);\n    } else {\n        // Set Target Active Effect for AC bonus\n        await targetActor.createEmbeddedDocuments(\"ActiveEffect\", [{\n            \"changes\": [{ \"key\": \"system.attributes.ac.bonus\", \"mode\": 2, \"value\": `${rollacbonus.total}`, \"priority\": \"20\" }],\n            \"label\": \"Bait and Switch AC Bonus\",\n            \"origin\": args[0].itemUuid,\n            \"icon\": \"icons/magic/perception/shadow-stealth-eyes-purple.webp\",\n\t    \"flags\": {\n              \"dae\": {\n                \"specialDuration\": [\n                  \"turnStartSource\"]}}\n        }]);\n    }\n\n    // Swap the token positions positions on the canvas\n    await SwapTokens(pcToken, targetToken, canvas);\n}\nreturn;\n\n//---------------------------------- MY FUNCTIONS -------------------------------------------\n\nasync function SwapTokens(pcMoveToken, targetMoveToken, thisCanvas) {\n    let targetCenter = targetMoveToken.object.center;\n    let pcCenter = pcMoveToken.center;\n    let snappedPosition = null;\n\n    thisCanvas.grid.diagonalRule = \"EUCL\";\n    const diagonalRule = canvas.grid.diagonRule;\n\n    // Move Actor to OLD Target Location\n    let travelRay = new Ray(pcCenter, targetCenter); //  create a ray to measure the angle to travel\n    let angle = travelRay.angle;\n    travelRay = Ray.fromAngle(pcMoveToken.data.x, pcMoveToken.data.y, angle, travelRay.distance);\n    snappedPosition = canvas.grid.getSnappedPosition(travelRay.B.x, travelRay.B.y);\n    canvas.grid.diagonalRule = diagonalRule;\n    await pcMoveToken.document.update(canvas.grid.getSnappedPosition(travelRay.B.x, travelRay.B.y));\n\n    // Move Target to OLD Actor Location\n    travelRay = new Ray(targetCenter, pcCenter); //  create a ray to measure the angle to travel\n    angle = travelRay.angle;\n    travelRay = Ray.fromAngle(targetMoveToken.data.x, targetMoveToken.data.y, angle, travelRay.distance);\n    snappedPosition = canvas.grid.getSnappedPosition(travelRay.B.x, travelRay.B.y);\n    canvas.grid.diagonalRule = diagonalRule;\n    await targetMoveToken.data.document.update(canvas.grid.getSnappedPosition(travelRay.B.x, travelRay.B.y));\n\n    return;\n}\n\n// Increment available resource\nasync function incrementResource(testActor, resourceName, numValue) {\n    let actorDup = duplicate(testActor);\n    let resources = Object.values(actorDup.data.resources);\n    let foundResource = resources.find(i => i.label.toLowerCase() === resourceName.toLowerCase());\n    if (foundrResource) {\n        foundResource.value = foundResource.value + numValue;\n        await testActor.update(actorDup);\n    } else ui.notifications.error(\"You have not setup a Superiority Dice resource.\");\n    return;\n}","author":"Be8r6Sgxcs3sL08I","_id":null,"img":"icons/svg/dice-target.svg","folder":null,"sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null}}},"core":{"sourceId":"Item.QCt9G1ryLky9enrK"},"cf":{"id":"temp_pbbargtiogk","path":"Manobras - Battle Master Novo","color":"#b74e4e"},"exportSource":{"world":"test","system":"dnd5e","coreVersion":"9.269","systemVersion":"1.6.1"},"rest-recovery":{"data":{"recovery":{"enabled":false}}}},"system":{"description":{"value":"<p></p><p><strong>MARQUE O ALVO PARA TROCAR, USE A SKILL. ESCOLHA QUEM VAI RECEBER A CA NA CAIXA DE DIALOGO. GG!</strong></p><p>When you're within 5 feet of a creature on your turn, you can expend one superiority die and switch places with that creature, provided you spend at least 5 feet of movement and the creature is willing and isn't incapacitated. This movement doesn't provoke opportunity attacks.</p><p>Roll the superiority die. Until the start of your next turn, you or the other creature (your choice) gains a bonus to AC equal to the number rolled.</p><p></p>","chat":"","unidentified":""},"source":"TCoE p42","activation":{"type":"special","cost":1,"condition":""},"duration":{"value":null,"units":""},"cover":null,"target":{"value":1,"width":null,"units":"","type":"creature"},"range":{"value":null,"long":null,"units":""},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"attribute","target":"","amount":1},"ability":"","actionType":"other","attackBonus":0,"chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"type":{"value":"","subtype":""},"requirements":"Fighter: Battlemaster","recharge":{"value":null,"charged":false},"attunement":0},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1668460261756,"modifiedTime":1685305423963,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"_id":"dBkFrvqDpDO9tFzY"}
{"name":"Uncanny Dodge","type":"feat","img":"icons/skills/movement/feet-winged-boots-brown.webp","effects":[{"_id":"ksFos60cgn0TWTFP","changes":[{"key":"flags.midi-qol.uncanny-dodge","mode":5,"value":"1","priority":20}],"disabled":false,"duration":{"startTime":null,"seconds":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"icon":"icons/skills/movement/feet-winged-boots-brown.webp","label":"1/2 Damage","origin":"Item.eEmSsq7xE3i0EyBS","transfer":false,"flags":{"dae":{"stackable":false,"macroRepeat":"none","specialDuration":["1Reaction"],"transfer":false},"ActiveAuras":{"isAura":false,"radius":null,"aura":"None","alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"hostile":false,"onlyOnce":false}},"tint":null}],"flags":{"core":{"sourceId":"Compendium.dnd5e.classfeatures.Mm64SKAHJWYecgXS"},"betterRolls5e":{"critRange":{"type":"String","value":null},"critDamage":{"type":"String","value":""},"quickDesc":{"type":"Boolean","value":true,"altValue":true},"quickAttack":{"type":"Boolean","value":true,"altValue":true},"quickSave":{"type":"Boolean","value":true,"altValue":true},"quickDamage":{"type":"Array","value":[],"altValue":[],"context":[]},"quickProperties":{"type":"Boolean","value":true,"altValue":true},"quickCharges":{"type":"Boolean","value":{"use":true,"resource":true,"charge":true},"altValue":{"use":true,"resource":true,"charge":true}},"quickTemplate":{"type":"Boolean","value":true,"altValue":true},"quickOther":{"type":"Boolean","value":true,"altValue":true,"context":""},"quickFlavor":{"type":"Boolean","value":true,"altValue":true},"quickPrompt":{"type":"Boolean","value":false,"altValue":false}},"magicitems":{"enabled":false,"equipped":false,"attuned":false,"charges":"0","chargeType":"c1","destroy":false,"destroyFlavorText":"reaches 0 charges: it crumbles into ashes and is destroyed.","rechargeable":false,"recharge":"0","rechargeType":"t1","rechargeUnit":"r1","sorting":"l"},"cf":{"id":"temp_6squr94sv2","color":"#000000"},"rest-recovery":{"data":{"recovery":{"enabled":false}}}},"system":{"description":{"value":"<p>Starting at 5th level, when an attacker that you can see hits you with an attack, you can use your reaction to halve the attack's damage against you.</p>","chat":"","unidentified":""},"source":"PHB pg. 96","activation":{"type":"reactiondamage","cost":1,"condition":""},"duration":{"value":"","units":""},"cover":null,"target":{"value":null,"width":null,"units":"","type":"self"},"range":{"value":null,"long":null,"units":"self"},"uses":{"value":0,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"","attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"type":{"value":"","subtype":""},"requirements":"Rogue 5","recharge":{"value":null,"charged":false}},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1661995926137,"modifiedTime":1684885201322,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"ownership":{"default":0,"devnIbfBHb74U9Zv":3,"Be8r6Sgxcs3sL08I":3},"folder":null,"sort":0,"_id":"edqbg2l8SWxygJwz"}
{"name":"#[CF_tempEntity]","type":"weapon","flags":{"cf":{"id":"temp_xkcn7ug77da","name":"Warlock","color":"#8a8585","fontColor":"#FFFFFF","icon":"","sorting":"m","contents":["771NEJjgU7nb9lqL"],"children":[]}},"img":"icons/svg/item-bag.svg","system":{"description":{"value":"","chat":"","unidentified":""},"source":"","quantity":1,"weight":0,"price":{"value":0,"denomination":"gp"},"attunement":0,"equipped":false,"rarity":"","identified":true,"activation":{"type":"","cost":null,"condition":""},"duration":{"value":"","units":""},"cover":null,"target":{"value":null,"width":null,"units":"","type":""},"range":{"value":null,"long":null,"units":""},"uses":{"value":null,"max":"","per":null,"recovery":""},"consume":{"type":"","target":null,"amount":null},"ability":null,"actionType":null,"attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"armor":{"value":null},"hp":{"value":null,"max":null,"dt":null,"conditions":""},"weaponType":"simpleM","baseItem":"","properties":{},"proficient":true},"effects":[],"folder":null,"sort":0,"ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1686175592868,"modifiedTime":1686175596446,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"_id":"eeFDRUbcOt0lwc7a"}
{"name":"Maneuvers: Rally","type":"feat","img":"icons/magic/perception/shadow-stealth-eyes-purple.webp","effects":[],"flags":{"ddbimporter":{"id":"2439086","entityTypeId":"222216831","componentId":1306902,"componentTypeId":258900837,"class":"Fighter","subclass":"Battle Master","importId":"28pyz8r4w0vt0973"},"infusions":{"infused":false},"obsidian":{"source":{"type":"class","text":"Fighter"}},"scene-packer":{"hash":"bb5b99210306aebff1d0057046c1855b04c269c7","sourceId":"Item.aM7l1DO4Qj51cCSY"},"spellTemplateManager":{"stmData":{"ignoreDuration":false,"spellTexture":"","useTexture":false,"alpha":50,"coneOrigin":1,"loopAnimations":true}},"midi-qol":{"effectActivation":false,"onUseMacroName":"[postActiveEffects]ItemMacro"},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"autoFailFriendly":false,"autoSaveFriendly":false,"offHandWeapon":false,"ignoreTotalCover":false},"magicitems":{"enabled":false,"equipped":false,"attuned":false,"charges":"0","chargeType":"c1","destroy":false,"destroyFlavorText":"reaches 0 charges: it crumbles into ashes and is destroyed.","rechargeable":false,"recharge":"0","rechargeType":"t1","rechargeUnit":"r1","sorting":"l"},"favtab":{"isFavorite":true},"itemacro":{"macro":{"data":{"_id":null,"name":"Maneuvers: Rally","type":"script","author":"ldRsJ6Yp5qPydWA1","img":"icons/svg/dice-target.svg","scope":"global","command":"","folder":null,"sort":0,"permission":{"default":0},"flags":{}},"name":"Maneuvers: Rally","type":"script","scope":"global","command":"let sourceActor = this.actor;\nlet SupDie = sourceActor.items.getName('Superiority Die');\nlet SupDieUses = SupDie.system.uses.value;\n         if (SupDieUses <= 0) return {};\n         if (!SupDie) {\n            ui.notifications.warn('Source actor does not appear to have a Superiority Die feature!');\n            return;}\nSupDie.update({'system.uses.value': SupDieUses - 1});","author":"Be8r6Sgxcs3sL08I","_id":null,"img":"icons/svg/dice-target.svg","folder":null,"sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null}}},"core":{"sourceId":"Item.QCt9G1ryLky9enrK"},"cf":{"id":"temp_pbbargtiogk"},"exportSource":{"world":"test","system":"dnd5e","coreVersion":"9.269","systemVersion":"1.6.1"},"rest-recovery":{"data":{"recovery":{"enabled":false}}}},"system":{"description":{"value":"<p><strong>MARQUE O ALVO QUE VAI RECEBER O EFEITO. CLIQUE.</strong></p><p><span style=\"font-family:'Helvetica Neue', Helvetica, Arial, sans-serif\">On your turn, you can use a bonus action and expend one superiority die to bolster the resolve of one of your companions. When you do so, choose a friendly creature who can see or hear you. That creature gains temporary hit points equal to the superiority die roll + your Charisma modifier.</span></p><p></p>","chat":"","unidentified":""},"source":"PHB p74","activation":{"type":"bonus","cost":1,"condition":""},"duration":{"value":"","units":""},"cover":null,"target":{"value":1,"width":null,"units":"","type":"ally"},"range":{"value":null,"long":null,"units":""},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"attribute","target":"","amount":1},"ability":"","actionType":"other","attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[["1d((2*floor(((@classes.fighter.levels)-2)/8))+8)+@abilities.cha.mod","temphp"]],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"type":{"value":"","subtype":""},"requirements":"Fighter: Battlemaster","recharge":{"value":null,"charged":false}},"ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1668460261771,"modifiedTime":1685305597625,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"_id":"fK0LckWJcTkaKAJR"}
{"name":"Maneuvers: Trip Attack","type":"feat","img":"icons/magic/perception/shadow-stealth-eyes-purple.webp","effects":[{"label":"Maneuvers: Trip Attack","icon":"icons/magic/perception/shadow-stealth-eyes-purple.webp","changes":[{"key":"flags.dnd5e.DamageBonusMacro","mode":0,"value":"ItemMacro","priority":20}],"transfer":true,"_id":"kMFbWjfCBzoaLAP1","disabled":false,"duration":{"startTime":null,"seconds":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"origin":null,"tint":null,"flags":{"dae":{"selfTarget":false,"selfTargetAlways":false,"stackable":"none","durationExpression":"","macroRepeat":"none","specialDuration":[]},"core":{"statusId":""},"ActiveAuras":{"isAura":false,"aura":"None","radius":null,"alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"displayTemp":false,"hostile":false,"onlyOnce":false}}}],"flags":{"ddbimporter":{"id":"2439086","entityTypeId":"222216831","componentId":1306902,"componentTypeId":258900837,"class":"Fighter","subclass":"Battle Master","importId":"28pyz8r4w0vt0973"},"infusions":{"infused":false},"obsidian":{"source":{"type":"class","text":"Fighter"}},"scene-packer":{"hash":"1d427ae377a960a04f240995e484f271678127e7","sourceId":"Item.iWz9q2UbN4L3kO4T"},"spellTemplateManager":{"stmData":{"ignoreDuration":false,"spellTexture":"","useTexture":false,"alpha":50,"coneOrigin":1,"loopAnimations":true}},"midi-qol":{"effectActivation":false},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"autoFailFriendly":false,"autoSaveFriendly":false,"offHandWeapon":false,"ignoreTotalCover":false},"magicitems":{"enabled":false,"equipped":false,"attuned":false,"charges":"0","chargeType":"c1","destroy":false,"destroyFlavorText":"reaches 0 charges: it crumbles into ashes and is destroyed.","rechargeable":false,"recharge":"0","rechargeType":"t1","rechargeUnit":"r1","sorting":"l"},"favtab":{"isFavorite":true},"itemacro":{"macro":{"data":{"_id":null,"name":"Maneuvers: Brace","type":"script","author":"ldRsJ6Yp5qPydWA1","img":"icons/svg/dice-target.svg","scope":"global","command":"","folder":null,"sort":0,"permission":{"default":0},"flags":{}},"name":"Maneuvers: Trip Attack","type":"script","scope":"global","command":"if (args[0].hitTargets.length < 1) return {};\nlet sourceActor = this.actor;\nlet SupDie = sourceActor.items.getName('Superiority Die');\nlet SupDieUses = SupDie.system.uses.value;\n         if (SupDieUses <= 0) return {};\n         if (!SupDie) {\n            ui.notifications.warn('Source actor does not appear to have a Superiority Die feature!');\n            return;}\nconst targetActor = game.user.targets.first().actor.uuid;         \nconst uuid = game.user.targets.first().actor.uuid;\nlet target = Array.from(game.user.targets)[0];\nconst hasEffectApplied = game.dfreds.effectInterface.hasEffectApplied('Prone', uuid);\nconst immunity = target.actor.system.traits.ci.value.has(\"prone\");\nif(immunity === true) {\n  ui.notifications.info(\"They are immune to prone!\");\n  return;\n}\n       \nconst targets = Array.from(game.user.targets);\nlet me = canvas.tokens.controlled[0].actor;\nlet meath = actor.data.data.abilities.str.mod\nlet meacr = actor.data.data.abilities.dex.mod\nlet bestSkill = meacr > meath ? meacr : meath;\nlet prof = me.data.data.attributes.prof\nlet DCtotal = 8+bestSkill+prof\n\nconst pcActor = MidiQOL.MQfromActorUuid(args[0].actorUuid);\n\tconst dActor = canvas.tokens.controlled[0].actor;\n\tconst fighterLevel = actor.getRollData().classes.fighter?.levels;\n\n\tif (fighterLevel > 17) superiorityDie = \"12\";\n   \t else if (fighterLevel > 9) superiorityDie = \"10\";\n  \t else if (fighterLevel > 0) superiorityDie = \"8\";\n\nlet dialog = new Promise((resolve, reject) => {\n        new Dialog({\n            // localize this text\n            title: \"Battle Master: Trip Attack\",\n            content: \"<p>Deseja usar o Maneuvers: Trip Attack (Dado Superiodade dano + Chance de Derrubar (prone))?</p>\",\n            buttons: {\n                one: {\n                    icon: '<p> </p><img src = \"icons/svg/light.svg\" width=\"60\" height=\"60\"></>',\n                    label: \"<p>Sim</p>\",\n                    callback: () => resolve(\"SIM\")\n                },\n                two: {\n                    icon: '<p> </p><img src = \"icons/svg/hazard.svg\" width=\"60\" height=\"60\"></>',\n                    label: \"<p>Não</p>\",\n                    callback: () => { resolve(\"NAO\") }\n                }\n            },\n            default: \"two\"\n        }).render(true);\n    });\n\n     const effectData = {\n        label: \"Trip\", \n        icon: \"icons/skills/melee/blade-tip-chipped-blood-red.webp\",\n        changes: [\n          {key: \"macro.CE\", mode: 0, value: \"Prone\", priority: 20} // macro to apply the damage\n                ],\n      }\n\n    let choiceACBonus = await dialog;\n    const baseDice = 1\n    if (choiceACBonus === \"SIM\") {\n    SupDie.update({'system.uses.value': SupDieUses - 1});\n    const targets = Array.from(game.user.targets);\n    const wait = async (ms) => new Promise((resolve)=> setTimeout(resolve, ms));\n    for (const target of targets) {\n            await game.MonksTokenBar.requestRoll(targets,{request:\"save:str\", silent: true, dc: DCtotal});\n            await wait(11000)\n            const listMessages = game.messages.contents\n            const lastMessage = listMessages[listMessages.length - 1];\n            let tokenid = 'token'+target.id;\n            let saveRoll = lastMessage.data.flags[\"monks-tokenbar\"][tokenid].total\n            if (saveRoll < DCtotal) {\n            if (!hasEffectApplied) {\n     \t    await MidiQOL.socket().executeAsGM(\"createEffects\", { actorUuid: targetActor, effects: [effectData] });\n        }}}\nconst diceMult = args[0].isCritical ? 2: 1;\nreturn {damageRoll: `${diceMult}d${superiorityDie}`, flavor: \"Trip Attack\"};\n}","author":"Be8r6Sgxcs3sL08I","_id":null,"img":"icons/svg/dice-target.svg","folder":null,"sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null}}},"core":{"sourceId":"Item.QCt9G1ryLky9enrK"},"cf":{"id":"temp_pbbargtiogk","path":"Manobras - Battle Master Novo","color":"#b74e4e"},"exportSource":{"world":"test","system":"dnd5e","coreVersion":"9.269","systemVersion":"1.6.1"},"rest-recovery":{"data":{"recovery":{"enabled":false}}}},"system":{"description":{"value":"<p><strong>SE VC ACERTAR ELE VAI PEDIR. CLIQUE SIM OU NÃO.</strong></p><p><span style=\"font-family:'Helvetica Neue', Helvetica, Arial, sans-serif\">When you hit a creature with a weapon attack, you can expend one superiority die to attempt to knock the target down. You add the superiority die to the attack's damage roll, and if the target is Large or smaller, it must make a Strength saving throw. On a failed save, you knock the target prone.</span></p><p><span style=\"font-family:Signika, sans-serif\">SAVE DC = 8 + your proficiency bonus + your Strength or Dexterity modifier (your choice)</span></p>","chat":"","unidentified":""},"source":"TCoE p42","activation":{"type":"special","cost":null,"condition":""},"duration":{"value":null,"units":""},"cover":null,"target":{"value":null,"width":null,"units":"","type":"self"},"range":{"value":null,"long":null,"units":"self"},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"attribute","target":"","amount":1},"ability":"","actionType":"other","attackBonus":0,"chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"type":{"value":"","subtype":""},"requirements":"Fighter: Battlemaster","recharge":{"value":null,"charged":false},"attunement":0},"ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1668460261754,"modifiedTime":1685300193337,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"_id":"frSGWpRpOrEpSutm"}
{"name":"Maneuvers: Quick Toss","type":"feat","img":"icons/skills/melee/weapons-crossed-swords-yellow.webp","effects":[{"label":"Maneuvers: Quick Toss","icon":"icons/skills/melee/weapons-crossed-swords-yellow.webp","changes":[{"key":"system.bonuses.All-Damage","mode":2,"value":"+1d((2*floor(((@classes.fighter.levels)-2)/8))+8)","priority":20}],"transfer":false,"_id":"uMbSvDuOby8PBdig","disabled":false,"duration":{"startTime":null,"seconds":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"origin":null,"tint":null,"flags":{"dae":{"selfTarget":true,"selfTargetAlways":false,"stackable":"none","durationExpression":"","macroRepeat":"none","specialDuration":["1Attack"]},"core":{"statusId":"bonus"},"ActiveAuras":{"isAura":false,"aura":"None","radius":"","alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"displayTemp":false,"hostile":false,"onlyOnce":false},"dfreds-convenient-effects":{"description":""}}}],"flags":{"ddbimporter":{"id":"2439086","entityTypeId":"222216831","componentId":1306902,"componentTypeId":258900837,"class":"Fighter","subclass":"Battle Master","importId":"28pyz8r4w0vt0973"},"infusions":{"infused":false},"obsidian":{"source":{"type":"class","text":"Fighter"}},"scene-packer":{"hash":"0a83478f2fb016e8b7ab41876040e59a3f3eb25b","sourceId":"Item.xuvIjgUy0xJer9Ue"},"spellTemplateManager":{"stmData":{"ignoreDuration":false,"spellTexture":"","useTexture":false,"alpha":50,"coneOrigin":1,"loopAnimations":true}},"midi-qol":{"effectActivation":false,"onUseMacroName":"[postActiveEffects]ItemMacro"},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"autoFailFriendly":false,"autoSaveFriendly":false,"offHandWeapon":false,"ignoreTotalCover":false},"magicitems":{"enabled":false,"equipped":false,"attuned":false,"charges":"0","chargeType":"c1","destroy":false,"destroyFlavorText":"reaches 0 charges: it crumbles into ashes and is destroyed.","rechargeable":false,"recharge":"0","rechargeType":"t1","rechargeUnit":"r1","sorting":"l"},"favtab":{"isFavorite":true},"itemacro":{"macro":{"data":{"_id":null,"name":"Maneuvers: Brace","type":"script","author":"ldRsJ6Yp5qPydWA1","img":"icons/svg/dice-target.svg","scope":"global","command":"","folder":null,"sort":0,"permission":{"default":0},"flags":{}},"name":"Maneuvers: Quick Toss","type":"script","scope":"global","command":"let sourceActor = this.actor;\nlet SupDie = sourceActor.items.getName('Superiority Die');\nlet SupDieUses = SupDie.system.uses.value;\n         if (SupDieUses <= 0) return {};\n         if (!SupDie) {\n            ui.notifications.warn('Source actor does not appear to have a Superiority Die feature!');\n            return;}\nSupDie.update({'system.uses.value': SupDieUses - 1});","author":"Be8r6Sgxcs3sL08I","_id":null,"img":"icons/svg/dice-target.svg","folder":null,"sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null}}},"core":{"sourceId":"Item.QCt9G1ryLky9enrK"},"cf":{"id":"temp_pbbargtiogk","path":"Manobras - Battle Master Novo","color":"#b74e4e"},"exportSource":{"world":"test","system":"dnd5e","coreVersion":"9.269","systemVersion":"1.6.1"},"rest-recovery":{"data":{"recovery":{"enabled":false}}}},"system":{"description":{"value":"<p><strong>CLIQUE PARA GERAR O EFEITO. EM SEGUIDA ROLE NECESSARIAMENTE O ATK QUE VAI RECEBER ESSE BONUS.</strong></p><p><span style=\"font-family:'Helvetica Neue', Helvetica, Arial, sans-serif\">As a bonus action, you can expend one superiority die and make a ranged attack with a weapon that has the thrown property. You can draw the weapon as part of making this attack. If you hit, add the superiority die to the weapon's damage roll.</span></p><p></p><p></p><p></p>","chat":"","unidentified":""},"source":"TCoE p42","activation":{"type":"special","cost":1,"condition":""},"duration":{"value":"","units":""},"cover":null,"target":{"value":null,"width":null,"units":"","type":"self"},"range":{"value":null,"long":null,"units":"self"},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"attribute","target":"","amount":1},"ability":"","actionType":"other","attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"type":{"value":"","subtype":""},"requirements":"Fighter: Battlemaster","recharge":{"value":null,"charged":false}},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1668460261780,"modifiedTime":1685305613839,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"_id":"hCd7iD7WCRkiFo6P"}
{"name":"Maneuvers: Distracting Strike","type":"feat","img":"icons/skills/melee/blade-tip-chipped-blood-red.webp","effects":[{"_id":"z6c1xhx4agrwbd3z","changes":[{"key":"flags.dnd5e.DamageBonusMacro","mode":0,"value":"ItemMacro","priority":20}],"disabled":false,"duration":{"startTime":null,"turns":null,"seconds":null,"combat":null,"rounds":null,"startRound":null,"startTurn":null},"icon":"icons/skills/melee/blade-tip-chipped-blood-red.webp","label":"Maneuvers: Distracting Strike","origin":"Actor.67GUmdTadYmGXD8W.Item.uIJSbACjp9yNcSdf","transfer":true,"flags":{"core":{"statusId":""},"dae":{"stackable":"none","durationExpression":"","macroRepeat":"none","specialDuration":["None"],"transfer":false,"selfTarget":false,"selfTargetAlways":false},"ActiveAuras":{"isAura":false,"aura":"None","radius":null,"alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"displayTemp":false,"hostile":false,"onlyOnce":false}},"tint":null}],"flags":{"ddbimporter":{"id":"53570","entityTypeId":"222216831","componentId":22,"componentTypeId":258900837,"class":"Fighter","subclass":"Battle Master","importId":"ye6nz9f4x9n3v7lu","ignoreIcon":true,"ignoreItemImport":true,"retainResourceConsumption":true},"infusions":{"infused":false},"obsidian":{"source":{"type":"class","text":"Fighter"}},"spellTemplateManager":{"stmData":{"ignoreDuration":false,"spellTexture":"","useTexture":false,"alpha":50,"coneOrigin":1,"loopAnimations":true}},"midi-qol":{"effectActivation":false,"onUseMacroName":""},"midiProperties":{"nodam":false,"halfdam":false,"fulldam":false,"rollOther":false,"critOther":false,"concentration":false,"magicdam":false,"magiceffect":false,"toggleEffect":false,"ignoreTotalCover":false},"magicitems":{"enabled":false,"equipped":false,"attuned":false,"charges":"0","chargeType":"c1","destroy":false,"destroyFlavorText":"reaches 0 charges: it crumbles into ashes and is destroyed.","rechargeable":false,"recharge":"0","rechargeType":"t1","rechargeUnit":"r1","sorting":"l"},"itemacro":{"macro":{"data":{"_id":null,"name":"Maneuvers: Trip Attack","type":"script","author":"ldRsJ6Yp5qPydWA1","img":"icons/svg/dice-target.svg","scope":"global","command":"","folder":null,"sort":0,"permission":{"default":0},"flags":{}},"name":"Maneuvers: Distracting Strike","type":"script","scope":"global","command":"if (args[0].hitTargets.length < 1) return {};\n\nlet sourceActor = this.actor;\nlet SupDie = sourceActor.items.getName('Superiority Die');\nlet SupDieUses = SupDie.system.uses.value;\n      if (SupDieUses <= 0) return {};\n        if (!SupDie) {\n            ui.notifications.warn('Source actor does not appear to have a Bardic Inspiration feature!');\n            return;}\n\nconst pcActor = MidiQOL.MQfromActorUuid(args[0].actorUuid);\n\tconst dActor = canvas.tokens.controlled[0].actor;\n\tconst fighterLevel = actor.getRollData().classes.fighter?.levels;\n\n\tif (fighterLevel > 17) superiorityDie = \"12\";\n   \t else if (fighterLevel > 9) superiorityDie = \"10\";\n  \t else if (fighterLevel > 0) superiorityDie = \"8\";\n\nlet dialog = new Promise((resolve, reject) => {\n        new Dialog({\n            // localize this text\n            title: \"Maneuvers: Distracting Strike\",\n            content: \"<p>Deseja usar o Maneuvers: Distracting Strike (+1 dado dano e vantagem para o proximo atacante q não seja você (SE VC for atacar atenção, a macro não diferencia quem vai atacar)?</p>\",\n            buttons: {\n                one: {\n                    icon: '<p> </p><img src = \"icons/svg/light.svg\" width=\"60\" height=\"60\"></>',\n                    label: \"<p>Sim</p>\",\n                    callback: () => resolve(\"SIM\")\n                },\n                two: {\n                    icon: '<p> </p><img src = \"icons/svg/hazard.svg\" width=\"60\" height=\"60\"></>',\n                    label: \"<p>Não</p>\",\n                    callback: () => { resolve(\"NAO\") }\n                }\n            },\n            default: \"two\"\n        }).render(true);\n    });\n\n    let choiceACBonus = await dialog;\n    const baseDice = 1\n    if (choiceACBonus === \"SIM\") {\n    SupDie.update({'system.uses.value': SupDieUses - 1});\n    const targetActor = args[0].targets[0].actor;\n    await targetActor.createEmbeddedDocuments(\"ActiveEffect\", [{\n            \"changes\": [{value: 1, mode: CONST.ACTIVE_EFFECT_MODES.CUSTOM, priority: 20, key:\"flags.midi-qol.grants.advantage.attack.all\"}],\n            \"label\": \"Distracting Strike\",\n            \"origin\": args[0].itemUuid,\n            \"icon\": \"icons/skills/melee/blade-tip-chipped-blood-red.webp\",\n \t    \"flags\": {\n                \"dae\": {\n                  \"specialDuration\": [\n                    \"isAttacked\",\n                    \"turnStartSource\"]}}\n        }]);};\n    const diceMult = args[0].isCritical ? 2: 1;\n    return {damageRoll: `${diceMult}d${superiorityDie}`, flavor: \"Distracting Strike\"}","author":"Be8r6Sgxcs3sL08I","_id":null,"img":"icons/svg/dice-target.svg","folder":null,"sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null}}},"favtab":{"isFavorite":true},"scene-packer":{"hash":"6b7080f0d3a687b39d68d0632f0380d6cacd05ad","sourceId":"Item.sc5t97Kfw1ImQQ81"},"core":{"sourceId":"Item.bpSu08y0CydFPHEi"},"cf":{"id":"temp_pbbargtiogk","path":"Manobras - Battle Master Novo","color":"#b74e4e"},"exportSource":{"world":"test","system":"dnd5e","coreVersion":"9.269","systemVersion":"1.6.1"},"rest-recovery":{"data":{"recovery":{"enabled":false}}}},"system":{"description":{"value":"<p><strong>NÃO USE A SKILL. ATAQUE NORMALMENTE.. ESCOLHA SE VAI USAR A SKILL (SÓ APARECE SE ACERTAR).</strong></p><p><strong>ATENÇÃO 1: A VANTAGEM SE APLICA A TODOS, INCLUINDO VC, NÃO TEM COMO MUDAR ISSO, ENTÃO FIQUE LIGADO PQ A SKILL NÃO É PRA VC.</strong></p><p><strong>ATENÇÃO 2: A SKILL NÃO SAI COM 1 ATK. AVISAR PRA TIRAR NO DEDO DEPOIS.</strong></p><p>When you hit a creature with a weapon attack, you can expend one superiority die to distract the creature, giving your allies an opening. You add the superiority die to the attack's damage roll. The next attack roll against the target by an attacker other than you has advantage if the attack is made before the start of your next turn.</p><p></p><p></p>","chat":"","unidentified":""},"source":"PHB p74","activation":{"type":"special","cost":null,"condition":""},"duration":{"value":null,"units":"inst"},"cover":null,"target":{"value":null,"width":null,"units":"","type":"self"},"range":{"value":null,"long":null,"units":"self"},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"attribute","target":"","amount":1},"ability":"","actionType":"","attackBonus":"0","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[["0 + @flags.dae.SuperiorityDie[Superiority]",""]],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"str"},"type":{"value":"","subtype":""},"requirements":"Fighter: Battlemaster","recharge":{"value":null,"charged":false},"attunement":0},"ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1668460261785,"modifiedTime":1685305505959,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"_id":"hiyodUOZbdU7DDKq"}
{"name":"Metamagic: Heightened Spell","ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"type":"feat","system":{"description":{"value":"<p>When you cast a spell that forces a creature to make a saving throw to resist its effects, you can spend 3 sorcery points to give one target of the spell disadvantage on its first saving throw made against the spell.</p>","chat":"","unidentified":""},"source":"SRD 5.1","activation":{"type":"special","cost":null,"condition":""},"duration":{"value":"","units":""},"cover":null,"target":{"value":null,"width":null,"units":"","type":""},"range":{"value":null,"long":null,"units":""},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"charges","target":"qTydC5cRYMjjGZgN","amount":3},"ability":"","actionType":"","attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"type":{"value":"class","subtype":"metamagic"},"requirements":"Sorcerer 3","recharge":{"value":null,"charged":false}},"flags":{"core":{"sourceId":"Compendium.dnd5e.classfeatures.tNG2qi9zhmXEkecA"},"rest-recovery":{"data":{"recovery":{"enabled":false}}},"cf":{"id":"temp_arnwcbydlr"}},"img":"icons/magic/fire/explosion-mushroom-nuke-orange.webp","effects":[{"label":"Metamagic: Heightened Spell","icon":"icons/magic/fire/explosion-mushroom-nuke-orange.webp","changes":[{"key":"flags.midi-qol.disadvantage.ability.save.all","mode":0,"value":"1","priority":20}],"transfer":false,"_id":"U9i7KMI7CHBlz44y","disabled":false,"duration":{"startTime":null,"seconds":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"origin":null,"tint":null,"flags":{"dfreds-convenient-effects":{"description":""},"dae":{"selfTarget":false,"selfTargetAlways":false,"stackable":"noneName","durationExpression":"","macroRepeat":"none","specialDuration":["isSave"]},"core":{"statusId":"Show"},"ActiveAuras":{"isAura":false,"aura":"None","radius":"","alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"displayTemp":false,"hostile":false,"onlyOnce":false}}}],"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1661787234433,"modifiedTime":1686175664528,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"_id":"jTEHcbeil3nRk5I2"}
{"name":"Maneuvers: Sweeping Attack","type":"feat","img":"icons/skills/melee/weapons-crossed-swords-yellow.webp","effects":[],"flags":{"ddbimporter":{"id":"2439086","entityTypeId":"222216831","componentId":1306902,"componentTypeId":258900837,"class":"Fighter","subclass":"Battle Master","importId":"28pyz8r4w0vt0973"},"infusions":{"infused":false},"obsidian":{"source":{"type":"class","text":"Fighter"}},"scene-packer":{"hash":"78785ad8948d6303d95c2205ab92380bb43a62ce","sourceId":"Item.PBVEexnPHVowsa1n"},"spellTemplateManager":{"stmData":{"ignoreDuration":false,"spellTexture":"","useTexture":false,"alpha":50,"coneOrigin":1,"loopAnimations":true}},"midi-qol":{"effectActivation":false,"onUseMacroName":"[postActiveEffects]ItemMacro"},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false,"autoFailFriendly":false,"autoSaveFriendly":false,"offHandWeapon":false},"magicitems":{"enabled":false,"equipped":false,"attuned":false,"charges":"0","chargeType":"c1","destroy":false,"destroyFlavorText":"reaches 0 charges: it crumbles into ashes and is destroyed.","rechargeable":false,"recharge":"0","rechargeType":"t1","rechargeUnit":"r1","sorting":"l"},"favtab":{"isFavorite":true},"itemacro":{"macro":{"data":{"_id":null,"name":"Maneuvers: Brace","type":"script","author":"ldRsJ6Yp5qPydWA1","img":"icons/svg/dice-target.svg","scope":"global","command":"","folder":null,"sort":0,"permission":{"default":0},"flags":{}},"name":"Maneuvers: Sweeping Attack (Semi-Manual)","type":"script","scope":"global","command":"let sourceActor = this.actor;\nlet SupDie = sourceActor.items.getName('Superiority Die');\nlet SupDieUses = SupDie.system.uses.value;\n         if (SupDieUses <= 0) return {};\n         if (!SupDie) {\n            ui.notifications.warn('Source actor does not appear to have a Superiority Die feature!');\n            return;}\nSupDie.update({'system.uses.value': SupDieUses - 1});","author":"Be8r6Sgxcs3sL08I","_id":null,"img":"icons/svg/dice-target.svg","folder":null,"sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null}}},"core":{"sourceId":"Item.QCt9G1ryLky9enrK"},"cf":{"id":"temp_pbbargtiogk","path":"Manobras - Battle Master Novo","color":"#b74e4e"},"exportSource":{"world":"test","system":"dnd5e","coreVersion":"9.269","systemVersion":"1.6.1"},"rest-recovery":{"data":{"recovery":{"enabled":false}}}},"system":{"description":{"value":"<p><strong>CLICAR NESSE ITEM SEM ALVO. </strong></p><p><strong>VAI ROLAR O DANO NO CHAT. GM TIRA MANUALMENTE.</strong></p><p><span style=\"font-family:'Helvetica Neue', Helvetica, Arial, sans-serif\">When you hit a creature with a melee weapon attack, you can expend one superiority die to attempt to damage another creature with the same attack. Choose another creature within 5 feet of the original target and within your reach. If the original attack roll would hit the second creature, it takes damage equal to the number you roll on your superiority die. The damage is of the same type dealt by the original attack.</span></p>","chat":"","unidentified":""},"source":"PHB p74","activation":{"type":"special","cost":null,"condition":""},"duration":{"value":"","units":"inst"},"cover":null,"target":{"value":1,"width":null,"units":"","type":"creature"},"range":{"value":null,"long":null,"units":""},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"attribute","target":"","amount":1},"ability":"","actionType":"util","attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[["1d((2*floor(((@classes.fighter.levels)-2)/8))+8)",""]],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"type":{"value":"","subtype":""},"requirements":"Fighter: Battlemaster","recharge":{"value":null,"charged":false}},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1668460261786,"modifiedTime":1685305564466,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"_id":"kXJf3aDVq204ff4h"}
{"_id":"lINjzvvdJj0AFDGQ","name":"Tough","type":"feat","img":"modules/plutonium/media/icon/feat/phb-tough.webp","data":{"description":{"value":"<div>\n\t\t\t\t\n\t\t\t\t<div class=\"rd__b  rd__b--3\"><p>Your hit point maximum increases by an amount equal to twice your level when you gain this feat. Whenever you gain a level thereafter, your hit point maximum increases by an additional 2 hit points.</p><div class=\"rd__spc-inline-post\"></div></div>\n\t\t\t</div>","chat":"","unidentified":""},"source":"PHB","activation":{"type":"","cost":0,"condition":""},"duration":{"value":0,"units":""},"target":{"value":0,"width":null,"units":"","type":""},"range":{"value":0,"long":0,"units":null},"uses":{"value":0,"max":0,"per":""},"consume":{"type":"","target":null,"amount":null},"ability":"","actionType":"","attackBonus":0,"chatFlavor":"","critical":null,"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"requirements":"","recharge":{"value":0,"charged":true}},"effects":[{"_id":"dHpWbiIZQkyzSVRh","changes":[{"key":"data.attributes.hp.max","mode":2,"value":"@details.level*2","priority":"20"}],"disabled":false,"duration":{"startTime":null},"icon":"modules/plutonium/media/icon/feat/phb-tough.webp","label":"Tough","transfer":true,"flags":{"dae":{"stackable":"none","macroRepeat":"none","specialDuration":[],"transfer":true},"dnd5e-helpers":{"rest-effect":"Ignore"},"ActiveAuras":{"isAura":false,"aura":"None","radius":null,"alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"hostile":false,"onlyOnce":false}},"tint":null,"selectedKey":"data.attributes.hp.max"}],"folder":null,"sort":0,"permission":{"default":0,"rbM5nB1AbUwbj4yJ":3},"flags":{"srd5e":{"page":"feats.html","source":"PHB","hash":"tough_phb"},"core":{"sourceId":"Item.UEankt4zuh3x9q2g"},"siftoolkit":{"SIFData":{"ignoreDuration":false,"texture":"","useTexture":false,"alpha":50,"coneOrigin":1,"loopAnimations":true,"playTemplateAudio":false,"playDamageAudio":false,"clip":"","volume":100}},"magicitems":{"enabled":false,"equipped":false,"attuned":false,"charges":"0","chargeType":"c1","destroy":false,"destroyFlavorText":"reaches 0 charges: it crumbles into ashes and is destroyed.","rechargeable":false,"recharge":"0","rechargeType":"t1","rechargeUnit":"r1","sorting":"l"},"cf":{"id":"temp_a5umw776e9r"}}}
{"name":"Maneuvers: Riposte","type":"feat","img":"icons/skills/melee/weapons-crossed-swords-yellow.webp","effects":[{"label":"Maneuvers: Riposte","changes":[{"key":"system.bonuses.mwak.damage","mode":2,"value":"+1d((2*floor(((@classes.fighter.levels)-2)/8))+8)","priority":20}],"duration":{"turns":2,"startTime":null,"seconds":null,"combat":null,"rounds":null,"startRound":null,"startTurn":null},"tint":null,"transfer":false,"disabled":false,"flags":{"dae":{"transfer":false,"stackable":"none","specialDuration":["1Attack:mwak"],"selfTarget":false,"selfTargetAlways":false,"durationExpression":"","macroRepeat":"none"},"ddbimporter":{"disabled":false},"midi-qol":{"forceCEOff":true},"dfreds-convenient-effects":{"description":"test"},"core":{"statusId":""},"ActiveAuras":{"isAura":false,"aura":"None","radius":"undefined","alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"displayTemp":false,"hostile":false,"onlyOnce":false}},"icon":"icons/skills/melee/weapons-crossed-swords-yellow.webp","_id":"hZbaD38eQRkxKakq","origin":null}],"flags":{"ddbimporter":{"id":"53568","entityTypeId":"222216831","componentId":20,"componentTypeId":258900837,"class":"Fighter","subclass":"Battle Master","importId":"W4YWKJNkxUtA2RJP","type":"class","effectsApplied":true},"infusions":{"infused":false},"obsidian":{"source":{"type":"class","text":"Fighter"}},"scene-packer":{"hash":"ac123cbac97430908ee117890dc512069179a162","sourceId":"Item.STzLjpsChlX4y9uf"},"favtab":{"isFavorite":true},"spellTemplateManager":{"stmData":{"ignoreDuration":false,"spellTexture":"","useTexture":false,"alpha":50,"coneOrigin":1,"loopAnimations":true}},"midi-qol":{"effectActivation":false,"onUseMacroName":"[postActiveEffects]ItemMacro","forceCEOff":true},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"autoFailFriendly":false,"autoSaveFriendly":false,"offHandWeapon":false,"ignoreTotalCover":false},"magicitems":{"enabled":false,"equipped":false,"attuned":false,"charges":"0","chargeType":"c1","destroy":false,"destroyFlavorText":"reaches 0 charges: it crumbles into ashes and is destroyed.","rechargeable":false,"recharge":"0","rechargeType":"t1","rechargeUnit":"r1","sorting":"l"},"itemacro":{"macro":{"data":{"_id":null,"name":"Maneuvers: Riposte","type":"script","author":"ldRsJ6Yp5qPydWA1","img":"icons/svg/dice-target.svg","scope":"global","command":"","folder":null,"sort":0,"permission":{"default":0},"flags":{}},"name":"Maneuvers: Riposte","type":"script","scope":"global","command":"let sourceActor = this.actor;\nlet SupDie = sourceActor.items.getName('Superiority Die');\nlet SupDieUses = SupDie.system.uses.value;\n         if (SupDieUses <= 0) return {};\n         if (!SupDie) {\n            ui.notifications.warn('Source actor does not appear to have a Superiority Die feature!');\n            return;}\nSupDie.update({'system.uses.value': SupDieUses - 1});","author":"Be8r6Sgxcs3sL08I","_id":null,"img":"icons/svg/dice-target.svg","folder":null,"sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null}}},"core":{"sourceId":"Actor.XauTPmdt4Drmy2f5.Item.iXhmaFUEC74Om45D"},"cf":{"id":"temp_pbbargtiogk","path":"Manobras - Battle Master Novo","color":"#b74e4e"},"exportSource":{"world":"test","system":"dnd5e","coreVersion":"9.269","systemVersion":"1.6.1"},"rest-recovery":{"data":{"recovery":{"enabled":false}}},"custom-character-sheet-sections":{"sectionName":""}},"system":{"description":{"value":"<p><strong>CLICAR PARA ATIVAR O EFEITO E DEPOIS ATACAR.</strong></p><p><span style=\"font-family:'Helvetica Neue', Helvetica, Arial, sans-serif\">When a creature misses you with a melee attack, you can use your reaction and expend one superiority die to make a melee weapon attack against the creature. If you hit, you add the superiority die to the attack's damage roll.</span></p>","chat":"","unidentified":""},"source":"","activation":{"type":"reactionmanual","cost":1,"condition":""},"duration":{"value":null,"units":""},"cover":null,"target":{"value":null,"width":null,"units":"","type":"self"},"range":{"value":null,"long":null,"units":""},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"charges","target":"","amount":1},"ability":"","actionType":"other","attackBonus":0,"chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"type":{"value":"class","subtype":"maneuver"},"requirements":"","recharge":{"value":null,"charged":false},"attunement":0},"ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1678278810727,"modifiedTime":1685305594434,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"_id":"mWWX4mek55sYbSQd"}
{"name":"Superiority Die","type":"feat","img":"icons/sundries/gaming/dice-runed-brown.webp","effects":[{"label":"Superiority Die","icon":"icons/sundries/gaming/dice-runed-brown.webp","changes":[{"key":"system.resources.secondary.max","mode":5,"value":"floor((@classes.fighter.levels + 1) / 8) + 4","priority":20},{"key":"system.resources.secondary.label","mode":5,"value":"Superiority Die","priority":20},{"key":"system.resources.secondary.lr","mode":5,"value":"1","priority":20},{"key":"system.resources.secondary.sr","mode":5,"value":"1","priority":20}],"transfer":true,"_id":"mt4pyiitTOvx5b40","disabled":false,"duration":{"startTime":null,"seconds":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"origin":null,"tint":null,"flags":{"dae":{"selfTarget":false,"selfTargetAlways":false,"stackable":"none","durationExpression":"","macroRepeat":"none","specialDuration":[]},"core":{"statusId":""},"ActiveAuras":{"isAura":false,"aura":"None","radius":"","alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"displayTemp":false,"hostile":false,"onlyOnce":false},"dfreds-convenient-effects":{"description":""}}}],"flags":{"ddbimporter":{"id":"1023","entityTypeId":"222216831","componentId":209,"componentTypeId":12168134,"class":"Fighter","subclass":"Battle Master","dndbeyond":{"levelScale":{"id":12,"level":7,"description":"d8","dice":{"diceCount":5,"diceValue":8,"diceMultiplier":null,"fixedValue":null,"diceString":"5d8"},"fixedValue":null},"levelScales":[{"id":11,"level":1,"description":"d8","dice":{"diceCount":4,"diceValue":8,"diceMultiplier":null,"fixedValue":null,"diceString":"4d8"},"fixedValue":null},{"id":12,"level":7,"description":"d8","dice":{"diceCount":5,"diceValue":8,"diceMultiplier":null,"fixedValue":null,"diceString":"5d8"},"fixedValue":null},{"id":13,"level":10,"description":"d10","dice":{"diceCount":5,"diceValue":10,"diceMultiplier":null,"fixedValue":null,"diceString":"5d10"},"fixedValue":null},{"id":14,"level":15,"description":"d10","dice":{"diceCount":6,"diceValue":10,"diceMultiplier":null,"fixedValue":null,"diceString":"6d10"},"fixedValue":null},{"id":15,"level":18,"description":"d12","dice":{"diceCount":6,"diceValue":12,"diceMultiplier":null,"fixedValue":null,"diceString":"6d12"},"fixedValue":null}],"limitedUse":[{"level":null,"uses":1}]},"importId":"ye6nz9f4x9n3v7lu","ignoreIcon":true,"ignoreItemImport":true,"retainResourceConsumption":true},"infusions":{"infused":false},"obsidian":{"source":{"type":"class","text":"Fighter"}},"spellTemplateManager":{"stmData":{"ignoreDuration":false,"spellTexture":"","useTexture":false,"alpha":50,"coneOrigin":1,"loopAnimations":true}},"midi-qol":{"effectActivation":false,"onUseMacroName":""},"midiProperties":{"nodam":false,"halfdam":false,"fulldam":false,"rollOther":false,"critOther":false,"concentration":false,"magicdam":false,"magiceffect":false,"toggleEffect":false,"ignoreTotalCover":false,"autoFailFriendly":false,"offHandWeapon":false,"autoSaveFriendly":false},"magicitems":{"enabled":false,"equipped":false,"attuned":false,"charges":"0","chargeType":"c1","destroy":false,"destroyFlavorText":"reaches 0 charges: it crumbles into ashes and is destroyed.","rechargeable":false,"recharge":"0","rechargeType":"t1","rechargeUnit":"r1","sorting":"l"},"scene-packer":{"hash":"a87762384522f590736ad8d73ac8e7404a2bca2a","sourceId":"Item.vHao9Rby7ILSUA0z"},"core":{"sourceId":"Item.8gdA6c8j5GnkX33K"},"itemacro":{"macro":{"data":{"_id":null,"name":"Superiority Die","type":"script","author":"ldRsJ6Yp5qPydWA1","img":"icons/svg/dice-target.svg","scope":"global","command":"/*****\nFighter Battlemaster : Superiority Die\n\nUSEAGE : PASSIVE\nThis item must be on the character for Manuevers to function.  \nIt does not do anything directly but is a helper effect to determine the Battle Master Hit Die (d8, d10, d12) based on level.\n \nv1.3 August 6 2022 jbowens #0415 (Discord) https://github.com/jbowensii/More-Automated-Spells-Items-and-Feats.git \n*****/\n\nif (args[0] === \"on\") {\n    const pcActor = await fromUuid(args[args.length - 1].actorUuid);\n    console.log(\"MACRO TEST | PC Actor: %O\", pcActor);\n\n    // Test Class\n    let pcFighter = pcActor.getRollData().classes?.fighter;\n    if (pcFighter === null) {\n        ui.notifications.error(\"You are not a Fighter!\");\n        return;\n    }\n\n    // Test Subclass\n    let pcFighterSubclass = pcActor.getRollData().classes.fighter?.subclass.identifier;\n    if (pcFighterSubclass != \"battle-master\") {\n        ui.notifications.error(\"You are not a Fighter Battlemaster!\");\n        return;\n    }\n\n    //const roll = await(new Roll(`2d8 + ${pcPaladin.levels}`)).roll();\n    let fighterLevel = pcFighter.levels;\n    console.log(\"MACRO TEST | Fighter Levels: %s\", fighterLevel);\n\n    let flagData;\n    if (fighterLevel > 17) flagData = \"+ 1d12\";\n    else if (fighterLevel > 9) flagData = \"+ 1d10\";\n    else if (fighterLevel > 0) flagData = \"+ 1d8\";\n    pcActor.setFlag(\"dae\", \"SuperiorityDie\", flagData)\n\n} else if (args[0] === \"off\") {\n    const pcActor = await fromUuid(args[args.length - 1].actorUuid);\n    pcActor.unsetFlag(\"dae\", \"SuperiorityDie\");\n}","folder":null,"sort":0,"permission":{"default":0},"flags":{}},"name":"Superiority Die","type":"script","scope":"global","command":"","author":"Be8r6Sgxcs3sL08I","_id":null,"img":"icons/svg/dice-target.svg","folder":null,"sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null}}},"exportSource":{"world":"test","system":"dnd5e","coreVersion":"9.269","systemVersion":"1.6.3"},"favtab":{"isFavorite":true},"cf":{"id":"temp_pbbargtiogk","path":"Manobras - Battle Master Novo","color":"#b74e4e"},"rest-recovery":{"data":{"recovery":{"enabled":false}}}},"system":{"description":{"value":"<p>When you choose this archetype at 3rd level, you learn maneuvers that are fueled by special dice called superiority dice.</p><p><strong>Maneuvers</strong>. You learn three maneuvers of your choice. Many maneuvers enhance an attack in some way. You can use only one maneuver per attack. You learn two additional maneuvers of your choice at 7th, 10th, and 15th level. Each time you learn new maneuvers, you can also replace one maneuver you know with a different one.</p><p><strong>Superiority Dice</strong>. You have four superiority dice, which are d8s. A superiority die is expended when you use it. You regain all of your expended superiority dice when you finish a short or long rest. You gain another superiority die at 7th level and one more at 15th level.</p><p><strong>Saving Throws</strong>. Some of your maneuvers require your target to make a saving throw to resist the maneuver's effects. The saving throw DC is calculated as follows:</p><p><strong>Maneuver save DC</strong> = 8 + your proficiency bonus + your Strength or Dexterity modifier (your choice)</p><p><span style=\"font-family:'Helvetica Neue', Helvetica, Arial, sans-serif\"><em>At 10th level, your superiority dice turn into d10s. At 18th level, they turn into d12s.</em></span></p><details><summary></summary><details><summary>v1.2 May 7 2022</summary><p>jbowens #0415 (Discord)</p><p>https://github.com/jbowensii/More-Automated-Spells-Items-and-Feats.git</p></details></details>","chat":"","unidentified":""},"source":"PHB p74","activation":{"type":"special","cost":1,"condition":""},"duration":{"value":null,"units":""},"cover":null,"target":{"value":null,"width":null,"units":"","type":""},"range":{"value":null,"long":null,"units":""},"uses":{"value":0,"max":"floor((@classes.fighter.levels + 1) / 8) + 4","per":"sr","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"other","attackBonus":0,"chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"type":{"value":"class","subtype":"maneuver"},"requirements":"Fighter: Battlemaster","recharge":{"value":null,"charged":false},"attunement":0},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1668460261767,"modifiedTime":1685300193516,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"_id":"of4iYuXmwzeDf3Bj"}
{"name":"#[CF_tempEntity]","type":"weapon","flags":{"cf":{"id":"temp_esxozmjvd1","name":"Wizard","color":"#3741c8","fontColor":"#FFFFFF","icon":"","sorting":"m","contents":["LuQXQJihCu2IGFeX"],"children":[]}},"img":"icons/svg/item-bag.svg","system":{"description":{"value":"","chat":"","unidentified":""},"source":"","quantity":1,"weight":0,"price":{"value":0,"denomination":"gp"},"attunement":0,"equipped":false,"rarity":"","identified":true,"activation":{"type":"","cost":null,"condition":""},"duration":{"value":"","units":""},"cover":null,"target":{"value":null,"width":null,"units":"","type":""},"range":{"value":null,"long":null,"units":""},"uses":{"value":null,"max":"","per":null,"recovery":""},"consume":{"type":"","target":null,"amount":null},"ability":null,"actionType":null,"attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"armor":{"value":null},"hp":{"value":null,"max":null,"dt":null,"conditions":""},"weaponType":"simpleM","baseItem":"","properties":{},"proficient":true},"effects":[],"folder":null,"sort":0,"ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1685998714961,"modifiedTime":1685998718450,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"_id":"pDRoJ9n85n9is82B"}
{"_id":"pkcWXwxgirR9leT3","name":"Colossus Slayer","type":"feat","img":"modules/plutonium/media/icon/feat/phb-tough.webp","effects":[{"_id":"Rflatnn1S6DNIZpF","changes":[{"key":"flags.dnd5e.DamageBonusMacro","mode":0,"value":"ItemMacro.Colossus Slayer","priority":30}],"disabled":false,"duration":{"startTime":null,"seconds":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"icon":"systems/dnd5e/icons/skills/yellow_14.jpg","label":"Colossus Slayer","transfer":true,"flags":{"dae":{"stackable":false,"macroRepeat":"none","specialDuration":[],"transfer":true},"ActiveAuras":{"isAura":false,"radius":null,"aura":"None","alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"hostile":false,"onlyOnce":false}},"tint":null,"origin":null}],"folder":null,"sort":0,"flags":{"core":{"sourceId":"Compendium.dnd5e.classfeatures.5gx1O0sxK08awEO9"},"spellTemplateManager":{"stmData":{"ignoreDuration":false,"spellTexture":"","useTexture":false,"alpha":50,"coneOrigin":1,"loopAnimations":true}},"midi-qol":{"onUseMacroName":"[postActiveEffects]ItemMacro","effectActivation":false},"magicitems":{"enabled":false,"equipped":false,"attuned":false,"charges":"0","chargeType":"c1","destroy":false,"destroyFlavorText":"reaches 0 charges: it crumbles into ashes and is destroyed.","rechargeable":false,"recharge":"0","rechargeType":"t1","rechargeUnit":"r1","sorting":"l"},"autoanimations":{"killAnim":false,"animLevel":false,"override":false,"animType":"t1","animName":"","bards":{"bardAnim":"a1","bardTarget":true,"bardTargetAnim":"a1","bardTargetColor":"a1","bardSelf":true,"marker":true,"markerColor":"a1","markerColorTarget":"a1"},"spellVar":"a1","hmAnim":"a1","rangedOptions":{"rangeDmgType":""},"color":"n1","spellOptions":{"spellLoops":1},"uaStrikeType":"physical","dtvar":"dt1","divineSmite":{"dsEnable":false,"dsSelf":true,"dsSelfDelay":0,"dsSelfColor":"a1","dsTarget":true,"dsTargetDelay":1250,"dsTargetColor":"a1"},"explosion":false,"exAnimLevel":false,"explodeVariant":"ev1","impactVar":"a1","explodeColor":"","explodeRadius":"0","explodeLoop":"1","allSounds":{"explosion":{"audioExplodeEnabled":false,"file":"","delay":100,"volume":0.25},"item":{"enableAudio":false,"file":"","delay":100,"volume":0.25}},"selfRadius":"5","animTint":"#ffffff","auraOpacity":0.75,"ctaOption":false,"teleDist":30,"templates":{"tempType":"a1","tempAnim":"","tempColor":"","tempLoop":1,"customAnim":false,"customPath":""}},"itemacro":{"macro":{"data":{"_id":null,"name":"Colossus Slayer","type":"script","author":"05k4ub2VgC3VLxAg","img":"icons/svg/dice-target.svg","scope":"global","command":"// v1.0\nif (![\"mwak\",\"rwak\"].includes(args[0].item.data.actionType)) return {}; // weapon attack\nif (args[0].hitTargets.length < 1) return {};\ntoken = canvas.tokens.get(args[0].tokenId);\nactor = token.actor;\nif (!actor || !token || args[0].hitTargets.length < 1) return {};\nconst rangerLevels = actor.getRollData().classes.ranger?.levels;\nif (!rangerLevels) {\n  MidiQOL.warn(\"Colossus Slayer Damage: Trying to do colossus attack and not a ranger\");\n  return {}; // ranger only\n}\nlet target = canvas.tokens.get(args[0].hitTargets[0]._id);\nif (game.combat) {\n  let combatTime = game.combat.round + game.combat.turn /100;\n  let lastTime = getProperty(token.data.flags, \"midi-qol.colossusAttackTime\");\n  if (combatTime === lastTime) {\n   MidiQOL.warn(\"Colossus Slayer Damage: Already done a colossus attack this turn\");\n   return {};\n  }\n}\nlet foundEnemy = true;\nlet isSneak = target.actor.data.data.attributes.hp.max != target.actor.data.data.attributes.hp.value;\nif (!isSneak) {\n  MidiQOL.warn(\"Colossus Slayer Damage: target not below its hit point maximum\");\n  return {};\n}\nlet useSneak = actor.data.flags.dae?.autoSneak;\nif (!useSneak) {\n    let dialog = new Promise((resolve, reject) => {\n      new Dialog({\n      // localize this text\n      title: \"Conditional Damage\",\n      content: `<p>Use Colossus Slayer?</p>`+(!foundEnemy ? \"<p>Only Nuetral creatures nearby</p>\" : \"\"),\n      buttons: {\n          one: {\n              icon: '<i class=\"fas fa-check\"></i>',\n              label: \"Confirm\",\n              callback: () => resolve(true)\n          },\n          two: {\n              icon: '<i class=\"fas fa-times\"></i>',\n              label: \"Cancel\",\n              callback: () => {resolve(false)}\n          }\n      },\n      default: \"two\"\n      }).render(true);\n    });\n    useSneak = await dialog;\n}\nif (!useSneak) return {}\nconst diceMult = args[0].isCritical ? 2: 1;\nif (game.combat) {\n  let combatTime = game.combat.round + game.combat.turn /100;\n  let lastTime = getProperty(token.data.flags, \"midi-qol.colossusAttackTime\");\n  if (combatTime !== lastTime) {\n     setProperty(token.data.flags, \"midi-qol.colossusAttackTime\", combatTime)\n  }\n}\n\n// How to check that we've already done one this turn?\nreturn {damageRoll: `${diceMult}d8`, flavor: \"Colossus Slayer\"};","folder":null,"sort":0,"permission":{"default":0},"flags":{}}}},"exportSource":{"world":"test","system":"dnd5e","coreVersion":"0.8.8","systemVersion":"1.3.3"},"siftoolkit":{"SIFData":{"ignoreDuration":false,"texture":"","useTexture":false,"alpha":50,"coneOrigin":1,"loopAnimations":true,"playTemplateAudio":false,"playDamageAudio":false,"clip":"","volume":100}},"rest-recovery":{"data":{"recovery":{"enabled":false}}},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false,"autoFailFriendly":false,"offHandWeapon":false,"autoSaveFriendly":false},"cf":{"id":"temp_l7snfkbanc"}},"system":{"description":{"value":"<p>Your tenacity can wear down the most potent foes. When you hit a creature with a weapon attack, the creature takes an extra 1d8 damage if it's below its hit point maximum. You can deal this extra damage only once per turn.</p>","chat":"","unidentified":""},"source":"PHB pg. 93","activation":{"type":"special","cost":null,"condition":""},"duration":{"value":null,"units":""},"cover":null,"target":{"value":null,"width":null,"units":"","type":"self"},"range":{"value":null,"long":null,"units":"self"},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"other","attackBonus":0,"chatFlavor":"","critical":null,"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell","value":""},"type":{"value":"","subtype":""},"requirements":"Hunter 3","recharge":{"value":null,"charged":false}},"ownership":{"default":0,"05k4ub2VgC3VLxAg":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":null,"modifiedTime":1686175651040,"lastModifiedBy":"Be8r6Sgxcs3sL08I"}}
{"name":"#[CF_tempEntity]","type":"weapon","flags":{"cf":{"id":"temp_6squr94sv2","name":"Rogue","color":"#db2c1f","fontColor":"#FFFFFF","icon":"","sorting":"m","contents":["cGyukUVwpn59kDMk","a6HgKxP24tT5SyQE","edqbg2l8SWxygJwz","GVcCKdnP5RZ2sqn5"],"children":[],"folderPath":[],"version":"2.5.7"}},"img":"icons/svg/item-bag.svg","system":{"description":{"value":"","chat":"","unidentified":""},"source":"","quantity":1,"weight":0,"price":0,"attunement":0,"equipped":false,"rarity":"","identified":true,"activation":{"type":"","cost":0,"condition":""},"duration":{"value":null,"units":""},"cover":null,"target":{"value":null,"width":null,"units":"","type":""},"range":{"value":null,"long":null,"units":""},"uses":{"value":null,"max":"","per":null,"recovery":""},"consume":{"type":"","target":null,"amount":null},"ability":null,"actionType":null,"attackBonus":0,"chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"armor":{"value":10},"hp":{"value":0,"max":0,"dt":null,"conditions":""},"weaponType":"simpleM","baseItem":"","properties":{},"proficient":true},"effects":[],"folder":null,"sort":0,"ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1668396888670,"modifiedTime":1686175993271,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"_id":"poWTeUwIzm9nlgIA"}
{"name":"Lay on Hands","type":"feat","img":"icons/magic/light/orbs-hand-gray.webp","effects":[{"_id":"hbyjgntb6xcq8klo","changes":[{"key":"system.resources.primary.max","mode":5,"value":"5 * @classes.paladin.levels","priority":20},{"key":"system.resources.primary.label","mode":5,"value":"Lay on Hands Pool","priority":20},{"key":"system.resources.primary.lr","mode":5,"value":"1","priority":20}],"disabled":false,"duration":{"startTime":null,"seconds":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"icon":"icons/magic/light/orbs-hand-gray.webp","label":"Lay on Hands Pool","origin":"Actor.iO04pmtZ0N3gTAk9.Item.IM2UCUasJLD5J7Fw","transfer":true,"flags":{"core":{"statusId":""},"dae":{"stackable":"none","durationExpression":"","macroRepeat":"none","specialDuration":[],"transfer":true},"dnd5e-helpers":{"rest-effect":"Ignore"},"ActiveAuras":{"isAura":false,"aura":"None","radius":null,"alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"displayTemp":false,"hostile":false,"onlyOnce":false}},"tint":null}],"flags":{"_sheetTab":"description","entityorder":{"order":161},"dynamiceffects":{"effects":[],"alwaysActive":false,"equipActive":false},"favtab":{"isFavourite":true,"isFavorite":true},"midi-qol":{"effectActivation":false,"onUseMacroName":"[preItemRoll]ItemMacro"},"midiProperties":{"nodam":false,"halfdam":false,"fulldam":false,"rollOther":false,"critOther":false,"concentration":false,"magicdam":false,"magiceffect":false,"toggleEffect":false,"ignoreTotalCover":false},"magicitems":{"enabled":false,"equipped":false,"attuned":false,"charges":"0","chargeType":"c1","destroy":false,"destroyFlavorText":"reaches 0 charges: it crumbles into ashes and is destroyed.","rechargeable":false,"recharge":"0","rechargeType":"t1","rechargeUnit":"r1","sorting":"l"},"itemacro":{"macro":{"data":{"_id":null,"name":"Lay on Hands","type":"script","author":"devnIbfBHb74U9Zv","img":"icons/svg/dice-target.svg","scope":"global","command":"const version = \"0.9.52\";\ntry {\n    if (args[0].macroPass === \"preItemRoll\") {\n      const theTarget = args[0].targets[0];\n      if (!theTarget) return false;\n    \n      // does not work on undead/constructs\n      let invalid = [\"undead\", \"construct\"].some(type => (theTarget?.actor.data.data.details.type?.value || \"\").toLowerCase().includes(type));\n      if (invalid) {\n          ui.notifications.warn(\"Lay on Hands can't affect undead/constructs\")\n          return false;\n      }\n      let consumeTarget = args[0].itemData.data.consume.target;\n      if (!consumeTarget || consumeTarget === \"\") consumeTarget = 'resources.primary.value'; \n      const available = getProperty(actor.data.data, consumeTarget);\n      // Have we got any left?\n      if (available <= 0) return false;\n    \n      // prompt for how much to use...\n      let d = new Promise((resolve, reject) => {\n        let theDialog = new Dialog({\n          title: \"Lay on Hands\",\n          content: `How many points to use? ${available} available<input id=\"mqlohpoints\" type=\"number\" min=\"0\" step=\"1.0\" max=\"${available}\"></input>`,\n          buttons: {\n            heal: {\n              label: \"Heal\",\n              callback: (html) => { resolve(Math.clamped(Math.floor(Number(html.find('#mqlohpoints')[0].value)), 0, available)); }\n            },\n            cureDiseasePoison: {\n              label: \"Disease/Poison\",\n              callback: (html) => { resolve(-Math.clamped(Math.floor(Number(html.find('#mqlohpoints')[0].value) / 5) * 5, 0, available)); }\n            },\n            abort: {\n              icon: '<i class=\"fas fa-cross\"></i>',\n              label: \"Quit\",\n              callback: () => { resolve(false) }\n            },\n          },\n          default: \"heal\",\n        }).render(true);\n      });\n      const consumed = await d;\n      if (!consumed) return false;\n      const workflow = MidiQOL.Workflow.getWorkflow(args[0].uuid);\n      const theItem = workflow.item;\n      let updates;\n      if (consumed > 0) {\n        updates = {\n          \"data.consume.amount\": Math.abs(consumed),\n          \"data.damage.parts\": [[`${Math.max(0, consumed)}`, \"healing\"]],\n          \"data.chatFlavor\": \"\",\n          \"data.consume.target\": consumeTarget\n        };\n      } else {\n        updates = {\n          \"data.consume.amount\": Math.abs(consumed),\n          \"data.damage.parts\": [],\n          \"data.chatFlavor\": `<h3>Remove up to ${Math.floor(Math.abs(consumed) / 5)} poisons/diseases</h3>`,\n          \"data.consume.target\": consumeTarget\n        };\n      }\n      setProperty(workflow, \"workflowOptions.autoConsumeResource\", true);\n      return theItem.update(updates);\n    }\n    return true;\n} catch (err)  {\n    console.error(`${args[0].itemData.name} - Lay on Hands ${version}`, err);\n}","folder":null,"sort":0,"permission":{"default":0},"flags":{}},"name":"Lay on Hands 10.0.10","type":"script","img":"icons/svg/dice-target.svg","scope":"global","command":"const version = \"10.0.10\";\ntry {\n    if (args[0].macroPass === \"preItemRoll\") {\n      const theTarget = args[0].targets[0];\n      if (!theTarget) return false;\n    \n      // does not work on undead/constructs\n      let invalid = [\"undead\", \"construct\"].some(type => (theTarget?.actor.system.details.type?.value || \"\").toLowerCase().includes(type));\n      if (invalid) {\n          ui.notifications.warn(\"Lay on Hands can't affect undead/constructs\")\n          return false;\n      }\n      let consumeTarget = args[0].itemData.system.consume.target;\n      if (!consumeTarget || consumeTarget === \"\") consumeTarget = 'resources.primary.value'; \n      const available = getProperty(actor.system, consumeTarget);\n      // Have we got any left?\n      if (available <= 0) return false;\n    \n      // prompt for how much to use...\n      let d = new Promise((resolve, reject) => {\n        let theDialog = new Dialog({\n          title: \"Lay on Hands\",\n          content: `How many points to use? ${available} available<input id=\"mqlohpoints\" type=\"number\" min=\"0\" step=\"1.0\" max=\"${available}\"></input>`,\n          buttons: {\n            heal: {\n              label: \"Heal\",\n              callback: (html) => { resolve(Math.clamped(Math.floor(Number(html.find('#mqlohpoints')[0].value)), 0, available)); }\n            },\n            cureDiseasePoison: {\n              label: \"Disease/Poison\",\n              callback: (html) => { resolve(-Math.clamped(Math.floor(Number(html.find('#mqlohpoints')[0].value) / 5) * 5, 0, available)); }\n            },\n            abort: {\n              icon: '<i class=\"fas fa-cross\"></i>',\n              label: \"Quit\",\n              callback: () => { resolve(false) }\n            },\n          },\n          default: \"heal\",\n        }).render(true);\n      });\n      const consumed = await d;\n      if (!consumed) return false;\n      const workflow = MidiQOL.Workflow.getWorkflow(args[0].uuid);\n      const theItem = workflow.item;\n      let updates;\n      if (consumed > 0) {\n        updates = {\n          \"system.consume.amount\": Math.abs(consumed),\n          \"system.damage.parts\": [[`${Math.max(0, consumed)}`, \"healing\"]],\n          \"system.chatFlavor\": \"\",\n          \"system.consume.target\": consumeTarget\n        };\n      } else {\n        updates = {\n          \"system.consume.amount\": Math.abs(consumed),\n          \"system.damage.parts\": [],\n          \"system.chatFlavor\": `<h3>Remove up to ${Math.floor(Math.abs(consumed) / 5)} poisons/diseases</h3>`,\n          \"system.consume.target\": consumeTarget\n        };\n      }\n      setProperty(workflow, \"workflowOptions.autoConsumeResource\", true);\n      return theItem.update(updates);\n    }\n    return true;\n} catch (err)  {\n    console.error(`${args[0].itemData.name} - Lay on Hands ${version}`, err);\n}","sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null}}},"core":{"sourceId":"Item.IM2UCUasJLD5J7Fw"},"scene-packer":{"sourceId":"Item.aGfO0Wkxr0QYfOSJ","hash":"6705c1d4f10459da0d62b2b06b023a246d9ed5bd"},"cf":{"id":"temp_mt8pdupg5f"},"rest-recovery":{"data":{"recovery":{"enabled":false}}}},"system":{"description":{"value":"<p>Your blessed touch can heal wounds. You have a pool of healing power that replenishes when you take a long rest. With that pool, you can restore a total number of hit points equal to your paladin level × 5. </p>\n<p>As an action, you can touch a creature and draw power from the pool to restore a number of hit points to that creature, up to the maximum amount remaining in your pool.</p>\n<p>Alternatively, you can expend 5 hit points from your pool of healing to cure the target of one disease or neutralize one poison affecting it. You can cure multiple diseases and neutralize multiple poisons with a single use of Lay on Hands, expending hit points separately for each one.</p>\n<p>This feature has no effect on undead and constructs.<br /><br />Midi-qol notes: <br />Item has a passive effect to set the Lay on Hands resource pool to be 5 * the paladin level, default primary resource pool. <br /><br />When first equipped you <span style=\"text-decoration:underline\"><strong>must edit</strong></span> the Item and the resource consumption should be set the set to consume from the primary (default)  resource pool.<br /><br />You can change the resource pool by editing the passive effect and updating the item.</p>","chat":"","unidentified":""},"source":"","activation":{"type":"action","cost":1,"condition":""},"duration":{"value":null,"units":""},"cover":null,"target":{"value":1,"width":null,"units":"","type":"creature"},"range":{"value":null,"long":null,"units":""},"uses":{"value":null,"max":"","per":"","recovery":"","type":"lr"},"consume":{"type":"attribute","target":"resources.primary.value","amount":5},"ability":"","actionType":"other","attackBonus":0,"chatFlavor":"","critical":{"threshold":null,"damage":null},"damage":{"parts":[["5","healing"]],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell","value":""},"type":{"value":"","subtype":""},"requirements":"Paladin 1","recharge":{"value":null,"charged":false},"featType":{"value":"","_deprecated":true},"time":{"value":"","_deprecated":true},"damageType":{"value":"","_deprecated":true},"attributes":{"spelldc":10},"attunement":0},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1661995926160,"modifiedTime":1686175538888,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"folder":null,"sort":0,"_id":"psp5X0ES66RwIiXc"}
{"name":"Maneuvers: Ambush","type":"feat","system":{"description":{"value":"<p><strong>Role a skill normalmente.</strong></p><p>When you make a Dexterity (Stealth) check or an initiative roll, you can expend one superiority die and add the die to the roll, provided you aren't incapacitated.</p>","chat":"","unidentified":""},"source":"","activation":{"type":"","cost":null,"condition":""},"duration":{"value":"","units":""},"cover":null,"target":{"value":null,"width":null,"units":"","type":"self"},"range":{"value":null,"long":null,"units":"self"},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"","attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"type":{"value":"class","subtype":"maneuver"},"requirements":"","recharge":{"value":null,"charged":false}},"flags":{"ddbimporter":{"id":"2439082","entityTypeId":"222216831","componentId":1306899,"componentTypeId":258900837,"type":"class","class":"Fighter","subclass":"Battle Master","effectsApplied":true,"importId":"gs7ffXqKfeX19j3t"},"infusions":{"infused":false},"obsidian":{"source":{"type":"class","text":"Fighter"}},"midi-qol":{"forceCEOff":true,"effectActivation":false},"core":{"sourceId":"Actor.XauTPmdt4Drmy2f5.Item.OWhbYcXFPBjst5Hn"},"custom-character-sheet-sections":{"sectionName":""},"rest-recovery":{"data":{"recovery":{"enabled":false}}},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"autoFailFriendly":false,"autoSaveFriendly":false,"rollOther":false,"critOther":false,"offHandWeapon":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false},"cf":{"id":"temp_pbbargtiogk","path":"Manobras - Battle Master Novo","color":"#b74e4e"},"magicitems":{"enabled":false,"equipped":false,"attuned":false,"charges":"0","chargeType":"c1","destroy":false,"destroyFlavorText":"reaches 0 charges: it crumbles into ashes and is destroyed.","rechargeable":false,"recharge":"0","rechargeType":"t1","rechargeUnit":"r1","sorting":"l"}},"effects":[{"label":"Maneuvers: Ambush","changes":[{"key":"flags.midi-qol.optional.Ambush.label","mode":0,"value":"Ambush","priority":20},{"key":"flags.midi-qol.optional.Ambush.count","mode":0,"value":"ItemUses.Superiority Die","priority":20},{"key":"flags.midi-qol.optional.Ambush.skill.ste","mode":0,"value":"+1d((2*floor(((@classes.fighter.levels)-2)/8))+8)","priority":20}],"duration":{"turns":null,"startTime":null,"seconds":null,"combat":null,"rounds":null,"startRound":null,"startTurn":null},"tint":null,"transfer":true,"disabled":false,"flags":{"dae":{"transfer":false,"stackable":"none","specialDuration":[],"selfTarget":false,"selfTargetAlways":false,"durationExpression":"","macroRepeat":"none"},"ddbimporter":{"disabled":false},"midi-qol":{"forceCEOff":true},"dfreds-convenient-effects":{"description":"test"},"core":{"statusId":""},"ActiveAuras":{"isAura":false,"aura":"None","radius":"undefined","alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"displayTemp":false,"hostile":false,"onlyOnce":false}},"icon":"icons/skills/melee/weapons-crossed-swords-yellow.webp","_id":"WC8OVaoOdggDwAY7","origin":null}],"img":"icons/skills/melee/weapons-crossed-swords-yellow.webp","_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1678262260677,"modifiedTime":1685305531888,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"_id":"q4vm68A7g0oWbZcK"}
{"name":"Maneuvers: Maneuvering Attack","type":"feat","img":"icons/skills/melee/blade-tip-chipped-blood-red.webp","effects":[{"label":"Maneuvers: Maneuvering Attack","icon":"icons/skills/melee/blade-tip-chipped-blood-red.webp","changes":[{"key":"flags.dnd5e.DamageBonusMacro","mode":0,"value":"ItemMacro","priority":20}],"transfer":true,"_id":"qNbPGfgVPV5Wq9DF","disabled":false,"duration":{"startTime":null,"seconds":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"origin":null,"tint":null,"flags":{"dae":{"selfTarget":false,"selfTargetAlways":false,"stackable":"none","durationExpression":"","macroRepeat":"none","specialDuration":[]},"core":{"statusId":""},"ActiveAuras":{"isAura":false,"aura":"None","radius":null,"alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"displayTemp":false,"hostile":false,"onlyOnce":false}}}],"flags":{"ddbimporter":{"id":"2439086","entityTypeId":"222216831","componentId":1306902,"componentTypeId":258900837,"class":"Fighter","subclass":"Battle Master","importId":"28pyz8r4w0vt0973"},"infusions":{"infused":false},"obsidian":{"source":{"type":"class","text":"Fighter"}},"scene-packer":{"hash":"734be59f3fc100b8c1e45ff31272123990577f0b","sourceId":"Item.PUVp9cI4sinphPqd"},"spellTemplateManager":{"stmData":{"ignoreDuration":false,"spellTexture":"","useTexture":false,"alpha":50,"coneOrigin":1,"loopAnimations":true}},"midi-qol":{"effectActivation":false},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false},"magicitems":{"enabled":false,"equipped":false,"attuned":false,"charges":"0","chargeType":"c1","destroy":false,"destroyFlavorText":"reaches 0 charges: it crumbles into ashes and is destroyed.","rechargeable":false,"recharge":"0","rechargeType":"t1","rechargeUnit":"r1","sorting":"l"},"favtab":{"isFavorite":true},"itemacro":{"macro":{"data":{"_id":null,"name":"Maneuvers: Brace","type":"script","author":"ldRsJ6Yp5qPydWA1","img":"icons/svg/dice-target.svg","scope":"global","command":"","folder":null,"sort":0,"permission":{"default":0},"flags":{}},"name":"Maneuvers: Maneuvering Attack","type":"script","scope":"global","command":"if (args[0].hitTargets.length < 1) return {};\nlet sourceActor = this.actor;\nlet SupDie = sourceActor.items.getName('Superiority Die');\nlet SupDieUses = SupDie.system.uses.value;\n         if (SupDieUses <= 0) return {};\n         if (!SupDie) {\n            ui.notifications.warn('Source actor does not appear to have a Superiority Die feature!');\n            return;}\n\nconst pcActor = MidiQOL.MQfromActorUuid(args[0].actorUuid);\n\tconst dActor = canvas.tokens.controlled[0].actor;\n\tconst fighterLevel = actor.getRollData().classes.fighter?.levels;\n\n\tif (fighterLevel > 17) superiorityDie = \"12\";\n   \t else if (fighterLevel > 9) superiorityDie = \"10\";\n  \t else if (fighterLevel > 0) superiorityDie = \"8\";\n\nlet dialog = new Promise((resolve, reject) => {\n        new Dialog({\n            // localize this text\n            title: \"Maneuvers: Maneuvering Attack\",\n            content: \"<p>Deseja usar o Maneuvers: Maneuvering Attack (um alido pode se mover metade sem tomar AdO do seu alvo)?</p>\",\n            buttons: {\n                one: {\n                    icon: '<p> </p><img src = \"icons/svg/light.svg\" width=\"60\" height=\"60\"></>',\n                    label: \"<p>Sim</p>\",\n                    callback: () => resolve(\"SIM\")\n                },\n                two: {\n                    icon: '<p> </p><img src = \"icons/svg/hazard.svg\" width=\"60\" height=\"60\"></>',\n                    label: \"<p>Não</p>\",\n                    callback: () => { resolve(\"NAO\") }\n                }\n            },\n            default: \"two\"\n        }).render(true);\n    });\n\n    let choiceACBonus = await dialog;\n    const baseDice = 1\n    if (choiceACBonus === \"SIM\") {\n    SupDie.update({'system.uses.value': SupDieUses - 1});\n    const targetActor = args[0].targets[0].actor;\n    const diceMult = args[0].isCritical ? 2: 1;\n    return {damageRoll: `${diceMult}d${superiorityDie}`, flavor: \"Maneuvering Attack\"} }","author":"Be8r6Sgxcs3sL08I","_id":null,"img":"icons/svg/dice-target.svg","folder":null,"sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null}}},"core":{"sourceId":"Item.QCt9G1ryLky9enrK"},"cf":{"id":"temp_pbbargtiogk","path":"Manobras - Battle Master Novo","color":"#b74e4e"},"exportSource":{"world":"test","system":"dnd5e","coreVersion":"9.269","systemVersion":"1.6.1"},"rest-recovery":{"data":{"recovery":{"enabled":false}}}},"system":{"description":{"value":"<p><strong>NÃO USE A SKILL. ATAQUE NORMALMENTE. VAI PEDIR SE VC QUER USAR E DAR O DANO. RESTO É ROLEPLAY.</strong></p><p><span style=\"font-family:'Helvetica Neue', Helvetica, Arial, sans-serif\">When you hit a creature with a weapon attack, you can expend one superiority die to maneuver one of your comrades into a more advantageous position. You add the superiority die to the attack's damage roll, and you choose a friendly creature who can see or hear you. That creature can use its reaction to move up to half its speed without provoking opportunity attacks from the target of your attack.</span></p><p></p><details><summary><strong>USAGE:</strong></summary><p>This Maneuver must be activated AFTER the character makes an attack and knows that a HIT was successful.  This will activate any bonuses, saves, effects, and extra damage to the TARGET.  A <span style=\"text-decoration:underline\"><span style=\"text-decoration:underline\">Superiority Die </span></span>will be expended immediately.  This provides a half normal movement bonus so the target of the REACTION can move half their movement manually without disrupting their movement on their turn.</p></details><p> </p><details><summary><strong>SETUP:</strong></summary><p>Please remember to link the use of this ability to a character sheet resource under the item details Resource Consumption dropdown.</p><img src=\"https://user-images.githubusercontent.com/76136571/161775726-fb67bb97-5fd1-45c5-8301-bbb17e2d0f1d.png\" width=\"569\" /></details><p> </p><details><summary><strong>VERSION INFO</strong></summary><p>v1.2 May 7 2022</p><p>jbowens #0415 (Discord)</p><p>https://github.com/jbowensii/More-Automated-Spells-Items-and-Feats.git</p></details>","chat":"","unidentified":""},"source":"PHB p74","activation":{"type":"special","cost":null,"condition":""},"duration":{"value":null,"units":""},"cover":null,"target":{"value":null,"width":null,"units":"","type":"self"},"range":{"value":null,"long":null,"units":"self"},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"attribute","target":"","amount":1},"ability":"","actionType":"","attackBonus":0,"chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"type":{"value":"","subtype":""},"requirements":"Fighter: Battlemaster","recharge":{"value":null,"charged":false},"attunement":0},"ownership":{"default":0,"ldRsJ6Yp5qPydWA1":3,"Be8r6Sgxcs3sL08I":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1668473467582,"modifiedTime":1685300191296,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"_id":"qeWOHadco9BlUtgS"}
{"name":"Maneuvers: Feinting Attack","type":"feat","img":"icons/skills/melee/weapons-crossed-swords-yellow.webp","effects":[{"_id":"tyr9bqr24wew5lex","changes":[{"key":"flags.midi-qol.advantage.attack.all","mode":0,"value":"1","priority":0},{"key":"system.bonuses.All-Damage","mode":2,"value":"+1d((2*floor(((@classes.fighter.levels)-2)/8))+8)","priority":5}],"disabled":false,"duration":{"startTime":null,"rounds":1,"seconds":null,"combat":null,"turns":null,"startRound":null,"startTurn":null},"icon":"icons/skills/melee/weapons-crossed-swords-yellow.webp","label":"Maneuvers: Feinting Attack","origin":"Actor.67GUmdTadYmGXD8W.Item.EbURPL9F8boGsK20","transfer":false,"flags":{"core":{"statusId":""},"dae":{"stackable":"none","durationExpression":"","macroRepeat":"none","specialDuration":["1Attack"],"transfer":false,"selfTarget":false,"selfTargetAlways":false},"ActiveAuras":{"isAura":false,"aura":"None","radius":"","alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"displayTemp":false,"hostile":false,"onlyOnce":false},"dfreds-convenient-effects":{"description":""}},"tint":null}],"flags":{"ddbimporter":{"id":"2439086","entityTypeId":"222216831","componentId":1306902,"componentTypeId":258900837,"class":"Fighter","subclass":"Battle Master","importId":"28pyz8r4w0vt0973"},"infusions":{"infused":false},"obsidian":{"source":{"type":"class","text":"Fighter"}},"scene-packer":{"hash":"b13bfd16b6a3c3e60f72110d7241dae140f20e36","sourceId":"Item.rZN9xErT3g3Nfwle"},"spellTemplateManager":{"stmData":{"ignoreDuration":false,"spellTexture":"","useTexture":false,"alpha":50,"coneOrigin":1,"loopAnimations":true}},"midi-qol":{"effectActivation":false,"onUseMacroName":"[postActiveEffects]ItemMacro"},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"autoFailFriendly":false,"autoSaveFriendly":false,"offHandWeapon":false,"ignoreTotalCover":false},"magicitems":{"enabled":false,"equipped":false,"attuned":false,"charges":"0","chargeType":"c1","destroy":false,"destroyFlavorText":"reaches 0 charges: it crumbles into ashes and is destroyed.","rechargeable":false,"recharge":"0","rechargeType":"t1","rechargeUnit":"r1","sorting":"l"},"favtab":{"isFavorite":true},"itemacro":{"macro":{"data":{"_id":null,"name":"Maneuvers: Brace","type":"script","author":"ldRsJ6Yp5qPydWA1","img":"icons/svg/dice-target.svg","scope":"global","command":"","folder":null,"sort":0,"permission":{"default":0},"flags":{}},"name":"Maneuvers: Feinting Attack","type":"script","scope":"global","command":"let sourceActor = this.actor;\nlet SupDie = sourceActor.items.getName('Superiority Die');\nlet SupDieUses = SupDie.system.uses.value;\n      if (SupDieUses <= 0) return {};\n         if (!SupDie) {\n            ui.notifications.warn('Source actor does not appear to have a Superiority Die feature!');\n            return;}\nSupDie.update({'system.uses.value': SupDieUses - 1});","author":"Be8r6Sgxcs3sL08I","_id":null,"img":"icons/svg/dice-target.svg","folder":null,"sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null}}},"core":{"sourceId":"Item.QCt9G1ryLky9enrK"},"cf":{"id":"temp_pbbargtiogk","path":"Manobras - Battle Master Novo","color":"#b74e4e"},"exportSource":{"world":"test","system":"dnd5e","coreVersion":"9.269","systemVersion":"1.6.1"},"rest-recovery":{"data":{"recovery":{"enabled":false}}}},"system":{"description":{"value":"<p><strong>CLIQUE ANTES DE ATACAR. DEPOIS ATAQUE.</strong></p><p>You can expend one superiority die and use a bonus action on your turn to feint, choosing one creature within 5 feet of you as your target. You have advantage on your next attack roll against that creature this turn. If that attack hits, add the superiority die to the attack's damage roll.</p>","chat":"","unidentified":""},"source":"PHB p74","activation":{"type":"special","cost":1,"condition":""},"duration":{"value":null,"units":""},"cover":null,"target":{"value":null,"width":null,"units":"","type":"self"},"range":{"value":null,"long":null,"units":""},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"attribute","target":"","amount":1},"ability":"","actionType":"other","attackBonus":0,"chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"type":{"value":"","subtype":""},"requirements":"Fighter: Battlemaster","recharge":{"value":null,"charged":false},"attunement":0},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1668450899415,"modifiedTime":1685305468090,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"_id":"rzgx3wkUnqGwthgd"}
{"name":"Maneuvers: Tactical Assessment","type":"feat","img":"icons/skills/melee/blade-tip-chipped-blood-red.webp","effects":[{"label":"Maneuvers: Tactical Assessment","icon":"icons/skills/melee/blade-tip-chipped-blood-red.webp","changes":[{"key":"flags.midi-qol.optional.Tactical.label","mode":0,"value":"Maneuvers: Tactical Assessment - Clique aqui pra ADD um dado de sup.","priority":20},{"key":"flags.midi-qol.optional.Tactical.skill.inv","mode":0,"value":"+1d((2*floor(((@classes.fighter.levels)-2)/8))+8)","priority":20},{"key":"flags.midi-qol.optional.Tactical.skill.his","mode":0,"value":"+1d((2*floor(((@classes.fighter.levels)-2)/8))+8)","priority":20},{"key":"flags.midi-qol.optional.Tactical.skill.ins","mode":0,"value":"+1d((2*floor(((@classes.fighter.levels)-2)/8))+8)","priority":20}],"transfer":true,"_id":"Lhpd0MGqVZCfDRs7","disabled":false,"duration":{"startTime":null,"seconds":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"origin":null,"tint":null,"flags":{"dfreds-convenient-effects":{"description":""},"dae":{"selfTarget":false,"selfTargetAlways":false,"stackable":"noneName","durationExpression":"","macroRepeat":"none","specialDuration":[]},"core":{"statusId":""},"ActiveAuras":{"isAura":false,"aura":"None","radius":"","alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"displayTemp":false,"hostile":false,"onlyOnce":false}}}],"flags":{"ddbimporter":{"id":"53570","entityTypeId":"222216831","componentId":22,"componentTypeId":258900837,"class":"Fighter","subclass":"Battle Master","importId":"ye6nz9f4x9n3v7lu","ignoreIcon":true,"ignoreItemImport":true,"retainResourceConsumption":true},"infusions":{"infused":false},"obsidian":{"source":{"type":"class","text":"Fighter"}},"spellTemplateManager":{"stmData":{"ignoreDuration":false,"spellTexture":"","useTexture":false,"alpha":50,"coneOrigin":1,"loopAnimations":true}},"midi-qol":{"effectActivation":false,"onUseMacroName":"[postActiveEffects]"},"midiProperties":{"nodam":false,"halfdam":false,"fulldam":true,"rollOther":false,"critOther":false,"concentration":false,"magicdam":false,"magiceffect":false,"toggleEffect":false,"ignoreTotalCover":false,"autoFailFriendly":false,"autoSaveFriendly":false,"offHandWeapon":false},"magicitems":{"enabled":false,"equipped":false,"attuned":false,"charges":"0","chargeType":"c1","destroy":false,"destroyFlavorText":"reaches 0 charges: it crumbles into ashes and is destroyed.","rechargeable":false,"recharge":"0","rechargeType":"t1","rechargeUnit":"r1","sorting":"l"},"itemacro":{"macro":{"data":{"_id":null,"name":"Maneuvers: Trip Attack","type":"script","author":"ldRsJ6Yp5qPydWA1","img":"icons/svg/dice-target.svg","scope":"global","command":"","folder":null,"sort":0,"permission":{"default":0},"flags":{}},"name":"Maneuvers: Tactical Assessment (Manual)","type":"script","scope":"global","command":"let sourceActor = this.actor;\nlet SupDie = sourceActor.items.getName('Superiority Die');\nlet SupDieUses = SupDie.system.uses.value;\n      if (SupDieUses <= 0) return {};\n        if (!SupDie) {\n            ui.notifications.warn('Source actor does not appear to have a Bardic Inspiration feature!');\n            return;}\nSupDie.update({'system.uses.value': SupDieUses - 1});","author":"Be8r6Sgxcs3sL08I","_id":null,"img":"icons/svg/dice-target.svg","folder":null,"sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null}}},"favtab":{"isFavorite":true},"scene-packer":{"hash":"5c3e66030dc9182adec68e8984437cf49cab73a8","sourceId":"Item.aFA4hdN8mUP1gzE3"},"core":{"sourceId":"Item.bpSu08y0CydFPHEi"},"cf":{"id":"temp_pbbargtiogk","path":"Manobras - Battle Master Novo","color":"#b74e4e"},"exportSource":{"world":"test","system":"dnd5e","coreVersion":"9.269","systemVersion":"1.6.1"},"rest-recovery":{"data":{"recovery":{"enabled":false}}}},"system":{"description":{"value":"<p><strong>Quando rolar algum desse, ele vai pedir se quer adicionar.</strong></p><p><span style=\"font-family:'Helvetica Neue', Helvetica, Arial, sans-serif\">When you make an Intelligence (Investigation), an Intelligence (History), or a Wisdom (Insight) check, you can expend one superiority die and add the superiority die to the ability check.</span></p><p></p>","chat":"","unidentified":""},"source":"PHB p74","activation":{"type":"special","cost":null,"condition":""},"duration":{"value":"","units":"inst"},"cover":null,"target":{"value":null,"width":null,"units":"","type":"self"},"range":{"value":null,"long":null,"units":""},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"attribute","target":"","amount":1},"ability":"dex","actionType":"other","attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[["ItemMacro",""]],"versatile":""},"formula":"","save":{"ability":"str","dc":null,"scaling":"str"},"type":{"value":"","subtype":""},"requirements":"Fighter: Battlemaster","recharge":{"value":null,"charged":false}},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1668460261769,"modifiedTime":1685305561146,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"_id":"sIhEzONHmjvO8mAB"}
{"_id":"tkNTOMSY00oPMAnJ","name":"Steady Aim","type":"feat","img":"modules/GMmacros/img/Ability_SteadyAim.png","data":{"description":{"value":"<div class=\"rd__b  rd__b--1\"><p><i>3rd-level rogue <a href=\"https://5e.tools/variantrules.html#optional%20class%20features_tce\" data-plut-hover=\"{&quot;page&quot;:&quot;variantrules.html&quot;,&quot;source&quot;:&quot;tce&quot;,&quot;hash&quot;:&quot;optional%20class%20features_tce&quot;}\">optional feature</a></i></p><p>As a bonus action, you give yourself advantage on your next attack roll on the current turn. You can use this bonus action only if you haven't moved during this turn, and after you use the bonus action, your speed is 0 until the end of the current turn.</p></div>","chat":"","unidentified":""},"source":"TCE","activation":{"type":"bonus","cost":1,"condition":""},"duration":{"value":null,"units":""},"target":{"value":null,"width":null,"units":"","type":"self"},"range":{"value":null,"long":null,"units":"self"},"uses":{"value":0,"max":"0","per":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"other","attackBonus":0,"chatFlavor":"","critical":null,"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"flat"},"requirements":"Rogue 3","recharge":{"value":null,"charged":false}},"effects":[],"folder":null,"sort":0,"permission":{"default":0,"QwT9izJ4aW8QVTjo":3},"flags":{"srd5e":{"page":"classfeatures.html","source":"TCE","hash":"steady%20aim_rogue_phb_3_tce"},"midi-qol":{"onUseMacroName":"[postActiveEffects]ItemMacro","effectActivation":false},"magicitems":{"enabled":false,"equipped":false,"attuned":false,"charges":"0","chargeType":"c1","destroy":false,"destroyFlavorText":"reaches 0 charges: it crumbles into ashes and is destroyed.","rechargeable":false,"recharge":"0","rechargeType":"t1","rechargeUnit":"r1","sorting":"l"},"autoanimations":{"killAnim":false,"animLevel":false,"override":false,"animType":"t1","animName":"","bards":{"bardAnim":"a1","bardTarget":true,"bardTargetAnim":"a1","bardTargetColor":"a1","bardSelf":true,"marker":true,"markerColor":"a1","markerColorTarget":"a1"},"spellVar":"a1","hmAnim":"a1","color":"n1","spellOptions":{"spellLoops":1},"uaStrikeType":"physical","dtvar":"dt1","divineSmite":{"dsEnable":false,"dsSelf":true,"dsSelfDelay":0,"dsSelfColor":"a1","dsTarget":true,"dsTargetDelay":1250,"dsTargetColor":"a1"},"explosion":false,"exAnimLevel":false,"explodeVariant":"ev1","impactVar":"a1","explodeColor":"","explodeRadius":"0","explodeLoop":"1","allSounds":{"explosion":{"audioExplodeEnabled":false,"file":"","delay":100,"volume":0.25},"item":{"enableAudio":false,"file":"","delay":100,"volume":0.25}},"selfRadius":"5","animTint":"#ffffff","auraOpacity":0.75,"ctaOption":false,"teleDist":30,"templates":{"tempType":"a1","tempAnim":"","tempColor":"","tempLoop":1,"customAnim":false,"customPath":""}},"spellTemplateManager":{},"siftoolkit":{"SIFData":{"alpha":50,"coneOrigin":1,"ignoreDuration":false,"loopAnimations":true,"texture":"","useTexture":false}},"core":{"sourceId":"Item.TK1Lr3IewQGYMLyC"},"itemacro":{"macro":{"data":{"_id":null,"name":"Steady Aim","type":"script","author":"QwT9izJ4aW8QVTjo","img":"icons/svg/dice-target.svg","scope":"global","command":"const a = canvas.tokens.controlled[0]?.actor || game.user.character;\nconst img = \"modules/GMmacros/img/Ability_SteadyAim.png\";\n\nconst effectData = {\n\tlabel: \"Steady Aim\", icon: img, \n\tchanges: [{value: 1, mode: CONST.ACTIVE_EFFECT_MODES.OVERRIDE, priority: 20, key:\"flags.midi-qol.advantage.attack.rwak\"}], duration: {turns:1}, flags:{dae: {specialDuration: [\"1Attack:rwak\"]}}\n};\n\nawait a.createEmbeddedDocuments(\"ActiveEffect\", [effectData]);","folder":null,"sort":0,"permission":{"default":0},"flags":{}}}},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false}}}
{"_id":"xsqMiTTUCo6MgjDj","name":"Slasher","type":"feat","img":"modules/GMmacros/img/slash.png","data":{"description":{"value":"<p> You’ve learned where to cut to have the greatest results, granting you the following benefits:</p>\n<ul>\n<li>Once per turn when you hit a creature with an attack that deals slashing damage, you can reduce the speed of the target by 10 feet until the start of your next turn.</li>\n<li>When you score a critical hit that deals slashing damage to a creature, you grievously wound it. Until the start of your next turn, the target has disadvantage on all attack rolls.</li>\n</ul>\n<p> </p>","chat":"","unidentified":""},"source":"TCoE","activation":{"type":"special","cost":0,"condition":""},"duration":{"value":null,"units":""},"target":{"value":null,"width":null,"units":"","type":"self"},"range":{"value":null,"long":null,"units":""},"uses":{"value":null,"max":"","per":""},"consume":{"type":"","target":"","amount":null},"ability":null,"actionType":"","attackBonus":0,"chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"requirements":"Feat: Slasher","recharge":{"value":null,"charged":false},"attunement":0},"effects":[{"_id":"5LsTTEo1APQ0w520","changes":[{"key":"flags.midi-qol.onUseMacroName","mode":0,"value":"ItemMacro.Slasher,preDamageRoll","priority":"20"}],"disabled":false,"duration":{"startTime":null},"icon":"modules/GMmacros/img/slash.png","label":"Slasher","origin":"Item.Aj6rMauKBQFNOrub","transfer":true,"flags":{"core":{"statusId":""},"dae":{"stackable":"none","durationExpression":"","macroRepeat":"none","specialDuration":[],"transfer":true},"ActiveAuras":{"isAura":false,"aura":"None","radius":null,"alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"displayTemp":false,"hostile":false,"onlyOnce":false},"dnd5e-helpers":{"rest-effect":"Ignore"}},"tint":null,"selectedKey":"flags.midi-qol.onUseMacroName"}],"folder":null,"sort":0,"permission":{"default":0,"QwT9izJ4aW8QVTjo":3},"flags":{"scene-packer":{"hash":"03fc135b9b61cac404cd57f30823767864e1e2ec","sourceId":"Item.CQe7aJptcXa6qlv1"},"spellTemplateManager":{"stmData":{"ignoreDuration":false,"spellTexture":"","useTexture":false,"alpha":50,"coneOrigin":1,"loopAnimations":true}},"magicitems":{"enabled":false,"equipped":false,"attuned":false,"charges":"0","chargeType":"c1","destroy":false,"destroyFlavorText":"reaches 0 charges: it crumbles into ashes and is destroyed.","rechargeable":false,"recharge":"0","rechargeType":"t1","rechargeUnit":"r1","sorting":"l"},"itemacro":{"macro":{"data":{"_id":null,"name":"Slasher","type":"script","author":"QwT9izJ4aW8QVTjo","img":"icons/svg/dice-target.svg","scope":"global","command":"/*****\nSlasher\n\nOnce per turn when you hit a creature with an attack that deals slashing damage, \nyou can reduce the speed of the target by 10 feet until the start of your next turn.\n\nWhen you score a critical hit that deals slashing damage to a creature, \nyou grievously wound it. Until the start of your next turn, the target has \ndisadvantage on all attack rolls.\n\nv0.1 April 13 2022 jbowens #0415 (Discord) https://github.com/jbowensii/More-Automated-Spells-Items-and-Feats.git \n*****/\n\n// make sure the attempted hit was made with a weapon attack\nif (![\"mwak\",\"rwak\"].includes(args[0].item.data.actionType)) return;\n\nif (args[0].macroPass === \"preDamageRoll\") {\n    const workflow = MidiQOL.Workflow.getWorkflow(args[0].itemUuid);\n    let targetToken = await fromUuid(args[0].hitTargetUuids[0]);\n    let targetActor = targetToken.actor;\n    let theItem = workflow.item.data.data;\n\n    if (theItem.damage.parts[0][1] !== \"slashing\") return;   // not a slashing weapon  \n        else {\n            let effect = await findEffect(targetActor, \"Reduced Movement\");\n            if (!effect) await applyReduceMovementEffect(targetActor, args[0].uuid);\n            if (workflow.isCritical) await applyAttackDisadvantageEffect(targetActor, args[0].uuid);\n        }\n    return; \n}\n\n// Apply the fightened effect to the target\nasync function applyReduceMovementEffect(target, originUuid) {\n    let effectData = {\n        label : \"Reduced Movement\",\n        icon : \"modules/GMmacros/img/slash.png\",\n        origin: originUuid,\n        changes: [ { \"key\": \"data.attributes.movement.all\", \"value\": `-10`, \"mode\":0, \"priority\": 20 } ],\n        disabled: false,\n        flags: { dae: {specialDuration: [\"turnStartSource\"]}, },\n\tduration: {seconds: 60},\n       }\n    await MidiQOL.socket().executeAsGM(\"createEffects\", {actorUuid: target.uuid, effects: [effectData]});\n}\n\n// Apply the fightened effect to the target\nasync function applyAttackDisadvantageEffect(target, originUuid) {\n    let effectData = {\n        label : \"Attack Disadvantage\",\n        icon : \"modules/GMmacros/img/slash.png\",\n        origin: originUuid,\n        changes: [ { \"key\": \"flags.midi-qol.disadvantage.attack.all\", \"value\": `1`, \"mode\": 0, \"priority\": 20 } ],\n        disabled: false,\n        flags: { dae: {specialDuration: [\"turnStartSource\"]}, },\n\tduration: {seconds: 60},\n       }\n    await MidiQOL.socket().executeAsGM(\"createEffects\", {actorUuid: target.uuid, effects: [effectData]});\n}\n\n// Function to test for an effect\nasync function findEffect (thisActor, effectName) {\n    let effectUuid = null;\n    effectUuid = thisActor?.effects.find(ef=> ef.data.label === effectName);\n    return effectUuid;        \n}","folder":null,"sort":0,"permission":{"default":0},"flags":{}}}},"core":{"sourceId":"Item.5PUe0GiheEHUomoR"},"exportSource":{"world":"test","system":"dnd5e","coreVersion":"9.255","systemVersion":"1.5.7"},"cf":{"id":"temp_a5umw776e9r","path":"Feats","color":"#0000ff"},"favtab":{"isFavorite":true},"siftoolkit":{"SIFData":{"ignoreDuration":false,"texture":"","useTexture":false,"alpha":50,"coneOrigin":1,"loopAnimations":true,"playTemplateAudio":false,"playDamageAudio":false,"playSaveAudio":false,"clip":"","volume":100}}}}
{"name":"Maneuvers: Commanding Presence","type":"feat","img":"icons/magic/perception/shadow-stealth-eyes-purple.webp","effects":[{"label":"Maneuvers: Commanding Presence","icon":"icons/magic/perception/shadow-stealth-eyes-purple.webp","changes":[{"key":"flags.midi-qol.optional.Presence.label","mode":0,"value":"Maneuvers: Commanding Presence: Clique aqui pra ADD um dado de sup.","priority":20},{"key":"flags.midi-qol.optional.Presence.skill.itm","mode":0,"value":"+1d((2*floor(((@classes.fighter.levels)-2)/8))+8)","priority":20},{"key":"flags.midi-qol.optional.Presence.skill.per","mode":0,"value":"+1d((2*floor(((@classes.fighter.levels)-2)/8))+8)","priority":20},{"key":"flags.midi-qol.optional.Presence.skill.prf","mode":0,"value":"+1d((2*floor(((@classes.fighter.levels)-2)/8))+8)","priority":20}],"transfer":true,"_id":"SmjUb52DovNB2MEp","disabled":false,"duration":{"startTime":null,"seconds":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"origin":null,"tint":null,"flags":{"dfreds-convenient-effects":{"description":""},"dae":{"selfTarget":false,"selfTargetAlways":false,"stackable":"noneName","durationExpression":"","macroRepeat":"none","specialDuration":[]},"core":{"statusId":""},"ActiveAuras":{"isAura":false,"aura":"None","radius":"","alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"displayTemp":false,"hostile":false,"onlyOnce":false}}}],"flags":{"ddbimporter":{"id":"2439086","entityTypeId":"222216831","componentId":1306902,"componentTypeId":258900837,"class":"Fighter","subclass":"Battle Master","importId":"28pyz8r4w0vt0973"},"infusions":{"infused":false},"obsidian":{"source":{"type":"class","text":"Fighter"}},"scene-packer":{"hash":"9b4b98008e1e24548b8843b090f3f25c307eaf0c","sourceId":"Item.UazpMHA0wRlD1Vi5"},"spellTemplateManager":{"stmData":{"ignoreDuration":false,"spellTexture":"","useTexture":false,"alpha":50,"coneOrigin":1,"loopAnimations":true}},"midi-qol":{"effectActivation":false,"onUseMacroName":"[postActiveEffects]ItemMacro"},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"autoFailFriendly":false,"autoSaveFriendly":false,"offHandWeapon":false,"ignoreTotalCover":false},"magicitems":{"enabled":false,"equipped":false,"attuned":false,"charges":"0","chargeType":"c1","destroy":false,"destroyFlavorText":"reaches 0 charges: it crumbles into ashes and is destroyed.","rechargeable":false,"recharge":"0","rechargeType":"t1","rechargeUnit":"r1","sorting":"l"},"favtab":{"isFavorite":true},"itemacro":{"macro":{"data":{"_id":null,"name":"Maneuvers: Brace","type":"script","author":"ldRsJ6Yp5qPydWA1","img":"icons/svg/dice-target.svg","scope":"global","command":"","folder":null,"sort":0,"permission":{"default":0},"flags":{}},"name":"Maneuvers: Commanding Presence","type":"script","scope":"global","command":"let sourceActor = this.actor;\nlet SupDie = sourceActor.items.getName('Superiority Die');\nlet SupDieUses = SupDie.system.uses.value;\n      if (SupDieUses <= 0) return {};\n        if (!SupDie) {\n            ui.notifications.warn('Source actor does not appear to have a Bardic Inspiration feature!');\n            return;}\nSupDie.update({'system.uses.value': SupDieUses - 1});","author":"Be8r6Sgxcs3sL08I","_id":null,"img":"icons/svg/dice-target.svg","folder":null,"sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null}}},"core":{"sourceId":"Item.QCt9G1ryLky9enrK"},"cf":{"id":"temp_pbbargtiogk","path":"Manobras - Battle Master Novo","color":"#b74e4e"},"exportSource":{"world":"test","system":"dnd5e","coreVersion":"9.269","systemVersion":"1.6.1"},"rest-recovery":{"data":{"recovery":{"enabled":false}}}},"system":{"description":{"value":"<p><strong>Quando rolar algum desse, ele vai pedir se quer adicionar.</strong></p><p>When you make a Charisma (Intimidation), a Charisma (Performance), or a Charisma (Persuasion) check, you can expend one superiority die and add the superiority die to the ability check.</p><p></p><p></p>","chat":"","unidentified":""},"source":"TCoE p42","activation":{"type":"special","cost":null,"condition":""},"duration":{"value":null,"units":""},"cover":null,"target":{"value":null,"width":null,"units":"","type":"self"},"range":{"value":null,"long":null,"units":""},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"attribute","target":"","amount":1},"ability":"","actionType":"other","attackBonus":0,"chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"type":{"value":"","subtype":""},"requirements":"Fighter: Battlemaster","recharge":{"value":null,"charged":false},"attunement":0},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1668460261747,"modifiedTime":1685305524867,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"_id":"zEhZAdAGu5O2SM0c"}
{"name":"Emissary of Redemption","type":"feat","system":{"description":{"value":"<div class=\"rd__b  rd__b--1\"><p>At 20th level, you become an avatar of peace, which gives you two benefits:</p><ul class=\"rd__list\"><li class=\"rd__li \">You have resistance to all damage dealt by other creatures (their attacks, spells, and other effects).</li><li class=\"rd__li \">Whenever a creature hits you with an attack, it takes radiant damage equal to half the damage you take from the attack.</li></ul><p>If you attack a creature, cast a spell on it, or deal damage to it by any means but this feature, neither benefit works against that creature until you finish a long rest.</p></div><p>-- Quando vc causar dano, vai criar um efeito passivo (não visivel) no alvo. Automaticamente, quando ele te atacar, vai dobrar o dano dele (com correção) para vc reduzir metade e ser o que deveria (sem resistência).</p><p>-- Quando o alvo te atacar, vai refletir 1/4 do dano original, dado que vc tem resistência contra tudo.</p><p><strong>Adicionar essas duas Actor OnUseMacro (no PJ): estão na Pasta Players Macros da GM Macros tb</strong></p><p><strong>MACRO 1 (AFTER DAMAGE ROLL)</strong></p><blockquote><p>const workflow = MidiQOL.Workflow.getWorkflow(args[0].uuid);</p><p>if (args[0].hitTargetUuids.length === 0) return {}</p><p>const tactor = (Array.from(workflow.targets))[0]?.actor;</p><p>if (tactor?.effects.find(i=&gt;i.data.label === \"Emissary of Redemption Attacked\")) {return} else {</p><p>let bsEffect = new ActiveEffect({label: \"Emissary of Redemption Attacked\",</p><p>icon: \"modules/GMmacros/img/phb-searing-smite.webp\"});</p><p>for (let tokenUuid of args[0].hitTargetUuids) {</p><p>const target = await fromUuid(tokenUuid);</p><p>const targetActor = target.actor;</p><p>if (!targetActor) continue;</p><p>await MidiQOL.socket().executeAsGM(\"createEffects\", {actorUuid: targetActor.uuid, effects: [bsEffect.toObject()]})</p><p>}</p><p>}</p></blockquote><p>MACRO 2 (ACTOR IS DAMAGED BY AN ATTACK)</p><blockquote><p>const version = \"10.0.33\"</p><p>const workfloww = MidiQOL.Workflow.getWorkflow(args[0].uuid)</p><p>const owner = workfloww.actor;</p><p>if (!owner?.effects.find(i=&gt;i.data.label === \"Emissary of Redemption Attacked\")) return;</p><p>if (args[0].macroPass = \"isDamaged\") {</p><p>try {</p><p>const actor = args[0].options?.actor;</p><p>const token = args[0].options?.token;</p><p>const target = fromUuidSync(args[0].tokenUuid);</p><p>const workflow = args[0];</p><p>let danocausado = workflow.damageTotal;</p><p>let damageType = workflow.damageDetail</p><p>const reflete = Math.floor(danocausado+1) // arredonda para cima, pq a resistencia vai ser para baixo.</p><p>const damageRoll = await new Roll(`${reflete}`).roll({async: true});</p><p>await new MidiQOL.DamageOnlyWorkflow(actor, token, damageRoll.total, damageType, [token], damageRoll, {flavor: \"Vc causou dano em mim! Correção de dano aqui\",itemCardId: args[0].itemCardId});</p><p>} catch (err) {</p><p>console.error(`Retribution ${version}`, err);</p><p>}</p><p>}</p></blockquote>","chat":"","unidentified":""},"source":"XGE","activation":{"type":"special","cost":0,"condition":""},"duration":{"value":"","units":""},"cover":null,"target":{"value":null,"width":null,"units":"","type":"self"},"range":{"value":null,"long":null,"units":"self"},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"other","attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"flat"},"type":{"value":"","subtype":""},"requirements":"Paladin 20 (Redemption)","recharge":{"value":null,"charged":false}},"img":"modules/GMmacros/img/Emissary_redemption.png","flags":{"plutonium":{"page":"subclassFeature","source":"XGE","hash":"emissary%20of%20redemption_paladin_phb_redemption_xge_20_xge"},"dnd5e":{"advancementOrigin":"z1xYql2hhQBsvGOL.4mp6Pp2M5P9j62V3"},"rest-recovery":{"data":{"recovery":{"enabled":false}}},"midi-qol":{"effectActivation":false,"onUseMacroName":""},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false,"autoFailFriendly":false,"autoSaveFriendly":false,"offHandWeapon":false},"magicitems":{"enabled":false,"equipped":false,"attuned":false,"charges":"0","chargeType":"c1","destroy":false,"destroyFlavorText":"reaches 0 charges: it crumbles into ashes and is destroyed.","rechargeable":false,"recharge":"0","rechargeType":"t1","rechargeUnit":"r1","sorting":"l"},"itemacro":{"macro":{"name":"Emissary of Redemption","type":"script","scope":"global","command":"// Ativa desativa\n// const effect = actor.effects.find(e => e.data.label === \"Emissary of Redemption\");\n// if(!effect.disabled) {\n//    await effect.update({ disabled: true });\n//     ui.notifications.warn(\"Effect disabled.\");\n//} else {\n// await effect.update({ disabled: false });}\n\nconst version = \"10.0.33\"\nconst workfloww = MidiQOL.Workflow.getWorkflow(args[0].uuid)\nconst owner = workfloww.actor;\nif (owner?.effects.find(i=>i.data.label === \"Emissary of Redemption Attacked\")) return;\n\ntry {\n    const workflow = args[0];\n    const actor = args[0].options?.actor;\n    const token = args[0].options?.token;\n    const target = fromUuidSync(args[0].tokenUuid);\n    let danocausado = workflow.damageTotal;\n    const reflete = Math.floor(danocausado / 4)\n    const damageRoll = await new Roll(`${reflete}`).roll({async: true});\n    await new MidiQOL.DamageOnlyWorkflow(actor, token, damageRoll.total, \"radiant\", [target], damageRoll, {flavor: `Emissary of Redemption (Radiant)`, itemCardId: \"new\", itemData: actor.items.getName(\"\")});\n    // Could do a MidiQOL.completeItemUse with the fetched item instead\n} catch (err) {\n    console.error(`Retribution ${version}`, err);\n}","author":"Be8r6Sgxcs3sL08I","_id":null,"img":"icons/svg/dice-target.svg","folder":null,"sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null}}},"core":{"sourceId":"Actor.YPh5XDISqV1e9Zth.Item.pGOBwOl4fYNvZ9Eb"}},"effects":[{"label":"Emissary of Redemption","icon":"modules/GMmacros/img/Emissary_redemption.png","changes":[{"key":"system.traits.dr.all","mode":0,"value":"1","priority":20},{"key":"flags.midi-qol.onUseMacroName","mode":0,"value":"ItemMacro, isDamaged","priority":20}],"transfer":true,"_id":"yE7GnuA2BxtcNzcc","disabled":false,"duration":{"startTime":null,"seconds":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"origin":null,"tint":null,"flags":{"dae":{"selfTarget":false,"selfTargetAlways":false,"stackable":"none","durationExpression":"","macroRepeat":"none","specialDuration":[]},"core":{"statusId":""},"ActiveAuras":{"isAura":false,"aura":"None","radius":"","alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"displayTemp":false,"hostile":false,"onlyOnce":false},"dfreds-convenient-effects":{"description":""}}}],"ownership":{"default":0,"l056gHuKc3178tdK":3,"Be8r6Sgxcs3sL08I":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1669682364474,"modifiedTime":1686614384593,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"_id":"fmyIZiN1dJ8H4bPF"}
{"name":"#[CF_tempEntity]","type":"weapon","flags":{"cf":{"id":"temp_mt8pdupg5f","name":"Paladin","color":"#e4de25","fontColor":"#1c1c1c","icon":"","sorting":"m","contents":["1f2ijhqxOr4FPVeT","psp5X0ES66RwIiXc","fmyIZiN1dJ8H4bPF"],"children":[]}},"img":"icons/svg/item-bag.svg","system":{"description":{"value":"","chat":"","unidentified":""},"source":"","quantity":1,"weight":0,"price":{"value":0,"denomination":"gp"},"attunement":0,"equipped":false,"rarity":"","identified":true,"activation":{"type":"","cost":null,"condition":""},"duration":{"value":"","units":""},"cover":null,"target":{"value":null,"width":null,"units":"","type":""},"range":{"value":null,"long":null,"units":""},"uses":{"value":null,"max":"","per":null,"recovery":""},"consume":{"type":"","target":null,"amount":null},"ability":null,"actionType":null,"attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"spell"},"armor":{"value":null},"hp":{"value":null,"max":null,"dt":null,"conditions":""},"weaponType":"simpleM","baseItem":"","properties":{},"proficient":true},"effects":[],"folder":null,"sort":0,"ownership":{"default":0,"Be8r6Sgxcs3sL08I":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1685907149601,"modifiedTime":1686614386543,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"_id":"DBGqtxqyQJgYfTYT"}
{"name":"Emissary of Redemption","type":"feat","system":{"description":{"value":"<div class=\"rd__b  rd__b--1\"><p>At 20th level, you become an avatar of peace, which gives you two benefits:</p><ul class=\"rd__list\"><li class=\"rd__li \">You have resistance to all damage dealt by other creatures (their attacks, spells, and other effects).</li><li class=\"rd__li \">Whenever a creature hits you with an attack, it takes radiant damage equal to half the damage you take from the attack.</li></ul><p>If you attack a creature, cast a spell on it, or deal damage to it by any means but this feature, neither benefit works against that creature until you finish a long rest.</p></div><p>-- Quando vc causar dano, vai criar um efeito passivo (não visivel) no alvo. Automaticamente, quando ele te atacar, vai dobrar o dano dele (com correção) para vc reduzir metade e ser o que deveria (sem resistência).</p><p>-- Quando o alvo te atacar, vai refletir 1/4 do dano original, dado que vc tem resistência contra tudo.</p><p><strong>Adicionar essas duas Actor OnUseMacro (no PJ): estão na Pasta Players Macros da GM Macros tb</strong></p><p><strong>MACRO 1 (AFTER DAMAGE ROLL)</strong></p><blockquote><p>const workflow = MidiQOL.Workflow.getWorkflow(args[0].uuid);</p><p>if (args[0].hitTargetUuids.length === 0) return {}</p><p>const tactor = (Array.from(workflow.targets))[0]?.actor;</p><p>if (tactor?.effects.find(i=&gt;i.data.label === \"Emissary of Redemption Attacked\")) {return} else {</p><p>let bsEffect = new ActiveEffect({label: \"Emissary of Redemption Attacked\",</p><p>icon: \"modules/GMmacros/img/phb-searing-smite.webp\"});</p><p>for (let tokenUuid of args[0].hitTargetUuids) {</p><p>const target = await fromUuid(tokenUuid);</p><p>const targetActor = target.actor;</p><p>if (!targetActor) continue;</p><p>await MidiQOL.socket().executeAsGM(\"createEffects\", {actorUuid: targetActor.uuid, effects: [bsEffect.toObject()]})</p><p>}</p><p>}</p></blockquote><p>MACRO 2 (ACTOR IS DAMAGED BY AN ATTACK)</p><blockquote><p>const version = \"10.0.33\"</p><p>const workfloww = MidiQOL.Workflow.getWorkflow(args[0].uuid)</p><p>const owner = workfloww.actor;</p><p>if (!owner?.effects.find(i=&gt;i.data.label === \"Emissary of Redemption Attacked\")) return;</p><p>if (args[0].macroPass = \"isDamaged\") {</p><p>try {</p><p>const actor = args[0].options?.actor;</p><p>const token = args[0].options?.token;</p><p>const target = fromUuidSync(args[0].tokenUuid);</p><p>const workflow = args[0];</p><p>let danocausado = workflow.damageTotal;</p><p>let damageType = workflow.damageDetail</p><p>const reflete = Math.floor(danocausado+1) // arredonda para cima, pq a resistencia vai ser para baixo.</p><p>const damageRoll = await new Roll(`${reflete}`).roll({async: true});</p><p>await new MidiQOL.DamageOnlyWorkflow(actor, token, damageRoll.total, damageType, [token], damageRoll, {flavor: \"Vc causou dano em mim! Correção de dano aqui\",itemCardId: args[0].itemCardId});</p><p>} catch (err) {</p><p>console.error(`Retribution ${version}`, err);</p><p>}</p><p>}</p></blockquote>","chat":"","unidentified":""},"source":"XGE","activation":{"type":"special","cost":0,"condition":""},"duration":{"value":"","units":""},"cover":null,"target":{"value":null,"width":null,"units":"","type":"self"},"range":{"value":null,"long":null,"units":"self"},"uses":{"value":null,"max":"","per":"","recovery":""},"consume":{"type":"","target":"","amount":null},"ability":"","actionType":"other","attackBonus":"","chatFlavor":"","critical":{"threshold":null,"damage":""},"damage":{"parts":[],"versatile":""},"formula":"","save":{"ability":"","dc":null,"scaling":"flat"},"type":{"value":"","subtype":""},"requirements":"Paladin 20 (Redemption)","recharge":{"value":null,"charged":false}},"img":"modules/GMmacros/img/Emissary_redemption.png","flags":{"plutonium":{"page":"subclassFeature","source":"XGE","hash":"emissary%20of%20redemption_paladin_phb_redemption_xge_20_xge"},"dnd5e":{"advancementOrigin":"z1xYql2hhQBsvGOL.4mp6Pp2M5P9j62V3"},"rest-recovery":{"data":{"recovery":{"enabled":false}}},"midi-qol":{"effectActivation":false,"onUseMacroName":""},"midiProperties":{"nodam":false,"fulldam":false,"halfdam":false,"rollOther":false,"critOther":false,"magicdam":false,"magiceffect":false,"concentration":false,"toggleEffect":false,"ignoreTotalCover":false,"autoFailFriendly":false,"autoSaveFriendly":false,"offHandWeapon":false},"magicitems":{"enabled":false,"equipped":false,"attuned":false,"charges":"0","chargeType":"c1","destroy":false,"destroyFlavorText":"reaches 0 charges: it crumbles into ashes and is destroyed.","rechargeable":false,"recharge":"0","rechargeType":"t1","rechargeUnit":"r1","sorting":"l"},"itemacro":{"macro":{"name":"Emissary of Redemption","type":"script","scope":"global","command":"// Ativa desativa\n// const effect = actor.effects.find(e => e.data.label === \"Emissary of Redemption\");\n// if(!effect.disabled) {\n//    await effect.update({ disabled: true });\n//     ui.notifications.warn(\"Effect disabled.\");\n//} else {\n// await effect.update({ disabled: false });}\n\nconst version = \"10.0.33\"\nconst workfloww = MidiQOL.Workflow.getWorkflow(args[0].uuid)\nconst owner = workfloww.actor;\nif (owner?.effects.find(i=>i.data.label === \"Emissary of Redemption Attacked\")) return;\n\ntry {\n    const workflow = args[0];\n    const actor = args[0].options?.actor;\n    const token = args[0].options?.token;\n    const target = fromUuidSync(args[0].tokenUuid);\n    let danocausado = workflow.damageTotal;\n    const reflete = Math.floor(danocausado / 4)\n    const damageRoll = await new Roll(`${reflete}`).roll({async: true});\n    await new MidiQOL.DamageOnlyWorkflow(actor, token, damageRoll.total, \"radiant\", [target], damageRoll, {flavor: `Emissary of Redemption (Radiant)`, itemCardId: \"new\", itemData: actor.items.getName(\"\")});\n    // Could do a MidiQOL.completeItemUse with the fetched item instead\n} catch (err) {\n    console.error(`Retribution ${version}`, err);\n}","author":"Be8r6Sgxcs3sL08I","_id":null,"img":"icons/svg/dice-target.svg","folder":null,"sort":0,"ownership":{"default":0},"flags":{},"_stats":{"systemId":null,"systemVersion":null,"coreVersion":null,"createdTime":null,"modifiedTime":null,"lastModifiedBy":null}}},"core":{"sourceId":"Actor.YPh5XDISqV1e9Zth.Item.pGOBwOl4fYNvZ9Eb"},"cf":{"id":"temp_mt8pdupg5f"}},"effects":[{"label":"Emissary of Redemption","icon":"modules/GMmacros/img/Emissary_redemption.png","changes":[{"key":"system.traits.dr.all","mode":0,"value":"1","priority":20},{"key":"flags.midi-qol.onUseMacroName","mode":0,"value":"ItemMacro, isDamaged","priority":20}],"transfer":true,"_id":"yE7GnuA2BxtcNzcc","disabled":false,"duration":{"startTime":null,"seconds":null,"combat":null,"rounds":null,"turns":null,"startRound":null,"startTurn":null},"origin":null,"tint":null,"flags":{"dae":{"selfTarget":false,"selfTargetAlways":false,"stackable":"none","durationExpression":"","macroRepeat":"none","specialDuration":[]},"core":{"statusId":""},"ActiveAuras":{"isAura":false,"aura":"None","radius":"","alignment":"","type":"","ignoreSelf":false,"height":false,"hidden":false,"displayTemp":false,"hostile":false,"onlyOnce":false},"dfreds-convenient-effects":{"description":""}}}],"ownership":{"default":0,"l056gHuKc3178tdK":3,"Be8r6Sgxcs3sL08I":3},"_stats":{"systemId":"dnd5e","systemVersion":"2.1.5","coreVersion":"10.291","createdTime":1669682364474,"modifiedTime":1686614386543,"lastModifiedBy":"Be8r6Sgxcs3sL08I"},"folder":null,"sort":0,"_id":"fmyIZiN1dJ8H4bPF"}
