{"name":"Arrowmacro","permission":{"default":0,"NeG597KOgANJAOdY":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false},"core":{"sourceId":"Macro.QiSggUQALHURN7Uo"},"macro-marker":{"activeData":{"icon":"modules/JB2A_DnD5e/Library/Generic/Weapon_Attacks/Ranged/Arrow_Simple_01_Thumb.webp","tooltip":"Arrow","colour":"#ff0000","trigger":""}}},"scope":"global","command":"var myStringArray = Array.from(game.user.targets)[0];\nvar arrayLength = game.user.targets.size;\nfor (var i = 0; i < arrayLength; i++) {\nconsole.log(myStringArray[i]);\n\nif(canvas.tokens.controlled.length == 0) return ui.notifications.error(\"Please select your token\");\nlet mainTarget = Array.from(game.user.targets)[i];\nlet myToken = canvas.tokens.controlled [0];\nlet halfGrid = canvas.scene.data.grid/2;\nlet srcX = (myToken.data.x + (myToken.data.width*halfGrid));\nlet srcY = (myToken.data.y + (myToken.data.height*halfGrid));\nlet tarX = (mainTarget.data.x + (mainTarget.data.width*halfGrid));\nlet tarY = (mainTarget.data.y + (mainTarget.data.height*halfGrid));\nlet outerRad = Math.sqrt(Math.pow(mainTarget.data.width*halfGrid,2) + Math.pow(myToken.data.width*halfGrid,2));\n\nlet anDeg = -(Math.atan(((srcY - tarY)/(srcX - tarX)))*57.3);\nlet anDist = Math.sqrt(Math.pow(srcX-tarX,2)+Math.pow(srcY-tarY,2));\nasync function wait(ms) {\n  return new Promise(resolve => {\n    setTimeout(resolve, ms);\n  });\n}\n\nlet anFile = \"modules/JB2A_DnD5e/Library/Generic/Weapon_Attacks/Ranged/Arrow_Simple_01_30ft_1200x200.webm\";\nlet anFileSize = 600;\nswitch(true){\n case (anDist<=1200):\n    anFileSize = 1200;\n    anFile = \"modules/JB2A_DnD5e/Library/Generic/Weapon_Attacks/Ranged/Arrow_Simple_01_30ft_1200x200.webm\";\n    break;\n case (anDist>3600):\n    anFileSize = 3600;\n    anFile = \"modules/JB2A_DnD5e/Library/Generic/Weapon_Attacks/Ranged/Arrow_Simple_01_90ft_3600x200.webm\";\n    break;\n default:\n    anFileSize = 2400;\n    anFile = \"modules/JB2A_DnD5e/Library/Generic/Weapon_Attacks/Ranged/Arrow_Simple_01_60ft_2400x200.webm\";\n    break;\n}\n\nlet anScale = Math.sqrt(Math.pow(srcX-tarX,2)+Math.pow(srcY-tarY,2))/anFileSize;\nlet anScaleY = anScale;\nif (anDist<=600){anScaleY = 0.6}\nif (anDist>=800){anScaleY = anScale}\n\nif(srcX>tarX){anDeg = anDeg+180}\nif(srcX==tarX){if(srcY>tarY){anDeg=90}else{anDeg=-90}}\n\nlet spellAnim = \n                    {\n                     file: anFile,\n                      position: {\n                        x: srcX,\n                        y: srcY\n                      },\n                      anchor: {\n                       x: 0,\n                       y: 0.5\n                      },\n                      angle: anDeg,\n                      scale: {\n                       x: anScale,\n                       y: anScaleY\n                      }\n                    }; \n\ncanvas.fxmaster.playVideo(spellAnim);\ngame.socket.emit('module.fxmaster', spellAnim);\nawait wait (20);\n}","author":"NeG597KOgANJAOdY","img":"modules/JB2A_DnD5e/Library/Generic/Weapon_Attacks/Ranged/Arrow_Simple_01_Thumb.webp","actorIds":[],"_id":"9sXeSgnQEp0iNC6a"}
{"name":"healmacro","permission":{"default":0,"NeG597KOgANJAOdY":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false},"core":{"sourceId":"Macro.PzeQutWfD871bFES"},"macro-marker":{"activeData":{"icon":"modules/JB2A_DnD5e/Library/1st_Level/Cure_Wounds_INSTANTANEOUS/CureWounds_01_Blue_Thumb.webp","tooltip":"Cure Wounds","colour":"#ff0000","trigger":""}}},"scope":"global","command":"/// Ensures the user has only 1 token targeted.\n\nif(game.user.targets.size !== 1) return ui.notifications.warn(`Single Target Please`);\n\nlet mainTarget = Array.from(game.user.targets)[0];\nlet halfGrid = canvas.scene.data.grid/2;\nlet tarX = (mainTarget.data.x + (mainTarget.data.width*halfGrid));\nlet tarY = (mainTarget.data.y + (mainTarget.data.height*halfGrid));\nlet tarScale = ((mainTarget.data.width + mainTarget.data.height)/2);\nlet spellAnim = \n                    {\n                     file: \"modules/JB2A_DnD5e/Library/1st_Level/Cure_Wounds_INSTANTANEOUS/CureWounds_01_Blue_200x200.webm\",\n                      position: {\n                        x: tarX,\n                        y: tarY\n                      },\n                      anchor: {\n                       x: 0.5,\n                       y: 0.5\n                      },\n                      angle: 0,\n                      scale: {\n                       x: tarScale,\n                       y: tarScale\n                      }\n                    }; \ncanvas.fxmaster.playVideo(spellAnim);\ngame.socket.emit('module.fxmaster', spellAnim);","author":"NeG597KOgANJAOdY","img":"modules/JB2A_DnD5e/Library/1st_Level/Cure_Wounds/CureWounds_01_Blue_Thumb.webp","actorIds":[],"_id":"KNMhrZxXO6TfDt83"}
{"name":"WitchBolt-Thunder-Macro","permission":{"default":0,"NeG597KOgANJAOdY":3},"type":"chat","flags":{"macro-marker":{"activeData":{"icon":"icons/svg/dice-target.svg","tooltip":"New Macro","colour":"#ff0000","trigger":""}},"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false},"core":{"sourceId":"Macro.xzZqerLXBvROr88V"}},"scope":"global","command":"if(game.user.targets.size == 0) ui.notifications.error('You must target at least one token');\nif(canvas.tokens.controlled.length == 0) ui.notifications.error(\"Please select your token\");\nif (!canvas.fxmaster) ui.notifications.error(\"This macro depends on the FXMaster module. Make sure it is installed and enabled\");\nconst sleepNow = (delay) => new Promise((resolve) => setTimeout(resolve, delay))\n\nasync function Cast() {\nvar myStringArray = Array.from(game.user.targets)[0];\nvar arrayLength = game.user.targets.size;\nfor (var i = 0; i < arrayLength; i++) {\n\nlet mainTarget = Array.from(game.user.targets)[i];\nlet myToken = canvas.tokens.controlled [0];\n\nlet ray = new Ray(myToken.center, mainTarget.center);\nlet anDeg = -(ray.angle * 57.3);\nlet anDist = ray.distance;\n\nlet file = \"modules/JB2A_DnD5e/Library/1st_Level/Witch_Bolt/\";\n\nlet anFile = `${file}WitchBolt_01_Regular_Blue_15ft_1000x400.webm`;\nlet anFileSize = 600;\nlet anchorX = 0.2;\nswitch(true){\n case (anDist<=600):\n    anFileSize = 600;\n    anFile = `${file}WitchBolt_01_Regular_Blue_15ft_1000x400.webm`;\n    anchorX = 0.2;\n    break;\n default:\n    anFileSize = 1200;\n    anFile = `${file}WitchBolt_01_Regular_Blue_30ft_1600x400.webm`;\n    anchorX = 0.125;\n    break;\n}\n\nlet anScale = anDist / anFileSize;\nlet anScaleY = anDist <= 600 ? 0.6  : anScale;\n\nlet spellAnim = \n                    {\n                     file: anFile,\n                      position: myToken.center,\n                      anchor: {\n                       x: anchorX,\n                       y: 0.5\n                      },\n                      angle: anDeg,\n                      scale: {\n                       x: anScale,\n                       y: anScaleY\n                      }\n                    }; \n\ncanvas.fxmaster.playVideo(spellAnim);\ngame.socket.emit('module.fxmaster', spellAnim);\nawait sleepNow(500)\n}\n}\nCast ()","author":"NeG597KOgANJAOdY","img":"modules/JB2A_DnD5e/Library/Cantrip/Ray_Of_Frost/RayOfFrost_01_Blue_Thumb.webp","actorIds":[],"_id":"KpZgRlrY90oP1RWv"}
{"name":"MagicMissilesPurplex1","permission":{"default":0,"NeG597KOgANJAOdY":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false},"core":{"sourceId":"Macro.bC9j7m5HaBstfCuB"},"macro-marker":{"activeData":{"icon":"modules/JB2A_DnD5e/Library/1st_Level/Magic_Missile_INSTANTANEOUS/MagicMissile_01_Purple_Thumb.webp","tooltip":"Magic Missiles Purple x1","colour":"#ff0000","trigger":""}}},"scope":"global","command":"/// checks for number of targets and sets the array command\nvar myStringArray = Array.from(game.user.targets)[0];\nvar arrayLength = game.user.targets.size;\nfor (var i = 0; i < arrayLength; i++) {\nconsole.log(myStringArray[i]);\n\n/// returns an error message if the caster token is not selected\nif(canvas.tokens.controlled.length == 0) return ui.notifications.error(\"Please select your token\");\n\n/// These lines pull the X Y coordinates for the selected token and caster token\nlet mainTarget = Array.from(game.user.targets)[i];\nlet myToken = canvas.tokens.controlled [0];\nlet halfGrid = canvas.scene.data.grid/2;\nlet srcX = (myToken.data.x + (myToken.data.width*halfGrid));\nlet srcY = (myToken.data.y + (myToken.data.height*halfGrid));\nlet tarX = (mainTarget.data.x + (mainTarget.data.width*halfGrid));\nlet tarY = (mainTarget.data.y + (mainTarget.data.height*halfGrid));\nlet outerRad = Math.sqrt(Math.pow(mainTarget.data.width*halfGrid,2) + Math.pow(myToken.data.width*halfGrid,2));\n\n/// calculating the angle and distance to target in pixels. This is unique to the current scene\nlet anDeg = -(Math.atan(((srcY - tarY)/(srcX - tarX)))*57.3);\nlet anDist = Math.sqrt(Math.pow(srcX-tarX,2)+Math.pow(srcY-tarY,2));\nasync function wait(ms) {\n  return new Promise(resolve => {\n    setTimeout(resolve, ms);\n  });\n}\n\n/// settinng the animation file to play. Base file can be any, because the file will be switched based on the distance to target\nlet anFile = \"modules/JB2A_DnD5e/Library/1st_Level/Magic_Missile_INSTANTANEOUS/MagicMissile_01_Purple_30ft_01_1200x400.webm\";\nlet anFileSize = 1200;\n/// evaluates the distance to the target and choose the best length animation file to play\nswitch(true){\n case (anDist<=1200):\n   /// anFileSize should always match the length of the animation file, otherwise it will not land on target. For example, 1200 for 1200x200, and 3600 for 3600x200. If the file was 600x200, anFileSize would be 600\n    anFileSize = 1200;\n    anFile = \"modules/JB2A_DnD5e/Library/1st_Level/Magic_Missile_INSTANTANEOUS/MagicMissile_01_Purple_30ft_04_1200x400.webm\";\n    break;\n case (anDist>2400):\n    anFileSize = 2400;\n    anFile = \"modules/JB2A_DnD5e/Library/1st_Level/Magic_Missile_INSTANTANEOUS/MagicMissile_01_Purple_60ft_02_2400x400.webm\";\n    break;\n default:\n    anFileSize = 2400;\n    anFile = \"modules/JB2A_DnD5e/Library/1st_Level/Magic_Missile_INSTANTANEOUS/MagicMissile_01_Purple_60ft_03_2400x400.webm\";\n    break;\n}\n\n/// Sets the scaling parameters for the video file. This will stretch or shrink the file on the x and y axis depending on the distance to target\nlet anScale = Math.sqrt(Math.pow(srcX-tarX,2)+Math.pow(srcY-tarY,2))/anFileSize;\nlet anScaleY = anScale;\nif (anDist<=600){anScaleY = 0.8}\nif (anDist>=800){anScaleY = anScale}\n\n/// corrects the angle against any variation\nif(srcX>tarX){anDeg = anDeg+180}\nif(srcX==tarX){if(srcY>tarY){anDeg=90}else{anDeg=-90}}\n\n/// Sets the originating position of the animation file and anchors it off center. Also applies the angle and scale that was determined above\nlet spellAnim = \n                    {\n                     file: anFile,\n                      position: {\n                        x: srcX,\n                        y: srcY\n                      },\n                      anchor: {\n                       x: 0,\n                       y: 0.5\n                      },\n                      angle: anDeg,\n                      scale: {\n                       x: anScale,\n                       y: anScaleY\n                      }\n                    }; \n\n/// Tells FXMaster to play the spell animation\ncanvas.fxmaster.playVideo(spellAnim);\ngame.socket.emit('module.fxmaster', spellAnim);\n/// delays 20ms between targets if multiple were selected\nawait wait (20);\n}","author":"NeG597KOgANJAOdY","img":"modules/JB2A_DnD5e/Library/1st_Level/Magic_Missile/MagicMissile_01_Purple_Thumb.webp","actorIds":[],"_id":"NPbq7jKay3YmgWpr"}
{"name":"Bitemacro","permission":{"default":0,"NeG597KOgANJAOdY":3},"type":"script","flags":{"core":{"sourceId":"Macro.B14ZptISDhdxLYtd"},"macro-marker":{"activeData":{"icon":"modules/JB2A_DnD5e/Library/1st_Level/Cure_Wounds/CureWounds_01_Blue_Thumb.webp","tooltip":"Blueprint Animation OnTargetFX","colour":"#ff0000","trigger":""}},"combat-utility-belt":{"macroTrigger":""}},"scope":"global","command":"if(game.user.targets.size == 0) ui.notifications.error('You must target at least one token');\nif (!canvas.fxmaster) ui.notifications.error(\"This macro depends on the FXMaster module. Make sure it is installed and enabled\");\nconst wait = (delay) => new Promise((resolve) => setTimeout(resolve, delay))\n\nasync function Cast() {\nvar myStringArray = Array.from(game.user.targets)[0];\nvar arrayLength = game.user.targets.size;\nfor (var i = 0; i < arrayLength; i++) {\nconsole.log(myStringArray[i]);\n\nlet mainTarget = Array.from(game.user.targets)[i];\nlet tarScale = ((mainTarget.data.width + mainTarget.data.height)/2);\n\nlet spellAnim = \n                    {\n                     file: \"modules/JB2A_DnD5e/Library/Generic/Creature/Bite_01_Red_400x400.webm\",\n                      position: mainTarget.center,\n                      anchor: {\n                       x: 0.5,\n                       y: 0.5\n                      },\n                      angle: 0,\n                      scale: {\n                       x: tarScale,\n                       y: tarScale\n                      }\n                    }; \ncanvas.fxmaster.playVideo(spellAnim);\ngame.socket.emit('module.fxmaster', spellAnim);\nawait wait (75);\n}\n}\nCast ()","author":"NeG597KOgANJAOdY","img":"modules/JB2A_DnD5e/Library/Generic/Creature/Bite_01_Red_Thumb.webp","actorIds":[],"_id":"VovpJBU2NS2wbji7"}
{"name":"FireboltMacro","permission":{"default":0,"NeG597KOgANJAOdY":3},"type":"script","flags":{"core":{"sourceId":"Macro.68CDpJv8wdDdnGI6"},"macro-marker":{"activeData":{"icon":"modules/JB2A_DnD5e/Library/Cantrip/Fire_Bolt/FireBolt_01_Regular_Orange_Thumb.webp","tooltip":"Blueprint CasterToTarget 30ft 60ft 90ft","colour":"#ff0000","trigger":""}},"combat-utility-belt":{"macroTrigger":""}},"scope":"global","command":"//This macro plays the animation on selected targets with a trajectory and distances of 30ft, 60ft and 90ft\n//It works for animations like Scorching Ray, Fire Bolt, Arrow, Boulder Toss, Siege Projectile that use these distances\n//Import this macro, duplicate it and change its name making sure it's unique by adding the colour (i.e. \"Ray Of Frost Blue\").\n//If it has the exact same name as the spell or item you want to trigger it from, you'll encounter an issue.\n\n//folder 01 is the directory path to the assets\n// let folder01 = \"modules/JB2A_DnD5e/Library/2nd_Level/Scorching_Ray/\";\n//anFile30 points to the file corresponding to 30ft, anFile60 for 60ft and anFile90 for 90ft\n// let anFile30 = `${folder01}ScorchingRay_01_Orange_30ft_1600x400.webm`;\n// let anFile60 = `${folder01}ScorchingRay_01_Orange_60ft_2800x400.webm`;\n// let anFile90 = `${folder01}ScorchingRay_01_Orange_90ft_4000x400.webm`;\n\n//How this macro is set up for Fire Bolt\nlet folder01 = \"modules/JB2A_DnD5e/Library/Cantrip/Fire_Bolt/\";\nlet anFile30 = `${folder01}FireBolt_01_Regular_Orange_30ft_1600x400.webm`;\nlet anFile60 = `${folder01}FireBolt_01_Regular_Orange_60ft_2800x400.webm`;\nlet anFile90 = `${folder01}FireBolt_01_Regular_Orange_90ft_4000x400.webm`;\n\n\nif(game.user.targets.size == 0) ui.notifications.error('You must target at least one token');\nif(canvas.tokens.controlled.length == 0) ui.notifications.error(\"Please select your token\");\n///Check if Module dependencies are installed or returns an error to the user\nif (!canvas.fxmaster) ui.notifications.error(\"This macro depends on the FXMaster module. Make sure it is installed and enabled\");\n\nconst wait = (delay) => new Promise((resolve) => setTimeout(resolve, delay))\n\nasync function Cast() {\nvar myStringArray = Array.from(game.user.targets)[0];\nvar arrayLength = game.user.targets.size;\nfor (var i = 0; i < arrayLength; i++) {\n\nlet mainTarget = Array.from(game.user.targets)[i];\nlet myToken = canvas.tokens.controlled [0];\n\nlet ray = new Ray(myToken.center, mainTarget.center);\nlet anDeg = -(ray.angle * 57.3);\nlet anDist = ray.distance;\n\n\nlet anFile = anFile30;\nlet anFileSize = 1200;\nlet anchorX = 0.125;\nswitch(true){\n case (anDist<=1200):\n    anFileSize = 1200;\n    anFile = anFile30;\n    anchorX = 0.125;\n    break;\n case (anDist>2400):\n    anFileSize = 3600;\n    anFile = anFile90;\n    anchorX = 0.05;\n    break;\n default:\n    anFileSize = 2400;\n    anFile = anFile60;\n    anchorX = 0.071;\n    break;\n}\n\nlet anScale = anDist / anFileSize;\nlet anScaleY = anDist <= 600 ? 0.6  : anScale;\n\nlet spellAnim = \n                    {\n                     file: anFile,\n                      position: myToken.center,\n                      anchor: {\n                       x: anchorX,\n                       y: 0.5\n                      },\n                      angle: anDeg,\n                      scale: {\n                       x: anScale,\n                       y: anScaleY\n                      }\n                    }; \n\ncanvas.fxmaster.playVideo(spellAnim);\ngame.socket.emit('module.fxmaster', spellAnim);\nawait wait (250);\n}\n}\nCast ()","author":"NeG597KOgANJAOdY","img":"modules/JB2A_DnD5e/Library/Cantrip/Fire_Bolt/FireBolt_01_Regular_Orange_Thumb.webp","actorIds":[],"_id":"hQ6En88DTqswXTJZ"}
{"name":"ScorchingRayMacro","permission":{"default":0,"NeG597KOgANJAOdY":3},"type":"script","flags":{"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false},"core":{"sourceId":"Macro.R7JPBXBjMKhCRzzi"},"macro-marker":{"activeData":{"icon":"modules/JB2A_DnD5e/Library/2nd_Level/Scorching_Ray_INSTANTANEOUS/ScorchingRay_01_Orange_Thumb.webp","tooltip":"Scorching Ray","colour":"#ff0000","trigger":""}}},"scope":"global","command":"var myStringArray = Array.from(game.user.targets)[0];\nvar arrayLength = game.user.targets.size;\nfor (var i = 0; i < arrayLength; i++) {\nconsole.log(myStringArray[i]);\n\nif(canvas.tokens.controlled.length == 0) return ui.notifications.error(\"Please select your token\");\nlet mainTarget = Array.from(game.user.targets)[i];\nlet myToken = canvas.tokens.controlled [0];\nlet halfGrid = canvas.scene.data.grid/2;\nlet srcX = (myToken.data.x + (myToken.data.width*halfGrid));\nlet srcY = (myToken.data.y + (myToken.data.height*halfGrid));\nlet tarX = (mainTarget.data.x + (mainTarget.data.width*halfGrid));\nlet tarY = (mainTarget.data.y + (mainTarget.data.height*halfGrid));\nlet outerRad = Math.sqrt(Math.pow(mainTarget.data.width*halfGrid,2) + Math.pow(myToken.data.width*halfGrid,2));\n\nlet anDeg = -(Math.atan(((srcY - tarY)/(srcX - tarX)))*57.3);\nlet anDist = Math.sqrt(Math.pow(srcX-tarX,2)+Math.pow(srcY-tarY,2));\nasync function wait(ms) {\n  return new Promise(resolve => {\n    setTimeout(resolve, ms);\n  });\n}\n\n\n\n\n//modules/JB2A_DnD5e/Library/2nd_Level/Scorching_Ray_INSTANTANEOUS/ScorchingRay_01_Orange_90ft_3600x200.webm\n\n\nlet anFile = \"modules/JB2A_DnD5e/Library/2nd_Level/Scorching_Ray_INSTANTANEOUS/ScorchingRay_01_Orange_30ft_1200x200.webm\";\nlet anFileSize = 1200;\nswitch(true){\n case (anDist<=1200):\n    anFileSize = 1200;\n    anFile = \"modules/JB2A_DnD5e/Library/2nd_Level/Scorching_Ray_INSTANTANEOUS/ScorchingRay_01_Orange_30ft_1200x200.webm\";\n    break;\n case (anDist>2400):\n    anFileSize = 2400;\n    anFile = \"modules/JB2A_DnD5e/Library/2nd_Level/Scorching_Ray_INSTANTANEOUS/ScorchingRay_01_Orange_60ft_2400x200.webm\";\n    break;\n default:\n    anFileSize = 1200;\n    anFile = \"modules/JB2A_DnD5e/Library/2nd_Level/Scorching_Ray_INSTANTANEOUS/ScorchingRay_01_Orange_30ft_1200x200.webm\";\n    break;\n}\n\n\nlet anScale = Math.sqrt(Math.pow(srcX-tarX,2)+Math.pow(srcY-tarY,2))/anFileSize;\nlet anScaleY = anScale;\nif (anDist<=600){anScaleY = 0.6}\nif (anDist>=800){anScaleY = anScale}\n\nif(srcX>tarX){anDeg = anDeg+180}\nif(srcX==tarX){if(srcY>tarY){anDeg=90}else{anDeg=-90}}\n\nlet spellAnim = \n                    {\n                     file: anFile,\n                      position: {\n                        x: srcX,\n                        y: srcY\n                      },\n                      anchor: {\n                       x: 0,\n                       y: 0.5\n                      },\n                      angle: anDeg,\n                      scale: {\n                       x: anScale,\n                       y: anScaleY\n                      }\n                    }; \n\ncanvas.fxmaster.playVideo(spellAnim);\ngame.socket.emit('module.fxmaster', spellAnim);\nawait wait (180);\n}","author":"NeG597KOgANJAOdY","img":"modules/JB2A_DnD5e/Library/2nd_Level/Scorching_Ray/ScorchingRay_01_Orange_Thumb.webp","actorIds":[],"_id":"pjPbhHNKgRUR29XG"}
{"name":"RayfrostMacro","permission":{"default":0,"NeG597KOgANJAOdY":3},"type":"chat","flags":{"macro-marker":{"activeData":{"icon":"icons/svg/dice-target.svg","tooltip":"New Macro","colour":"#ff0000","trigger":""}},"combat-utility-belt":{"macroTrigger":""},"furnace":{"runAsGM":false},"core":{"sourceId":"Macro.xzZqerLXBvROr88V"}},"scope":"global","command":"if(game.user.targets.size == 0) ui.notifications.error('You must target at least one token');\nif(canvas.tokens.controlled.length == 0) ui.notifications.error(\"Please select your token\");\nif (!canvas.fxmaster) ui.notifications.error(\"This macro depends on the FXMaster module. Make sure it is installed and enabled\");\nconst wait = (delay) => new Promise((resolve) => setTimeout(resolve, delay))\n\nasync function Cast() {\nvar myStringArray = Array.from(game.user.targets)[0];\nvar arrayLength = game.user.targets.size;\nfor (var i = 0; i < arrayLength; i++) {\n\nlet mainTarget = Array.from(game.user.targets)[i];\nlet myToken = canvas.tokens.controlled [0];\n\nlet ray = new Ray(myToken.center, mainTarget.center);\nlet anDeg = -(ray.angle * 57.3);\nlet anDist = ray.distance;\n\nlet file = \"modules/JB2A_DnD5e/Library/Cantrip/Ray_Of_Frost/\";\n\nlet anFile = `${file}RayOfFrost_01_Blue_15ft_1000x200.webm`;\nlet anFileSize = 600;\nlet anchorX = 0.2;\nswitch(true){\n case (anDist<=600):\n    anFileSize = 600;\n    anFile = `${file}RayOfFrost_01_Blue_15ft_1000x400.webm`;\n    anchorX = 0.2;\n    break;\n case (anDist>1200):\n    anFileSize = 1800;\n    anFile = `${file}RayOfFrost_01_Blue_45ft_2200x400.webm`;\n    anchorX = 0.091;\n    break;\n default:\n    anFileSize = 1200;\n    anFile = `${file}RayOfFrost_01_Blue_30ft_1600x400.webm`;\n    anchorX = 0.125;\n    break;\n}\n\nlet anScale = anDist / anFileSize;\nlet anScaleY = anScale;\nif (anDist<=300){anScaleY = 0.7}\nif (anDist>=400 && anDist<=600){anScaleY = anScale*0.9}\nif (anDist>=700 && anDist<=900){anScaleY = 0.8}\nif (anDist>=1000 && anDist<=1200){anScaleY = anScale*0.9}\nif (anDist>=1300 && anDist<=1500){anScaleY = 0.6}\nif (anDist>=1600 && anDist<=1800){anScaleY = 0.8}\nif (anDist>=1800){anScaleY = anScale}\n\nlet spellAnim = \n                    {\n                     file: anFile,\n                      position: myToken.center,\n                      anchor: {\n                       x: anchorX,\n                       y: 0.5\n                      },\n                      angle: anDeg,\n                      scale: {\n                       x: anScale,\n                       y: anScaleY\n                      }\n                    }; \n\ncanvas.fxmaster.playVideo(spellAnim);\ngame.socket.emit('module.fxmaster', spellAnim);\nawait wait (500);\n}\n}\nCast ()","author":"NeG597KOgANJAOdY","img":"modules/JB2A_DnD5e/Library/Cantrip/Ray_Of_Frost/RayOfFrost_01_Blue_Thumb.webp","actorIds":[],"_id":"xSb06o3xiVqLKcMI"}
